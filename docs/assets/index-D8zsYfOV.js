var LV=Object.defineProperty;var D3=i=>{throw TypeError(i)};var DV=(i,e,t)=>e in i?LV(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var oe=(i,e,t)=>DV(i,typeof e!="symbol"?e+"":e,t),HS=(i,e,t)=>e.has(i)||D3("Cannot "+t);var gt=(i,e,t)=>(HS(i,e,"read from private field"),t?t.call(i):e.get(i)),st=(i,e,t)=>e.has(i)?D3("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),Ln=(i,e,t,n)=>(HS(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),W=(i,e,t)=>(HS(i,e,"access private method"),t);var GS=(i,e,t,n)=>({set _(r){Ln(i,e,r,t)},get _(){return gt(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var qd,qa,Bo,Ii,LU,DU,_T,wT,ST,jx,IU;class IV{constructor(e,t,n,r){st(this,Ii);st(this,qd);st(this,qa,[]);st(this,Bo,0);Ln(this,qa,e),Ln(this,qd,document.querySelector(t)),W(this,Ii,LU).call(this,n,r),W(this,Ii,DU).call(this)}run(){gt(this,qa).length&&W(this,Ii,jx).call(this)}}qd=new WeakMap,qa=new WeakMap,Bo=new WeakMap,Ii=new WeakSet,LU=function(e,t){const n=document.querySelector(e),r=document.querySelector(t);n.addEventListener("click",W(this,Ii,wT).bind(this)),r.addEventListener("click",W(this,Ii,_T).bind(this))},DU=function(){document.addEventListener("keydown",e=>{e.key==="ArrowRight"&&W(this,Ii,_T).call(this),e.key==="ArrowLeft"&&W(this,Ii,wT).call(this)})},_T=function(){W(this,Ii,ST).call(this),gt(this,Bo)>=gt(this,qa).length-1?Ln(this,Bo,0):GS(this,Bo)._++,W(this,Ii,jx).call(this)},wT=function(){W(this,Ii,ST).call(this),gt(this,Bo)<=0?Ln(this,Bo,gt(this,qa).length-1):GS(this,Bo)._--,W(this,Ii,jx).call(this)},ST=function(){gt(this,qa)[gt(this,Bo)].close()},jx=function(){gt(this,qa)[gt(this,Bo)].open(),W(this,Ii,IU).call(this)},IU=function(){var n;const e=gt(this,qa)[gt(this,Bo)],t=document.createElement("a");t.href=e.link,t.target="_blank",t.rel="noopener noreferrer",t.textContent=`[Lesson ${e.number}] ${e.title}`,(n=gt(this,qd).querySelector("a"))==null||n.remove(),gt(this,qd).append(t)};/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const rf="169",ao={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},lo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},UU=0,MT=1,FU=2,UV=3,kU=0,zp=1,Ji=2,ya=3,wo=0,Vi=1,_n=2,ba=0,Ch=1,ea=2,bT=3,TT=4,NU=5,Dc=100,OU=101,zU=102,BU=103,HU=104,GU=200,VU=201,WU=202,jU=203,T1=204,E1=205,XU=206,YU=207,qU=208,KU=209,ZU=210,QU=211,JU=212,$U=213,eF=214,A1=0,C1=1,P1=2,Hh=3,R1=4,L1=5,D1=6,I1=7,k0=0,tF=1,nF=2,Ta=0,GE=1,Bp=2,VE=3,ta=4,iF=5,rF=6,sF=7,ET="attached",oF="detached",Q_=300,Xl=301,tu=302,Ca=303,Kg=304,Hp=306,xn=1e3,ds=1001,dp=1002,wn=1003,J_=1004,FV=1004,yh=1005,kV=1005,gn=1006,kd=1007,NV=1007,uo=1008,OV=1008,Pa=1009,WE=1010,jE=1011,Gh=1012,$_=1013,Yl=1014,Hi=1015,Zi=1016,ew=1017,tw=1018,Vh=1020,XE=35902,YE=1021,qE=1022,fr=1023,KE=1024,ZE=1025,Vc=1026,Wh=1027,N0=1028,O0=1029,QE=1030,nw=1031,zV=1032,iw=1033,bg=33776,Tg=33777,Eg=33778,Ag=33779,U1=35840,F1=35841,k1=35842,N1=35843,O1=36196,z1=37492,B1=37496,H1=37808,G1=37809,V1=37810,W1=37811,j1=37812,X1=37813,Y1=37814,q1=37815,K1=37816,Z1=37817,Q1=37818,J1=37819,$1=37820,e_=37821,Cg=36492,t_=36494,n_=36495,JE=36283,i_=36284,r_=36285,s_=36286,aF=2200,lF=2201,cF=2202,pp=2300,mp=2301,Xx=2302,xh=2400,_h=2401,Zg=2402,rw=2500,$E=2501,uF=0,eA=1,o_=2,hF=3200,sf=3201,BV=3202,HV=3203,du=0,fF=1,zl="",Wt="srgb",Wi="srgb-linear",sw="display-p3",z0="display-p3-linear",Qg="linear",Nn="srgb",Jg="rec709",$g="p3",GV=0,oh=7680,VV=7681,WV=7682,jV=7683,XV=34055,YV=34056,qV=5386,KV=512,ZV=513,QV=514,JV=515,$V=516,eW=517,tW=518,AT=519,dF=512,pF=513,mF=514,tA=515,gF=516,vF=517,yF=518,xF=519,e0=35044,nW=35048,iW=35040,rW=35045,sW=35049,oW=35041,aW=35046,lW=35050,cW=35042,uW="100",CT="300 es",Ja=2e3,t0=2001;let hl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const Or=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let I3=1234567;const Ph=Math.PI/180,gp=180/Math.PI;function vo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Or[i&255]+Or[i>>8&255]+Or[i>>16&255]+Or[i>>24&255]+"-"+Or[e&255]+Or[e>>8&255]+"-"+Or[e>>16&15|64]+Or[e>>24&255]+"-"+Or[t&63|128]+Or[t>>8&255]+"-"+Or[t>>16&255]+Or[t>>24&255]+Or[n&255]+Or[n>>8&255]+Or[n>>16&255]+Or[n>>24&255]).toLowerCase()}function mi(i,e,t){return Math.max(e,Math.min(t,i))}function nA(i,e){return(i%e+e)%e}function hW(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function fW(i,e,t){return i!==e?(t-i)/(e-i):0}function Pg(i,e,t){return(1-t)*i+t*e}function dW(i,e,t,n){return Pg(i,e,1-Math.exp(-t*n))}function pW(i,e=1){return e-Math.abs(nA(i,e*2)-e)}function mW(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function gW(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function vW(i,e){return i+Math.floor(Math.random()*(e-i+1))}function yW(i,e){return i+Math.random()*(e-i)}function xW(i){return i*(.5-Math.random())}function _W(i){i!==void 0&&(I3=i);let e=I3+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function wW(i){return i*Ph}function SW(i){return i*gp}function MW(i){return(i&i-1)===0&&i!==0}function bW(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function TW(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function EW(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),u=o((e+n)/2),h=s((e-n)/2),f=o((e-n)/2),p=s((n-e)/2),v=o((n-e)/2);switch(r){case"XYX":i.set(a*u,l*h,l*f,a*c);break;case"YZY":i.set(l*f,a*u,l*h,a*c);break;case"ZXZ":i.set(l*h,l*f,a*u,a*c);break;case"XZX":i.set(a*u,l*v,l*p,a*c);break;case"YXY":i.set(l*p,a*u,l*v,a*c);break;case"ZYZ":i.set(l*v,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function hs(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Vt(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Ai={DEG2RAD:Ph,RAD2DEG:gp,generateUUID:vo,clamp:mi,euclideanModulo:nA,mapLinear:hW,inverseLerp:fW,lerp:Pg,damp:dW,pingpong:pW,smoothstep:mW,smootherstep:gW,randInt:vW,randFloat:yW,randFloatSpread:xW,seededRandom:_W,degToRad:wW,radToDeg:SW,isPowerOfTwo:MW,ceilPowerOfTwo:bW,floorPowerOfTwo:TW,setQuaternionFromProperEuler:EW,normalize:Vt,denormalize:hs};class be{constructor(e=0,t=0){be.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(mi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Nt{constructor(e,t,n,r,s,o,a,l,c){Nt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,c)}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],f=n[2],p=n[5],v=n[8],x=r[0],y=r[3],g=r[6],_=r[1],w=r[4],S=r[7],C=r[2],E=r[5],A=r[8];return s[0]=o*x+a*_+l*C,s[3]=o*y+a*w+l*E,s[6]=o*g+a*S+l*A,s[1]=c*x+u*_+h*C,s[4]=c*y+u*w+h*E,s[7]=c*g+u*S+h*A,s[2]=f*x+p*_+v*C,s[5]=f*y+p*w+v*E,s[8]=f*g+p*S+v*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=a*l-u*s,p=c*s-o*l,v=t*h+n*f+r*p;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/v;return e[0]=h*x,e[1]=(r*c-u*n)*x,e[2]=(a*n-r*o)*x,e[3]=f*x,e[4]=(u*t-r*l)*x,e[5]=(r*s-a*t)*x,e[6]=p*x,e[7]=(n*l-c*t)*x,e[8]=(o*t-n*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(VS.makeScale(e,t)),this}rotate(e){return this.premultiply(VS.makeRotation(-e)),this}translate(e,t){return this.premultiply(VS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const VS=new Nt;function _F(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const AW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function vd(i,e){return new AW[i](e)}function n0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function wF(){const i=n0("canvas");return i.style.display="block",i}const U3={};function Yx(i){i in U3||(U3[i]=!0,console.warn(i))}function CW(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}function PW(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function RW(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const F3=new Nt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),k3=new Nt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Am={[Wi]:{transfer:Qg,primaries:Jg,luminanceCoefficients:[.2126,.7152,.0722],toReference:i=>i,fromReference:i=>i},[Wt]:{transfer:Nn,primaries:Jg,luminanceCoefficients:[.2126,.7152,.0722],toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[z0]:{transfer:Qg,primaries:$g,luminanceCoefficients:[.2289,.6917,.0793],toReference:i=>i.applyMatrix3(k3),fromReference:i=>i.applyMatrix3(F3)},[sw]:{transfer:Nn,primaries:$g,luminanceCoefficients:[.2289,.6917,.0793],toReference:i=>i.convertSRGBToLinear().applyMatrix3(k3),fromReference:i=>i.applyMatrix3(F3).convertLinearToSRGB()}},LW=new Set([Wi,z0]),on={enabled:!0,_workingColorSpace:Wi,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!LW.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;const n=Am[e].toReference,r=Am[t].fromReference;return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return Am[i].primaries},getTransfer:function(i){return i===zl?Qg:Am[i].transfer},getLuminanceCoefficients:function(i,e=this._workingColorSpace){return i.fromArray(Am[e].luminanceCoefficients)}};function Nd(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function WS(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Rf;class SF{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Rf===void 0&&(Rf=n0("canvas")),Rf.width=e.width,Rf.height=e.height;const n=Rf.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Rf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=n0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Nd(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Nd(t[n]/255)*255):t[n]=Nd(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let DW=0;class wh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:DW++}),this.uuid=vo(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(jS(r[o].image)):s.push(jS(r[o]))}else s=jS(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function jS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?SF.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let IW=0;class Cn extends hl{constructor(e=Cn.DEFAULT_IMAGE,t=Cn.DEFAULT_MAPPING,n=ds,r=ds,s=gn,o=uo,a=fr,l=Pa,c=Cn.DEFAULT_ANISOTROPY,u=zl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:IW++}),this.uuid=vo(),this.name="",this.source=new wh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new be(0,0),this.repeat=new be(1,1),this.center=new be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Nt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Q_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case xn:e.x=e.x-Math.floor(e.x);break;case ds:e.x=e.x<0?0:1;break;case dp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case xn:e.y=e.y-Math.floor(e.y);break;case ds:e.y=e.y<0?0:1;break;case dp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Cn.DEFAULT_IMAGE=null;Cn.DEFAULT_MAPPING=Q_;Cn.DEFAULT_ANISOTROPY=1;class Pt{constructor(e=0,t=0,n=0,r=1){Pt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],f=l[1],p=l[5],v=l[9],x=l[2],y=l[6],g=l[10];if(Math.abs(u-f)<.01&&Math.abs(h-x)<.01&&Math.abs(v-y)<.01){if(Math.abs(u+f)<.1&&Math.abs(h+x)<.1&&Math.abs(v+y)<.1&&Math.abs(c+p+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(c+1)/2,S=(p+1)/2,C=(g+1)/2,E=(u+f)/4,A=(h+x)/4,T=(v+y)/4;return w>S&&w>C?w<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(w),r=E/n,s=A/n):S>C?S<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(S),n=E/r,s=T/r):C<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),n=A/s,r=T/s),this.set(n,r,s,t),this}let _=Math.sqrt((y-v)*(y-v)+(h-x)*(h-x)+(f-u)*(f-u));return Math.abs(_)<.001&&(_=1),this.x=(y-v)/_,this.y=(h-x)/_,this.z=(f-u)/_,this.w=Math.acos((c+p+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class MF extends hl{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Pt(0,0,e,t),this.scissorTest=!1,this.viewport=new Pt(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:gn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const s=new Cn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new wh(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vi extends MF{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class ow extends Cn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=wn,this.minFilter=wn,this.wrapR=ds,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class UW extends vi{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new ow(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class iA extends Cn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=wn,this.minFilter=wn,this.wrapR=ds,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class FW extends vi{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new iA(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Qt{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const f=s[o+0],p=s[o+1],v=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h;return}if(a===1){e[t+0]=f,e[t+1]=p,e[t+2]=v,e[t+3]=x;return}if(h!==x||l!==f||c!==p||u!==v){let y=1-a;const g=l*f+c*p+u*v+h*x,_=g>=0?1:-1,w=1-g*g;if(w>Number.EPSILON){const C=Math.sqrt(w),E=Math.atan2(C,g*_);y=Math.sin(y*E)/C,a=Math.sin(a*E)/C}const S=a*_;if(l=l*y+f*S,c=c*y+p*S,u=u*y+v*S,h=h*y+x*S,y===1-a){const C=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=C,c*=C,u*=C,h*=C}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],f=s[o+1],p=s[o+2],v=s[o+3];return e[t]=a*v+u*h+l*p-c*f,e[t+1]=l*v+u*f+c*h-a*p,e[t+2]=c*v+u*p+a*f-l*h,e[t+3]=u*v-a*h-l*f-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),f=l(n/2),p=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=f*u*h+c*p*v,this._y=c*p*h-f*u*v,this._z=c*u*v+f*p*h,this._w=c*u*h-f*p*v;break;case"YXZ":this._x=f*u*h+c*p*v,this._y=c*p*h-f*u*v,this._z=c*u*v-f*p*h,this._w=c*u*h+f*p*v;break;case"ZXY":this._x=f*u*h-c*p*v,this._y=c*p*h+f*u*v,this._z=c*u*v+f*p*h,this._w=c*u*h-f*p*v;break;case"ZYX":this._x=f*u*h-c*p*v,this._y=c*p*h+f*u*v,this._z=c*u*v-f*p*h,this._w=c*u*h+f*p*v;break;case"YZX":this._x=f*u*h+c*p*v,this._y=c*p*h+f*u*v,this._z=c*u*v-f*p*h,this._w=c*u*h-f*p*v;break;case"XZY":this._x=f*u*h-c*p*v,this._y=c*p*h-f*u*v,this._z=c*u*v+f*p*h,this._w=c*u*h+f*p*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],f=n+a+h;if(f>0){const p=.5/Math.sqrt(f+1);this._w=.25/p,this._x=(u-l)*p,this._y=(s-c)*p,this._z=(o-r)*p}else if(n>a&&n>h){const p=2*Math.sqrt(1+n-a-h);this._w=(u-l)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(s+c)/p}else if(a>h){const p=2*Math.sqrt(1+a-n-h);this._w=(s-c)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(l+u)/p}else{const p=2*Math.sqrt(1+h-n-a);this._w=(o-r)/p,this._x=(s+c)/p,this._y=(l+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const p=1-t;return this._w=p*o+t*this._w,this._x=p*n+t*this._x,this._y=p*r+t*this._y,this._z=p*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,f=Math.sin(t*u)/c;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=s*h+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class N{constructor(e=0,t=0,n=0){N.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(N3.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(N3.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*n),u=2*(a*t-s*r),h=2*(s*n-o*t);return this.x=t+l*c+o*h-a*u,this.y=n+l*u+a*c-s*h,this.z=r+l*h+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return XS.copy(this).projectOnVector(e),this.sub(XS)}reflect(e){return this.sub(XS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(mi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const XS=new N,N3=new Qt;class vn{constructor(e=new N(1/0,1/0,1/0),t=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(fa.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(fa.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=fa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,fa):fa.fromBufferAttribute(s,o),fa.applyMatrix4(e.matrixWorld),this.expandByPoint(fa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Jv.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Jv.copy(n.boundingBox)),Jv.applyMatrix4(e.matrixWorld),this.union(Jv)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,fa),fa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Cm),$v.subVectors(this.max,Cm),Lf.subVectors(e.a,Cm),Df.subVectors(e.b,Cm),If.subVectors(e.c,Cm),mc.subVectors(Df,Lf),gc.subVectors(If,Df),zu.subVectors(Lf,If);let t=[0,-mc.z,mc.y,0,-gc.z,gc.y,0,-zu.z,zu.y,mc.z,0,-mc.x,gc.z,0,-gc.x,zu.z,0,-zu.x,-mc.y,mc.x,0,-gc.y,gc.x,0,-zu.y,zu.x,0];return!YS(t,Lf,Df,If,$v)||(t=[1,0,0,0,1,0,0,0,1],!YS(t,Lf,Df,If,$v))?!1:(ey.crossVectors(mc,gc),t=[ey.x,ey.y,ey.z],YS(t,Lf,Df,If,$v))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(fa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ml[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ml[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ml[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ml[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ml[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ml[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ml[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ml[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ml),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ml=[new N,new N,new N,new N,new N,new N,new N,new N],fa=new N,Jv=new vn,Lf=new N,Df=new N,If=new N,mc=new N,gc=new N,zu=new N,Cm=new N,$v=new N,ey=new N,Bu=new N;function YS(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Bu.fromArray(i,s);const a=r.x*Math.abs(Bu.x)+r.y*Math.abs(Bu.y)+r.z*Math.abs(Bu.z),l=e.dot(Bu),c=t.dot(Bu),u=n.dot(Bu);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const kW=new vn,Pm=new N,qS=new N;class Li{constructor(e=new N,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):kW.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Pm.subVectors(e,this.center);const t=Pm.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Pm,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(qS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Pm.copy(e.center).add(qS)),this.expandByPoint(Pm.copy(e.center).sub(qS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const bl=new N,KS=new N,ty=new N,vc=new N,ZS=new N,ny=new N,QS=new N;class la{constructor(e=new N,t=new N(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,bl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=bl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(bl.copy(this.origin).addScaledVector(this.direction,t),bl.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){KS.copy(e).add(t).multiplyScalar(.5),ty.copy(t).sub(e).normalize(),vc.copy(this.origin).sub(KS);const s=e.distanceTo(t)*.5,o=-this.direction.dot(ty),a=vc.dot(this.direction),l=-vc.dot(ty),c=vc.lengthSq(),u=Math.abs(1-o*o);let h,f,p,v;if(u>0)if(h=o*l-a,f=o*a-l,v=s*u,h>=0)if(f>=-v)if(f<=v){const x=1/u;h*=x,f*=x,p=h*(h+o*f+2*a)+f*(o*h+f+2*l)+c}else f=s,h=Math.max(0,-(o*f+a)),p=-h*h+f*(f+2*l)+c;else f=-s,h=Math.max(0,-(o*f+a)),p=-h*h+f*(f+2*l)+c;else f<=-v?(h=Math.max(0,-(-o*s+a)),f=h>0?-s:Math.min(Math.max(-s,-l),s),p=-h*h+f*(f+2*l)+c):f<=v?(h=0,f=Math.min(Math.max(-s,-l),s),p=f*(f+2*l)+c):(h=Math.max(0,-(o*s+a)),f=h>0?s:Math.min(Math.max(-s,-l),s),p=-h*h+f*(f+2*l)+c);else f=o>0?-s:s,h=Math.max(0,-(o*f+a)),p=-h*h+f*(f+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(KS).addScaledVector(ty,f),p}intersectSphere(e,t){bl.subVectors(e.center,this.origin);const n=bl.dot(this.direction),r=bl.dot(bl)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,f=this.origin;return c>=0?(n=(e.min.x-f.x)*c,r=(e.max.x-f.x)*c):(n=(e.max.x-f.x)*c,r=(e.min.x-f.x)*c),u>=0?(s=(e.min.y-f.y)*u,o=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,o=(e.min.y-f.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-f.z)*h,l=(e.max.z-f.z)*h):(a=(e.max.z-f.z)*h,l=(e.min.z-f.z)*h),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,bl)!==null}intersectTriangle(e,t,n,r,s){ZS.subVectors(t,e),ny.subVectors(n,e),QS.crossVectors(ZS,ny);let o=this.direction.dot(QS),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;vc.subVectors(this.origin,e);const l=a*this.direction.dot(ny.crossVectors(vc,ny));if(l<0)return null;const c=a*this.direction.dot(ZS.cross(vc));if(c<0||l+c>o)return null;const u=-a*vc.dot(QS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ze{constructor(e,t,n,r,s,o,a,l,c,u,h,f,p,v,x,y){Ze.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,c,u,h,f,p,v,x,y)}set(e,t,n,r,s,o,a,l,c,u,h,f,p,v,x,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=h,g[14]=f,g[3]=p,g[7]=v,g[11]=x,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ze().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Uf.setFromMatrixColumn(e,0).length(),s=1/Uf.setFromMatrixColumn(e,1).length(),o=1/Uf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const f=o*u,p=o*h,v=a*u,x=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=p+v*c,t[5]=f-x*c,t[9]=-a*l,t[2]=x-f*c,t[6]=v+p*c,t[10]=o*l}else if(e.order==="YXZ"){const f=l*u,p=l*h,v=c*u,x=c*h;t[0]=f+x*a,t[4]=v*a-p,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=p*a-v,t[6]=x+f*a,t[10]=o*l}else if(e.order==="ZXY"){const f=l*u,p=l*h,v=c*u,x=c*h;t[0]=f-x*a,t[4]=-o*h,t[8]=v+p*a,t[1]=p+v*a,t[5]=o*u,t[9]=x-f*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const f=o*u,p=o*h,v=a*u,x=a*h;t[0]=l*u,t[4]=v*c-p,t[8]=f*c+x,t[1]=l*h,t[5]=x*c+f,t[9]=p*c-v,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const f=o*l,p=o*c,v=a*l,x=a*c;t[0]=l*u,t[4]=x-f*h,t[8]=v*h+p,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=p*h+v,t[10]=f-x*h}else if(e.order==="XZY"){const f=o*l,p=o*c,v=a*l,x=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=f*h+x,t[5]=o*u,t[9]=p*h-v,t[2]=v*h-p,t[6]=a*u,t[10]=x*h+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(NW,e,OW)}lookAt(e,t,n){const r=this.elements;return io.subVectors(e,t),io.lengthSq()===0&&(io.z=1),io.normalize(),yc.crossVectors(n,io),yc.lengthSq()===0&&(Math.abs(n.z)===1?io.x+=1e-4:io.z+=1e-4,io.normalize(),yc.crossVectors(n,io)),yc.normalize(),iy.crossVectors(io,yc),r[0]=yc.x,r[4]=iy.x,r[8]=io.x,r[1]=yc.y,r[5]=iy.y,r[9]=io.y,r[2]=yc.z,r[6]=iy.z,r[10]=io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],f=n[9],p=n[13],v=n[2],x=n[6],y=n[10],g=n[14],_=n[3],w=n[7],S=n[11],C=n[15],E=r[0],A=r[4],T=r[8],L=r[12],M=r[1],R=r[5],D=r[9],F=r[13],z=r[2],q=r[6],H=r[10],$=r[14],U=r[3],X=r[7],j=r[11],B=r[15];return s[0]=o*E+a*M+l*z+c*U,s[4]=o*A+a*R+l*q+c*X,s[8]=o*T+a*D+l*H+c*j,s[12]=o*L+a*F+l*$+c*B,s[1]=u*E+h*M+f*z+p*U,s[5]=u*A+h*R+f*q+p*X,s[9]=u*T+h*D+f*H+p*j,s[13]=u*L+h*F+f*$+p*B,s[2]=v*E+x*M+y*z+g*U,s[6]=v*A+x*R+y*q+g*X,s[10]=v*T+x*D+y*H+g*j,s[14]=v*L+x*F+y*$+g*B,s[3]=_*E+w*M+S*z+C*U,s[7]=_*A+w*R+S*q+C*X,s[11]=_*T+w*D+S*H+C*j,s[15]=_*L+w*F+S*$+C*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],f=e[10],p=e[14],v=e[3],x=e[7],y=e[11],g=e[15];return v*(+s*l*h-r*c*h-s*a*f+n*c*f+r*a*p-n*l*p)+x*(+t*l*p-t*c*f+s*o*f-r*o*p+r*c*u-s*l*u)+y*(+t*c*h-t*a*p-s*o*h+n*o*p+s*a*u-n*c*u)+g*(-r*a*u-t*l*h+t*a*f+r*o*h-n*o*f+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],v=e[12],x=e[13],y=e[14],g=e[15],_=h*y*c-x*f*c+x*l*p-a*y*p-h*l*g+a*f*g,w=v*f*c-u*y*c-v*l*p+o*y*p+u*l*g-o*f*g,S=u*x*c-v*h*c+v*a*p-o*x*p-u*a*g+o*h*g,C=v*h*l-u*x*l-v*a*f+o*x*f+u*a*y-o*h*y,E=t*_+n*w+r*S+s*C;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/E;return e[0]=_*A,e[1]=(x*f*s-h*y*s-x*r*p+n*y*p+h*r*g-n*f*g)*A,e[2]=(a*y*s-x*l*s+x*r*c-n*y*c-a*r*g+n*l*g)*A,e[3]=(h*l*s-a*f*s-h*r*c+n*f*c+a*r*p-n*l*p)*A,e[4]=w*A,e[5]=(u*y*s-v*f*s+v*r*p-t*y*p-u*r*g+t*f*g)*A,e[6]=(v*l*s-o*y*s-v*r*c+t*y*c+o*r*g-t*l*g)*A,e[7]=(o*f*s-u*l*s+u*r*c-t*f*c-o*r*p+t*l*p)*A,e[8]=S*A,e[9]=(v*h*s-u*x*s-v*n*p+t*x*p+u*n*g-t*h*g)*A,e[10]=(o*x*s-v*a*s+v*n*c-t*x*c-o*n*g+t*a*g)*A,e[11]=(u*a*s-o*h*s-u*n*c+t*h*c+o*n*p-t*a*p)*A,e[12]=C*A,e[13]=(u*x*r-v*h*r+v*n*f-t*x*f-u*n*y+t*h*y)*A,e[14]=(v*a*r-o*x*r-v*n*l+t*x*l+o*n*y-t*a*y)*A,e[15]=(o*h*r-u*a*r+u*n*l-t*h*l-o*n*f+t*a*f)*A,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,f=s*c,p=s*u,v=s*h,x=o*u,y=o*h,g=a*h,_=l*c,w=l*u,S=l*h,C=n.x,E=n.y,A=n.z;return r[0]=(1-(x+g))*C,r[1]=(p+S)*C,r[2]=(v-w)*C,r[3]=0,r[4]=(p-S)*E,r[5]=(1-(f+g))*E,r[6]=(y+_)*E,r[7]=0,r[8]=(v+w)*A,r[9]=(y-_)*A,r[10]=(1-(f+x))*A,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Uf.set(r[0],r[1],r[2]).length();const o=Uf.set(r[4],r[5],r[6]).length(),a=Uf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],da.copy(this);const c=1/s,u=1/o,h=1/a;return da.elements[0]*=c,da.elements[1]*=c,da.elements[2]*=c,da.elements[4]*=u,da.elements[5]*=u,da.elements[6]*=u,da.elements[8]*=h,da.elements[9]*=h,da.elements[10]*=h,t.setFromRotationMatrix(da),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=Ja){const l=this.elements,c=2*s/(t-e),u=2*s/(n-r),h=(t+e)/(t-e),f=(n+r)/(n-r);let p,v;if(a===Ja)p=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===t0)p=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=f,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=Ja){const l=this.elements,c=1/(t-e),u=1/(n-r),h=1/(o-s),f=(t+e)*c,p=(n+r)*u;let v,x;if(a===Ja)v=(o+s)*h,x=-2*h;else if(a===t0)v=s*h,x=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-f,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=x,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Uf=new N,da=new Ze,NW=new N(0,0,0),OW=new N(1,1,1),yc=new N,iy=new N,io=new N,O3=new Ze,z3=new Qt;class ms{constructor(e=0,t=0,n=0,r=ms.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],f=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(mi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-mi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(mi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-mi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(mi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-mi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return O3.makeRotationFromQuaternion(e),this.setFromRotationMatrix(O3,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return z3.setFromEuler(this),this.setFromQuaternion(z3,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ms.DEFAULT_ORDER="XYZ";class Rh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let zW=0;const B3=new N,Ff=new Qt,Tl=new Ze,ry=new N,Rm=new N,BW=new N,HW=new Qt,H3=new N(1,0,0),G3=new N(0,1,0),V3=new N(0,0,1),W3={type:"added"},GW={type:"removed"},kf={type:"childadded",child:null},JS={type:"childremoved",child:null};class Kt extends hl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:zW++}),this.uuid=vo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kt.DEFAULT_UP.clone();const e=new N,t=new ms,n=new Qt,r=new N(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ze},normalMatrix:{value:new Nt}}),this.matrix=new Ze,this.matrixWorld=new Ze,this.matrixAutoUpdate=Kt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Kt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Rh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ff.setFromAxisAngle(e,t),this.quaternion.multiply(Ff),this}rotateOnWorldAxis(e,t){return Ff.setFromAxisAngle(e,t),this.quaternion.premultiply(Ff),this}rotateX(e){return this.rotateOnAxis(H3,e)}rotateY(e){return this.rotateOnAxis(G3,e)}rotateZ(e){return this.rotateOnAxis(V3,e)}translateOnAxis(e,t){return B3.copy(e).applyQuaternion(this.quaternion),this.position.add(B3.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(H3,e)}translateY(e){return this.translateOnAxis(G3,e)}translateZ(e){return this.translateOnAxis(V3,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Tl.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ry.copy(e):ry.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Rm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tl.lookAt(Rm,ry,this.up):Tl.lookAt(ry,Rm,this.up),this.quaternion.setFromRotationMatrix(Tl),r&&(Tl.extractRotation(r.matrixWorld),Ff.setFromRotationMatrix(Tl),this.quaternion.premultiply(Ff.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(W3),kf.child=e,this.dispatchEvent(kf),kf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(GW),JS.child=e,this.dispatchEvent(JS),JS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Tl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Tl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Tl),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(W3),kf.child=e,this.dispatchEvent(kf),kf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rm,e,BW),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rm,HW,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),f=o(e.skeletons),p=o(e.animations),v=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),f.length>0&&(n.skeletons=f),p.length>0&&(n.animations=p),v.length>0&&(n.nodes=v)}return n.object=r,n;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Kt.DEFAULT_UP=new N(0,1,0);Kt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Kt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pa=new N,El=new N,$S=new N,Al=new N,Nf=new N,Of=new N,j3=new N,eM=new N,tM=new N,nM=new N,iM=new Pt,rM=new Pt,sM=new Pt;class An{constructor(e=new N,t=new N,n=new N){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),pa.subVectors(e,t),r.cross(pa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){pa.subVectors(r,t),El.subVectors(n,t),$S.subVectors(e,t);const o=pa.dot(pa),a=pa.dot(El),l=pa.dot($S),c=El.dot(El),u=El.dot($S),h=o*c-a*a;if(h===0)return s.set(0,0,0),null;const f=1/h,p=(c*l-a*u)*f,v=(o*u-a*l)*f;return s.set(1-p-v,v,p)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Al)===null?!1:Al.x>=0&&Al.y>=0&&Al.x+Al.y<=1}static getInterpolation(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Al)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Al.x),l.addScaledVector(o,Al.y),l.addScaledVector(a,Al.z),l)}static getInterpolatedAttribute(e,t,n,r,s,o){return iM.setScalar(0),rM.setScalar(0),sM.setScalar(0),iM.fromBufferAttribute(e,t),rM.fromBufferAttribute(e,n),sM.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(iM,s.x),o.addScaledVector(rM,s.y),o.addScaledVector(sM,s.z),o}static isFrontFacing(e,t,n,r){return pa.subVectors(n,t),El.subVectors(e,t),pa.cross(El).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pa.subVectors(this.c,this.b),El.subVectors(this.a,this.b),pa.cross(El).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return An.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return An.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return An.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return An.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return An.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;Nf.subVectors(r,n),Of.subVectors(s,n),eM.subVectors(e,n);const l=Nf.dot(eM),c=Of.dot(eM);if(l<=0&&c<=0)return t.copy(n);tM.subVectors(e,r);const u=Nf.dot(tM),h=Of.dot(tM);if(u>=0&&h<=u)return t.copy(r);const f=l*h-u*c;if(f<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(Nf,o);nM.subVectors(e,s);const p=Nf.dot(nM),v=Of.dot(nM);if(v>=0&&p<=v)return t.copy(s);const x=p*c-l*v;if(x<=0&&c>=0&&v<=0)return a=c/(c-v),t.copy(n).addScaledVector(Of,a);const y=u*v-p*h;if(y<=0&&h-u>=0&&p-v>=0)return j3.subVectors(s,r),a=(h-u)/(h-u+(p-v)),t.copy(r).addScaledVector(j3,a);const g=1/(y+x+f);return o=x*g,a=f*g,t.copy(n).addScaledVector(Nf,o).addScaledVector(Of,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const bF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xc={h:0,s:0,l:0},sy={h:0,s:0,l:0};function oM(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Ge{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Wt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,on.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=on.workingColorSpace){return this.r=e,this.g=t,this.b=n,on.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=on.workingColorSpace){if(e=nA(e,1),t=mi(t,0,1),n=mi(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=oM(o,s,e+1/3),this.g=oM(o,s,e),this.b=oM(o,s,e-1/3)}return on.toWorkingColorSpace(this,r),this}setStyle(e,t=Wt){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Wt){const n=bF[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Nd(e.r),this.g=Nd(e.g),this.b=Nd(e.b),this}copyLinearToSRGB(e){return this.r=WS(e.r),this.g=WS(e.g),this.b=WS(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Wt){return on.fromWorkingColorSpace(zr.copy(this),e),Math.round(mi(zr.r*255,0,255))*65536+Math.round(mi(zr.g*255,0,255))*256+Math.round(mi(zr.b*255,0,255))}getHexString(e=Wt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=on.workingColorSpace){on.fromWorkingColorSpace(zr.copy(this),t);const n=zr.r,r=zr.g,s=zr.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case n:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-n)/h+2;break;case s:l=(n-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=on.workingColorSpace){return on.fromWorkingColorSpace(zr.copy(this),t),e.r=zr.r,e.g=zr.g,e.b=zr.b,e}getStyle(e=Wt){on.fromWorkingColorSpace(zr.copy(this),e);const t=zr.r,n=zr.g,r=zr.b;return e!==Wt?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(xc),this.setHSL(xc.h+e,xc.s+t,xc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(xc),e.getHSL(sy);const n=Pg(xc.h,sy.h,t),r=Pg(xc.s,sy.s,t),s=Pg(xc.l,sy.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zr=new Ge;Ge.NAMES=bF;let VW=0;class Di extends hl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:VW++}),this.uuid=vo(),this.name="",this.type="Material",this.blending=Ch,this.side=wo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=T1,this.blendDst=E1,this.blendEquation=Dc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ge(0,0,0),this.blendAlpha=0,this.depthFunc=Hh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=oh,this.stencilZFail=oh,this.stencilZPass=oh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Ch&&(n.blending=this.blending),this.side!==wo&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==T1&&(n.blendSrc=this.blendSrc),this.blendDst!==E1&&(n.blendDst=this.blendDst),this.blendEquation!==Dc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Hh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AT&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==oh&&(n.stencilFail=this.stencilFail),this.stencilZFail!==oh&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==oh&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Yt extends Di{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ms,this.combine=k0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bl=WW();function WW(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Cs(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=mi(i,-65504,65504),Bl.floatView[0]=i;const e=Bl.uint32View[0],t=e>>23&511;return Bl.baseTable[t]+((e&8388607)>>Bl.shiftTable[t])}function hg(i){const e=i>>10;return Bl.uint32View[0]=Bl.mantissaTable[Bl.offsetTable[e]+(i&1023)]+Bl.exponentTable[e],Bl.floatView[0]}const fg={toHalfFloat:Cs,fromHalfFloat:hg},Oi=new N,oy=new be;class wt{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=e0,this.updateRanges=[],this.gpuType=Hi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)oy.fromBufferAttribute(this,t),oy.applyMatrix3(e),this.setXY(t,oy.x,oy.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Oi.fromBufferAttribute(this,t),Oi.applyMatrix3(e),this.setXYZ(t,Oi.x,Oi.y,Oi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Oi.fromBufferAttribute(this,t),Oi.applyMatrix4(e),this.setXYZ(t,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Oi.fromBufferAttribute(this,t),Oi.applyNormalMatrix(e),this.setXYZ(t,Oi.x,Oi.y,Oi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Oi.fromBufferAttribute(this,t),Oi.transformDirection(e),this.setXYZ(t,Oi.x,Oi.y,Oi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=hs(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Vt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=hs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=hs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=hs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=hs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==e0&&(e.usage=this.usage),e}}class jW extends wt{constructor(e,t,n){super(new Int8Array(e),t,n)}}class XW extends wt{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class YW extends wt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class qW extends wt{constructor(e,t,n){super(new Int16Array(e),t,n)}}class rA extends wt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class KW extends wt{constructor(e,t,n){super(new Int32Array(e),t,n)}}class sA extends wt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class ZW extends wt{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=hg(this.array[e*this.itemSize]);return this.normalized&&(t=hs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize]=Cs(t),this}getY(e){let t=hg(this.array[e*this.itemSize+1]);return this.normalized&&(t=hs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+1]=Cs(t),this}getZ(e){let t=hg(this.array[e*this.itemSize+2]);return this.normalized&&(t=hs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+2]=Cs(t),this}getW(e){let t=hg(this.array[e*this.itemSize+3]);return this.normalized&&(t=hs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.array[e*this.itemSize+3]=Cs(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array)),this.array[e+0]=Cs(t),this.array[e+1]=Cs(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array)),this.array[e+0]=Cs(t),this.array[e+1]=Cs(n),this.array[e+2]=Cs(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.array[e+0]=Cs(t),this.array[e+1]=Cs(n),this.array[e+2]=Cs(r),this.array[e+3]=Cs(s),this}}class lt extends wt{constructor(e,t,n){super(new Float32Array(e),t,n)}}let QW=0;const No=new Ze,aM=new Kt,zf=new N,ro=new vn,Lm=new vn,cr=new N;class yt extends hl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:QW++}),this.uuid=vo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(_F(e)?sA:rA)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Nt().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return No.makeRotationFromQuaternion(e),this.applyMatrix4(No),this}rotateX(e){return No.makeRotationX(e),this.applyMatrix4(No),this}rotateY(e){return No.makeRotationY(e),this.applyMatrix4(No),this}rotateZ(e){return No.makeRotationZ(e),this.applyMatrix4(No),this}translate(e,t,n){return No.makeTranslation(e,t,n),this.applyMatrix4(No),this}scale(e,t,n){return No.makeScale(e,t,n),this.applyMatrix4(No),this}lookAt(e){return aM.lookAt(e),aM.updateMatrix(),this.applyMatrix4(aM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(zf).negate(),this.translate(zf.x,zf.y,zf.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new lt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];ro.setFromBufferAttribute(s),this.morphTargetsRelative?(cr.addVectors(this.boundingBox.min,ro.min),this.boundingBox.expandByPoint(cr),cr.addVectors(this.boundingBox.max,ro.max),this.boundingBox.expandByPoint(cr)):(this.boundingBox.expandByPoint(ro.min),this.boundingBox.expandByPoint(ro.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Li);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new N,1/0);return}if(e){const n=this.boundingSphere.center;if(ro.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Lm.setFromBufferAttribute(a),this.morphTargetsRelative?(cr.addVectors(ro.min,Lm.min),ro.expandByPoint(cr),cr.addVectors(ro.max,Lm.max),ro.expandByPoint(cr)):(ro.expandByPoint(Lm.min),ro.expandByPoint(Lm.max))}ro.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)cr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(cr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)cr.fromBufferAttribute(a,c),l&&(zf.fromBufferAttribute(e,c),cr.add(zf)),r=Math.max(r,n.distanceToSquared(cr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new wt(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let T=0;T<n.count;T++)a[T]=new N,l[T]=new N;const c=new N,u=new N,h=new N,f=new be,p=new be,v=new be,x=new N,y=new N;function g(T,L,M){c.fromBufferAttribute(n,T),u.fromBufferAttribute(n,L),h.fromBufferAttribute(n,M),f.fromBufferAttribute(s,T),p.fromBufferAttribute(s,L),v.fromBufferAttribute(s,M),u.sub(c),h.sub(c),p.sub(f),v.sub(f);const R=1/(p.x*v.y-v.x*p.y);isFinite(R)&&(x.copy(u).multiplyScalar(v.y).addScaledVector(h,-p.y).multiplyScalar(R),y.copy(h).multiplyScalar(p.x).addScaledVector(u,-v.x).multiplyScalar(R),a[T].add(x),a[L].add(x),a[M].add(x),l[T].add(y),l[L].add(y),l[M].add(y))}let _=this.groups;_.length===0&&(_=[{start:0,count:e.count}]);for(let T=0,L=_.length;T<L;++T){const M=_[T],R=M.start,D=M.count;for(let F=R,z=R+D;F<z;F+=3)g(e.getX(F+0),e.getX(F+1),e.getX(F+2))}const w=new N,S=new N,C=new N,E=new N;function A(T){C.fromBufferAttribute(r,T),E.copy(C);const L=a[T];w.copy(L),w.sub(C.multiplyScalar(C.dot(L))).normalize(),S.crossVectors(E,L);const R=S.dot(l[T])<0?-1:1;o.setXYZW(T,w.x,w.y,w.z,R)}for(let T=0,L=_.length;T<L;++T){const M=_[T],R=M.start,D=M.count;for(let F=R,z=R+D;F<z;F+=3)A(e.getX(F+0)),A(e.getX(F+1)),A(e.getX(F+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new wt(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let f=0,p=n.count;f<p;f++)n.setXYZ(f,0,0,0);const r=new N,s=new N,o=new N,a=new N,l=new N,c=new N,u=new N,h=new N;if(e)for(let f=0,p=e.count;f<p;f+=3){const v=e.getX(f+0),x=e.getX(f+1),y=e.getX(f+2);r.fromBufferAttribute(t,v),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,y),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,v),l.fromBufferAttribute(n,x),c.fromBufferAttribute(n,y),a.add(u),l.add(u),c.add(u),n.setXYZ(v,a.x,a.y,a.z),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(y,c.x,c.y,c.z)}else for(let f=0,p=t.count;f<p;f+=3)r.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(f+0,u.x,u.y,u.z),n.setXYZ(f+1,u.x,u.y,u.z),n.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)cr.fromBufferAttribute(e,t),cr.normalize(),e.setXYZ(t,cr.x,cr.y,cr.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,f=new c.constructor(l.length*u);let p=0,v=0;for(let x=0,y=l.length;x<y;x++){a.isInterleavedBufferAttribute?p=l[x]*a.data.stride+a.offset:p=l[x]*u;for(let g=0;g<u;g++)f[v++]=c[p++]}return new wt(f,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new yt,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=c[u],p=e(f,n);l.push(p)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,f=c.length;h<f;h++){const p=c[h];u.push(p.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let f=0,p=h.length;f<p;f++)u.push(h[f].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const X3=new Ze,Hu=new la,ay=new Li,Y3=new N,ly=new N,cy=new N,uy=new N,lM=new N,hy=new N,q3=new N,fy=new N;class Ae extends Kt{constructor(e=new yt,t=new Yt){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){hy.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],h=s[l];u!==0&&(lM.fromBufferAttribute(h,e),o?hy.addScaledVector(lM,u):hy.addScaledVector(lM.sub(t),u))}t.add(hy)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),ay.copy(n.boundingSphere),ay.applyMatrix4(s),Hu.copy(e.ray).recast(e.near),!(ay.containsPoint(Hu.origin)===!1&&(Hu.intersectSphere(ay,Y3)===null||Hu.origin.distanceToSquared(Y3)>(e.far-e.near)**2))&&(X3.copy(s).invert(),Hu.copy(e.ray).applyMatrix4(X3),!(n.boundingBox!==null&&Hu.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Hu)))}_computeIntersections(e,t,n){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,f=s.groups,p=s.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,x=f.length;v<x;v++){const y=f[v],g=o[y.materialIndex],_=Math.max(y.start,p.start),w=Math.min(a.count,Math.min(y.start+y.count,p.start+p.count));for(let S=_,C=w;S<C;S+=3){const E=a.getX(S),A=a.getX(S+1),T=a.getX(S+2);r=dy(this,g,e,n,c,u,h,E,A,T),r&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,p.start),x=Math.min(a.count,p.start+p.count);for(let y=v,g=x;y<g;y+=3){const _=a.getX(y),w=a.getX(y+1),S=a.getX(y+2);r=dy(this,o,e,n,c,u,h,_,w,S),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,x=f.length;v<x;v++){const y=f[v],g=o[y.materialIndex],_=Math.max(y.start,p.start),w=Math.min(l.count,Math.min(y.start+y.count,p.start+p.count));for(let S=_,C=w;S<C;S+=3){const E=S,A=S+1,T=S+2;r=dy(this,g,e,n,c,u,h,E,A,T),r&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,p.start),x=Math.min(l.count,p.start+p.count);for(let y=v,g=x;y<g;y+=3){const _=y,w=y+1,S=y+2;r=dy(this,o,e,n,c,u,h,_,w,S),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}}}function JW(i,e,t,n,r,s,o,a){let l;if(e.side===Vi?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===wo,a),l===null)return null;fy.copy(a),fy.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(fy);return c<t.near||c>t.far?null:{distance:c,point:fy.clone(),object:i}}function dy(i,e,t,n,r,s,o,a,l,c){i.getVertexPosition(a,ly),i.getVertexPosition(l,cy),i.getVertexPosition(c,uy);const u=JW(i,e,t,n,ly,cy,uy,q3);if(u){const h=new N;An.getBarycoord(q3,ly,cy,uy,h),r&&(u.uv=An.getInterpolatedAttribute(r,a,l,c,h,new be)),s&&(u.uv1=An.getInterpolatedAttribute(s,a,l,c,h,new be)),o&&(u.normal=An.getInterpolatedAttribute(o,a,l,c,h,new N),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const f={a,b:l,c,normal:new N,materialIndex:0};An.getNormal(ly,cy,uy,f.normal),u.face=f,u.barycoord=h}return u}class un extends yt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let f=0,p=0;v("z","y","x",-1,-1,n,t,e,o,s,0),v("z","y","x",1,-1,n,t,-e,o,s,1),v("x","z","y",1,1,e,n,t,r,o,2),v("x","z","y",1,-1,e,n,-t,r,o,3),v("x","y","z",1,-1,e,t,n,r,s,4),v("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new lt(c,3)),this.setAttribute("normal",new lt(u,3)),this.setAttribute("uv",new lt(h,2));function v(x,y,g,_,w,S,C,E,A,T,L){const M=S/A,R=C/T,D=S/2,F=C/2,z=E/2,q=A+1,H=T+1;let $=0,U=0;const X=new N;for(let j=0;j<H;j++){const B=j*R-F;for(let Z=0;Z<q;Z++){const ie=Z*M-D;X[x]=ie*_,X[y]=B*w,X[g]=z,c.push(X.x,X.y,X.z),X[x]=0,X[y]=0,X[g]=E>0?1:-1,u.push(X.x,X.y,X.z),h.push(Z/A),h.push(1-j/T),$+=1}}for(let j=0;j<T;j++)for(let B=0;B<A;B++){const Z=f+B+q*j,ie=f+B+q*(j+1),V=f+(B+1)+q*(j+1),te=f+(B+1)+q*j;l.push(Z,ie,te),l.push(ie,V,te),U+=6}a.addGroup(p,U,L),p+=U,f+=$}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new un(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vp(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function cs(i){const e={};for(let t=0;t<i.length;t++){const n=vp(i[t]);for(const r in n)e[r]=n[r]}return e}function $W(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function TF(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:on.workingColorSpace}const Is={clone:vp,merge:cs};var ej=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tj=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ft extends Di{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ej,this.fragmentShader=tj,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vp(e.uniforms),this.uniformsGroups=$W(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Gp extends Kt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ze,this.projectionMatrix=new Ze,this.projectionMatrixInverse=new Ze,this.coordinateSystem=Ja}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _c=new N,K3=new be,Z3=new be;class Un extends Gp{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=gp*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ph*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return gp*2*Math.atan(Math.tan(Ph*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){_c.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(_c.x,_c.y).multiplyScalar(-e/_c.z),_c.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(_c.x,_c.y).multiplyScalar(-e/_c.z)}getViewSize(e,t){return this.getViewBounds(e,K3,Z3),t.subVectors(Z3,K3)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Ph*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Bf=-90,Hf=1;class oA extends Kt{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Un(Bf,Hf,e,t);r.layers=this.layers,this.add(r);const s=new Un(Bf,Hf,e,t);s.layers=this.layers,this.add(s);const o=new Un(Bf,Hf,e,t);o.layers=this.layers,this.add(o);const a=new Un(Bf,Hf,e,t);a.layers=this.layers,this.add(a);const l=new Un(Bf,Hf,e,t);l.layers=this.layers,this.add(l);const c=new Un(Bf,Hf,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Ja)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===t0)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,h=e.getRenderTarget(),f=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,c),n.texture.generateMipmaps=x,e.setRenderTarget(n,5,r),e.render(t,u),e.setRenderTarget(h,f,p),e.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class B0 extends Cn{constructor(e,t,n,r,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:Xl,super(e,t,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class aA extends vi{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new B0(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:gn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new un(5,5,5),s=new Ft({name:"CubemapFromEquirect",uniforms:vp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Vi,blending:ba});s.uniforms.tEquirect.value=t;const o=new Ae(r,s),a=t.minFilter;return t.minFilter===uo&&(t.minFilter=gn),new oA(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const cM=new N,nj=new N,ij=new Nt;class Vr{constructor(e=new N(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=cM.subVectors(n,t).cross(nj.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(cM),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ij.getNormalMatrix(e),r=this.coplanarPoint(cM).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Gu=new Li,py=new N;class H0{constructor(e=new Vr,t=new Vr,n=new Vr,r=new Vr,s=new Vr,o=new Vr){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ja){const n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],f=r[7],p=r[8],v=r[9],x=r[10],y=r[11],g=r[12],_=r[13],w=r[14],S=r[15];if(n[0].setComponents(l-s,f-c,y-p,S-g).normalize(),n[1].setComponents(l+s,f+c,y+p,S+g).normalize(),n[2].setComponents(l+o,f+u,y+v,S+_).normalize(),n[3].setComponents(l-o,f-u,y-v,S-_).normalize(),n[4].setComponents(l-a,f-h,y-x,S-w).normalize(),t===Ja)n[5].setComponents(l+a,f+h,y+x,S+w).normalize();else if(t===t0)n[5].setComponents(a,h,x,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Gu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Gu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gu)}intersectsSprite(e){return Gu.center.set(0,0,0),Gu.radius=.7071067811865476,Gu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gu)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(py.x=r.normal.x>0?e.max.x:e.min.x,py.y=r.normal.y>0?e.max.y:e.min.y,py.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(py)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function EF(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function rj(i){const e=new WeakMap;function t(a,l){const c=a.array,u=a.usage,h=c.byteLength,f=i.createBuffer();i.bindBuffer(l,f),i.bufferData(l,c,u),a.onUploadCallback();let p;if(c instanceof Float32Array)p=i.FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?p=i.HALF_FLOAT:p=i.UNSIGNED_SHORT;else if(c instanceof Int16Array)p=i.SHORT;else if(c instanceof Uint32Array)p=i.UNSIGNED_INT;else if(c instanceof Int32Array)p=i.INT;else if(c instanceof Int8Array)p=i.BYTE;else if(c instanceof Uint8Array)p=i.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)p=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:f,type:p,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:h}}function n(a,l,c){const u=l.array,h=l.updateRanges;if(i.bindBuffer(c,a),h.length===0)i.bufferSubData(c,0,u);else{h.sort((p,v)=>p.start-v.start);let f=0;for(let p=1;p<h.length;p++){const v=h[f],x=h[p];x.start<=v.start+v.count+1?v.count=Math.max(v.count,x.start+x.count-v.start):(++f,h[f]=x)}h.length=f+1;for(let p=0,v=h.length;p<v;p++){const x=h[p];i.bufferSubData(c,x.start*u.BYTES_PER_ELEMENT,u,x.start,x.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(i.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,t(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,a,l),c.version=a.version}}return{get:r,remove:s,update:o}}class Ot extends yt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=e/a,f=t/l,p=[],v=[],x=[],y=[];for(let g=0;g<u;g++){const _=g*f-o;for(let w=0;w<c;w++){const S=w*h-s;v.push(S,-_,0),x.push(0,0,1),y.push(w/a),y.push(1-g/l)}}for(let g=0;g<l;g++)for(let _=0;_<a;_++){const w=_+c*g,S=_+c*(g+1),C=_+1+c*(g+1),E=_+1+c*g;p.push(w,S,E),p.push(S,C,E)}this.setIndex(p),this.setAttribute("position",new lt(v,3)),this.setAttribute("normal",new lt(x,3)),this.setAttribute("uv",new lt(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ot(e.width,e.height,e.widthSegments,e.heightSegments)}}var sj=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,oj=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,aj=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,lj=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cj=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,uj=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,hj=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,fj=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,dj=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,pj=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,mj=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,gj=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,vj=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,yj=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,xj=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,_j=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,wj=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Sj=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Mj=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,bj=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Tj=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ej=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Aj=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Cj=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Pj=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Rj=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Lj=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Dj=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Ij=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Uj=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Fj="gl_FragColor = linearToOutputTexel( gl_FragColor );",kj=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Nj=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Oj=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,zj=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Bj=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Hj=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Gj=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Vj=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Wj=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jj=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Xj=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Yj=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,qj=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Kj=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Zj=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Qj=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Jj=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$j=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,e9=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,t9=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,n9=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,i9=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,r9=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,s9=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,o9=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,a9=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,l9=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,c9=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,u9=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,h9=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,f9=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,d9=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,p9=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,m9=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,g9=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,v9=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,y9=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,x9=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_9=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,w9=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,S9=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,M9=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,b9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,T9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,E9=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,A9=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,C9=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,P9=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,R9=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,L9=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,D9=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,I9=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,U9=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,F9=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,k9=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,N9=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,O9=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,z9=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,B9=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,H9=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,G9=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,V9=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,W9=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,j9=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,X9=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Y9=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,q9=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,K9=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Z9=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Q9=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,J9=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,$9=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,e7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,t7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,n7=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,i7=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const r7=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,s7=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,o7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,a7=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,l7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,c7=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,u7=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,h7=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,f7=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,d7=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,p7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,m7=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,g7=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,v7=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,y7=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,x7=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_7=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,w7=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,S7=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,M7=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,b7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,T7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,E7=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,A7=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,C7=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,P7=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,R7=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,L7=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,D7=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,I7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,U7=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,F7=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,k7=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,N7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Gt={alphahash_fragment:sj,alphahash_pars_fragment:oj,alphamap_fragment:aj,alphamap_pars_fragment:lj,alphatest_fragment:cj,alphatest_pars_fragment:uj,aomap_fragment:hj,aomap_pars_fragment:fj,batching_pars_vertex:dj,batching_vertex:pj,begin_vertex:mj,beginnormal_vertex:gj,bsdfs:vj,iridescence_fragment:yj,bumpmap_pars_fragment:xj,clipping_planes_fragment:_j,clipping_planes_pars_fragment:wj,clipping_planes_pars_vertex:Sj,clipping_planes_vertex:Mj,color_fragment:bj,color_pars_fragment:Tj,color_pars_vertex:Ej,color_vertex:Aj,common:Cj,cube_uv_reflection_fragment:Pj,defaultnormal_vertex:Rj,displacementmap_pars_vertex:Lj,displacementmap_vertex:Dj,emissivemap_fragment:Ij,emissivemap_pars_fragment:Uj,colorspace_fragment:Fj,colorspace_pars_fragment:kj,envmap_fragment:Nj,envmap_common_pars_fragment:Oj,envmap_pars_fragment:zj,envmap_pars_vertex:Bj,envmap_physical_pars_fragment:Qj,envmap_vertex:Hj,fog_vertex:Gj,fog_pars_vertex:Vj,fog_fragment:Wj,fog_pars_fragment:jj,gradientmap_pars_fragment:Xj,lightmap_pars_fragment:Yj,lights_lambert_fragment:qj,lights_lambert_pars_fragment:Kj,lights_pars_begin:Zj,lights_toon_fragment:Jj,lights_toon_pars_fragment:$j,lights_phong_fragment:e9,lights_phong_pars_fragment:t9,lights_physical_fragment:n9,lights_physical_pars_fragment:i9,lights_fragment_begin:r9,lights_fragment_maps:s9,lights_fragment_end:o9,logdepthbuf_fragment:a9,logdepthbuf_pars_fragment:l9,logdepthbuf_pars_vertex:c9,logdepthbuf_vertex:u9,map_fragment:h9,map_pars_fragment:f9,map_particle_fragment:d9,map_particle_pars_fragment:p9,metalnessmap_fragment:m9,metalnessmap_pars_fragment:g9,morphinstance_vertex:v9,morphcolor_vertex:y9,morphnormal_vertex:x9,morphtarget_pars_vertex:_9,morphtarget_vertex:w9,normal_fragment_begin:S9,normal_fragment_maps:M9,normal_pars_fragment:b9,normal_pars_vertex:T9,normal_vertex:E9,normalmap_pars_fragment:A9,clearcoat_normal_fragment_begin:C9,clearcoat_normal_fragment_maps:P9,clearcoat_pars_fragment:R9,iridescence_pars_fragment:L9,opaque_fragment:D9,packing:I9,premultiplied_alpha_fragment:U9,project_vertex:F9,dithering_fragment:k9,dithering_pars_fragment:N9,roughnessmap_fragment:O9,roughnessmap_pars_fragment:z9,shadowmap_pars_fragment:B9,shadowmap_pars_vertex:H9,shadowmap_vertex:G9,shadowmask_pars_fragment:V9,skinbase_vertex:W9,skinning_pars_vertex:j9,skinning_vertex:X9,skinnormal_vertex:Y9,specularmap_fragment:q9,specularmap_pars_fragment:K9,tonemapping_fragment:Z9,tonemapping_pars_fragment:Q9,transmission_fragment:J9,transmission_pars_fragment:$9,uv_pars_fragment:e7,uv_pars_vertex:t7,uv_vertex:n7,worldpos_vertex:i7,background_vert:r7,background_frag:s7,backgroundCube_vert:o7,backgroundCube_frag:a7,cube_vert:l7,cube_frag:c7,depth_vert:u7,depth_frag:h7,distanceRGBA_vert:f7,distanceRGBA_frag:d7,equirect_vert:p7,equirect_frag:m7,linedashed_vert:g7,linedashed_frag:v7,meshbasic_vert:y7,meshbasic_frag:x7,meshlambert_vert:_7,meshlambert_frag:w7,meshmatcap_vert:S7,meshmatcap_frag:M7,meshnormal_vert:b7,meshnormal_frag:T7,meshphong_vert:E7,meshphong_frag:A7,meshphysical_vert:C7,meshphysical_frag:P7,meshtoon_vert:R7,meshtoon_frag:L7,points_vert:D7,points_frag:I7,shadow_vert:U7,shadow_frag:F7,sprite_vert:k7,sprite_frag:N7},it={common:{diffuse:{value:new Ge(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Nt},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Nt}},envmap:{envMap:{value:null},envMapRotation:{value:new Nt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Nt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Nt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Nt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Nt},normalScale:{value:new be(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Nt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Nt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Nt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Nt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ge(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ge(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0},uvTransform:{value:new Nt}},sprite:{diffuse:{value:new Ge(16777215)},opacity:{value:1},center:{value:new be(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Nt},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0}}},wa={basic:{uniforms:cs([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.fog]),vertexShader:Gt.meshbasic_vert,fragmentShader:Gt.meshbasic_frag},lambert:{uniforms:cs([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new Ge(0)}}]),vertexShader:Gt.meshlambert_vert,fragmentShader:Gt.meshlambert_frag},phong:{uniforms:cs([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new Ge(0)},specular:{value:new Ge(1118481)},shininess:{value:30}}]),vertexShader:Gt.meshphong_vert,fragmentShader:Gt.meshphong_frag},standard:{uniforms:cs([it.common,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.roughnessmap,it.metalnessmap,it.fog,it.lights,{emissive:{value:new Ge(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gt.meshphysical_vert,fragmentShader:Gt.meshphysical_frag},toon:{uniforms:cs([it.common,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.gradientmap,it.fog,it.lights,{emissive:{value:new Ge(0)}}]),vertexShader:Gt.meshtoon_vert,fragmentShader:Gt.meshtoon_frag},matcap:{uniforms:cs([it.common,it.bumpmap,it.normalmap,it.displacementmap,it.fog,{matcap:{value:null}}]),vertexShader:Gt.meshmatcap_vert,fragmentShader:Gt.meshmatcap_frag},points:{uniforms:cs([it.points,it.fog]),vertexShader:Gt.points_vert,fragmentShader:Gt.points_frag},dashed:{uniforms:cs([it.common,it.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gt.linedashed_vert,fragmentShader:Gt.linedashed_frag},depth:{uniforms:cs([it.common,it.displacementmap]),vertexShader:Gt.depth_vert,fragmentShader:Gt.depth_frag},normal:{uniforms:cs([it.common,it.bumpmap,it.normalmap,it.displacementmap,{opacity:{value:1}}]),vertexShader:Gt.meshnormal_vert,fragmentShader:Gt.meshnormal_frag},sprite:{uniforms:cs([it.sprite,it.fog]),vertexShader:Gt.sprite_vert,fragmentShader:Gt.sprite_frag},background:{uniforms:{uvTransform:{value:new Nt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Gt.background_vert,fragmentShader:Gt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Nt}},vertexShader:Gt.backgroundCube_vert,fragmentShader:Gt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Gt.cube_vert,fragmentShader:Gt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gt.equirect_vert,fragmentShader:Gt.equirect_frag},distanceRGBA:{uniforms:cs([it.common,it.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gt.distanceRGBA_vert,fragmentShader:Gt.distanceRGBA_frag},shadow:{uniforms:cs([it.lights,it.fog,{color:{value:new Ge(0)},opacity:{value:1}}]),vertexShader:Gt.shadow_vert,fragmentShader:Gt.shadow_frag}};wa.physical={uniforms:cs([wa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Nt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Nt},clearcoatNormalScale:{value:new be(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Nt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Nt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Nt},sheen:{value:0},sheenColor:{value:new Ge(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Nt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Nt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Nt},transmissionSamplerSize:{value:new be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Nt},attenuationDistance:{value:0},attenuationColor:{value:new Ge(0)},specularColor:{value:new Ge(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Nt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Nt},anisotropyVector:{value:new be},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Nt}}]),vertexShader:Gt.meshphysical_vert,fragmentShader:Gt.meshphysical_frag};const my={r:0,b:0,g:0},Vu=new ms,O7=new Ze;function z7(i,e,t,n,r,s,o){const a=new Ge(0);let l=s===!0?0:1,c,u,h=null,f=0,p=null;function v(_){let w=_.isScene===!0?_.background:null;return w&&w.isTexture&&(w=(_.backgroundBlurriness>0?t:e).get(w)),w}function x(_){let w=!1;const S=v(_);S===null?g(a,l):S&&S.isColor&&(g(S,1),w=!0);const C=i.xr.getEnvironmentBlendMode();C==="additive"?n.buffers.color.setClear(0,0,0,1,o):C==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||w)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function y(_,w){const S=v(w);S&&(S.isCubeTexture||S.mapping===Hp)?(u===void 0&&(u=new Ae(new un(1,1,1),new Ft({name:"BackgroundCubeMaterial",uniforms:vp(wa.backgroundCube.uniforms),vertexShader:wa.backgroundCube.vertexShader,fragmentShader:wa.backgroundCube.fragmentShader,side:Vi,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(C,E,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),Vu.copy(w.backgroundRotation),Vu.x*=-1,Vu.y*=-1,Vu.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(Vu.y*=-1,Vu.z*=-1),u.material.uniforms.envMap.value=S,u.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(O7.makeRotationFromEuler(Vu)),u.material.toneMapped=on.getTransfer(S.colorSpace)!==Nn,(h!==S||f!==S.version||p!==i.toneMapping)&&(u.material.needsUpdate=!0,h=S,f=S.version,p=i.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):S&&S.isTexture&&(c===void 0&&(c=new Ae(new Ot(2,2),new Ft({name:"BackgroundMaterial",uniforms:vp(wa.background.uniforms),vertexShader:wa.background.vertexShader,fragmentShader:wa.background.fragmentShader,side:wo,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=S,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=on.getTransfer(S.colorSpace)!==Nn,S.matrixAutoUpdate===!0&&S.updateMatrix(),c.material.uniforms.uvTransform.value.copy(S.matrix),(h!==S||f!==S.version||p!==i.toneMapping)&&(c.material.needsUpdate=!0,h=S,f=S.version,p=i.toneMapping),c.layers.enableAll(),_.unshift(c,c.geometry,c.material,0,0,null))}function g(_,w){_.getRGB(my,TF(i)),n.buffers.color.setClear(my.r,my.g,my.b,w,o)}return{getClearColor:function(){return a},setClearColor:function(_,w=1){a.set(_),l=w,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(_){l=_,g(a,l)},render:x,addToRenderList:y}}function B7(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=f(null);let s=r,o=!1;function a(M,R,D,F,z){let q=!1;const H=h(F,D,R);s!==H&&(s=H,c(s.object)),q=p(M,F,D,z),q&&v(M,F,D,z),z!==null&&e.update(z,i.ELEMENT_ARRAY_BUFFER),(q||o)&&(o=!1,S(M,R,D,F),z!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function l(){return i.createVertexArray()}function c(M){return i.bindVertexArray(M)}function u(M){return i.deleteVertexArray(M)}function h(M,R,D){const F=D.wireframe===!0;let z=n[M.id];z===void 0&&(z={},n[M.id]=z);let q=z[R.id];q===void 0&&(q={},z[R.id]=q);let H=q[F];return H===void 0&&(H=f(l()),q[F]=H),H}function f(M){const R=[],D=[],F=[];for(let z=0;z<t;z++)R[z]=0,D[z]=0,F[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:D,attributeDivisors:F,object:M,attributes:{},index:null}}function p(M,R,D,F){const z=s.attributes,q=R.attributes;let H=0;const $=D.getAttributes();for(const U in $)if($[U].location>=0){const j=z[U];let B=q[U];if(B===void 0&&(U==="instanceMatrix"&&M.instanceMatrix&&(B=M.instanceMatrix),U==="instanceColor"&&M.instanceColor&&(B=M.instanceColor)),j===void 0||j.attribute!==B||B&&j.data!==B.data)return!0;H++}return s.attributesNum!==H||s.index!==F}function v(M,R,D,F){const z={},q=R.attributes;let H=0;const $=D.getAttributes();for(const U in $)if($[U].location>=0){let j=q[U];j===void 0&&(U==="instanceMatrix"&&M.instanceMatrix&&(j=M.instanceMatrix),U==="instanceColor"&&M.instanceColor&&(j=M.instanceColor));const B={};B.attribute=j,j&&j.data&&(B.data=j.data),z[U]=B,H++}s.attributes=z,s.attributesNum=H,s.index=F}function x(){const M=s.newAttributes;for(let R=0,D=M.length;R<D;R++)M[R]=0}function y(M){g(M,0)}function g(M,R){const D=s.newAttributes,F=s.enabledAttributes,z=s.attributeDivisors;D[M]=1,F[M]===0&&(i.enableVertexAttribArray(M),F[M]=1),z[M]!==R&&(i.vertexAttribDivisor(M,R),z[M]=R)}function _(){const M=s.newAttributes,R=s.enabledAttributes;for(let D=0,F=R.length;D<F;D++)R[D]!==M[D]&&(i.disableVertexAttribArray(D),R[D]=0)}function w(M,R,D,F,z,q,H){H===!0?i.vertexAttribIPointer(M,R,D,z,q):i.vertexAttribPointer(M,R,D,F,z,q)}function S(M,R,D,F){x();const z=F.attributes,q=D.getAttributes(),H=R.defaultAttributeValues;for(const $ in q){const U=q[$];if(U.location>=0){let X=z[$];if(X===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(X=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(X=M.instanceColor)),X!==void 0){const j=X.normalized,B=X.itemSize,Z=e.get(X);if(Z===void 0)continue;const ie=Z.buffer,V=Z.type,te=Z.bytesPerElement,fe=V===i.INT||V===i.UNSIGNED_INT||X.gpuType===$_;if(X.isInterleavedBufferAttribute){const he=X.data,le=he.stride,G=X.offset;if(he.isInstancedInterleavedBuffer){for(let Q=0;Q<U.locationSize;Q++)g(U.location+Q,he.meshPerAttribute);M.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Q=0;Q<U.locationSize;Q++)y(U.location+Q);i.bindBuffer(i.ARRAY_BUFFER,ie);for(let Q=0;Q<U.locationSize;Q++)w(U.location+Q,B/U.locationSize,V,j,le*te,(G+B/U.locationSize*Q)*te,fe)}else{if(X.isInstancedBufferAttribute){for(let he=0;he<U.locationSize;he++)g(U.location+he,X.meshPerAttribute);M.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let he=0;he<U.locationSize;he++)y(U.location+he);i.bindBuffer(i.ARRAY_BUFFER,ie);for(let he=0;he<U.locationSize;he++)w(U.location+he,B/U.locationSize,V,j,B*te,B/U.locationSize*he*te,fe)}}else if(H!==void 0){const j=H[$];if(j!==void 0)switch(j.length){case 2:i.vertexAttrib2fv(U.location,j);break;case 3:i.vertexAttrib3fv(U.location,j);break;case 4:i.vertexAttrib4fv(U.location,j);break;default:i.vertexAttrib1fv(U.location,j)}}}}_()}function C(){T();for(const M in n){const R=n[M];for(const D in R){const F=R[D];for(const z in F)u(F[z].object),delete F[z];delete R[D]}delete n[M]}}function E(M){if(n[M.id]===void 0)return;const R=n[M.id];for(const D in R){const F=R[D];for(const z in F)u(F[z].object),delete F[z];delete R[D]}delete n[M.id]}function A(M){for(const R in n){const D=n[R];if(D[M.id]===void 0)continue;const F=D[M.id];for(const z in F)u(F[z].object),delete F[z];delete D[M.id]}}function T(){L(),o=!0,s!==r&&(s=r,c(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:T,resetDefaultState:L,dispose:C,releaseStatesOfGeometry:E,releaseStatesOfProgram:A,initAttributes:x,enableAttribute:y,disableUnusedAttributes:_}}function H7(i,e,t){let n;function r(c){n=c}function s(c,u){i.drawArrays(n,c,u),t.update(u,n,1)}function o(c,u,h){h!==0&&(i.drawArraysInstanced(n,c,u,h),t.update(u,n,h))}function a(c,u,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,u,0,h);let p=0;for(let v=0;v<h;v++)p+=u[v];t.update(p,n,1)}function l(c,u,h,f){if(h===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let v=0;v<c.length;v++)o(c[v],u[v],f[v]);else{p.multiDrawArraysInstancedWEBGL(n,c,0,u,0,f,0,h);let v=0;for(let x=0;x<h;x++)v+=u[x];for(let x=0;x<f.length;x++)t.update(v,n,f[x])}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function G7(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(A){return!(A!==fr&&n.convert(A)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(A){const T=A===Zi&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(A!==Pa&&n.convert(A)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&A!==Hi&&!T)}function l(A){if(A==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const h=t.logarithmicDepthBuffer===!0,f=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control");if(f===!0){const A=e.get("EXT_clip_control");A.clipControlEXT(A.LOWER_LEFT_EXT,A.ZERO_TO_ONE_EXT)}const p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),v=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=i.getParameter(i.MAX_TEXTURE_SIZE),y=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),g=i.getParameter(i.MAX_VERTEX_ATTRIBS),_=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),w=i.getParameter(i.MAX_VARYING_VECTORS),S=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),C=v>0,E=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:h,reverseDepthBuffer:f,maxTextures:p,maxVertexTextures:v,maxTextureSize:x,maxCubemapSize:y,maxAttributes:g,maxVertexUniforms:_,maxVaryings:w,maxFragmentUniforms:S,vertexTextures:C,maxSamples:E}}function V7(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Vr,a=new Nt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,f){const p=h.length!==0||f||n!==0||r;return r=f,n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,f){t=u(h,f,0)},this.setState=function(h,f,p){const v=h.clippingPlanes,x=h.clipIntersection,y=h.clipShadows,g=i.get(h);if(!r||v===null||v.length===0||s&&!y)s?u(null):c();else{const _=s?0:n,w=_*4;let S=g.clippingState||null;l.value=S,S=u(v,f,w,p);for(let C=0;C!==w;++C)S[C]=t[C];g.clippingState=S,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=_}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,f,p,v){const x=h!==null?h.length:0;let y=null;if(x!==0){if(y=l.value,v!==!0||y===null){const g=p+x*4,_=f.matrixWorldInverse;a.getNormalMatrix(_),(y===null||y.length<g)&&(y=new Float32Array(g));for(let w=0,S=p;w!==x;++w,S+=4)o.copy(h[w]).applyMatrix4(_,a),o.normal.toArray(y,S),y[S+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,y}}function W7(i){let e=new WeakMap;function t(o,a){return a===Ca?o.mapping=Xl:a===Kg&&(o.mapping=tu),o}function n(o){if(o&&o.isTexture){const a=o.mapping;if(a===Ca||a===Kg)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new aA(l.height);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class yo extends Gp{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const yd=4,Q3=[.125,.215,.35,.446,.526,.582],mh=20,uM=new yo,J3=new Ge;let hM=null,fM=0,dM=0,pM=!1;const ah=(1+Math.sqrt(5))/2,Gf=1/ah,$3=[new N(-ah,Gf,0),new N(ah,Gf,0),new N(-Gf,0,ah),new N(Gf,0,ah),new N(0,ah,-Gf),new N(0,ah,Gf),new N(-1,1,-1),new N(1,1,-1),new N(-1,1,1),new N(1,1,1)];class PT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){hM=this._renderer.getRenderTarget(),fM=this._renderer.getActiveCubeFace(),dM=this._renderer.getActiveMipmapLevel(),pM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=nR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=tR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hM,fM,dM),this._renderer.xr.enabled=pM,e.scissorTest=!1,gy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Xl||e.mapping===tu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),hM=this._renderer.getRenderTarget(),fM=this._renderer.getActiveCubeFace(),dM=this._renderer.getActiveMipmapLevel(),pM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:gn,minFilter:gn,generateMipmaps:!1,type:Zi,format:fr,colorSpace:Wi,depthBuffer:!1},r=eR(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=eR(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=j7(s)),this._blurMaterial=X7(s,e,t)}return r}_compileMaterial(e){const t=new Ae(this._lodPlanes[0],e);this._renderer.compile(t,uM)}_sceneToCubeUV(e,t,n,r){const a=new Un(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,f=u.toneMapping;u.getClearColor(J3),u.toneMapping=Ta,u.autoClear=!1;const p=new Yt({name:"PMREM.Background",side:Vi,depthWrite:!1,depthTest:!1}),v=new Ae(new un,p);let x=!1;const y=e.background;y?y.isColor&&(p.color.copy(y),e.background=null,x=!0):(p.color.copy(J3),x=!0);for(let g=0;g<6;g++){const _=g%3;_===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):_===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const w=this._cubeSize;gy(r,_*w,g>2?w:0,w,w),u.setRenderTarget(r),x&&u.render(v,a),u.render(e,a)}v.geometry.dispose(),v.material.dispose(),u.toneMapping=f,u.autoClear=h,e.background=y}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Xl||e.mapping===tu;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=nR()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=tR());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ae(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;gy(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,uM)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=$3[(r-s-1)%$3.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new Ae(this._lodPlanes[r],c),f=c.uniforms,p=this._sizeLods[n]-1,v=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*mh-1),x=s/v,y=isFinite(s)?1+Math.floor(u*x):mh;y>mh&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${mh}`);const g=[];let _=0;for(let A=0;A<mh;++A){const T=A/x,L=Math.exp(-T*T/2);g.push(L),A===0?_+=L:A<y&&(_+=2*L)}for(let A=0;A<g.length;A++)g[A]=g[A]/_;f.envMap.value=e.texture,f.samples.value=y,f.weights.value=g,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a);const{_lodMax:w}=this;f.dTheta.value=v,f.mipInt.value=w-n;const S=this._sizeLods[r],C=3*S*(r>w-yd?r-w+yd:0),E=4*(this._cubeSize-S);gy(t,C,E,3*S,2*S),l.setRenderTarget(t),l.render(h,uM)}}function j7(i){const e=[],t=[],n=[];let r=i;const s=i-yd+1+Q3.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-yd?l=Q3[o-i+yd-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,f=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,v=6,x=3,y=2,g=1,_=new Float32Array(x*v*p),w=new Float32Array(y*v*p),S=new Float32Array(g*v*p);for(let E=0;E<p;E++){const A=E%3*2/3-1,T=E>2?0:-1,L=[A,T,0,A+2/3,T,0,A+2/3,T+1,0,A,T,0,A+2/3,T+1,0,A,T+1,0];_.set(L,x*v*E),w.set(f,y*v*E);const M=[E,E,E,E,E,E];S.set(M,g*v*E)}const C=new yt;C.setAttribute("position",new wt(_,x)),C.setAttribute("uv",new wt(w,y)),C.setAttribute("faceIndex",new wt(S,g)),e.push(C),r>yd&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function eR(i,e,t){const n=new vi(i,e,t);return n.texture.mapping=Hp,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function gy(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function X7(i,e,t){const n=new Float32Array(mh),r=new N(0,1,0);return new Ft({name:"SphericalGaussianBlur",defines:{n:mh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:lA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ba,depthTest:!1,depthWrite:!1})}function tR(){return new Ft({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ba,depthTest:!1,depthWrite:!1})}function nR(){return new Ft({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ba,depthTest:!1,depthWrite:!1})}function lA(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Y7(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===Ca||l===Kg,u=l===Xl||l===tu;if(c||u){let h=e.get(a);const f=h!==void 0?h.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==f)return t===null&&(t=new PT(i)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),h.texture;if(h!==void 0)return h.texture;{const p=a.image;return c&&p&&p.height>0||u&&p&&r(p)?(t===null&&(t=new PT(i)),h=c?t.fromEquirectangular(a):t.fromCubemap(a),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),a.addEventListener("dispose",s),h.texture):null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function q7(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&Yx("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function K7(i,e,t,n){const r={},s=new WeakMap;function o(h){const f=h.target;f.index!==null&&e.remove(f.index);for(const v in f.attributes)e.remove(f.attributes[v]);for(const v in f.morphAttributes){const x=f.morphAttributes[v];for(let y=0,g=x.length;y<g;y++)e.remove(x[y])}f.removeEventListener("dispose",o),delete r[f.id];const p=s.get(f);p&&(e.remove(p),s.delete(f)),n.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function a(h,f){return r[f.id]===!0||(f.addEventListener("dispose",o),r[f.id]=!0,t.memory.geometries++),f}function l(h){const f=h.attributes;for(const v in f)e.update(f[v],i.ARRAY_BUFFER);const p=h.morphAttributes;for(const v in p){const x=p[v];for(let y=0,g=x.length;y<g;y++)e.update(x[y],i.ARRAY_BUFFER)}}function c(h){const f=[],p=h.index,v=h.attributes.position;let x=0;if(p!==null){const _=p.array;x=p.version;for(let w=0,S=_.length;w<S;w+=3){const C=_[w+0],E=_[w+1],A=_[w+2];f.push(C,E,E,A,A,C)}}else if(v!==void 0){const _=v.array;x=v.version;for(let w=0,S=_.length/3-1;w<S;w+=3){const C=w+0,E=w+1,A=w+2;f.push(C,E,E,A,A,C)}}else return;const y=new(_F(f)?sA:rA)(f,1);y.version=x;const g=s.get(h);g&&e.remove(g),s.set(h,y)}function u(h){const f=s.get(h);if(f){const p=h.index;p!==null&&f.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function Z7(i,e,t){let n;function r(f){n=f}let s,o;function a(f){s=f.type,o=f.bytesPerElement}function l(f,p){i.drawElements(n,p,s,f*o),t.update(p,n,1)}function c(f,p,v){v!==0&&(i.drawElementsInstanced(n,p,s,f*o,v),t.update(p,n,v))}function u(f,p,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,p,0,s,f,0,v);let y=0;for(let g=0;g<v;g++)y+=p[g];t.update(y,n,1)}function h(f,p,v,x){if(v===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let g=0;g<f.length;g++)c(f[g]/o,p[g],x[g]);else{y.multiDrawElementsInstancedWEBGL(n,p,0,s,f,0,x,0,v);let g=0;for(let _=0;_<v;_++)g+=p[_];for(let _=0;_<x.length;_++)t.update(g,n,x[_])}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function Q7(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function J7(i,e,t){const n=new WeakMap,r=new Pt;function s(o,a,l){const c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=u!==void 0?u.length:0;let f=n.get(a);if(f===void 0||f.count!==h){let L=function(){A.dispose(),n.delete(a),a.removeEventListener("dispose",L)};f!==void 0&&f.texture.dispose();const p=a.morphAttributes.position!==void 0,v=a.morphAttributes.normal!==void 0,x=a.morphAttributes.color!==void 0,y=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],_=a.morphAttributes.color||[];let w=0;p===!0&&(w=1),v===!0&&(w=2),x===!0&&(w=3);let S=a.attributes.position.count*w,C=1;S>e.maxTextureSize&&(C=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const E=new Float32Array(S*C*4*h),A=new ow(E,S,C,h);A.type=Hi,A.needsUpdate=!0;const T=w*4;for(let M=0;M<h;M++){const R=y[M],D=g[M],F=_[M],z=S*C*4*M;for(let q=0;q<R.count;q++){const H=q*T;p===!0&&(r.fromBufferAttribute(R,q),E[z+H+0]=r.x,E[z+H+1]=r.y,E[z+H+2]=r.z,E[z+H+3]=0),v===!0&&(r.fromBufferAttribute(D,q),E[z+H+4]=r.x,E[z+H+5]=r.y,E[z+H+6]=r.z,E[z+H+7]=0),x===!0&&(r.fromBufferAttribute(F,q),E[z+H+8]=r.x,E[z+H+9]=r.y,E[z+H+10]=r.z,E[z+H+11]=F.itemSize===4?r.w:1)}}f={count:h,texture:A,size:new be(S,C)},n.set(a,f),a.addEventListener("dispose",L)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let p=0;for(let x=0;x<c.length;x++)p+=c[x];const v=a.morphTargetsRelative?1:1-p;l.getUniforms().setValue(i,"morphTargetBaseInfluence",v),l.getUniforms().setValue(i,"morphTargetInfluences",c)}l.getUniforms().setValue(i,"morphTargetsTexture",f.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",f.size)}return{update:s}}function $7(i,e,t,n){let r=new WeakMap;function s(l){const c=n.render.frame,u=l.geometry,h=e.get(l,u);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const f=l.skeleton;r.get(f)!==c&&(f.update(),r.set(f,c))}return h}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}class aw extends Cn{constructor(e,t,n,r,s,o,a,l,c,u=Vc){if(u!==Vc&&u!==Wh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Vc&&(n=Yl),n===void 0&&u===Wh&&(n=Vh),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:wn,this.minFilter=l!==void 0?l:wn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const AF=new Cn,iR=new aw(1,1),CF=new ow,PF=new iA,RF=new B0,rR=[],sR=[],oR=new Float32Array(16),aR=new Float32Array(9),lR=new Float32Array(4);function Vp(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=rR[r];if(s===void 0&&(s=new Float32Array(r),rR[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function $i(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function er(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function lw(i,e){let t=sR[e];t===void 0&&(t=new Int32Array(e),sR[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function eX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function tX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2fv(this.addr,e),er(t,e)}}function nX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if($i(t,e))return;i.uniform3fv(this.addr,e),er(t,e)}}function iX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4fv(this.addr,e),er(t,e)}}function rX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),er(t,e)}else{if($i(t,n))return;lR.set(n),i.uniformMatrix2fv(this.addr,!1,lR),er(t,n)}}function sX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),er(t,e)}else{if($i(t,n))return;aR.set(n),i.uniformMatrix3fv(this.addr,!1,aR),er(t,n)}}function oX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),er(t,e)}else{if($i(t,n))return;oR.set(n),i.uniformMatrix4fv(this.addr,!1,oR),er(t,n)}}function aX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function lX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2iv(this.addr,e),er(t,e)}}function cX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($i(t,e))return;i.uniform3iv(this.addr,e),er(t,e)}}function uX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4iv(this.addr,e),er(t,e)}}function hX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function fX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2uiv(this.addr,e),er(t,e)}}function dX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($i(t,e))return;i.uniform3uiv(this.addr,e),er(t,e)}}function pX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4uiv(this.addr,e),er(t,e)}}function mX(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(iR.compareFunction=tA,s=iR):s=AF,t.setTexture2D(e||s,r)}function gX(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||PF,r)}function vX(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||RF,r)}function yX(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||CF,r)}function xX(i){switch(i){case 5126:return eX;case 35664:return tX;case 35665:return nX;case 35666:return iX;case 35674:return rX;case 35675:return sX;case 35676:return oX;case 5124:case 35670:return aX;case 35667:case 35671:return lX;case 35668:case 35672:return cX;case 35669:case 35673:return uX;case 5125:return hX;case 36294:return fX;case 36295:return dX;case 36296:return pX;case 35678:case 36198:case 36298:case 36306:case 35682:return mX;case 35679:case 36299:case 36307:return gX;case 35680:case 36300:case 36308:case 36293:return vX;case 36289:case 36303:case 36311:case 36292:return yX}}function _X(i,e){i.uniform1fv(this.addr,e)}function wX(i,e){const t=Vp(e,this.size,2);i.uniform2fv(this.addr,t)}function SX(i,e){const t=Vp(e,this.size,3);i.uniform3fv(this.addr,t)}function MX(i,e){const t=Vp(e,this.size,4);i.uniform4fv(this.addr,t)}function bX(i,e){const t=Vp(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function TX(i,e){const t=Vp(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function EX(i,e){const t=Vp(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function AX(i,e){i.uniform1iv(this.addr,e)}function CX(i,e){i.uniform2iv(this.addr,e)}function PX(i,e){i.uniform3iv(this.addr,e)}function RX(i,e){i.uniform4iv(this.addr,e)}function LX(i,e){i.uniform1uiv(this.addr,e)}function DX(i,e){i.uniform2uiv(this.addr,e)}function IX(i,e){i.uniform3uiv(this.addr,e)}function UX(i,e){i.uniform4uiv(this.addr,e)}function FX(i,e,t){const n=this.cache,r=e.length,s=lw(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),er(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||AF,s[o])}function kX(i,e,t){const n=this.cache,r=e.length,s=lw(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),er(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||PF,s[o])}function NX(i,e,t){const n=this.cache,r=e.length,s=lw(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),er(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||RF,s[o])}function OX(i,e,t){const n=this.cache,r=e.length,s=lw(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),er(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||CF,s[o])}function zX(i){switch(i){case 5126:return _X;case 35664:return wX;case 35665:return SX;case 35666:return MX;case 35674:return bX;case 35675:return TX;case 35676:return EX;case 5124:case 35670:return AX;case 35667:case 35671:return CX;case 35668:case 35672:return PX;case 35669:case 35673:return RX;case 5125:return LX;case 36294:return DX;case 36295:return IX;case 36296:return UX;case 35678:case 36198:case 36298:case 36306:case 35682:return FX;case 35679:case 36299:case 36307:return kX;case 35680:case 36300:case 36308:case 36293:return NX;case 36289:case 36303:case 36311:case 36292:return OX}}class BX{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=xX(t.type)}}class HX{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=zX(t.type)}}class GX{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const mM=/(\w+)(\])?(\[|\.)?/g;function cR(i,e){i.seq.push(e),i.map[e.id]=e}function VX(i,e,t){const n=i.name,r=n.length;for(mM.lastIndex=0;;){const s=mM.exec(n),o=mM.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){cR(t,c===void 0?new BX(a,i,e):new HX(a,i,e));break}else{let h=t.map[a];h===void 0&&(h=new GX(a),cR(t,h)),t=h}}}class qx{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);VX(s,o,this)}}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function uR(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const WX=37297;let jX=0;function XX(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}function YX(i){const e=on.getPrimaries(on.workingColorSpace),t=on.getPrimaries(i);let n;switch(e===t?n="":e===$g&&t===Jg?n="LinearDisplayP3ToLinearSRGB":e===Jg&&t===$g&&(n="LinearSRGBToLinearDisplayP3"),i){case Wi:case z0:return[n,"LinearTransferOETF"];case Wt:case sw:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),[n,"LinearTransferOETF"]}}function hR(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+XX(i.getShaderSource(e),o)}else return r}function qX(i,e){const t=YX(e);return`vec4 ${i}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function KX(i,e){let t;switch(e){case GE:t="Linear";break;case Bp:t="Reinhard";break;case VE:t="Cineon";break;case ta:t="ACESFilmic";break;case rF:t="AgX";break;case sF:t="Neutral";break;case iF:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const vy=new N;function ZX(){on.getLuminanceCoefficients(vy);const i=vy.x.toFixed(4),e=vy.y.toFixed(4),t=vy.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function QX(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(dg).join(`
`)}function JX(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function $X(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function dg(i){return i!==""}function fR(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function dR(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const eY=/^[ \t]*#include +<([\w\d./]+)>/gm;function RT(i){return i.replace(eY,nY)}const tY=new Map;function nY(i,e){let t=Gt[e];if(t===void 0){const n=tY.get(e);if(n!==void 0)t=Gt[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return RT(t)}const iY=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pR(i){return i.replace(iY,rY)}function rY(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function mR(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function sY(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===zp?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Ji?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===ya&&(e="SHADOWMAP_TYPE_VSM"),e}function oY(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Xl:case tu:e="ENVMAP_TYPE_CUBE";break;case Hp:e="ENVMAP_TYPE_CUBE_UV";break}return e}function aY(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case tu:e="ENVMAP_MODE_REFRACTION";break}return e}function lY(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case k0:e="ENVMAP_BLENDING_MULTIPLY";break;case tF:e="ENVMAP_BLENDING_MIX";break;case nF:e="ENVMAP_BLENDING_ADD";break}return e}function cY(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function uY(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=sY(t),c=oY(t),u=aY(t),h=lY(t),f=cY(t),p=QX(t),v=JX(s),x=r.createProgram();let y,g,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(dg).join(`
`),y.length>0&&(y+=`
`),g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(dg).join(`
`),g.length>0&&(g+=`
`)):(y=[mR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(dg).join(`
`),g=[mR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ta?"#define TONE_MAPPING":"",t.toneMapping!==Ta?Gt.tonemapping_pars_fragment:"",t.toneMapping!==Ta?KX("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Gt.colorspace_pars_fragment,qX("linearToOutputTexel",t.outputColorSpace),ZX(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(dg).join(`
`)),o=RT(o),o=fR(o,t),o=dR(o,t),a=RT(a),a=fR(a,t),a=dR(a,t),o=pR(o),a=pR(a),t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,y=[p,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,g=["#define varying in",t.glslVersion===CT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===CT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const w=_+y+o,S=_+g+a,C=uR(r,r.VERTEX_SHADER,w),E=uR(r,r.FRAGMENT_SHADER,S);r.attachShader(x,C),r.attachShader(x,E),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function A(R){if(i.debug.checkShaderErrors){const D=r.getProgramInfoLog(x).trim(),F=r.getShaderInfoLog(C).trim(),z=r.getShaderInfoLog(E).trim();let q=!0,H=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(q=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,x,C,E);else{const $=hR(r,C,"vertex"),U=hR(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Material Name: `+R.name+`
Material Type: `+R.type+`

Program Info Log: `+D+`
`+$+`
`+U)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(F===""||z==="")&&(H=!1);H&&(R.diagnostics={runnable:q,programLog:D,vertexShader:{log:F,prefix:y},fragmentShader:{log:z,prefix:g}})}r.deleteShader(C),r.deleteShader(E),T=new qx(r,x),L=$X(r,x)}let T;this.getUniforms=function(){return T===void 0&&A(this),T};let L;this.getAttributes=function(){return L===void 0&&A(this),L};let M=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=r.getProgramParameter(x,WX)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=jX++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=C,this.fragmentShader=E,this}let hY=0;class fY{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new dY(e),t.set(e,n)),n}}class dY{constructor(e){this.id=hY++,this.code=e,this.usedTimes=0}}function pY(i,e,t,n,r,s,o){const a=new Rh,l=new fY,c=new Set,u=[],h=r.logarithmicDepthBuffer,f=r.reverseDepthBuffer,p=r.vertexTextures;let v=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(M){return c.add(M),M===0?"uv":`uv${M}`}function g(M,R,D,F,z){const q=F.fog,H=z.geometry,$=M.isMeshStandardMaterial?F.environment:null,U=(M.isMeshStandardMaterial?t:e).get(M.envMap||$),X=U&&U.mapping===Hp?U.image.height:null,j=x[M.type];M.precision!==null&&(v=r.getMaxPrecision(M.precision),v!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",v,"instead."));const B=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,Z=B!==void 0?B.length:0;let ie=0;H.morphAttributes.position!==void 0&&(ie=1),H.morphAttributes.normal!==void 0&&(ie=2),H.morphAttributes.color!==void 0&&(ie=3);let V,te,fe,he;if(j){const Lt=wa[j];V=Lt.vertexShader,te=Lt.fragmentShader}else V=M.vertexShader,te=M.fragmentShader,l.update(M),fe=l.getVertexShaderID(M),he=l.getFragmentShaderID(M);const le=i.getRenderTarget(),G=z.isInstancedMesh===!0,Q=z.isBatchedMesh===!0,J=!!M.map,ne=!!M.matcap,Y=!!U,de=!!M.aoMap,ve=!!M.lightMap,Se=!!M.bumpMap,Te=!!M.normalMap,Ee=!!M.displacementMap,Re=!!M.emissiveMap,K=!!M.metalnessMap,k=!!M.roughnessMap,ue=M.anisotropy>0,me=M.clearcoat>0,Me=M.dispersion>0,ge=M.iridescence>0,Ye=M.sheen>0,Ie=M.transmission>0,ze=ue&&!!M.anisotropyMap,Je=me&&!!M.clearcoatMap,Fe=me&&!!M.clearcoatNormalMap,Xe=me&&!!M.clearcoatRoughnessMap,ct=ge&&!!M.iridescenceMap,tt=ge&&!!M.iridescenceThicknessMap,Ve=Ye&&!!M.sheenColorMap,qe=Ye&&!!M.sheenRoughnessMap,ce=!!M.specularMap,ke=!!M.specularColorMap,ae=!!M.specularIntensityMap,Be=Ie&&!!M.transmissionMap,pe=Ie&&!!M.thicknessMap,De=!!M.gradientMap,$e=!!M.alphaMap,je=M.alphaTest>0,rt=!!M.alphaHash,bt=!!M.extensions;let Ct=Ta;M.toneMapped&&(le===null||le.isXRRenderTarget===!0)&&(Ct=i.toneMapping);const nt={shaderID:j,shaderType:M.type,shaderName:M.name,vertexShader:V,fragmentShader:te,defines:M.defines,customVertexShaderID:fe,customFragmentShaderID:he,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:v,batching:Q,batchingColor:Q&&z._colorsTexture!==null,instancing:G,instancingColor:G&&z.instanceColor!==null,instancingMorph:G&&z.morphTexture!==null,supportsVertexTextures:p,outputColorSpace:le===null?i.outputColorSpace:le.isXRRenderTarget===!0?le.texture.colorSpace:Wi,alphaToCoverage:!!M.alphaToCoverage,map:J,matcap:ne,envMap:Y,envMapMode:Y&&U.mapping,envMapCubeUVHeight:X,aoMap:de,lightMap:ve,bumpMap:Se,normalMap:Te,displacementMap:p&&Ee,emissiveMap:Re,normalMapObjectSpace:Te&&M.normalMapType===fF,normalMapTangentSpace:Te&&M.normalMapType===du,metalnessMap:K,roughnessMap:k,anisotropy:ue,anisotropyMap:ze,clearcoat:me,clearcoatMap:Je,clearcoatNormalMap:Fe,clearcoatRoughnessMap:Xe,dispersion:Me,iridescence:ge,iridescenceMap:ct,iridescenceThicknessMap:tt,sheen:Ye,sheenColorMap:Ve,sheenRoughnessMap:qe,specularMap:ce,specularColorMap:ke,specularIntensityMap:ae,transmission:Ie,transmissionMap:Be,thicknessMap:pe,gradientMap:De,opaque:M.transparent===!1&&M.blending===Ch&&M.alphaToCoverage===!1,alphaMap:$e,alphaTest:je,alphaHash:rt,combine:M.combine,mapUv:J&&y(M.map.channel),aoMapUv:de&&y(M.aoMap.channel),lightMapUv:ve&&y(M.lightMap.channel),bumpMapUv:Se&&y(M.bumpMap.channel),normalMapUv:Te&&y(M.normalMap.channel),displacementMapUv:Ee&&y(M.displacementMap.channel),emissiveMapUv:Re&&y(M.emissiveMap.channel),metalnessMapUv:K&&y(M.metalnessMap.channel),roughnessMapUv:k&&y(M.roughnessMap.channel),anisotropyMapUv:ze&&y(M.anisotropyMap.channel),clearcoatMapUv:Je&&y(M.clearcoatMap.channel),clearcoatNormalMapUv:Fe&&y(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Xe&&y(M.clearcoatRoughnessMap.channel),iridescenceMapUv:ct&&y(M.iridescenceMap.channel),iridescenceThicknessMapUv:tt&&y(M.iridescenceThicknessMap.channel),sheenColorMapUv:Ve&&y(M.sheenColorMap.channel),sheenRoughnessMapUv:qe&&y(M.sheenRoughnessMap.channel),specularMapUv:ce&&y(M.specularMap.channel),specularColorMapUv:ke&&y(M.specularColorMap.channel),specularIntensityMapUv:ae&&y(M.specularIntensityMap.channel),transmissionMapUv:Be&&y(M.transmissionMap.channel),thicknessMapUv:pe&&y(M.thicknessMap.channel),alphaMapUv:$e&&y(M.alphaMap.channel),vertexTangents:!!H.attributes.tangent&&(Te||ue),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,pointsUvs:z.isPoints===!0&&!!H.attributes.uv&&(J||$e),fog:!!q,useFog:M.fog===!0,fogExp2:!!q&&q.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:f,skinning:z.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:Z,morphTextureStride:ie,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numLightProbes:R.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:i.shadowMap.enabled&&D.length>0,shadowMapType:i.shadowMap.type,toneMapping:Ct,decodeVideoTexture:J&&M.map.isVideoTexture===!0&&on.getTransfer(M.map.colorSpace)===Nn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===_n,flipSided:M.side===Vi,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:bt&&M.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(bt&&M.extensions.multiDraw===!0||Q)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return nt.vertexUv1s=c.has(1),nt.vertexUv2s=c.has(2),nt.vertexUv3s=c.has(3),c.clear(),nt}function _(M){const R=[];if(M.shaderID?R.push(M.shaderID):(R.push(M.customVertexShaderID),R.push(M.customFragmentShaderID)),M.defines!==void 0)for(const D in M.defines)R.push(D),R.push(M.defines[D]);return M.isRawShaderMaterial===!1&&(w(R,M),S(R,M),R.push(i.outputColorSpace)),R.push(M.customProgramCacheKey),R.join()}function w(M,R){M.push(R.precision),M.push(R.outputColorSpace),M.push(R.envMapMode),M.push(R.envMapCubeUVHeight),M.push(R.mapUv),M.push(R.alphaMapUv),M.push(R.lightMapUv),M.push(R.aoMapUv),M.push(R.bumpMapUv),M.push(R.normalMapUv),M.push(R.displacementMapUv),M.push(R.emissiveMapUv),M.push(R.metalnessMapUv),M.push(R.roughnessMapUv),M.push(R.anisotropyMapUv),M.push(R.clearcoatMapUv),M.push(R.clearcoatNormalMapUv),M.push(R.clearcoatRoughnessMapUv),M.push(R.iridescenceMapUv),M.push(R.iridescenceThicknessMapUv),M.push(R.sheenColorMapUv),M.push(R.sheenRoughnessMapUv),M.push(R.specularMapUv),M.push(R.specularColorMapUv),M.push(R.specularIntensityMapUv),M.push(R.transmissionMapUv),M.push(R.thicknessMapUv),M.push(R.combine),M.push(R.fogExp2),M.push(R.sizeAttenuation),M.push(R.morphTargetsCount),M.push(R.morphAttributeCount),M.push(R.numDirLights),M.push(R.numPointLights),M.push(R.numSpotLights),M.push(R.numSpotLightMaps),M.push(R.numHemiLights),M.push(R.numRectAreaLights),M.push(R.numDirLightShadows),M.push(R.numPointLightShadows),M.push(R.numSpotLightShadows),M.push(R.numSpotLightShadowsWithMaps),M.push(R.numLightProbes),M.push(R.shadowMapType),M.push(R.toneMapping),M.push(R.numClippingPlanes),M.push(R.numClipIntersection),M.push(R.depthPacking)}function S(M,R){a.disableAll(),R.supportsVertexTextures&&a.enable(0),R.instancing&&a.enable(1),R.instancingColor&&a.enable(2),R.instancingMorph&&a.enable(3),R.matcap&&a.enable(4),R.envMap&&a.enable(5),R.normalMapObjectSpace&&a.enable(6),R.normalMapTangentSpace&&a.enable(7),R.clearcoat&&a.enable(8),R.iridescence&&a.enable(9),R.alphaTest&&a.enable(10),R.vertexColors&&a.enable(11),R.vertexAlphas&&a.enable(12),R.vertexUv1s&&a.enable(13),R.vertexUv2s&&a.enable(14),R.vertexUv3s&&a.enable(15),R.vertexTangents&&a.enable(16),R.anisotropy&&a.enable(17),R.alphaHash&&a.enable(18),R.batching&&a.enable(19),R.dispersion&&a.enable(20),R.batchingColor&&a.enable(21),M.push(a.mask),a.disableAll(),R.fog&&a.enable(0),R.useFog&&a.enable(1),R.flatShading&&a.enable(2),R.logarithmicDepthBuffer&&a.enable(3),R.reverseDepthBuffer&&a.enable(4),R.skinning&&a.enable(5),R.morphTargets&&a.enable(6),R.morphNormals&&a.enable(7),R.morphColors&&a.enable(8),R.premultipliedAlpha&&a.enable(9),R.shadowMapEnabled&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.useDepthPacking&&a.enable(13),R.dithering&&a.enable(14),R.transmission&&a.enable(15),R.sheen&&a.enable(16),R.opaque&&a.enable(17),R.pointsUvs&&a.enable(18),R.decodeVideoTexture&&a.enable(19),R.alphaToCoverage&&a.enable(20),M.push(a.mask)}function C(M){const R=x[M.type];let D;if(R){const F=wa[R];D=Is.clone(F.uniforms)}else D=M.uniforms;return D}function E(M,R){let D;for(let F=0,z=u.length;F<z;F++){const q=u[F];if(q.cacheKey===R){D=q,++D.usedTimes;break}}return D===void 0&&(D=new uY(i,R,M,s),u.push(D)),D}function A(M){if(--M.usedTimes===0){const R=u.indexOf(M);u[R]=u[u.length-1],u.pop(),M.destroy()}}function T(M){l.remove(M)}function L(){l.dispose()}return{getParameters:g,getProgramCacheKey:_,getUniforms:C,acquireProgram:E,releaseProgram:A,releaseShaderCache:T,programs:u,dispose:L}}function mY(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let a=i.get(o);return a===void 0&&(a={},i.set(o,a)),a}function n(o){i.delete(o)}function r(o,a,l){i.get(o)[a]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function gY(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function gR(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function vR(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(h,f,p,v,x,y){let g=i[e];return g===void 0?(g={id:h.id,object:h,geometry:f,material:p,groupOrder:v,renderOrder:h.renderOrder,z:x,group:y},i[e]=g):(g.id=h.id,g.object=h,g.geometry=f,g.material=p,g.groupOrder=v,g.renderOrder=h.renderOrder,g.z=x,g.group=y),e++,g}function a(h,f,p,v,x,y){const g=o(h,f,p,v,x,y);p.transmission>0?n.push(g):p.transparent===!0?r.push(g):t.push(g)}function l(h,f,p,v,x,y){const g=o(h,f,p,v,x,y);p.transmission>0?n.unshift(g):p.transparent===!0?r.unshift(g):t.unshift(g)}function c(h,f){t.length>1&&t.sort(h||gY),n.length>1&&n.sort(f||gR),r.length>1&&r.sort(f||gR)}function u(){for(let h=e,f=i.length;h<f;h++){const p=i[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function vY(){let i=new WeakMap;function e(n,r){const s=i.get(n);let o;return s===void 0?(o=new vR,i.set(n,[o])):r>=s.length?(o=new vR,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function yY(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new N,color:new Ge};break;case"SpotLight":t={position:new N,direction:new N,color:new Ge,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new N,color:new Ge,distance:0,decay:0};break;case"HemisphereLight":t={direction:new N,skyColor:new Ge,groundColor:new Ge};break;case"RectAreaLight":t={color:new Ge,position:new N,halfWidth:new N,halfHeight:new N};break}return i[e.id]=t,t}}}function xY(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let _Y=0;function wY(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function SY(i){const e=new yY,t=xY(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new N);const r=new N,s=new Ze,o=new Ze;function a(c){let u=0,h=0,f=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let p=0,v=0,x=0,y=0,g=0,_=0,w=0,S=0,C=0,E=0,A=0;c.sort(wY);for(let L=0,M=c.length;L<M;L++){const R=c[L],D=R.color,F=R.intensity,z=R.distance,q=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)u+=D.r*F,h+=D.g*F,f+=D.b*F;else if(R.isLightProbe){for(let H=0;H<9;H++)n.probe[H].addScaledVector(R.sh.coefficients[H],F);A++}else if(R.isDirectionalLight){const H=e.get(R);if(H.color.copy(R.color).multiplyScalar(R.intensity),R.castShadow){const $=R.shadow,U=t.get(R);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,n.directionalShadow[p]=U,n.directionalShadowMap[p]=q,n.directionalShadowMatrix[p]=R.shadow.matrix,_++}n.directional[p]=H,p++}else if(R.isSpotLight){const H=e.get(R);H.position.setFromMatrixPosition(R.matrixWorld),H.color.copy(D).multiplyScalar(F),H.distance=z,H.coneCos=Math.cos(R.angle),H.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),H.decay=R.decay,n.spot[x]=H;const $=R.shadow;if(R.map&&(n.spotLightMap[C]=R.map,C++,$.updateMatrices(R),R.castShadow&&E++),n.spotLightMatrix[x]=$.matrix,R.castShadow){const U=t.get(R);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,n.spotShadow[x]=U,n.spotShadowMap[x]=q,S++}x++}else if(R.isRectAreaLight){const H=e.get(R);H.color.copy(D).multiplyScalar(F),H.halfWidth.set(R.width*.5,0,0),H.halfHeight.set(0,R.height*.5,0),n.rectArea[y]=H,y++}else if(R.isPointLight){const H=e.get(R);if(H.color.copy(R.color).multiplyScalar(R.intensity),H.distance=R.distance,H.decay=R.decay,R.castShadow){const $=R.shadow,U=t.get(R);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,U.shadowCameraNear=$.camera.near,U.shadowCameraFar=$.camera.far,n.pointShadow[v]=U,n.pointShadowMap[v]=q,n.pointShadowMatrix[v]=R.shadow.matrix,w++}n.point[v]=H,v++}else if(R.isHemisphereLight){const H=e.get(R);H.skyColor.copy(R.color).multiplyScalar(F),H.groundColor.copy(R.groundColor).multiplyScalar(F),n.hemi[g]=H,g++}}y>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=it.LTC_FLOAT_1,n.rectAreaLTC2=it.LTC_FLOAT_2):(n.rectAreaLTC1=it.LTC_HALF_1,n.rectAreaLTC2=it.LTC_HALF_2)),n.ambient[0]=u,n.ambient[1]=h,n.ambient[2]=f;const T=n.hash;(T.directionalLength!==p||T.pointLength!==v||T.spotLength!==x||T.rectAreaLength!==y||T.hemiLength!==g||T.numDirectionalShadows!==_||T.numPointShadows!==w||T.numSpotShadows!==S||T.numSpotMaps!==C||T.numLightProbes!==A)&&(n.directional.length=p,n.spot.length=x,n.rectArea.length=y,n.point.length=v,n.hemi.length=g,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=S+C-E,n.spotLightMap.length=C,n.numSpotLightShadowsWithMaps=E,n.numLightProbes=A,T.directionalLength=p,T.pointLength=v,T.spotLength=x,T.rectAreaLength=y,T.hemiLength=g,T.numDirectionalShadows=_,T.numPointShadows=w,T.numSpotShadows=S,T.numSpotMaps=C,T.numLightProbes=A,n.version=_Y++)}function l(c,u){let h=0,f=0,p=0,v=0,x=0;const y=u.matrixWorldInverse;for(let g=0,_=c.length;g<_;g++){const w=c[g];if(w.isDirectionalLight){const S=n.directional[h];S.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(y),h++}else if(w.isSpotLight){const S=n.spot[p];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(y),S.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(y),p++}else if(w.isRectAreaLight){const S=n.rectArea[v];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(y),o.identity(),s.copy(w.matrixWorld),s.premultiply(y),o.extractRotation(s),S.halfWidth.set(w.width*.5,0,0),S.halfHeight.set(0,w.height*.5,0),S.halfWidth.applyMatrix4(o),S.halfHeight.applyMatrix4(o),v++}else if(w.isPointLight){const S=n.point[f];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(y),f++}else if(w.isHemisphereLight){const S=n.hemi[x];S.direction.setFromMatrixPosition(w.matrixWorld),S.direction.transformDirection(y),x++}}}return{setup:a,setupView:l,state:n}}function yR(i){const e=new SY(i),t=[],n=[];function r(u){c.camera=u,t.length=0,n.length=0}function s(u){t.push(u)}function o(u){n.push(u)}function a(){e.setup(t)}function l(u){e.setupView(t,u)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function MY(i){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new yR(i),e.set(r,[a])):s>=o.length?(a=new yR(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}class pu extends Di{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hF,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cw extends Di{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const bY=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,TY=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function EY(i,e,t){let n=new H0;const r=new be,s=new be,o=new Pt,a=new pu({depthPacking:sf}),l=new cw,c={},u=t.maxTextureSize,h={[wo]:Vi,[Vi]:wo,[_n]:_n},f=new Ft({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new be},radius:{value:4}},vertexShader:bY,fragmentShader:TY}),p=f.clone();p.defines.HORIZONTAL_PASS=1;const v=new yt;v.setAttribute("position",new wt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Ae(v,f),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=zp;let g=this.type;this.render=function(E,A,T){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||E.length===0)return;const L=i.getRenderTarget(),M=i.getActiveCubeFace(),R=i.getActiveMipmapLevel(),D=i.state;D.setBlending(ba),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);const F=g!==ya&&this.type===ya,z=g===ya&&this.type!==ya;for(let q=0,H=E.length;q<H;q++){const $=E[q],U=$.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;r.copy(U.mapSize);const X=U.getFrameExtents();if(r.multiply(X),s.copy(U.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/X.x),r.x=s.x*X.x,U.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/X.y),r.y=s.y*X.y,U.mapSize.y=s.y)),U.map===null||F===!0||z===!0){const B=this.type!==ya?{minFilter:wn,magFilter:wn}:{};U.map!==null&&U.map.dispose(),U.map=new vi(r.x,r.y,B),U.map.texture.name=$.name+".shadowMap",U.camera.updateProjectionMatrix()}i.setRenderTarget(U.map),i.clear();const j=U.getViewportCount();for(let B=0;B<j;B++){const Z=U.getViewport(B);o.set(s.x*Z.x,s.y*Z.y,s.x*Z.z,s.y*Z.w),D.viewport(o),U.updateMatrices($,B),n=U.getFrustum(),S(A,T,U.camera,$,this.type)}U.isPointLightShadow!==!0&&this.type===ya&&_(U,T),U.needsUpdate=!1}g=this.type,y.needsUpdate=!1,i.setRenderTarget(L,M,R)};function _(E,A){const T=e.update(x);f.defines.VSM_SAMPLES!==E.blurSamples&&(f.defines.VSM_SAMPLES=E.blurSamples,p.defines.VSM_SAMPLES=E.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new vi(r.x,r.y)),f.uniforms.shadow_pass.value=E.map.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,i.setRenderTarget(E.mapPass),i.clear(),i.renderBufferDirect(A,null,T,f,x,null),p.uniforms.shadow_pass.value=E.mapPass.texture,p.uniforms.resolution.value=E.mapSize,p.uniforms.radius.value=E.radius,i.setRenderTarget(E.map),i.clear(),i.renderBufferDirect(A,null,T,p,x,null)}function w(E,A,T,L){let M=null;const R=T.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(R!==void 0)M=R;else if(M=T.isPointLight===!0?l:a,i.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const D=M.uuid,F=A.uuid;let z=c[D];z===void 0&&(z={},c[D]=z);let q=z[F];q===void 0&&(q=M.clone(),z[F]=q,A.addEventListener("dispose",C)),M=q}if(M.visible=A.visible,M.wireframe=A.wireframe,L===ya?M.side=A.shadowSide!==null?A.shadowSide:A.side:M.side=A.shadowSide!==null?A.shadowSide:h[A.side],M.alphaMap=A.alphaMap,M.alphaTest=A.alphaTest,M.map=A.map,M.clipShadows=A.clipShadows,M.clippingPlanes=A.clippingPlanes,M.clipIntersection=A.clipIntersection,M.displacementMap=A.displacementMap,M.displacementScale=A.displacementScale,M.displacementBias=A.displacementBias,M.wireframeLinewidth=A.wireframeLinewidth,M.linewidth=A.linewidth,T.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const D=i.properties.get(M);D.light=T}return M}function S(E,A,T,L,M){if(E.visible===!1)return;if(E.layers.test(A.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&M===ya)&&(!E.frustumCulled||n.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,E.matrixWorld);const F=e.update(E),z=E.material;if(Array.isArray(z)){const q=F.groups;for(let H=0,$=q.length;H<$;H++){const U=q[H],X=z[U.materialIndex];if(X&&X.visible){const j=w(E,X,L,M);E.onBeforeShadow(i,E,A,T,F,j,U),i.renderBufferDirect(T,null,F,j,E,U),E.onAfterShadow(i,E,A,T,F,j,U)}}}else if(z.visible){const q=w(E,z,L,M);E.onBeforeShadow(i,E,A,T,F,q,null),i.renderBufferDirect(T,null,F,q,E,null),E.onAfterShadow(i,E,A,T,F,q,null)}}const D=E.children;for(let F=0,z=D.length;F<z;F++)S(D[F],A,T,L,M)}function C(E){E.target.removeEventListener("dispose",C);for(const T in c){const L=c[T],M=E.target.uuid;M in L&&(L[M].dispose(),delete L[M])}}}const AY={[A1]:C1,[P1]:D1,[R1]:I1,[Hh]:L1,[C1]:A1,[D1]:P1,[I1]:R1,[L1]:Hh};function CY(i){function e(){let ae=!1;const Be=new Pt;let pe=null;const De=new Pt(0,0,0,0);return{setMask:function($e){pe!==$e&&!ae&&(i.colorMask($e,$e,$e,$e),pe=$e)},setLocked:function($e){ae=$e},setClear:function($e,je,rt,bt,Ct){Ct===!0&&($e*=bt,je*=bt,rt*=bt),Be.set($e,je,rt,bt),De.equals(Be)===!1&&(i.clearColor($e,je,rt,bt),De.copy(Be))},reset:function(){ae=!1,pe=null,De.set(-1,0,0,0)}}}function t(){let ae=!1,Be=!1,pe=null,De=null,$e=null;return{setReversed:function(je){Be=je},setTest:function(je){je?fe(i.DEPTH_TEST):he(i.DEPTH_TEST)},setMask:function(je){pe!==je&&!ae&&(i.depthMask(je),pe=je)},setFunc:function(je){if(Be&&(je=AY[je]),De!==je){switch(je){case A1:i.depthFunc(i.NEVER);break;case C1:i.depthFunc(i.ALWAYS);break;case P1:i.depthFunc(i.LESS);break;case Hh:i.depthFunc(i.LEQUAL);break;case R1:i.depthFunc(i.EQUAL);break;case L1:i.depthFunc(i.GEQUAL);break;case D1:i.depthFunc(i.GREATER);break;case I1:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}De=je}},setLocked:function(je){ae=je},setClear:function(je){$e!==je&&(i.clearDepth(je),$e=je)},reset:function(){ae=!1,pe=null,De=null,$e=null}}}function n(){let ae=!1,Be=null,pe=null,De=null,$e=null,je=null,rt=null,bt=null,Ct=null;return{setTest:function(nt){ae||(nt?fe(i.STENCIL_TEST):he(i.STENCIL_TEST))},setMask:function(nt){Be!==nt&&!ae&&(i.stencilMask(nt),Be=nt)},setFunc:function(nt,Lt,ln){(pe!==nt||De!==Lt||$e!==ln)&&(i.stencilFunc(nt,Lt,ln),pe=nt,De=Lt,$e=ln)},setOp:function(nt,Lt,ln){(je!==nt||rt!==Lt||bt!==ln)&&(i.stencilOp(nt,Lt,ln),je=nt,rt=Lt,bt=ln)},setLocked:function(nt){ae=nt},setClear:function(nt){Ct!==nt&&(i.clearStencil(nt),Ct=nt)},reset:function(){ae=!1,Be=null,pe=null,De=null,$e=null,je=null,rt=null,bt=null,Ct=null}}}const r=new e,s=new t,o=new n,a=new WeakMap,l=new WeakMap;let c={},u={},h=new WeakMap,f=[],p=null,v=!1,x=null,y=null,g=null,_=null,w=null,S=null,C=null,E=new Ge(0,0,0),A=0,T=!1,L=null,M=null,R=null,D=null,F=null;const z=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let q=!1,H=0;const $=i.getParameter(i.VERSION);$.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec($)[1]),q=H>=1):$.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),q=H>=2);let U=null,X={};const j=i.getParameter(i.SCISSOR_BOX),B=i.getParameter(i.VIEWPORT),Z=new Pt().fromArray(j),ie=new Pt().fromArray(B);function V(ae,Be,pe,De){const $e=new Uint8Array(4),je=i.createTexture();i.bindTexture(ae,je),i.texParameteri(ae,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(ae,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let rt=0;rt<pe;rt++)ae===i.TEXTURE_3D||ae===i.TEXTURE_2D_ARRAY?i.texImage3D(Be,0,i.RGBA,1,1,De,0,i.RGBA,i.UNSIGNED_BYTE,$e):i.texImage2D(Be+rt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,$e);return je}const te={};te[i.TEXTURE_2D]=V(i.TEXTURE_2D,i.TEXTURE_2D,1),te[i.TEXTURE_CUBE_MAP]=V(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),te[i.TEXTURE_2D_ARRAY]=V(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),te[i.TEXTURE_3D]=V(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),fe(i.DEPTH_TEST),s.setFunc(Hh),ve(!1),Se(MT),fe(i.CULL_FACE),Y(ba);function fe(ae){c[ae]!==!0&&(i.enable(ae),c[ae]=!0)}function he(ae){c[ae]!==!1&&(i.disable(ae),c[ae]=!1)}function le(ae,Be){return u[ae]!==Be?(i.bindFramebuffer(ae,Be),u[ae]=Be,ae===i.DRAW_FRAMEBUFFER&&(u[i.FRAMEBUFFER]=Be),ae===i.FRAMEBUFFER&&(u[i.DRAW_FRAMEBUFFER]=Be),!0):!1}function G(ae,Be){let pe=f,De=!1;if(ae){pe=h.get(Be),pe===void 0&&(pe=[],h.set(Be,pe));const $e=ae.textures;if(pe.length!==$e.length||pe[0]!==i.COLOR_ATTACHMENT0){for(let je=0,rt=$e.length;je<rt;je++)pe[je]=i.COLOR_ATTACHMENT0+je;pe.length=$e.length,De=!0}}else pe[0]!==i.BACK&&(pe[0]=i.BACK,De=!0);De&&i.drawBuffers(pe)}function Q(ae){return p!==ae?(i.useProgram(ae),p=ae,!0):!1}const J={[Dc]:i.FUNC_ADD,[OU]:i.FUNC_SUBTRACT,[zU]:i.FUNC_REVERSE_SUBTRACT};J[BU]=i.MIN,J[HU]=i.MAX;const ne={[GU]:i.ZERO,[VU]:i.ONE,[WU]:i.SRC_COLOR,[T1]:i.SRC_ALPHA,[ZU]:i.SRC_ALPHA_SATURATE,[qU]:i.DST_COLOR,[XU]:i.DST_ALPHA,[jU]:i.ONE_MINUS_SRC_COLOR,[E1]:i.ONE_MINUS_SRC_ALPHA,[KU]:i.ONE_MINUS_DST_COLOR,[YU]:i.ONE_MINUS_DST_ALPHA,[QU]:i.CONSTANT_COLOR,[JU]:i.ONE_MINUS_CONSTANT_COLOR,[$U]:i.CONSTANT_ALPHA,[eF]:i.ONE_MINUS_CONSTANT_ALPHA};function Y(ae,Be,pe,De,$e,je,rt,bt,Ct,nt){if(ae===ba){v===!0&&(he(i.BLEND),v=!1);return}if(v===!1&&(fe(i.BLEND),v=!0),ae!==NU){if(ae!==x||nt!==T){if((y!==Dc||w!==Dc)&&(i.blendEquation(i.FUNC_ADD),y=Dc,w=Dc),nt)switch(ae){case Ch:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ea:i.blendFunc(i.ONE,i.ONE);break;case bT:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case TT:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}else switch(ae){case Ch:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ea:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case bT:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case TT:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}g=null,_=null,S=null,C=null,E.set(0,0,0),A=0,x=ae,T=nt}return}$e=$e||Be,je=je||pe,rt=rt||De,(Be!==y||$e!==w)&&(i.blendEquationSeparate(J[Be],J[$e]),y=Be,w=$e),(pe!==g||De!==_||je!==S||rt!==C)&&(i.blendFuncSeparate(ne[pe],ne[De],ne[je],ne[rt]),g=pe,_=De,S=je,C=rt),(bt.equals(E)===!1||Ct!==A)&&(i.blendColor(bt.r,bt.g,bt.b,Ct),E.copy(bt),A=Ct),x=ae,T=!1}function de(ae,Be){ae.side===_n?he(i.CULL_FACE):fe(i.CULL_FACE);let pe=ae.side===Vi;Be&&(pe=!pe),ve(pe),ae.blending===Ch&&ae.transparent===!1?Y(ba):Y(ae.blending,ae.blendEquation,ae.blendSrc,ae.blendDst,ae.blendEquationAlpha,ae.blendSrcAlpha,ae.blendDstAlpha,ae.blendColor,ae.blendAlpha,ae.premultipliedAlpha),s.setFunc(ae.depthFunc),s.setTest(ae.depthTest),s.setMask(ae.depthWrite),r.setMask(ae.colorWrite);const De=ae.stencilWrite;o.setTest(De),De&&(o.setMask(ae.stencilWriteMask),o.setFunc(ae.stencilFunc,ae.stencilRef,ae.stencilFuncMask),o.setOp(ae.stencilFail,ae.stencilZFail,ae.stencilZPass)),Ee(ae.polygonOffset,ae.polygonOffsetFactor,ae.polygonOffsetUnits),ae.alphaToCoverage===!0?fe(i.SAMPLE_ALPHA_TO_COVERAGE):he(i.SAMPLE_ALPHA_TO_COVERAGE)}function ve(ae){L!==ae&&(ae?i.frontFace(i.CW):i.frontFace(i.CCW),L=ae)}function Se(ae){ae!==UU?(fe(i.CULL_FACE),ae!==M&&(ae===MT?i.cullFace(i.BACK):ae===FU?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):he(i.CULL_FACE),M=ae}function Te(ae){ae!==R&&(q&&i.lineWidth(ae),R=ae)}function Ee(ae,Be,pe){ae?(fe(i.POLYGON_OFFSET_FILL),(D!==Be||F!==pe)&&(i.polygonOffset(Be,pe),D=Be,F=pe)):he(i.POLYGON_OFFSET_FILL)}function Re(ae){ae?fe(i.SCISSOR_TEST):he(i.SCISSOR_TEST)}function K(ae){ae===void 0&&(ae=i.TEXTURE0+z-1),U!==ae&&(i.activeTexture(ae),U=ae)}function k(ae,Be,pe){pe===void 0&&(U===null?pe=i.TEXTURE0+z-1:pe=U);let De=X[pe];De===void 0&&(De={type:void 0,texture:void 0},X[pe]=De),(De.type!==ae||De.texture!==Be)&&(U!==pe&&(i.activeTexture(pe),U=pe),i.bindTexture(ae,Be||te[ae]),De.type=ae,De.texture=Be)}function ue(){const ae=X[U];ae!==void 0&&ae.type!==void 0&&(i.bindTexture(ae.type,null),ae.type=void 0,ae.texture=void 0)}function me(){try{i.compressedTexImage2D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Me(){try{i.compressedTexImage3D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ge(){try{i.texSubImage2D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ye(){try{i.texSubImage3D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ie(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ze(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Je(){try{i.texStorage2D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Fe(){try{i.texStorage3D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Xe(){try{i.texImage2D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ct(){try{i.texImage3D.apply(i,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function tt(ae){Z.equals(ae)===!1&&(i.scissor(ae.x,ae.y,ae.z,ae.w),Z.copy(ae))}function Ve(ae){ie.equals(ae)===!1&&(i.viewport(ae.x,ae.y,ae.z,ae.w),ie.copy(ae))}function qe(ae,Be){let pe=l.get(Be);pe===void 0&&(pe=new WeakMap,l.set(Be,pe));let De=pe.get(ae);De===void 0&&(De=i.getUniformBlockIndex(Be,ae.name),pe.set(ae,De))}function ce(ae,Be){const De=l.get(Be).get(ae);a.get(Be)!==De&&(i.uniformBlockBinding(Be,De,ae.__bindingPointIndex),a.set(Be,De))}function ke(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),c={},U=null,X={},u={},h=new WeakMap,f=[],p=null,v=!1,x=null,y=null,g=null,_=null,w=null,S=null,C=null,E=new Ge(0,0,0),A=0,T=!1,L=null,M=null,R=null,D=null,F=null,Z.set(0,0,i.canvas.width,i.canvas.height),ie.set(0,0,i.canvas.width,i.canvas.height),r.reset(),s.reset(),o.reset()}return{buffers:{color:r,depth:s,stencil:o},enable:fe,disable:he,bindFramebuffer:le,drawBuffers:G,useProgram:Q,setBlending:Y,setMaterial:de,setFlipSided:ve,setCullFace:Se,setLineWidth:Te,setPolygonOffset:Ee,setScissorTest:Re,activeTexture:K,bindTexture:k,unbindTexture:ue,compressedTexImage2D:me,compressedTexImage3D:Me,texImage2D:Xe,texImage3D:ct,updateUBOMapping:qe,uniformBlockBinding:ce,texStorage2D:Je,texStorage3D:Fe,texSubImage2D:ge,texSubImage3D:Ye,compressedTexSubImage2D:Ie,compressedTexSubImage3D:ze,scissor:tt,viewport:Ve,reset:ke}}function PY(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function RY(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function LY(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function LT(i,e,t,n){const r=DY(n);switch(t){case YE:return i*e;case KE:return i*e;case ZE:return i*e*2;case N0:return i*e/r.components*r.byteLength;case O0:return i*e/r.components*r.byteLength;case QE:return i*e*2/r.components*r.byteLength;case nw:return i*e*2/r.components*r.byteLength;case qE:return i*e*3/r.components*r.byteLength;case fr:return i*e*4/r.components*r.byteLength;case iw:return i*e*4/r.components*r.byteLength;case bg:case Tg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Eg:case Ag:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case F1:case N1:return Math.max(i,16)*Math.max(e,8)/4;case U1:case k1:return Math.max(i,8)*Math.max(e,8)/2;case O1:case z1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case B1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case H1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case G1:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case V1:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case W1:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case j1:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case X1:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Y1:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case q1:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case K1:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Z1:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Q1:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case J1:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case $1:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case e_:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Cg:case t_:case n_:return Math.ceil(i/4)*Math.ceil(e/4)*16;case JE:case i_:return Math.ceil(i/4)*Math.ceil(e/4)*8;case r_:case s_:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function DY(i){switch(i){case Pa:case WE:return{byteLength:1,components:1};case Gh:case jE:case Zi:return{byteLength:2,components:1};case ew:case tw:return{byteLength:2,components:4};case Yl:case $_:case Hi:return{byteLength:4,components:1};case XE:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}const IY={contain:PY,cover:RY,fill:LY,getByteLength:LT};function UY(i,e,t,n,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new be,u=new WeakMap;let h;const f=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(K,k){return p?new OffscreenCanvas(K,k):n0("canvas")}function x(K,k,ue){let me=1;const Me=Re(K);if((Me.width>ue||Me.height>ue)&&(me=ue/Math.max(Me.width,Me.height)),me<1)if(typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&K instanceof ImageBitmap||typeof VideoFrame<"u"&&K instanceof VideoFrame){const ge=Math.floor(me*Me.width),Ye=Math.floor(me*Me.height);h===void 0&&(h=v(ge,Ye));const Ie=k?v(ge,Ye):h;return Ie.width=ge,Ie.height=Ye,Ie.getContext("2d").drawImage(K,0,0,ge,Ye),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Me.width+"x"+Me.height+") to ("+ge+"x"+Ye+")."),Ie}else return"data"in K&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Me.width+"x"+Me.height+")."),K;return K}function y(K){return K.generateMipmaps&&K.minFilter!==wn&&K.minFilter!==gn}function g(K){i.generateMipmap(K)}function _(K,k,ue,me,Me=!1){if(K!==null){if(i[K]!==void 0)return i[K];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+K+"'")}let ge=k;if(k===i.RED&&(ue===i.FLOAT&&(ge=i.R32F),ue===i.HALF_FLOAT&&(ge=i.R16F),ue===i.UNSIGNED_BYTE&&(ge=i.R8)),k===i.RED_INTEGER&&(ue===i.UNSIGNED_BYTE&&(ge=i.R8UI),ue===i.UNSIGNED_SHORT&&(ge=i.R16UI),ue===i.UNSIGNED_INT&&(ge=i.R32UI),ue===i.BYTE&&(ge=i.R8I),ue===i.SHORT&&(ge=i.R16I),ue===i.INT&&(ge=i.R32I)),k===i.RG&&(ue===i.FLOAT&&(ge=i.RG32F),ue===i.HALF_FLOAT&&(ge=i.RG16F),ue===i.UNSIGNED_BYTE&&(ge=i.RG8)),k===i.RG_INTEGER&&(ue===i.UNSIGNED_BYTE&&(ge=i.RG8UI),ue===i.UNSIGNED_SHORT&&(ge=i.RG16UI),ue===i.UNSIGNED_INT&&(ge=i.RG32UI),ue===i.BYTE&&(ge=i.RG8I),ue===i.SHORT&&(ge=i.RG16I),ue===i.INT&&(ge=i.RG32I)),k===i.RGB_INTEGER&&(ue===i.UNSIGNED_BYTE&&(ge=i.RGB8UI),ue===i.UNSIGNED_SHORT&&(ge=i.RGB16UI),ue===i.UNSIGNED_INT&&(ge=i.RGB32UI),ue===i.BYTE&&(ge=i.RGB8I),ue===i.SHORT&&(ge=i.RGB16I),ue===i.INT&&(ge=i.RGB32I)),k===i.RGBA_INTEGER&&(ue===i.UNSIGNED_BYTE&&(ge=i.RGBA8UI),ue===i.UNSIGNED_SHORT&&(ge=i.RGBA16UI),ue===i.UNSIGNED_INT&&(ge=i.RGBA32UI),ue===i.BYTE&&(ge=i.RGBA8I),ue===i.SHORT&&(ge=i.RGBA16I),ue===i.INT&&(ge=i.RGBA32I)),k===i.RGB&&ue===i.UNSIGNED_INT_5_9_9_9_REV&&(ge=i.RGB9_E5),k===i.RGBA){const Ye=Me?Qg:on.getTransfer(me);ue===i.FLOAT&&(ge=i.RGBA32F),ue===i.HALF_FLOAT&&(ge=i.RGBA16F),ue===i.UNSIGNED_BYTE&&(ge=Ye===Nn?i.SRGB8_ALPHA8:i.RGBA8),ue===i.UNSIGNED_SHORT_4_4_4_4&&(ge=i.RGBA4),ue===i.UNSIGNED_SHORT_5_5_5_1&&(ge=i.RGB5_A1)}return(ge===i.R16F||ge===i.R32F||ge===i.RG16F||ge===i.RG32F||ge===i.RGBA16F||ge===i.RGBA32F)&&e.get("EXT_color_buffer_float"),ge}function w(K,k){let ue;return K?k===null||k===Yl||k===Vh?ue=i.DEPTH24_STENCIL8:k===Hi?ue=i.DEPTH32F_STENCIL8:k===Gh&&(ue=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):k===null||k===Yl||k===Vh?ue=i.DEPTH_COMPONENT24:k===Hi?ue=i.DEPTH_COMPONENT32F:k===Gh&&(ue=i.DEPTH_COMPONENT16),ue}function S(K,k){return y(K)===!0||K.isFramebufferTexture&&K.minFilter!==wn&&K.minFilter!==gn?Math.log2(Math.max(k.width,k.height))+1:K.mipmaps!==void 0&&K.mipmaps.length>0?K.mipmaps.length:K.isCompressedTexture&&Array.isArray(K.image)?k.mipmaps.length:1}function C(K){const k=K.target;k.removeEventListener("dispose",C),A(k),k.isVideoTexture&&u.delete(k)}function E(K){const k=K.target;k.removeEventListener("dispose",E),L(k)}function A(K){const k=n.get(K);if(k.__webglInit===void 0)return;const ue=K.source,me=f.get(ue);if(me){const Me=me[k.__cacheKey];Me.usedTimes--,Me.usedTimes===0&&T(K),Object.keys(me).length===0&&f.delete(ue)}n.remove(K)}function T(K){const k=n.get(K);i.deleteTexture(k.__webglTexture);const ue=K.source,me=f.get(ue);delete me[k.__cacheKey],o.memory.textures--}function L(K){const k=n.get(K);if(K.depthTexture&&K.depthTexture.dispose(),K.isWebGLCubeRenderTarget)for(let me=0;me<6;me++){if(Array.isArray(k.__webglFramebuffer[me]))for(let Me=0;Me<k.__webglFramebuffer[me].length;Me++)i.deleteFramebuffer(k.__webglFramebuffer[me][Me]);else i.deleteFramebuffer(k.__webglFramebuffer[me]);k.__webglDepthbuffer&&i.deleteRenderbuffer(k.__webglDepthbuffer[me])}else{if(Array.isArray(k.__webglFramebuffer))for(let me=0;me<k.__webglFramebuffer.length;me++)i.deleteFramebuffer(k.__webglFramebuffer[me]);else i.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&i.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&i.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let me=0;me<k.__webglColorRenderbuffer.length;me++)k.__webglColorRenderbuffer[me]&&i.deleteRenderbuffer(k.__webglColorRenderbuffer[me]);k.__webglDepthRenderbuffer&&i.deleteRenderbuffer(k.__webglDepthRenderbuffer)}const ue=K.textures;for(let me=0,Me=ue.length;me<Me;me++){const ge=n.get(ue[me]);ge.__webglTexture&&(i.deleteTexture(ge.__webglTexture),o.memory.textures--),n.remove(ue[me])}n.remove(K)}let M=0;function R(){M=0}function D(){const K=M;return K>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+K+" texture units while this GPU supports only "+r.maxTextures),M+=1,K}function F(K){const k=[];return k.push(K.wrapS),k.push(K.wrapT),k.push(K.wrapR||0),k.push(K.magFilter),k.push(K.minFilter),k.push(K.anisotropy),k.push(K.internalFormat),k.push(K.format),k.push(K.type),k.push(K.generateMipmaps),k.push(K.premultiplyAlpha),k.push(K.flipY),k.push(K.unpackAlignment),k.push(K.colorSpace),k.join()}function z(K,k){const ue=n.get(K);if(K.isVideoTexture&&Te(K),K.isRenderTargetTexture===!1&&K.version>0&&ue.__version!==K.version){const me=K.image;if(me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ie(ue,K,k);return}}t.bindTexture(i.TEXTURE_2D,ue.__webglTexture,i.TEXTURE0+k)}function q(K,k){const ue=n.get(K);if(K.version>0&&ue.__version!==K.version){ie(ue,K,k);return}t.bindTexture(i.TEXTURE_2D_ARRAY,ue.__webglTexture,i.TEXTURE0+k)}function H(K,k){const ue=n.get(K);if(K.version>0&&ue.__version!==K.version){ie(ue,K,k);return}t.bindTexture(i.TEXTURE_3D,ue.__webglTexture,i.TEXTURE0+k)}function $(K,k){const ue=n.get(K);if(K.version>0&&ue.__version!==K.version){V(ue,K,k);return}t.bindTexture(i.TEXTURE_CUBE_MAP,ue.__webglTexture,i.TEXTURE0+k)}const U={[xn]:i.REPEAT,[ds]:i.CLAMP_TO_EDGE,[dp]:i.MIRRORED_REPEAT},X={[wn]:i.NEAREST,[J_]:i.NEAREST_MIPMAP_NEAREST,[yh]:i.NEAREST_MIPMAP_LINEAR,[gn]:i.LINEAR,[kd]:i.LINEAR_MIPMAP_NEAREST,[uo]:i.LINEAR_MIPMAP_LINEAR},j={[dF]:i.NEVER,[xF]:i.ALWAYS,[pF]:i.LESS,[tA]:i.LEQUAL,[mF]:i.EQUAL,[yF]:i.GEQUAL,[gF]:i.GREATER,[vF]:i.NOTEQUAL};function B(K,k){if(k.type===Hi&&e.has("OES_texture_float_linear")===!1&&(k.magFilter===gn||k.magFilter===kd||k.magFilter===yh||k.magFilter===uo||k.minFilter===gn||k.minFilter===kd||k.minFilter===yh||k.minFilter===uo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(K,i.TEXTURE_WRAP_S,U[k.wrapS]),i.texParameteri(K,i.TEXTURE_WRAP_T,U[k.wrapT]),(K===i.TEXTURE_3D||K===i.TEXTURE_2D_ARRAY)&&i.texParameteri(K,i.TEXTURE_WRAP_R,U[k.wrapR]),i.texParameteri(K,i.TEXTURE_MAG_FILTER,X[k.magFilter]),i.texParameteri(K,i.TEXTURE_MIN_FILTER,X[k.minFilter]),k.compareFunction&&(i.texParameteri(K,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(K,i.TEXTURE_COMPARE_FUNC,j[k.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(k.magFilter===wn||k.minFilter!==yh&&k.minFilter!==uo||k.type===Hi&&e.has("OES_texture_float_linear")===!1)return;if(k.anisotropy>1||n.get(k).__currentAnisotropy){const ue=e.get("EXT_texture_filter_anisotropic");i.texParameterf(K,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,r.getMaxAnisotropy())),n.get(k).__currentAnisotropy=k.anisotropy}}}function Z(K,k){let ue=!1;K.__webglInit===void 0&&(K.__webglInit=!0,k.addEventListener("dispose",C));const me=k.source;let Me=f.get(me);Me===void 0&&(Me={},f.set(me,Me));const ge=F(k);if(ge!==K.__cacheKey){Me[ge]===void 0&&(Me[ge]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ue=!0),Me[ge].usedTimes++;const Ye=Me[K.__cacheKey];Ye!==void 0&&(Me[K.__cacheKey].usedTimes--,Ye.usedTimes===0&&T(k)),K.__cacheKey=ge,K.__webglTexture=Me[ge].texture}return ue}function ie(K,k,ue){let me=i.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(me=i.TEXTURE_2D_ARRAY),k.isData3DTexture&&(me=i.TEXTURE_3D);const Me=Z(K,k),ge=k.source;t.bindTexture(me,K.__webglTexture,i.TEXTURE0+ue);const Ye=n.get(ge);if(ge.version!==Ye.__version||Me===!0){t.activeTexture(i.TEXTURE0+ue);const Ie=on.getPrimaries(on.workingColorSpace),ze=k.colorSpace===zl?null:on.getPrimaries(k.colorSpace),Je=k.colorSpace===zl||Ie===ze?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,k.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,k.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Je);let Fe=x(k.image,!1,r.maxTextureSize);Fe=Ee(k,Fe);const Xe=s.convert(k.format,k.colorSpace),ct=s.convert(k.type);let tt=_(k.internalFormat,Xe,ct,k.colorSpace,k.isVideoTexture);B(me,k);let Ve;const qe=k.mipmaps,ce=k.isVideoTexture!==!0,ke=Ye.__version===void 0||Me===!0,ae=ge.dataReady,Be=S(k,Fe);if(k.isDepthTexture)tt=w(k.format===Wh,k.type),ke&&(ce?t.texStorage2D(i.TEXTURE_2D,1,tt,Fe.width,Fe.height):t.texImage2D(i.TEXTURE_2D,0,tt,Fe.width,Fe.height,0,Xe,ct,null));else if(k.isDataTexture)if(qe.length>0){ce&&ke&&t.texStorage2D(i.TEXTURE_2D,Be,tt,qe[0].width,qe[0].height);for(let pe=0,De=qe.length;pe<De;pe++)Ve=qe[pe],ce?ae&&t.texSubImage2D(i.TEXTURE_2D,pe,0,0,Ve.width,Ve.height,Xe,ct,Ve.data):t.texImage2D(i.TEXTURE_2D,pe,tt,Ve.width,Ve.height,0,Xe,ct,Ve.data);k.generateMipmaps=!1}else ce?(ke&&t.texStorage2D(i.TEXTURE_2D,Be,tt,Fe.width,Fe.height),ae&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Fe.width,Fe.height,Xe,ct,Fe.data)):t.texImage2D(i.TEXTURE_2D,0,tt,Fe.width,Fe.height,0,Xe,ct,Fe.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){ce&&ke&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Be,tt,qe[0].width,qe[0].height,Fe.depth);for(let pe=0,De=qe.length;pe<De;pe++)if(Ve=qe[pe],k.format!==fr)if(Xe!==null)if(ce){if(ae)if(k.layerUpdates.size>0){const $e=LT(Ve.width,Ve.height,k.format,k.type);for(const je of k.layerUpdates){const rt=Ve.data.subarray(je*$e/Ve.data.BYTES_PER_ELEMENT,(je+1)*$e/Ve.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,pe,0,0,je,Ve.width,Ve.height,1,Xe,rt,0,0)}k.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,pe,0,0,0,Ve.width,Ve.height,Fe.depth,Xe,Ve.data,0,0)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,pe,tt,Ve.width,Ve.height,Fe.depth,0,Ve.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ce?ae&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,pe,0,0,0,Ve.width,Ve.height,Fe.depth,Xe,ct,Ve.data):t.texImage3D(i.TEXTURE_2D_ARRAY,pe,tt,Ve.width,Ve.height,Fe.depth,0,Xe,ct,Ve.data)}else{ce&&ke&&t.texStorage2D(i.TEXTURE_2D,Be,tt,qe[0].width,qe[0].height);for(let pe=0,De=qe.length;pe<De;pe++)Ve=qe[pe],k.format!==fr?Xe!==null?ce?ae&&t.compressedTexSubImage2D(i.TEXTURE_2D,pe,0,0,Ve.width,Ve.height,Xe,Ve.data):t.compressedTexImage2D(i.TEXTURE_2D,pe,tt,Ve.width,Ve.height,0,Ve.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ce?ae&&t.texSubImage2D(i.TEXTURE_2D,pe,0,0,Ve.width,Ve.height,Xe,ct,Ve.data):t.texImage2D(i.TEXTURE_2D,pe,tt,Ve.width,Ve.height,0,Xe,ct,Ve.data)}else if(k.isDataArrayTexture)if(ce){if(ke&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Be,tt,Fe.width,Fe.height,Fe.depth),ae)if(k.layerUpdates.size>0){const pe=LT(Fe.width,Fe.height,k.format,k.type);for(const De of k.layerUpdates){const $e=Fe.data.subarray(De*pe/Fe.data.BYTES_PER_ELEMENT,(De+1)*pe/Fe.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,De,Fe.width,Fe.height,1,Xe,ct,$e)}k.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Fe.width,Fe.height,Fe.depth,Xe,ct,Fe.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,tt,Fe.width,Fe.height,Fe.depth,0,Xe,ct,Fe.data);else if(k.isData3DTexture)ce?(ke&&t.texStorage3D(i.TEXTURE_3D,Be,tt,Fe.width,Fe.height,Fe.depth),ae&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Fe.width,Fe.height,Fe.depth,Xe,ct,Fe.data)):t.texImage3D(i.TEXTURE_3D,0,tt,Fe.width,Fe.height,Fe.depth,0,Xe,ct,Fe.data);else if(k.isFramebufferTexture){if(ke)if(ce)t.texStorage2D(i.TEXTURE_2D,Be,tt,Fe.width,Fe.height);else{let pe=Fe.width,De=Fe.height;for(let $e=0;$e<Be;$e++)t.texImage2D(i.TEXTURE_2D,$e,tt,pe,De,0,Xe,ct,null),pe>>=1,De>>=1}}else if(qe.length>0){if(ce&&ke){const pe=Re(qe[0]);t.texStorage2D(i.TEXTURE_2D,Be,tt,pe.width,pe.height)}for(let pe=0,De=qe.length;pe<De;pe++)Ve=qe[pe],ce?ae&&t.texSubImage2D(i.TEXTURE_2D,pe,0,0,Xe,ct,Ve):t.texImage2D(i.TEXTURE_2D,pe,tt,Xe,ct,Ve);k.generateMipmaps=!1}else if(ce){if(ke){const pe=Re(Fe);t.texStorage2D(i.TEXTURE_2D,Be,tt,pe.width,pe.height)}ae&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Xe,ct,Fe)}else t.texImage2D(i.TEXTURE_2D,0,tt,Xe,ct,Fe);y(k)&&g(me),Ye.__version=ge.version,k.onUpdate&&k.onUpdate(k)}K.__version=k.version}function V(K,k,ue){if(k.image.length!==6)return;const me=Z(K,k),Me=k.source;t.bindTexture(i.TEXTURE_CUBE_MAP,K.__webglTexture,i.TEXTURE0+ue);const ge=n.get(Me);if(Me.version!==ge.__version||me===!0){t.activeTexture(i.TEXTURE0+ue);const Ye=on.getPrimaries(on.workingColorSpace),Ie=k.colorSpace===zl?null:on.getPrimaries(k.colorSpace),ze=k.colorSpace===zl||Ye===Ie?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,k.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,k.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,ze);const Je=k.isCompressedTexture||k.image[0].isCompressedTexture,Fe=k.image[0]&&k.image[0].isDataTexture,Xe=[];for(let De=0;De<6;De++)!Je&&!Fe?Xe[De]=x(k.image[De],!0,r.maxCubemapSize):Xe[De]=Fe?k.image[De].image:k.image[De],Xe[De]=Ee(k,Xe[De]);const ct=Xe[0],tt=s.convert(k.format,k.colorSpace),Ve=s.convert(k.type),qe=_(k.internalFormat,tt,Ve,k.colorSpace),ce=k.isVideoTexture!==!0,ke=ge.__version===void 0||me===!0,ae=Me.dataReady;let Be=S(k,ct);B(i.TEXTURE_CUBE_MAP,k);let pe;if(Je){ce&&ke&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Be,qe,ct.width,ct.height);for(let De=0;De<6;De++){pe=Xe[De].mipmaps;for(let $e=0;$e<pe.length;$e++){const je=pe[$e];k.format!==fr?tt!==null?ce?ae&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e,0,0,je.width,je.height,tt,je.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e,qe,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ce?ae&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e,0,0,je.width,je.height,tt,Ve,je.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e,qe,je.width,je.height,0,tt,Ve,je.data)}}}else{if(pe=k.mipmaps,ce&&ke){pe.length>0&&Be++;const De=Re(Xe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Be,qe,De.width,De.height)}for(let De=0;De<6;De++)if(Fe){ce?ae&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,Xe[De].width,Xe[De].height,tt,Ve,Xe[De].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,qe,Xe[De].width,Xe[De].height,0,tt,Ve,Xe[De].data);for(let $e=0;$e<pe.length;$e++){const rt=pe[$e].image[De].image;ce?ae&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e+1,0,0,rt.width,rt.height,tt,Ve,rt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e+1,qe,rt.width,rt.height,0,tt,Ve,rt.data)}}else{ce?ae&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,tt,Ve,Xe[De]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,qe,tt,Ve,Xe[De]);for(let $e=0;$e<pe.length;$e++){const je=pe[$e];ce?ae&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e+1,0,0,tt,Ve,je.image[De]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e+1,qe,tt,Ve,je.image[De])}}}y(k)&&g(i.TEXTURE_CUBE_MAP),ge.__version=Me.version,k.onUpdate&&k.onUpdate(k)}K.__version=k.version}function te(K,k,ue,me,Me,ge){const Ye=s.convert(ue.format,ue.colorSpace),Ie=s.convert(ue.type),ze=_(ue.internalFormat,Ye,Ie,ue.colorSpace);if(!n.get(k).__hasExternalTextures){const Fe=Math.max(1,k.width>>ge),Xe=Math.max(1,k.height>>ge);Me===i.TEXTURE_3D||Me===i.TEXTURE_2D_ARRAY?t.texImage3D(Me,ge,ze,Fe,Xe,k.depth,0,Ye,Ie,null):t.texImage2D(Me,ge,ze,Fe,Xe,0,Ye,Ie,null)}t.bindFramebuffer(i.FRAMEBUFFER,K),Se(k)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,me,Me,n.get(ue).__webglTexture,0,ve(k)):(Me===i.TEXTURE_2D||Me>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Me<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,me,Me,n.get(ue).__webglTexture,ge),t.bindFramebuffer(i.FRAMEBUFFER,null)}function fe(K,k,ue){if(i.bindRenderbuffer(i.RENDERBUFFER,K),k.depthBuffer){const me=k.depthTexture,Me=me&&me.isDepthTexture?me.type:null,ge=w(k.stencilBuffer,Me),Ye=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ie=ve(k);Se(k)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Ie,ge,k.width,k.height):ue?i.renderbufferStorageMultisample(i.RENDERBUFFER,Ie,ge,k.width,k.height):i.renderbufferStorage(i.RENDERBUFFER,ge,k.width,k.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ye,i.RENDERBUFFER,K)}else{const me=k.textures;for(let Me=0;Me<me.length;Me++){const ge=me[Me],Ye=s.convert(ge.format,ge.colorSpace),Ie=s.convert(ge.type),ze=_(ge.internalFormat,Ye,Ie,ge.colorSpace),Je=ve(k);ue&&Se(k)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Je,ze,k.width,k.height):Se(k)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Je,ze,k.width,k.height):i.renderbufferStorage(i.RENDERBUFFER,ze,k.width,k.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function he(K,k){if(k&&k.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,K),!(k.depthTexture&&k.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(k.depthTexture).__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),z(k.depthTexture,0);const me=n.get(k.depthTexture).__webglTexture,Me=ve(k);if(k.depthTexture.format===Vc)Se(k)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0,Me):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0);else if(k.depthTexture.format===Wh)Se(k)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0,Me):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0);else throw new Error("Unknown depthTexture format")}function le(K){const k=n.get(K),ue=K.isWebGLCubeRenderTarget===!0;if(k.__boundDepthTexture!==K.depthTexture){const me=K.depthTexture;if(k.__depthDisposeCallback&&k.__depthDisposeCallback(),me){const Me=()=>{delete k.__boundDepthTexture,delete k.__depthDisposeCallback,me.removeEventListener("dispose",Me)};me.addEventListener("dispose",Me),k.__depthDisposeCallback=Me}k.__boundDepthTexture=me}if(K.depthTexture&&!k.__autoAllocateDepthBuffer){if(ue)throw new Error("target.depthTexture not supported in Cube render targets");he(k.__webglFramebuffer,K)}else if(ue){k.__webglDepthbuffer=[];for(let me=0;me<6;me++)if(t.bindFramebuffer(i.FRAMEBUFFER,k.__webglFramebuffer[me]),k.__webglDepthbuffer[me]===void 0)k.__webglDepthbuffer[me]=i.createRenderbuffer(),fe(k.__webglDepthbuffer[me],K,!1);else{const Me=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ge=k.__webglDepthbuffer[me];i.bindRenderbuffer(i.RENDERBUFFER,ge),i.framebufferRenderbuffer(i.FRAMEBUFFER,Me,i.RENDERBUFFER,ge)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer===void 0)k.__webglDepthbuffer=i.createRenderbuffer(),fe(k.__webglDepthbuffer,K,!1);else{const me=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Me=k.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Me),i.framebufferRenderbuffer(i.FRAMEBUFFER,me,i.RENDERBUFFER,Me)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function G(K,k,ue){const me=n.get(K);k!==void 0&&te(me.__webglFramebuffer,K,K.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ue!==void 0&&le(K)}function Q(K){const k=K.texture,ue=n.get(K),me=n.get(k);K.addEventListener("dispose",E);const Me=K.textures,ge=K.isWebGLCubeRenderTarget===!0,Ye=Me.length>1;if(Ye||(me.__webglTexture===void 0&&(me.__webglTexture=i.createTexture()),me.__version=k.version,o.memory.textures++),ge){ue.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)if(k.mipmaps&&k.mipmaps.length>0){ue.__webglFramebuffer[Ie]=[];for(let ze=0;ze<k.mipmaps.length;ze++)ue.__webglFramebuffer[Ie][ze]=i.createFramebuffer()}else ue.__webglFramebuffer[Ie]=i.createFramebuffer()}else{if(k.mipmaps&&k.mipmaps.length>0){ue.__webglFramebuffer=[];for(let Ie=0;Ie<k.mipmaps.length;Ie++)ue.__webglFramebuffer[Ie]=i.createFramebuffer()}else ue.__webglFramebuffer=i.createFramebuffer();if(Ye)for(let Ie=0,ze=Me.length;Ie<ze;Ie++){const Je=n.get(Me[Ie]);Je.__webglTexture===void 0&&(Je.__webglTexture=i.createTexture(),o.memory.textures++)}if(K.samples>0&&Se(K)===!1){ue.__webglMultisampledFramebuffer=i.createFramebuffer(),ue.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,ue.__webglMultisampledFramebuffer);for(let Ie=0;Ie<Me.length;Ie++){const ze=Me[Ie];ue.__webglColorRenderbuffer[Ie]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ue.__webglColorRenderbuffer[Ie]);const Je=s.convert(ze.format,ze.colorSpace),Fe=s.convert(ze.type),Xe=_(ze.internalFormat,Je,Fe,ze.colorSpace,K.isXRRenderTarget===!0),ct=ve(K);i.renderbufferStorageMultisample(i.RENDERBUFFER,ct,Xe,K.width,K.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ie,i.RENDERBUFFER,ue.__webglColorRenderbuffer[Ie])}i.bindRenderbuffer(i.RENDERBUFFER,null),K.depthBuffer&&(ue.__webglDepthRenderbuffer=i.createRenderbuffer(),fe(ue.__webglDepthRenderbuffer,K,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(ge){t.bindTexture(i.TEXTURE_CUBE_MAP,me.__webglTexture),B(i.TEXTURE_CUBE_MAP,k);for(let Ie=0;Ie<6;Ie++)if(k.mipmaps&&k.mipmaps.length>0)for(let ze=0;ze<k.mipmaps.length;ze++)te(ue.__webglFramebuffer[Ie][ze],K,k,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,ze);else te(ue.__webglFramebuffer[Ie],K,k,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0);y(k)&&g(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ye){for(let Ie=0,ze=Me.length;Ie<ze;Ie++){const Je=Me[Ie],Fe=n.get(Je);t.bindTexture(i.TEXTURE_2D,Fe.__webglTexture),B(i.TEXTURE_2D,Je),te(ue.__webglFramebuffer,K,Je,i.COLOR_ATTACHMENT0+Ie,i.TEXTURE_2D,0),y(Je)&&g(i.TEXTURE_2D)}t.unbindTexture()}else{let Ie=i.TEXTURE_2D;if((K.isWebGL3DRenderTarget||K.isWebGLArrayRenderTarget)&&(Ie=K.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Ie,me.__webglTexture),B(Ie,k),k.mipmaps&&k.mipmaps.length>0)for(let ze=0;ze<k.mipmaps.length;ze++)te(ue.__webglFramebuffer[ze],K,k,i.COLOR_ATTACHMENT0,Ie,ze);else te(ue.__webglFramebuffer,K,k,i.COLOR_ATTACHMENT0,Ie,0);y(k)&&g(Ie),t.unbindTexture()}K.depthBuffer&&le(K)}function J(K){const k=K.textures;for(let ue=0,me=k.length;ue<me;ue++){const Me=k[ue];if(y(Me)){const ge=K.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,Ye=n.get(Me).__webglTexture;t.bindTexture(ge,Ye),g(ge),t.unbindTexture()}}}const ne=[],Y=[];function de(K){if(K.samples>0){if(Se(K)===!1){const k=K.textures,ue=K.width,me=K.height;let Me=i.COLOR_BUFFER_BIT;const ge=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ye=n.get(K),Ie=k.length>1;if(Ie)for(let ze=0;ze<k.length;ze++)t.bindFramebuffer(i.FRAMEBUFFER,Ye.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ze,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ye.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+ze,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ye.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ye.__webglFramebuffer);for(let ze=0;ze<k.length;ze++){if(K.resolveDepthBuffer&&(K.depthBuffer&&(Me|=i.DEPTH_BUFFER_BIT),K.stencilBuffer&&K.resolveStencilBuffer&&(Me|=i.STENCIL_BUFFER_BIT)),Ie){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ye.__webglColorRenderbuffer[ze]);const Je=n.get(k[ze]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Je,0)}i.blitFramebuffer(0,0,ue,me,0,0,ue,me,Me,i.NEAREST),l===!0&&(ne.length=0,Y.length=0,ne.push(i.COLOR_ATTACHMENT0+ze),K.depthBuffer&&K.resolveDepthBuffer===!1&&(ne.push(ge),Y.push(ge),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Y)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,ne))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Ie)for(let ze=0;ze<k.length;ze++){t.bindFramebuffer(i.FRAMEBUFFER,Ye.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ze,i.RENDERBUFFER,Ye.__webglColorRenderbuffer[ze]);const Je=n.get(k[ze]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ye.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+ze,i.TEXTURE_2D,Je,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ye.__webglMultisampledFramebuffer)}else if(K.depthBuffer&&K.resolveDepthBuffer===!1&&l){const k=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[k])}}}function ve(K){return Math.min(r.maxSamples,K.samples)}function Se(K){const k=n.get(K);return K.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function Te(K){const k=o.render.frame;u.get(K)!==k&&(u.set(K,k),K.update())}function Ee(K,k){const ue=K.colorSpace,me=K.format,Me=K.type;return K.isCompressedTexture===!0||K.isVideoTexture===!0||ue!==Wi&&ue!==zl&&(on.getTransfer(ue)===Nn?(me!==fr||Me!==Pa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ue)),k}function Re(K){return typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement?(c.width=K.naturalWidth||K.width,c.height=K.naturalHeight||K.height):typeof VideoFrame<"u"&&K instanceof VideoFrame?(c.width=K.displayWidth,c.height=K.displayHeight):(c.width=K.width,c.height=K.height),c}this.allocateTextureUnit=D,this.resetTextureUnits=R,this.setTexture2D=z,this.setTexture2DArray=q,this.setTexture3D=H,this.setTextureCube=$,this.rebindTextures=G,this.setupRenderTarget=Q,this.updateRenderTargetMipmap=J,this.updateMultisampleRenderTarget=de,this.setupDepthRenderbuffer=le,this.setupFrameBufferTexture=te,this.useMultisampledRTT=Se}function LF(i,e){function t(n,r=zl){let s;const o=on.getTransfer(r);if(n===Pa)return i.UNSIGNED_BYTE;if(n===ew)return i.UNSIGNED_SHORT_4_4_4_4;if(n===tw)return i.UNSIGNED_SHORT_5_5_5_1;if(n===XE)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===WE)return i.BYTE;if(n===jE)return i.SHORT;if(n===Gh)return i.UNSIGNED_SHORT;if(n===$_)return i.INT;if(n===Yl)return i.UNSIGNED_INT;if(n===Hi)return i.FLOAT;if(n===Zi)return i.HALF_FLOAT;if(n===YE)return i.ALPHA;if(n===qE)return i.RGB;if(n===fr)return i.RGBA;if(n===KE)return i.LUMINANCE;if(n===ZE)return i.LUMINANCE_ALPHA;if(n===Vc)return i.DEPTH_COMPONENT;if(n===Wh)return i.DEPTH_STENCIL;if(n===N0)return i.RED;if(n===O0)return i.RED_INTEGER;if(n===QE)return i.RG;if(n===nw)return i.RG_INTEGER;if(n===iw)return i.RGBA_INTEGER;if(n===bg||n===Tg||n===Eg||n===Ag)if(o===Nn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===bg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Tg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Eg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Ag)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===bg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Tg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Eg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Ag)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===U1||n===F1||n===k1||n===N1)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===U1)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===F1)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===k1)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===N1)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===O1||n===z1||n===B1)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===O1||n===z1)return o===Nn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===B1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===H1||n===G1||n===V1||n===W1||n===j1||n===X1||n===Y1||n===q1||n===K1||n===Z1||n===Q1||n===J1||n===$1||n===e_)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===H1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===G1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===V1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===W1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===j1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===X1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Y1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===q1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===K1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Z1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Q1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===J1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===$1)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===e_)return o===Nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Cg||n===t_||n===n_)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Cg)return o===Nn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===t_)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===n_)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===JE||n===i_||n===r_||n===s_)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===Cg)return s.COMPRESSED_RED_RGTC1_EXT;if(n===i_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===r_)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===s_)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Vh?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}class DF extends Un{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ho extends Kt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const FY={type:"move"};class gM{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ho,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ho,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ho,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const x of e.hand.values()){const y=t.getJointPose(x,n),g=this._getHandJoint(c,x);y!==null&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=y.radius),g.visible=y!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],f=u.position.distanceTo(h.position),p=.02,v=.005;c.inputState.pinching&&f>p+v?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&f<=p-v&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(FY)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new ho;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const kY=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,NY=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class OY{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new Cn,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Ft({vertexShader:kY,fragmentShader:NY,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ae(new Ot(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class zY extends hl{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,f=null,p=null,v=null;const x=new OY,y=t.getContextAttributes();let g=null,_=null;const w=[],S=[],C=new be;let E=null;const A=new Un;A.layers.enable(1),A.viewport=new Pt;const T=new Un;T.layers.enable(2),T.viewport=new Pt;const L=[A,T],M=new DF;M.layers.enable(1),M.layers.enable(2);let R=null,D=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(V){let te=w[V];return te===void 0&&(te=new gM,w[V]=te),te.getTargetRaySpace()},this.getControllerGrip=function(V){let te=w[V];return te===void 0&&(te=new gM,w[V]=te),te.getGripSpace()},this.getHand=function(V){let te=w[V];return te===void 0&&(te=new gM,w[V]=te),te.getHandSpace()};function F(V){const te=S.indexOf(V.inputSource);if(te===-1)return;const fe=w[te];fe!==void 0&&(fe.update(V.inputSource,V.frame,c||o),fe.dispatchEvent({type:V.type,data:V.inputSource}))}function z(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",q);for(let V=0;V<w.length;V++){const te=S[V];te!==null&&(S[V]=null,w[V].disconnect(te))}R=null,D=null,x.reset(),e.setRenderTarget(g),p=null,f=null,h=null,r=null,_=null,ie.stop(),n.isPresenting=!1,e.setPixelRatio(E),e.setSize(C.width,C.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(V){s=V,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(V){a=V,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(V){c=V},this.getBaseLayer=function(){return f!==null?f:p},this.getBinding=function(){return h},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(V){if(r=V,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",z),r.addEventListener("inputsourceschange",q),y.xrCompatible!==!0&&await t.makeXRCompatible(),E=e.getPixelRatio(),e.getSize(C),r.renderState.layers===void 0){const te={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,t,te),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),_=new vi(p.framebufferWidth,p.framebufferHeight,{format:fr,type:Pa,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil})}else{let te=null,fe=null,he=null;y.depth&&(he=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,te=y.stencil?Wh:Vc,fe=y.stencil?Vh:Yl);const le={colorFormat:t.RGBA8,depthFormat:he,scaleFactor:s};h=new XRWebGLBinding(r,t),f=h.createProjectionLayer(le),r.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),_=new vi(f.textureWidth,f.textureHeight,{format:fr,type:Pa,depthTexture:new aw(f.textureWidth,f.textureHeight,fe,void 0,void 0,void 0,void 0,void 0,void 0,te),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:f.ignoreDepthValues===!1})}_.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),ie.setContext(r),ie.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return x.getDepthTexture()};function q(V){for(let te=0;te<V.removed.length;te++){const fe=V.removed[te],he=S.indexOf(fe);he>=0&&(S[he]=null,w[he].disconnect(fe))}for(let te=0;te<V.added.length;te++){const fe=V.added[te];let he=S.indexOf(fe);if(he===-1){for(let G=0;G<w.length;G++)if(G>=S.length){S.push(fe),he=G;break}else if(S[G]===null){S[G]=fe,he=G;break}if(he===-1)break}const le=w[he];le&&le.connect(fe)}}const H=new N,$=new N;function U(V,te,fe){H.setFromMatrixPosition(te.matrixWorld),$.setFromMatrixPosition(fe.matrixWorld);const he=H.distanceTo($),le=te.projectionMatrix.elements,G=fe.projectionMatrix.elements,Q=le[14]/(le[10]-1),J=le[14]/(le[10]+1),ne=(le[9]+1)/le[5],Y=(le[9]-1)/le[5],de=(le[8]-1)/le[0],ve=(G[8]+1)/G[0],Se=Q*de,Te=Q*ve,Ee=he/(-de+ve),Re=Ee*-de;if(te.matrixWorld.decompose(V.position,V.quaternion,V.scale),V.translateX(Re),V.translateZ(Ee),V.matrixWorld.compose(V.position,V.quaternion,V.scale),V.matrixWorldInverse.copy(V.matrixWorld).invert(),le[10]===-1)V.projectionMatrix.copy(te.projectionMatrix),V.projectionMatrixInverse.copy(te.projectionMatrixInverse);else{const K=Q+Ee,k=J+Ee,ue=Se-Re,me=Te+(he-Re),Me=ne*J/k*K,ge=Y*J/k*K;V.projectionMatrix.makePerspective(ue,me,Me,ge,K,k),V.projectionMatrixInverse.copy(V.projectionMatrix).invert()}}function X(V,te){te===null?V.matrixWorld.copy(V.matrix):V.matrixWorld.multiplyMatrices(te.matrixWorld,V.matrix),V.matrixWorldInverse.copy(V.matrixWorld).invert()}this.updateCamera=function(V){if(r===null)return;let te=V.near,fe=V.far;x.texture!==null&&(x.depthNear>0&&(te=x.depthNear),x.depthFar>0&&(fe=x.depthFar)),M.near=T.near=A.near=te,M.far=T.far=A.far=fe,(R!==M.near||D!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),R=M.near,D=M.far);const he=V.parent,le=M.cameras;X(M,he);for(let G=0;G<le.length;G++)X(le[G],he);le.length===2?U(M,A,T):M.projectionMatrix.copy(A.projectionMatrix),j(V,M,he)};function j(V,te,fe){fe===null?V.matrix.copy(te.matrixWorld):(V.matrix.copy(fe.matrixWorld),V.matrix.invert(),V.matrix.multiply(te.matrixWorld)),V.matrix.decompose(V.position,V.quaternion,V.scale),V.updateMatrixWorld(!0),V.projectionMatrix.copy(te.projectionMatrix),V.projectionMatrixInverse.copy(te.projectionMatrixInverse),V.isPerspectiveCamera&&(V.fov=gp*2*Math.atan(1/V.projectionMatrix.elements[5]),V.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(f===null&&p===null))return l},this.setFoveation=function(V){l=V,f!==null&&(f.fixedFoveation=V),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=V)},this.hasDepthSensing=function(){return x.texture!==null},this.getDepthSensingMesh=function(){return x.getMesh(M)};let B=null;function Z(V,te){if(u=te.getViewerPose(c||o),v=te,u!==null){const fe=u.views;p!==null&&(e.setRenderTargetFramebuffer(_,p.framebuffer),e.setRenderTarget(_));let he=!1;fe.length!==M.cameras.length&&(M.cameras.length=0,he=!0);for(let G=0;G<fe.length;G++){const Q=fe[G];let J=null;if(p!==null)J=p.getViewport(Q);else{const Y=h.getViewSubImage(f,Q);J=Y.viewport,G===0&&(e.setRenderTargetTextures(_,Y.colorTexture,f.ignoreDepthValues?void 0:Y.depthStencilTexture),e.setRenderTarget(_))}let ne=L[G];ne===void 0&&(ne=new Un,ne.layers.enable(G),ne.viewport=new Pt,L[G]=ne),ne.matrix.fromArray(Q.transform.matrix),ne.matrix.decompose(ne.position,ne.quaternion,ne.scale),ne.projectionMatrix.fromArray(Q.projectionMatrix),ne.projectionMatrixInverse.copy(ne.projectionMatrix).invert(),ne.viewport.set(J.x,J.y,J.width,J.height),G===0&&(M.matrix.copy(ne.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),he===!0&&M.cameras.push(ne)}const le=r.enabledFeatures;if(le&&le.includes("depth-sensing")){const G=h.getDepthInformation(fe[0]);G&&G.isValid&&G.texture&&x.init(e,G,r.renderState)}}for(let fe=0;fe<w.length;fe++){const he=S[fe],le=w[fe];he!==null&&le!==void 0&&le.update(he,te,c||o)}B&&B(V,te),te.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:te}),v=null}const ie=new EF;ie.setAnimationLoop(Z),this.setAnimationLoop=function(V){B=V},this.dispose=function(){}}}const Wu=new ms,BY=new Ze;function HY(i,e){function t(y,g){y.matrixAutoUpdate===!0&&y.updateMatrix(),g.value.copy(y.matrix)}function n(y,g){g.color.getRGB(y.fogColor.value,TF(i)),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)}function r(y,g,_,w,S){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(y,g):g.isMeshToonMaterial?(s(y,g),h(y,g)):g.isMeshPhongMaterial?(s(y,g),u(y,g)):g.isMeshStandardMaterial?(s(y,g),f(y,g),g.isMeshPhysicalMaterial&&p(y,g,S)):g.isMeshMatcapMaterial?(s(y,g),v(y,g)):g.isMeshDepthMaterial?s(y,g):g.isMeshDistanceMaterial?(s(y,g),x(y,g)):g.isMeshNormalMaterial?s(y,g):g.isLineBasicMaterial?(o(y,g),g.isLineDashedMaterial&&a(y,g)):g.isPointsMaterial?l(y,g,_,w):g.isSpriteMaterial?c(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.bumpMap&&(y.bumpMap.value=g.bumpMap,t(g.bumpMap,y.bumpMapTransform),y.bumpScale.value=g.bumpScale,g.side===Vi&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,t(g.normalMap,y.normalMapTransform),y.normalScale.value.copy(g.normalScale),g.side===Vi&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,t(g.displacementMap,y.displacementMapTransform),y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,y.emissiveMapTransform)),g.specularMap&&(y.specularMap.value=g.specularMap,t(g.specularMap,y.specularMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);const _=e.get(g),w=_.envMap,S=_.envMapRotation;w&&(y.envMap.value=w,Wu.copy(S),Wu.x*=-1,Wu.y*=-1,Wu.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(Wu.y*=-1,Wu.z*=-1),y.envMapRotation.value.setFromMatrix4(BY.makeRotationFromEuler(Wu)),y.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap&&(y.lightMap.value=g.lightMap,y.lightMapIntensity.value=g.lightMapIntensity,t(g.lightMap,y.lightMapTransform)),g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,y.aoMapTransform))}function o(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform))}function a(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}function l(y,g,_,w){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*_,y.scale.value=w*.5,g.map&&(y.map.value=g.map,t(g.map,y.uvTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function c(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function u(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4)}function h(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap)}function f(y,g){y.metalness.value=g.metalness,g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,y.metalnessMapTransform)),y.roughness.value=g.roughness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,y.roughnessMapTransform)),g.envMap&&(y.envMapIntensity.value=g.envMapIntensity)}function p(y,g,_){y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,y.sheenColorMapTransform)),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,y.sheenRoughnessMapTransform))),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,y.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(y.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Vi&&y.clearcoatNormalScale.value.negate())),g.dispersion>0&&(y.dispersion.value=g.dispersion),g.iridescence>0&&(y.iridescence.value=g.iridescence,y.iridescenceIOR.value=g.iridescenceIOR,y.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(y.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,y.iridescenceMapTransform)),g.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=_.texture,y.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,y.transmissionMapTransform)),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(y.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(y.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,y.specularColorMapTransform)),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,y.specularIntensityMapTransform))}function v(y,g){g.matcap&&(y.matcap.value=g.matcap)}function x(y,g){const _=e.get(g).light;y.referencePosition.value.setFromMatrixPosition(_.matrixWorld),y.nearDistance.value=_.shadow.camera.near,y.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function GY(i,e,t,n){let r={},s={},o=[];const a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(_,w){const S=w.program;n.uniformBlockBinding(_,S)}function c(_,w){let S=r[_.id];S===void 0&&(v(_),S=u(_),r[_.id]=S,_.addEventListener("dispose",y));const C=w.program;n.updateUBOMapping(_,C);const E=e.render.frame;s[_.id]!==E&&(f(_),s[_.id]=E)}function u(_){const w=h();_.__bindingPointIndex=w;const S=i.createBuffer(),C=_.__size,E=_.usage;return i.bindBuffer(i.UNIFORM_BUFFER,S),i.bufferData(i.UNIFORM_BUFFER,C,E),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,w,S),S}function h(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(_){const w=r[_.id],S=_.uniforms,C=_.__cache;i.bindBuffer(i.UNIFORM_BUFFER,w);for(let E=0,A=S.length;E<A;E++){const T=Array.isArray(S[E])?S[E]:[S[E]];for(let L=0,M=T.length;L<M;L++){const R=T[L];if(p(R,E,L,C)===!0){const D=R.__offset,F=Array.isArray(R.value)?R.value:[R.value];let z=0;for(let q=0;q<F.length;q++){const H=F[q],$=x(H);typeof H=="number"||typeof H=="boolean"?(R.__data[0]=H,i.bufferSubData(i.UNIFORM_BUFFER,D+z,R.__data)):H.isMatrix3?(R.__data[0]=H.elements[0],R.__data[1]=H.elements[1],R.__data[2]=H.elements[2],R.__data[3]=0,R.__data[4]=H.elements[3],R.__data[5]=H.elements[4],R.__data[6]=H.elements[5],R.__data[7]=0,R.__data[8]=H.elements[6],R.__data[9]=H.elements[7],R.__data[10]=H.elements[8],R.__data[11]=0):(H.toArray(R.__data,z),z+=$.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,D,R.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function p(_,w,S,C){const E=_.value,A=w+"_"+S;if(C[A]===void 0)return typeof E=="number"||typeof E=="boolean"?C[A]=E:C[A]=E.clone(),!0;{const T=C[A];if(typeof E=="number"||typeof E=="boolean"){if(T!==E)return C[A]=E,!0}else if(T.equals(E)===!1)return T.copy(E),!0}return!1}function v(_){const w=_.uniforms;let S=0;const C=16;for(let A=0,T=w.length;A<T;A++){const L=Array.isArray(w[A])?w[A]:[w[A]];for(let M=0,R=L.length;M<R;M++){const D=L[M],F=Array.isArray(D.value)?D.value:[D.value];for(let z=0,q=F.length;z<q;z++){const H=F[z],$=x(H),U=S%C,X=U%$.boundary,j=U+X;S+=X,j!==0&&C-j<$.storage&&(S+=C-j),D.__data=new Float32Array($.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=S,S+=$.storage}}}const E=S%C;return E>0&&(S+=C-E),_.__size=S,_.__cache={},this}function x(_){const w={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(w.boundary=4,w.storage=4):_.isVector2?(w.boundary=8,w.storage=8):_.isVector3||_.isColor?(w.boundary=16,w.storage=12):_.isVector4?(w.boundary=16,w.storage=16):_.isMatrix3?(w.boundary=48,w.storage=48):_.isMatrix4?(w.boundary=64,w.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),w}function y(_){const w=_.target;w.removeEventListener("dispose",y);const S=o.indexOf(w.__bindingPointIndex);o.splice(S,1),i.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function g(){for(const _ in r)i.deleteBuffer(r[_]);o=[],r={},s={}}return{bind:l,update:c,dispose:g}}class cA{constructor(e={}){const{canvas:t=wF(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let f;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=o;const p=new Uint32Array(4),v=new Int32Array(4);let x=null,y=null;const g=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Wt,this.toneMapping=Ta,this.toneMappingExposure=1;const w=this;let S=!1,C=0,E=0,A=null,T=-1,L=null;const M=new Pt,R=new Pt;let D=null;const F=new Ge(0);let z=0,q=t.width,H=t.height,$=1,U=null,X=null;const j=new Pt(0,0,q,H),B=new Pt(0,0,q,H);let Z=!1;const ie=new H0;let V=!1,te=!1;const fe=new Ze,he=new Ze,le=new N,G=new Pt,Q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let J=!1;function ne(){return A===null?$:1}let Y=n;function de(ee,xe){return t.getContext(ee,xe)}try{const ee={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${rf}`),t.addEventListener("webglcontextlost",De,!1),t.addEventListener("webglcontextrestored",$e,!1),t.addEventListener("webglcontextcreationerror",je,!1),Y===null){const xe="webgl2";if(Y=de(xe,ee),Y===null)throw de(xe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ee){throw console.error("THREE.WebGLRenderer: "+ee.message),ee}let ve,Se,Te,Ee,Re,K,k,ue,me,Me,ge,Ye,Ie,ze,Je,Fe,Xe,ct,tt,Ve,qe,ce,ke,ae;function Be(){ve=new q7(Y),ve.init(),ce=new LF(Y,ve),Se=new G7(Y,ve,e,ce),Te=new CY(Y),Se.reverseDepthBuffer&&Te.buffers.depth.setReversed(!0),Ee=new Q7(Y),Re=new mY,K=new UY(Y,ve,Te,Re,Se,ce,Ee),k=new W7(w),ue=new Y7(w),me=new rj(Y),ke=new B7(Y,me),Me=new K7(Y,me,Ee,ke),ge=new $7(Y,Me,me,Ee),tt=new J7(Y,Se,K),Fe=new V7(Re),Ye=new pY(w,k,ue,ve,Se,ke,Fe),Ie=new HY(w,Re),ze=new vY,Je=new MY(ve),ct=new z7(w,k,ue,Te,ge,f,l),Xe=new EY(w,ge,Se),ae=new GY(Y,Ee,Se,Te),Ve=new H7(Y,ve,Ee),qe=new Z7(Y,ve,Ee),Ee.programs=Ye.programs,w.capabilities=Se,w.extensions=ve,w.properties=Re,w.renderLists=ze,w.shadowMap=Xe,w.state=Te,w.info=Ee}Be();const pe=new zY(w,Y);this.xr=pe,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){const ee=ve.get("WEBGL_lose_context");ee&&ee.loseContext()},this.forceContextRestore=function(){const ee=ve.get("WEBGL_lose_context");ee&&ee.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(ee){ee!==void 0&&($=ee,this.setSize(q,H,!1))},this.getSize=function(ee){return ee.set(q,H)},this.setSize=function(ee,xe,Pe=!0){if(pe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}q=ee,H=xe,t.width=Math.floor(ee*$),t.height=Math.floor(xe*$),Pe===!0&&(t.style.width=ee+"px",t.style.height=xe+"px"),this.setViewport(0,0,ee,xe)},this.getDrawingBufferSize=function(ee){return ee.set(q*$,H*$).floor()},this.setDrawingBufferSize=function(ee,xe,Pe){q=ee,H=xe,$=Pe,t.width=Math.floor(ee*Pe),t.height=Math.floor(xe*Pe),this.setViewport(0,0,ee,xe)},this.getCurrentViewport=function(ee){return ee.copy(M)},this.getViewport=function(ee){return ee.copy(j)},this.setViewport=function(ee,xe,Pe,Le){ee.isVector4?j.set(ee.x,ee.y,ee.z,ee.w):j.set(ee,xe,Pe,Le),Te.viewport(M.copy(j).multiplyScalar($).round())},this.getScissor=function(ee){return ee.copy(B)},this.setScissor=function(ee,xe,Pe,Le){ee.isVector4?B.set(ee.x,ee.y,ee.z,ee.w):B.set(ee,xe,Pe,Le),Te.scissor(R.copy(B).multiplyScalar($).round())},this.getScissorTest=function(){return Z},this.setScissorTest=function(ee){Te.setScissorTest(Z=ee)},this.setOpaqueSort=function(ee){U=ee},this.setTransparentSort=function(ee){X=ee},this.getClearColor=function(ee){return ee.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(ee=!0,xe=!0,Pe=!0){let Le=0;if(ee){let _e=!1;if(A!==null){const Qe=A.texture.format;_e=Qe===iw||Qe===nw||Qe===O0}if(_e){const Qe=A.texture.type,ot=Qe===Pa||Qe===Yl||Qe===Gh||Qe===Vh||Qe===ew||Qe===tw,He=ct.getClearColor(),ht=ct.getClearAlpha(),Tt=He.r,St=He.g,vt=He.b;ot?(p[0]=Tt,p[1]=St,p[2]=vt,p[3]=ht,Y.clearBufferuiv(Y.COLOR,0,p)):(v[0]=Tt,v[1]=St,v[2]=vt,v[3]=ht,Y.clearBufferiv(Y.COLOR,0,v))}else Le|=Y.COLOR_BUFFER_BIT}xe&&(Le|=Y.DEPTH_BUFFER_BIT,Y.clearDepth(this.capabilities.reverseDepthBuffer?0:1)),Pe&&(Le|=Y.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Y.clear(Le)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",De,!1),t.removeEventListener("webglcontextrestored",$e,!1),t.removeEventListener("webglcontextcreationerror",je,!1),ze.dispose(),Je.dispose(),Re.dispose(),k.dispose(),ue.dispose(),ge.dispose(),ke.dispose(),ae.dispose(),Ye.dispose(),pe.dispose(),pe.removeEventListener("sessionstart",Fn),pe.removeEventListener("sessionend",qn),wi.stop()};function De(ee){ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function $e(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const ee=Ee.autoReset,xe=Xe.enabled,Pe=Xe.autoUpdate,Le=Xe.needsUpdate,_e=Xe.type;Be(),Ee.autoReset=ee,Xe.enabled=xe,Xe.autoUpdate=Pe,Xe.needsUpdate=Le,Xe.type=_e}function je(ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ee.statusMessage)}function rt(ee){const xe=ee.target;xe.removeEventListener("dispose",rt),bt(xe)}function bt(ee){Ct(ee),Re.remove(ee)}function Ct(ee){const xe=Re.get(ee).programs;xe!==void 0&&(xe.forEach(function(Pe){Ye.releaseProgram(Pe)}),ee.isShaderMaterial&&Ye.releaseShaderCache(ee))}this.renderBufferDirect=function(ee,xe,Pe,Le,_e,Qe){xe===null&&(xe=Q);const ot=_e.isMesh&&_e.matrixWorld.determinant()<0,He=Mu(ee,xe,Pe,Le,_e);Te.setMaterial(Le,ot);let ht=Pe.index,Tt=1;if(Le.wireframe===!0){if(ht=Me.getWireframeAttribute(Pe),ht===void 0)return;Tt=2}const St=Pe.drawRange,vt=Pe.attributes.position;let nn=St.start*Tt,rn=(St.start+St.count)*Tt;Qe!==null&&(nn=Math.max(nn,Qe.start*Tt),rn=Math.min(rn,(Qe.start+Qe.count)*Tt)),ht!==null?(nn=Math.max(nn,0),rn=Math.min(rn,ht.count)):vt!=null&&(nn=Math.max(nn,0),rn=Math.min(rn,vt.count));const sn=rn-nn;if(sn<0||sn===1/0)return;ke.setup(_e,Le,He,Pe,ht);let kt,xt=Ve;if(ht!==null&&(kt=me.get(ht),xt=qe,xt.setIndex(kt)),_e.isMesh)Le.wireframe===!0?(Te.setLineWidth(Le.wireframeLinewidth*ne()),xt.setMode(Y.LINES)):xt.setMode(Y.TRIANGLES);else if(_e.isLine){let dt=Le.linewidth;dt===void 0&&(dt=1),Te.setLineWidth(dt*ne()),_e.isLineSegments?xt.setMode(Y.LINES):_e.isLineLoop?xt.setMode(Y.LINE_LOOP):xt.setMode(Y.LINE_STRIP)}else _e.isPoints?xt.setMode(Y.POINTS):_e.isSprite&&xt.setMode(Y.TRIANGLES);if(_e.isBatchedMesh)if(_e._multiDrawInstances!==null)xt.renderMultiDrawInstances(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount,_e._multiDrawInstances);else if(ve.get("WEBGL_multi_draw"))xt.renderMultiDraw(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount);else{const dt=_e._multiDrawStarts,$t=_e._multiDrawCounts,Rt=_e._multiDrawCount,ui=ht?me.get(ht).bytesPerElement:1,Xi=Re.get(Le).currentProgram.getUniforms();for(let dn=0;dn<Rt;dn++)Xi.setValue(Y,"_gl_DrawID",dn),xt.render(dt[dn]/ui,$t[dn])}else if(_e.isInstancedMesh)xt.renderInstances(nn,sn,_e.count);else if(Pe.isInstancedBufferGeometry){const dt=Pe._maxInstanceCount!==void 0?Pe._maxInstanceCount:1/0,$t=Math.min(Pe.instanceCount,dt);xt.renderInstances(nn,sn,$t)}else xt.render(nn,sn)};function nt(ee,xe,Pe){ee.transparent===!0&&ee.side===_n&&ee.forceSinglePass===!1?(ee.side=Vi,ee.needsUpdate=!0,ci(ee,xe,Pe),ee.side=wo,ee.needsUpdate=!0,ci(ee,xe,Pe),ee.side=_n):ci(ee,xe,Pe)}this.compile=function(ee,xe,Pe=null){Pe===null&&(Pe=ee),y=Je.get(Pe),y.init(xe),_.push(y),Pe.traverseVisible(function(_e){_e.isLight&&_e.layers.test(xe.layers)&&(y.pushLight(_e),_e.castShadow&&y.pushShadow(_e))}),ee!==Pe&&ee.traverseVisible(function(_e){_e.isLight&&_e.layers.test(xe.layers)&&(y.pushLight(_e),_e.castShadow&&y.pushShadow(_e))}),y.setupLights();const Le=new Set;return ee.traverse(function(_e){if(!(_e.isMesh||_e.isPoints||_e.isLine||_e.isSprite))return;const Qe=_e.material;if(Qe)if(Array.isArray(Qe))for(let ot=0;ot<Qe.length;ot++){const He=Qe[ot];nt(He,Pe,_e),Le.add(He)}else nt(Qe,Pe,_e),Le.add(Qe)}),_.pop(),y=null,Le},this.compileAsync=function(ee,xe,Pe=null){const Le=this.compile(ee,xe,Pe);return new Promise(_e=>{function Qe(){if(Le.forEach(function(ot){Re.get(ot).currentProgram.isReady()&&Le.delete(ot)}),Le.size===0){_e(ee);return}setTimeout(Qe,10)}ve.get("KHR_parallel_shader_compile")!==null?Qe():setTimeout(Qe,10)})};let Lt=null;function ln(ee){Lt&&Lt(ee)}function Fn(){wi.stop()}function qn(){wi.start()}const wi=new EF;wi.setAnimationLoop(ln),typeof self<"u"&&wi.setContext(self),this.setAnimationLoop=function(ee){Lt=ee,pe.setAnimationLoop(ee),ee===null?wi.stop():wi.start()},pe.addEventListener("sessionstart",Fn),pe.addEventListener("sessionend",qn),this.render=function(ee,xe){if(xe!==void 0&&xe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(S===!0)return;if(ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),xe.parent===null&&xe.matrixWorldAutoUpdate===!0&&xe.updateMatrixWorld(),pe.enabled===!0&&pe.isPresenting===!0&&(pe.cameraAutoUpdate===!0&&pe.updateCamera(xe),xe=pe.getCamera()),ee.isScene===!0&&ee.onBeforeRender(w,ee,xe,A),y=Je.get(ee,_.length),y.init(xe),_.push(y),he.multiplyMatrices(xe.projectionMatrix,xe.matrixWorldInverse),ie.setFromProjectionMatrix(he),te=this.localClippingEnabled,V=Fe.init(this.clippingPlanes,te),x=ze.get(ee,g.length),x.init(),g.push(x),pe.enabled===!0&&pe.isPresenting===!0){const Qe=w.xr.getDepthSensingMesh();Qe!==null&&Jr(Qe,xe,-1/0,w.sortObjects)}Jr(ee,xe,0,w.sortObjects),x.finish(),w.sortObjects===!0&&x.sort(U,X),J=pe.enabled===!1||pe.isPresenting===!1||pe.hasDepthSensing()===!1,J&&ct.addToRenderList(x,ee),this.info.render.frame++,V===!0&&Fe.beginShadows();const Pe=y.state.shadowsArray;Xe.render(Pe,ee,xe),V===!0&&Fe.endShadows(),this.info.autoReset===!0&&this.info.reset();const Le=x.opaque,_e=x.transmissive;if(y.setupLights(),xe.isArrayCamera){const Qe=xe.cameras;if(_e.length>0)for(let ot=0,He=Qe.length;ot<He;ot++){const ht=Qe[ot];Ks(Le,_e,ee,ht)}J&&ct.render(ee);for(let ot=0,He=Qe.length;ot<He;ot++){const ht=Qe[ot];Ir(x,ee,ht,ht.viewport)}}else _e.length>0&&Ks(Le,_e,ee,xe),J&&ct.render(ee),Ir(x,ee,xe);A!==null&&(K.updateMultisampleRenderTarget(A),K.updateRenderTargetMipmap(A)),ee.isScene===!0&&ee.onAfterRender(w,ee,xe),ke.resetDefaultState(),T=-1,L=null,_.pop(),_.length>0?(y=_[_.length-1],V===!0&&Fe.setGlobalState(w.clippingPlanes,y.state.camera)):y=null,g.pop(),g.length>0?x=g[g.length-1]:x=null};function Jr(ee,xe,Pe,Le){if(ee.visible===!1)return;if(ee.layers.test(xe.layers)){if(ee.isGroup)Pe=ee.renderOrder;else if(ee.isLOD)ee.autoUpdate===!0&&ee.update(xe);else if(ee.isLight)y.pushLight(ee),ee.castShadow&&y.pushShadow(ee);else if(ee.isSprite){if(!ee.frustumCulled||ie.intersectsSprite(ee)){Le&&G.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(he);const ot=ge.update(ee),He=ee.material;He.visible&&x.push(ee,ot,He,Pe,G.z,null)}}else if((ee.isMesh||ee.isLine||ee.isPoints)&&(!ee.frustumCulled||ie.intersectsObject(ee))){const ot=ge.update(ee),He=ee.material;if(Le&&(ee.boundingSphere!==void 0?(ee.boundingSphere===null&&ee.computeBoundingSphere(),G.copy(ee.boundingSphere.center)):(ot.boundingSphere===null&&ot.computeBoundingSphere(),G.copy(ot.boundingSphere.center)),G.applyMatrix4(ee.matrixWorld).applyMatrix4(he)),Array.isArray(He)){const ht=ot.groups;for(let Tt=0,St=ht.length;Tt<St;Tt++){const vt=ht[Tt],nn=He[vt.materialIndex];nn&&nn.visible&&x.push(ee,ot,nn,Pe,G.z,vt)}}else He.visible&&x.push(ee,ot,He,Pe,G.z,null)}}const Qe=ee.children;for(let ot=0,He=Qe.length;ot<He;ot++)Jr(Qe[ot],xe,Pe,Le)}function Ir(ee,xe,Pe,Le){const _e=ee.opaque,Qe=ee.transmissive,ot=ee.transparent;y.setupLightsView(Pe),V===!0&&Fe.setGlobalState(w.clippingPlanes,Pe),Le&&Te.viewport(M.copy(Le)),_e.length>0&&rr(_e,xe,Pe),Qe.length>0&&rr(Qe,xe,Pe),ot.length>0&&rr(ot,xe,Pe),Te.buffers.depth.setTest(!0),Te.buffers.depth.setMask(!0),Te.buffers.color.setMask(!0),Te.setPolygonOffset(!1)}function Ks(ee,xe,Pe,Le){if((Pe.isScene===!0?Pe.overrideMaterial:null)!==null)return;y.state.transmissionRenderTarget[Le.id]===void 0&&(y.state.transmissionRenderTarget[Le.id]=new vi(1,1,{generateMipmaps:!0,type:ve.has("EXT_color_buffer_half_float")||ve.has("EXT_color_buffer_float")?Zi:Pa,minFilter:uo,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:on.workingColorSpace}));const Qe=y.state.transmissionRenderTarget[Le.id],ot=Le.viewport||M;Qe.setSize(ot.z,ot.w);const He=w.getRenderTarget();w.setRenderTarget(Qe),w.getClearColor(F),z=w.getClearAlpha(),z<1&&w.setClearColor(16777215,.5),w.clear(),J&&ct.render(Pe);const ht=w.toneMapping;w.toneMapping=Ta;const Tt=Le.viewport;if(Le.viewport!==void 0&&(Le.viewport=void 0),y.setupLightsView(Le),V===!0&&Fe.setGlobalState(w.clippingPlanes,Le),rr(ee,Pe,Le),K.updateMultisampleRenderTarget(Qe),K.updateRenderTargetMipmap(Qe),ve.has("WEBGL_multisampled_render_to_texture")===!1){let St=!1;for(let vt=0,nn=xe.length;vt<nn;vt++){const rn=xe[vt],sn=rn.object,kt=rn.geometry,xt=rn.material,dt=rn.group;if(xt.side===_n&&sn.layers.test(Le.layers)){const $t=xt.side;xt.side=Vi,xt.needsUpdate=!0,_s(sn,Pe,Le,kt,xt,dt),xt.side=$t,xt.needsUpdate=!0,St=!0}}St===!0&&(K.updateMultisampleRenderTarget(Qe),K.updateRenderTargetMipmap(Qe))}w.setRenderTarget(He),w.setClearColor(F,z),Tt!==void 0&&(Le.viewport=Tt),w.toneMapping=ht}function rr(ee,xe,Pe){const Le=xe.isScene===!0?xe.overrideMaterial:null;for(let _e=0,Qe=ee.length;_e<Qe;_e++){const ot=ee[_e],He=ot.object,ht=ot.geometry,Tt=Le===null?ot.material:Le,St=ot.group;He.layers.test(Pe.layers)&&_s(He,xe,Pe,ht,Tt,St)}}function _s(ee,xe,Pe,Le,_e,Qe){ee.onBeforeRender(w,xe,Pe,Le,_e,Qe),ee.modelViewMatrix.multiplyMatrices(Pe.matrixWorldInverse,ee.matrixWorld),ee.normalMatrix.getNormalMatrix(ee.modelViewMatrix),_e.onBeforeRender(w,xe,Pe,Le,ee,Qe),_e.transparent===!0&&_e.side===_n&&_e.forceSinglePass===!1?(_e.side=Vi,_e.needsUpdate=!0,w.renderBufferDirect(Pe,xe,Le,_e,ee,Qe),_e.side=wo,_e.needsUpdate=!0,w.renderBufferDirect(Pe,xe,Le,_e,ee,Qe),_e.side=_n):w.renderBufferDirect(Pe,xe,Le,_e,ee,Qe),ee.onAfterRender(w,xe,Pe,Le,_e,Qe)}function ci(ee,xe,Pe){xe.isScene!==!0&&(xe=Q);const Le=Re.get(ee),_e=y.state.lights,Qe=y.state.shadowsArray,ot=_e.state.version,He=Ye.getParameters(ee,_e.state,Qe,xe,Pe),ht=Ye.getProgramCacheKey(He);let Tt=Le.programs;Le.environment=ee.isMeshStandardMaterial?xe.environment:null,Le.fog=xe.fog,Le.envMap=(ee.isMeshStandardMaterial?ue:k).get(ee.envMap||Le.environment),Le.envMapRotation=Le.environment!==null&&ee.envMap===null?xe.environmentRotation:ee.envMapRotation,Tt===void 0&&(ee.addEventListener("dispose",rt),Tt=new Map,Le.programs=Tt);let St=Tt.get(ht);if(St!==void 0){if(Le.currentProgram===St&&Le.lightsStateVersion===ot)return Su(ee,He),St}else He.uniforms=Ye.getUniforms(ee),ee.onBeforeCompile(He,w),St=Ye.acquireProgram(He,ht),Tt.set(ht,St),Le.uniforms=He.uniforms;const vt=Le.uniforms;return(!ee.isShaderMaterial&&!ee.isRawShaderMaterial||ee.clipping===!0)&&(vt.clippingPlanes=Fe.uniform),Su(ee,He),Le.needsLights=mf(ee),Le.lightsStateVersion=ot,Le.needsLights&&(vt.ambientLightColor.value=_e.state.ambient,vt.lightProbe.value=_e.state.probe,vt.directionalLights.value=_e.state.directional,vt.directionalLightShadows.value=_e.state.directionalShadow,vt.spotLights.value=_e.state.spot,vt.spotLightShadows.value=_e.state.spotShadow,vt.rectAreaLights.value=_e.state.rectArea,vt.ltc_1.value=_e.state.rectAreaLTC1,vt.ltc_2.value=_e.state.rectAreaLTC2,vt.pointLights.value=_e.state.point,vt.pointLightShadows.value=_e.state.pointShadow,vt.hemisphereLights.value=_e.state.hemi,vt.directionalShadowMap.value=_e.state.directionalShadowMap,vt.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,vt.spotShadowMap.value=_e.state.spotShadowMap,vt.spotLightMatrix.value=_e.state.spotLightMatrix,vt.spotLightMap.value=_e.state.spotLightMap,vt.pointShadowMap.value=_e.state.pointShadowMap,vt.pointShadowMatrix.value=_e.state.pointShadowMatrix),Le.currentProgram=St,Le.uniformsList=null,St}function Ao(ee){if(ee.uniformsList===null){const xe=ee.currentProgram.getUniforms();ee.uniformsList=qx.seqWithValue(xe.seq,ee.uniforms)}return ee.uniformsList}function Su(ee,xe){const Pe=Re.get(ee);Pe.outputColorSpace=xe.outputColorSpace,Pe.batching=xe.batching,Pe.batchingColor=xe.batchingColor,Pe.instancing=xe.instancing,Pe.instancingColor=xe.instancingColor,Pe.instancingMorph=xe.instancingMorph,Pe.skinning=xe.skinning,Pe.morphTargets=xe.morphTargets,Pe.morphNormals=xe.morphNormals,Pe.morphColors=xe.morphColors,Pe.morphTargetsCount=xe.morphTargetsCount,Pe.numClippingPlanes=xe.numClippingPlanes,Pe.numIntersection=xe.numClipIntersection,Pe.vertexAlphas=xe.vertexAlphas,Pe.vertexTangents=xe.vertexTangents,Pe.toneMapping=xe.toneMapping}function Mu(ee,xe,Pe,Le,_e){xe.isScene!==!0&&(xe=Q),K.resetTextureUnits();const Qe=xe.fog,ot=Le.isMeshStandardMaterial?xe.environment:null,He=A===null?w.outputColorSpace:A.isXRRenderTarget===!0?A.texture.colorSpace:Wi,ht=(Le.isMeshStandardMaterial?ue:k).get(Le.envMap||ot),Tt=Le.vertexColors===!0&&!!Pe.attributes.color&&Pe.attributes.color.itemSize===4,St=!!Pe.attributes.tangent&&(!!Le.normalMap||Le.anisotropy>0),vt=!!Pe.morphAttributes.position,nn=!!Pe.morphAttributes.normal,rn=!!Pe.morphAttributes.color;let sn=Ta;Le.toneMapped&&(A===null||A.isXRRenderTarget===!0)&&(sn=w.toneMapping);const kt=Pe.morphAttributes.position||Pe.morphAttributes.normal||Pe.morphAttributes.color,xt=kt!==void 0?kt.length:0,dt=Re.get(Le),$t=y.state.lights;if(V===!0&&(te===!0||ee!==L)){const kn=ee===L&&Le.id===T;Fe.setState(Le,ee,kn)}let Rt=!1;Le.version===dt.__version?(dt.needsLights&&dt.lightsStateVersion!==$t.state.version||dt.outputColorSpace!==He||_e.isBatchedMesh&&dt.batching===!1||!_e.isBatchedMesh&&dt.batching===!0||_e.isBatchedMesh&&dt.batchingColor===!0&&_e.colorTexture===null||_e.isBatchedMesh&&dt.batchingColor===!1&&_e.colorTexture!==null||_e.isInstancedMesh&&dt.instancing===!1||!_e.isInstancedMesh&&dt.instancing===!0||_e.isSkinnedMesh&&dt.skinning===!1||!_e.isSkinnedMesh&&dt.skinning===!0||_e.isInstancedMesh&&dt.instancingColor===!0&&_e.instanceColor===null||_e.isInstancedMesh&&dt.instancingColor===!1&&_e.instanceColor!==null||_e.isInstancedMesh&&dt.instancingMorph===!0&&_e.morphTexture===null||_e.isInstancedMesh&&dt.instancingMorph===!1&&_e.morphTexture!==null||dt.envMap!==ht||Le.fog===!0&&dt.fog!==Qe||dt.numClippingPlanes!==void 0&&(dt.numClippingPlanes!==Fe.numPlanes||dt.numIntersection!==Fe.numIntersection)||dt.vertexAlphas!==Tt||dt.vertexTangents!==St||dt.morphTargets!==vt||dt.morphNormals!==nn||dt.morphColors!==rn||dt.toneMapping!==sn||dt.morphTargetsCount!==xt)&&(Rt=!0):(Rt=!0,dt.__version=Le.version);let ui=dt.currentProgram;Rt===!0&&(ui=ci(Le,xe,_e));let Xi=!1,dn=!1,$r=!1;const bn=ui.getUniforms(),es=dt.uniforms;if(Te.useProgram(ui.program)&&(Xi=!0,dn=!0,$r=!0),Le.id!==T&&(T=Le.id,dn=!0),Xi||L!==ee){Se.reverseDepthBuffer?(fe.copy(ee.projectionMatrix),PW(fe),RW(fe),bn.setValue(Y,"projectionMatrix",fe)):bn.setValue(Y,"projectionMatrix",ee.projectionMatrix),bn.setValue(Y,"viewMatrix",ee.matrixWorldInverse);const kn=bn.map.cameraPosition;kn!==void 0&&kn.setValue(Y,le.setFromMatrixPosition(ee.matrixWorld)),Se.logarithmicDepthBuffer&&bn.setValue(Y,"logDepthBufFC",2/(Math.log(ee.far+1)/Math.LN2)),(Le.isMeshPhongMaterial||Le.isMeshToonMaterial||Le.isMeshLambertMaterial||Le.isMeshBasicMaterial||Le.isMeshStandardMaterial||Le.isShaderMaterial)&&bn.setValue(Y,"isOrthographic",ee.isOrthographicCamera===!0),L!==ee&&(L=ee,dn=!0,$r=!0)}if(_e.isSkinnedMesh){bn.setOptional(Y,_e,"bindMatrix"),bn.setOptional(Y,_e,"bindMatrixInverse");const kn=_e.skeleton;kn&&(kn.boneTexture===null&&kn.computeBoneTexture(),bn.setValue(Y,"boneTexture",kn.boneTexture,K))}_e.isBatchedMesh&&(bn.setOptional(Y,_e,"batchingTexture"),bn.setValue(Y,"batchingTexture",_e._matricesTexture,K),bn.setOptional(Y,_e,"batchingIdTexture"),bn.setValue(Y,"batchingIdTexture",_e._indirectTexture,K),bn.setOptional(Y,_e,"batchingColorTexture"),_e._colorsTexture!==null&&bn.setValue(Y,"batchingColorTexture",_e._colorsTexture,K));const Co=Pe.morphAttributes;if((Co.position!==void 0||Co.normal!==void 0||Co.color!==void 0)&&tt.update(_e,Pe,ui),(dn||dt.receiveShadow!==_e.receiveShadow)&&(dt.receiveShadow=_e.receiveShadow,bn.setValue(Y,"receiveShadow",_e.receiveShadow)),Le.isMeshGouraudMaterial&&Le.envMap!==null&&(es.envMap.value=ht,es.flipEnvMap.value=ht.isCubeTexture&&ht.isRenderTargetTexture===!1?-1:1),Le.isMeshStandardMaterial&&Le.envMap===null&&xe.environment!==null&&(es.envMapIntensity.value=xe.environmentIntensity),dn&&(bn.setValue(Y,"toneMappingExposure",w.toneMappingExposure),dt.needsLights&&nm(es,$r),Qe&&Le.fog===!0&&Ie.refreshFogUniforms(es,Qe),Ie.refreshMaterialUniforms(es,Le,$,H,y.state.transmissionRenderTarget[ee.id]),qx.upload(Y,Ao(dt),es,K)),Le.isShaderMaterial&&Le.uniformsNeedUpdate===!0&&(qx.upload(Y,Ao(dt),es,K),Le.uniformsNeedUpdate=!1),Le.isSpriteMaterial&&bn.setValue(Y,"center",_e.center),bn.setValue(Y,"modelViewMatrix",_e.modelViewMatrix),bn.setValue(Y,"normalMatrix",_e.normalMatrix),bn.setValue(Y,"modelMatrix",_e.matrixWorld),Le.isShaderMaterial||Le.isRawShaderMaterial){const kn=Le.uniformsGroups;for(let yr=0,rc=kn.length;yr<rc;yr++){const Ua=kn[yr];ae.update(Ua,ui),ae.bind(Ua,ui)}}return ui}function nm(ee,xe){ee.ambientLightColor.needsUpdate=xe,ee.lightProbe.needsUpdate=xe,ee.directionalLights.needsUpdate=xe,ee.directionalLightShadows.needsUpdate=xe,ee.pointLights.needsUpdate=xe,ee.pointLightShadows.needsUpdate=xe,ee.spotLights.needsUpdate=xe,ee.spotLightShadows.needsUpdate=xe,ee.rectAreaLights.needsUpdate=xe,ee.hemisphereLights.needsUpdate=xe}function mf(ee){return ee.isMeshLambertMaterial||ee.isMeshToonMaterial||ee.isMeshPhongMaterial||ee.isMeshStandardMaterial||ee.isShadowMaterial||ee.isShaderMaterial&&ee.lights===!0}this.getActiveCubeFace=function(){return C},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(ee,xe,Pe){Re.get(ee.texture).__webglTexture=xe,Re.get(ee.depthTexture).__webglTexture=Pe;const Le=Re.get(ee);Le.__hasExternalTextures=!0,Le.__autoAllocateDepthBuffer=Pe===void 0,Le.__autoAllocateDepthBuffer||ve.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Le.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(ee,xe){const Pe=Re.get(ee);Pe.__webglFramebuffer=xe,Pe.__useDefaultFramebuffer=xe===void 0},this.setRenderTarget=function(ee,xe=0,Pe=0){A=ee,C=xe,E=Pe;let Le=!0,_e=null,Qe=!1,ot=!1;if(ee){const ht=Re.get(ee);if(ht.__useDefaultFramebuffer!==void 0)Te.bindFramebuffer(Y.FRAMEBUFFER,null),Le=!1;else if(ht.__webglFramebuffer===void 0)K.setupRenderTarget(ee);else if(ht.__hasExternalTextures)K.rebindTextures(ee,Re.get(ee.texture).__webglTexture,Re.get(ee.depthTexture).__webglTexture);else if(ee.depthBuffer){const vt=ee.depthTexture;if(ht.__boundDepthTexture!==vt){if(vt!==null&&Re.has(vt)&&(ee.width!==vt.image.width||ee.height!==vt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");K.setupDepthRenderbuffer(ee)}}const Tt=ee.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(ot=!0);const St=Re.get(ee).__webglFramebuffer;ee.isWebGLCubeRenderTarget?(Array.isArray(St[xe])?_e=St[xe][Pe]:_e=St[xe],Qe=!0):ee.samples>0&&K.useMultisampledRTT(ee)===!1?_e=Re.get(ee).__webglMultisampledFramebuffer:Array.isArray(St)?_e=St[Pe]:_e=St,M.copy(ee.viewport),R.copy(ee.scissor),D=ee.scissorTest}else M.copy(j).multiplyScalar($).floor(),R.copy(B).multiplyScalar($).floor(),D=Z;if(Te.bindFramebuffer(Y.FRAMEBUFFER,_e)&&Le&&Te.drawBuffers(ee,_e),Te.viewport(M),Te.scissor(R),Te.setScissorTest(D),Qe){const ht=Re.get(ee.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+xe,ht.__webglTexture,Pe)}else if(ot){const ht=Re.get(ee.texture),Tt=xe||0;Y.framebufferTextureLayer(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,ht.__webglTexture,Pe||0,Tt)}T=-1},this.readRenderTargetPixels=function(ee,xe,Pe,Le,_e,Qe,ot){if(!(ee&&ee.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let He=Re.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&ot!==void 0&&(He=He[ot]),He){Te.bindFramebuffer(Y.FRAMEBUFFER,He);try{const ht=ee.texture,Tt=ht.format,St=ht.type;if(!Se.textureFormatReadable(Tt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Se.textureTypeReadable(St)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}xe>=0&&xe<=ee.width-Le&&Pe>=0&&Pe<=ee.height-_e&&Y.readPixels(xe,Pe,Le,_e,ce.convert(Tt),ce.convert(St),Qe)}finally{const ht=A!==null?Re.get(A).__webglFramebuffer:null;Te.bindFramebuffer(Y.FRAMEBUFFER,ht)}}},this.readRenderTargetPixelsAsync=async function(ee,xe,Pe,Le,_e,Qe,ot){if(!(ee&&ee.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let He=Re.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&ot!==void 0&&(He=He[ot]),He){const ht=ee.texture,Tt=ht.format,St=ht.type;if(!Se.textureFormatReadable(Tt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Se.textureTypeReadable(St))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(xe>=0&&xe<=ee.width-Le&&Pe>=0&&Pe<=ee.height-_e){Te.bindFramebuffer(Y.FRAMEBUFFER,He);const vt=Y.createBuffer();Y.bindBuffer(Y.PIXEL_PACK_BUFFER,vt),Y.bufferData(Y.PIXEL_PACK_BUFFER,Qe.byteLength,Y.STREAM_READ),Y.readPixels(xe,Pe,Le,_e,ce.convert(Tt),ce.convert(St),0);const nn=A!==null?Re.get(A).__webglFramebuffer:null;Te.bindFramebuffer(Y.FRAMEBUFFER,nn);const rn=Y.fenceSync(Y.SYNC_GPU_COMMANDS_COMPLETE,0);return Y.flush(),await CW(Y,rn,4),Y.bindBuffer(Y.PIXEL_PACK_BUFFER,vt),Y.getBufferSubData(Y.PIXEL_PACK_BUFFER,0,Qe),Y.deleteBuffer(vt),Y.deleteSync(rn),Qe}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(ee,xe=null,Pe=0){ee.isTexture!==!0&&(Yx("WebGLRenderer: copyFramebufferToTexture function signature has changed."),xe=arguments[0]||null,ee=arguments[1]);const Le=Math.pow(2,-Pe),_e=Math.floor(ee.image.width*Le),Qe=Math.floor(ee.image.height*Le),ot=xe!==null?xe.x:0,He=xe!==null?xe.y:0;K.setTexture2D(ee,0),Y.copyTexSubImage2D(Y.TEXTURE_2D,Pe,0,0,ot,He,_e,Qe),Te.unbindTexture()},this.copyTextureToTexture=function(ee,xe,Pe=null,Le=null,_e=0){ee.isTexture!==!0&&(Yx("WebGLRenderer: copyTextureToTexture function signature has changed."),Le=arguments[0]||null,ee=arguments[1],xe=arguments[2],_e=arguments[3]||0,Pe=null);let Qe,ot,He,ht,Tt,St;Pe!==null?(Qe=Pe.max.x-Pe.min.x,ot=Pe.max.y-Pe.min.y,He=Pe.min.x,ht=Pe.min.y):(Qe=ee.image.width,ot=ee.image.height,He=0,ht=0),Le!==null?(Tt=Le.x,St=Le.y):(Tt=0,St=0);const vt=ce.convert(xe.format),nn=ce.convert(xe.type);K.setTexture2D(xe,0),Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,xe.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,xe.unpackAlignment);const rn=Y.getParameter(Y.UNPACK_ROW_LENGTH),sn=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),kt=Y.getParameter(Y.UNPACK_SKIP_PIXELS),xt=Y.getParameter(Y.UNPACK_SKIP_ROWS),dt=Y.getParameter(Y.UNPACK_SKIP_IMAGES),$t=ee.isCompressedTexture?ee.mipmaps[_e]:ee.image;Y.pixelStorei(Y.UNPACK_ROW_LENGTH,$t.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,$t.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,He),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,ht),ee.isDataTexture?Y.texSubImage2D(Y.TEXTURE_2D,_e,Tt,St,Qe,ot,vt,nn,$t.data):ee.isCompressedTexture?Y.compressedTexSubImage2D(Y.TEXTURE_2D,_e,Tt,St,$t.width,$t.height,vt,$t.data):Y.texSubImage2D(Y.TEXTURE_2D,_e,Tt,St,Qe,ot,vt,nn,$t),Y.pixelStorei(Y.UNPACK_ROW_LENGTH,rn),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,sn),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,kt),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,xt),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,dt),_e===0&&xe.generateMipmaps&&Y.generateMipmap(Y.TEXTURE_2D),Te.unbindTexture()},this.copyTextureToTexture3D=function(ee,xe,Pe=null,Le=null,_e=0){ee.isTexture!==!0&&(Yx("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Pe=arguments[0]||null,Le=arguments[1]||null,ee=arguments[2],xe=arguments[3],_e=arguments[4]||0);let Qe,ot,He,ht,Tt,St,vt,nn,rn;const sn=ee.isCompressedTexture?ee.mipmaps[_e]:ee.image;Pe!==null?(Qe=Pe.max.x-Pe.min.x,ot=Pe.max.y-Pe.min.y,He=Pe.max.z-Pe.min.z,ht=Pe.min.x,Tt=Pe.min.y,St=Pe.min.z):(Qe=sn.width,ot=sn.height,He=sn.depth,ht=0,Tt=0,St=0),Le!==null?(vt=Le.x,nn=Le.y,rn=Le.z):(vt=0,nn=0,rn=0);const kt=ce.convert(xe.format),xt=ce.convert(xe.type);let dt;if(xe.isData3DTexture)K.setTexture3D(xe,0),dt=Y.TEXTURE_3D;else if(xe.isDataArrayTexture||xe.isCompressedArrayTexture)K.setTexture2DArray(xe,0),dt=Y.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,xe.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,xe.unpackAlignment);const $t=Y.getParameter(Y.UNPACK_ROW_LENGTH),Rt=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),ui=Y.getParameter(Y.UNPACK_SKIP_PIXELS),Xi=Y.getParameter(Y.UNPACK_SKIP_ROWS),dn=Y.getParameter(Y.UNPACK_SKIP_IMAGES);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,sn.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,sn.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,ht),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Tt),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,St),ee.isDataTexture||ee.isData3DTexture?Y.texSubImage3D(dt,_e,vt,nn,rn,Qe,ot,He,kt,xt,sn.data):xe.isCompressedArrayTexture?Y.compressedTexSubImage3D(dt,_e,vt,nn,rn,Qe,ot,He,kt,sn.data):Y.texSubImage3D(dt,_e,vt,nn,rn,Qe,ot,He,kt,xt,sn),Y.pixelStorei(Y.UNPACK_ROW_LENGTH,$t),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Rt),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,ui),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Xi),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,dn),_e===0&&xe.generateMipmaps&&Y.generateMipmap(dt),Te.unbindTexture()},this.initRenderTarget=function(ee){Re.get(ee).__webglFramebuffer===void 0&&K.setupRenderTarget(ee)},this.initTexture=function(ee){ee.isCubeTexture?K.setTextureCube(ee,0):ee.isData3DTexture?K.setTexture3D(ee,0):ee.isDataArrayTexture||ee.isCompressedArrayTexture?K.setTexture2DArray(ee,0):K.setTexture2D(ee,0),Te.unbindTexture()},this.resetState=function(){C=0,E=0,A=null,Te.reset(),ke.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ja}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===sw?"display-p3":"srgb",t.unpackColorSpace=on.workingColorSpace===z0?"display-p3":"srgb"}}class G0{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ge(e),this.density=t}clone(){return new G0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class uw{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ge(e),this.near=t,this.far=n}clone(){return new uw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class yp extends Kt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ms,this.environmentIntensity=1,this.environmentRotation=new ms,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class V0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=e0,this.updateRanges=[],this.version=0,this.uuid=vo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const as=new N;class Ls{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)as.fromBufferAttribute(this,t),as.applyMatrix4(e),this.setXYZ(t,as.x,as.y,as.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)as.fromBufferAttribute(this,t),as.applyNormalMatrix(e),this.setXYZ(t,as.x,as.y,as.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)as.fromBufferAttribute(this,t),as.transformDirection(e),this.setXYZ(t,as.x,as.y,as.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=hs(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Vt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=hs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=hs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=hs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=hs(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vt(t,this.array),n=Vt(n,this.array),r=Vt(r,this.array),s=Vt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new wt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ls(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class uA extends Di{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Vf;const Dm=new N,Wf=new N,jf=new N,Xf=new be,Im=new be,IF=new Ze,yy=new N,Um=new N,xy=new N,xR=new be,vM=new be,_R=new be;class UF extends Kt{constructor(e=new uA){if(super(),this.isSprite=!0,this.type="Sprite",Vf===void 0){Vf=new yt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new V0(t,5);Vf.setIndex([0,1,2,0,2,3]),Vf.setAttribute("position",new Ls(n,3,0,!1)),Vf.setAttribute("uv",new Ls(n,2,3,!1))}this.geometry=Vf,this.material=e,this.center=new be(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Wf.setFromMatrixScale(this.matrixWorld),IF.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),jf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Wf.multiplyScalar(-jf.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;_y(yy.set(-.5,-.5,0),jf,o,Wf,r,s),_y(Um.set(.5,-.5,0),jf,o,Wf,r,s),_y(xy.set(.5,.5,0),jf,o,Wf,r,s),xR.set(0,0),vM.set(1,0),_R.set(1,1);let a=e.ray.intersectTriangle(yy,Um,xy,!1,Dm);if(a===null&&(_y(Um.set(-.5,.5,0),jf,o,Wf,r,s),vM.set(0,1),a=e.ray.intersectTriangle(yy,xy,Um,!1,Dm),a===null))return;const l=e.ray.origin.distanceTo(Dm);l<e.near||l>e.far||t.push({distance:l,point:Dm.clone(),uv:An.getInterpolation(Dm,yy,Um,xy,xR,vM,_R,new be),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function _y(i,e,t,n,r,s){Xf.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(Im.x=s*Xf.x-r*Xf.y,Im.y=r*Xf.x+s*Xf.y):Im.copy(Xf),i.copy(e),i.x+=Im.x,i.y+=Im.y,i.applyMatrix4(IF)}const wy=new N,wR=new N;class FF extends Kt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){wy.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(wy);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){wy.setFromMatrixPosition(e.matrixWorld),wR.setFromMatrixPosition(this.matrixWorld);const n=wy.distanceTo(wR)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),n>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const SR=new N,MR=new Pt,bR=new Pt,VY=new N,TR=new Ze,Sy=new N,yM=new Li,ER=new Ze,xM=new la;class hA extends Ae{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=ET,this.bindMatrix=new Ze,this.bindMatrixInverse=new Ze,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new vn),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Sy),this.boundingBox.expandByPoint(Sy)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Li),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Sy),this.boundingSphere.expandByPoint(Sy)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),yM.copy(this.boundingSphere),yM.applyMatrix4(r),e.ray.intersectsSphere(yM)!==!1&&(ER.copy(r).invert(),xM.copy(e.ray).applyMatrix4(ER),!(this.boundingBox!==null&&xM.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,xM)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Pt,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===ET?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===oF?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;MR.fromBufferAttribute(r.attributes.skinIndex,e),bR.fromBufferAttribute(r.attributes.skinWeight,e),SR.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=bR.getComponent(s);if(o!==0){const a=MR.getComponent(s);TR.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(VY.copy(SR).applyMatrix4(TR),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hw extends Kt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Jo extends Cn{constructor(e=null,t=1,n=1,r,s,o,a,l,c=wn,u=wn,h,f){super(null,o,a,l,c,u,r,s,h,f),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const AR=new Ze,WY=new Ze;class W0{constructor(e=[],t=[]){this.uuid=vo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ze)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Ze;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:WY;AR.multiplyMatrices(a,t[s]),AR.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new W0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Jo(t,e,e,fr,Hi);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new hw),this.bones.push(o),this.boneInverses.push(new Ze().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class nu extends wt{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Yf=new Ze,CR=new Ze,My=[],PR=new vn,jY=new Ze,Fm=new Ae,km=new Li;class fw extends Ae{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new nu(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,jY)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new vn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Yf),PR.copy(e.boundingBox).applyMatrix4(Yf),this.boundingBox.union(PR)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Li),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Yf),km.copy(e.boundingSphere).applyMatrix4(Yf),this.boundingSphere.union(km)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let a=0;a<n.length;a++)n[a]=r[o+a]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Fm.geometry=this.geometry,Fm.material=this.material,Fm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),km.copy(this.boundingSphere),km.applyMatrix4(n),e.ray.intersectsSphere(km)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Yf),CR.multiplyMatrices(n,Yf),Fm.matrixWorld=CR,Fm.raycast(e,My);for(let o=0,a=My.length;o<a;o++){const l=My[o];l.instanceId=s,l.object=this,t.push(l)}My.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new nu(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Jo(new Float32Array(r*this.count),r,this.count,N0,Hi));const s=this.morphTexture.source.data.data;let o=0;for(let c=0;c<n.length;c++)o+=n[c];const a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function XY(i,e){return i.z-e.z}function YY(i,e){return e.z-i.z}class qY{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const o=r[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t,o.index=n}reset(){this.list.length=0,this.index=0}}const wc=new Ze,_M=new Ze,KY=new Ze,ZY=new Ge(1,1,1),RR=new Ze,wM=new H0,by=new vn,ju=new Li,Nm=new N,LR=new N,QY=new N,SM=new qY,Br=new Ae,Ty=[];function JY(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let o=0;o<n;o++)e.setComponent(s+t,o,i.getComponent(s,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}class kF extends Ae{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,n=t*2,r){super(new yt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._availableInstanceIds=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Jo(t,e,e,fr,Hi);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Jo(t,e,e,O0,Yl);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Jo(t,e,e,fr,Hi);n.colorSpace=on.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:a,itemSize:l,normalized:c}=o,u=new a.constructor(n*l),h=new wt(u,l,c);t.setAttribute(s,h)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new wt(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vn);const e=this.boundingBox,t=this._drawInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,wc),this.getBoundingBoxAt(s,by).applyMatrix4(wc),e.union(by)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Li);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,wc),this.getBoundingSphereAt(s,ju).applyMatrix4(wc),e.union(ju)}}addInstance(e){if(this._drawInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(r=this._availableInstanceIds.pop(),this._drawInfo[r]=n):(r=this._drawInfo.length,this._drawInfo.push(n));const s=this._matricesTexture,o=s.image.data;KY.toArray(o,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(ZY.toArray(a.image.data,r*4),a.needsUpdate=!0),r}addGeometry(e,t=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=t,s===null?r.vertexStart=0:r.vertexStart=s.vertexStart+s.vertexCount;const c=e.getIndex(),u=c!==null;if(u&&(n===-1?r.indexCount=c.count:r.indexCount=n,s===null?r.indexStart=0:r.indexStart=s.indexStart+s.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const h=this._geometryCount;return this._geometryCount++,o.push(r),a.push({start:u?r.indexStart:r.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new vn,sphereInitialized:!1,sphere:new Li}),this.setGeometryAt(h,e),h}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(r&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.vertexCount;for(const p in n.attributes){const v=t.getAttribute(p),x=n.getAttribute(p);JY(v,x,l);const y=v.itemSize;for(let g=v.count,_=c;g<_;g++){const w=l+g;for(let S=0;S<y;S++)x.setComponent(w,S,0)}x.needsUpdate=!0,x.addUpdateRange(l*y,c*y)}if(r){const p=a.indexStart;for(let v=0;v<o.count;v++)s.setX(p+v,l+o.getX(v));for(let v=o.count,x=a.indexCount;v<x;v++)s.setX(p+v,l);s.needsUpdate=!0,s.addUpdateRange(p,a.indexCount)}const u=this._bounds[e];t.boundingBox!==null?(u.box.copy(t.boundingBox),u.boxInitialized=!0):u.boxInitialized=!1,t.boundingSphere!==null?(u.sphere.copy(t.boundingSphere),u.sphereInitialized=!0):u.sphereInitialized=!1;const h=this._drawRanges[e],f=t.getAttribute("position");return h.count=r?o.count:f.count,this._visibilityChanged=!0,e}deleteInstance(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?this:(t[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this._bounds[e],r=n.box,s=this.geometry;if(n.boxInitialized===!1){r.makeEmpty();const o=s.index,a=s.attributes.position,l=this._drawRanges[e];for(let c=l.start,u=l.start+l.count;c<u;c++){let h=c;o&&(h=o.getX(h)),r.expandByPoint(Nm.fromBufferAttribute(a,h))}n.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this._bounds[e],r=n.sphere,s=this.geometry;if(n.sphereInitialized===!1){r.makeEmpty(),this.getBoundingBoxAt(e,by),by.getCenter(r.center);const o=s.index,a=s.attributes.position,l=this._drawRanges[e];let c=0;for(let u=l.start,h=l.start+l.count;u<h;u++){let f=u;o&&(f=o.getX(f)),Nm.fromBufferAttribute(a,f),c=Math.max(c,r.center.distanceToSquared(Nm))}r.radius=Math.sqrt(c),n.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){const n=this._drawInfo,r=this._matricesTexture,s=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?this:(t.toArray(s,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,t){const n=this._drawInfo,r=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?null:t.fromArray(r,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const n=this._colorsTexture,r=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(r,e*4),n.needsUpdate=!0,this)}getColorAt(e,t){const n=this._colorsTexture.image.data,r=this._drawInfo;return e>=r.length||r[e].active===!1?null:t.fromArray(n,e*4)}setVisibleAt(e,t){const n=this._drawInfo;return e>=n.length||n[e].active===!1||n[e].visible===t?this:(n[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}setGeometryIdAt(e,t){const n=this._drawInfo;return e>=n.length||n[e].active===!1||t<0||t>=this._geometryCount?null:(n[e].geometryIndex=t,this)}getGeometryIdAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?-1:t[e].geometryIndex}getGeometryRangeAt(e,t={}){if(e<0||e>=this._geometryCount)return null;const n=this._drawRanges[e];return t.start=n.start,t.count=n.count,t}raycast(e,t){const n=this._drawInfo,r=this._drawRanges,s=this.matrixWorld,o=this.geometry;Br.material=this.material,Br.geometry.index=o.index,Br.geometry.attributes=o.attributes,Br.geometry.boundingBox===null&&(Br.geometry.boundingBox=new vn),Br.geometry.boundingSphere===null&&(Br.geometry.boundingSphere=new Li);for(let a=0,l=n.length;a<l;a++){if(!n[a].visible||!n[a].active)continue;const c=n[a].geometryIndex,u=r[c];Br.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Br.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Br.geometry.boundingBox),this.getBoundingSphereAt(c,Br.geometry.boundingSphere),Br.raycast(e,Ty);for(let h=0,f=Ty.length;h<f;h++){const p=Ty[h];p.object=this,p.batchId=a,t.push(p)}Ty.length=0}Br.material=null,Br.geometry.index=null,Br.geometry.attributes={},Br.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._drawInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,h=this._drawRanges,f=this.perObjectFrustumCulled,p=this._indirectTexture,v=p.image.data;f&&(RR.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),wM.setFromProjectionMatrix(RR,e.coordinateSystem));let x=0;if(this.sortObjects){_M.copy(this.matrixWorld).invert(),Nm.setFromMatrixPosition(n.matrixWorld).applyMatrix4(_M),LR.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(_M);for(let _=0,w=l.length;_<w;_++)if(l[_].visible&&l[_].active){const S=l[_].geometryIndex;this.getMatrixAt(_,wc),this.getBoundingSphereAt(S,ju).applyMatrix4(wc);let C=!1;if(f&&(C=!wM.intersectsSphere(ju)),!C){const E=QY.subVectors(ju.center,Nm).dot(LR);SM.push(h[S],E,_)}}const y=SM.list,g=this.customSort;g===null?y.sort(s.transparent?YY:XY):g.call(this,y,n);for(let _=0,w=y.length;_<w;_++){const S=y[_];c[x]=S.start*a,u[x]=S.count,v[x]=S.index,x++}SM.reset()}else for(let y=0,g=l.length;y<g;y++)if(l[y].visible&&l[y].active){const _=l[y].geometryIndex;let w=!1;if(f&&(this.getMatrixAt(y,wc),this.getBoundingSphereAt(_,ju).applyMatrix4(wc),w=!wM.intersectsSphere(ju)),!w){const S=h[_];c[x]=S.start*a,u[x]=S.count,v[x]=y,x++}}p.needsUpdate=!0,this._multiDrawCount=x,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class vr extends Di{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ge(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const a_=new N,l_=new N,DR=new Ze,Om=new la,Ey=new Li,MM=new N,IR=new N;let Xt=class extends Kt{constructor(e=new yt,t=new vr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)a_.fromBufferAttribute(t,r-1),l_.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=a_.distanceTo(l_);e.setAttribute("lineDistance",new lt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ey.copy(n.boundingSphere),Ey.applyMatrix4(r),Ey.radius+=s,e.ray.intersectsSphere(Ey)===!1)return;DR.copy(r).invert(),Om.copy(e.ray).applyMatrix4(DR);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,u=n.index,f=n.attributes.position;if(u!==null){const p=Math.max(0,o.start),v=Math.min(u.count,o.start+o.count);for(let x=p,y=v-1;x<y;x+=c){const g=u.getX(x),_=u.getX(x+1),w=Ay(this,e,Om,l,g,_);w&&t.push(w)}if(this.isLineLoop){const x=u.getX(v-1),y=u.getX(p),g=Ay(this,e,Om,l,x,y);g&&t.push(g)}}else{const p=Math.max(0,o.start),v=Math.min(f.count,o.start+o.count);for(let x=p,y=v-1;x<y;x+=c){const g=Ay(this,e,Om,l,x,x+1);g&&t.push(g)}if(this.isLineLoop){const x=Ay(this,e,Om,l,v-1,p);x&&t.push(x)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function Ay(i,e,t,n,r,s){const o=i.geometry.attributes.position;if(a_.fromBufferAttribute(o,r),l_.fromBufferAttribute(o,s),t.distanceSqToSegment(a_,l_,MM,IR)>n)return;MM.applyMatrix4(i.matrixWorld);const l=e.ray.origin.distanceTo(MM);if(!(l<e.near||l>e.far))return{distance:l,point:IR.clone().applyMatrix4(i.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:i}}const UR=new N,FR=new N;class La extends Xt{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)UR.fromBufferAttribute(t,r),FR.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+UR.distanceTo(FR);e.setAttribute("lineDistance",new lt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class fA extends Xt{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class of extends Di{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const kR=new Ze,DT=new la,Cy=new Li,Py=new N;class ca extends Kt{constructor(e=new yt,t=new of){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Cy.copy(n.boundingSphere),Cy.applyMatrix4(r),Cy.radius+=s,e.ray.intersectsSphere(Cy)===!1)return;kR.copy(r).invert(),DT.copy(e.ray).applyMatrix4(kR);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,h=n.attributes.position;if(c!==null){const f=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);for(let v=f,x=p;v<x;v++){const y=c.getX(v);Py.fromBufferAttribute(h,y),NR(Py,y,l,r,e,t,this)}}else{const f=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let v=f,x=p;v<x;v++)Py.fromBufferAttribute(h,v),NR(Py,v,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function NR(i,e,t,n,r,s,o){const a=DT.distanceSqToPoint(i);if(a<t){const l=new N;DT.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class $Y extends Cn{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:gn,this.magFilter=s!==void 0?s:gn,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class eq extends Cn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=wn,this.minFilter=wn,this.generateMipmaps=!1,this.needsUpdate=!0}}class dw extends Cn{constructor(e,t,n,r,s,o,a,l,c,u,h,f){super(null,o,a,l,c,u,r,s,h,f),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class tq extends dw{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ds,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class nq extends dw{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Xl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class NF extends Cn{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Da{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const u=n[r],f=n[r+1]-u,p=(o-u)/f;return(r+p)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new be:new N);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new N,r=[],s=[],o=[],a=new N,l=new Ze;for(let p=0;p<=e;p++){const v=p/e;r[p]=this.getTangentAt(v,new N)}s[0]=new N,o[0]=new N;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),f=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),f<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let p=1;p<=e;p++){if(s[p]=s[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(r[p-1],r[p]),a.length()>Number.EPSILON){a.normalize();const v=Math.acos(mi(r[p-1].dot(r[p]),-1,1));s[p].applyMatrix4(l.makeRotationAxis(a,v))}o[p].crossVectors(r[p],s[p])}if(t===!0){let p=Math.acos(mi(s[0].dot(s[e]),-1,1));p/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(p=-p);for(let v=1;v<=e;v++)s[v].applyMatrix4(l.makeRotationAxis(r[v],p*v)),o[v].crossVectors(r[v],s[v])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class pw extends Da{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new be){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),f=l-this.aX,p=c-this.aY;l=f*u-p*h+this.aX,c=f*h+p*u+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class OF extends pw{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function dA(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let f=(o-s)/c-(a-s)/(c+u)+(a-o)/u,p=(a-o)/u-(l-o)/(u+h)+(l-a)/h;f*=u,p*=u,r(o,a,f,p)},calc:function(s){const o=s*s,a=o*s;return i+e*s+t*o+n*a}}}const Ry=new N,bM=new dA,TM=new dA,EM=new dA;class zF extends Da{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new N){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(Ry.subVectors(r[0],r[1]).add(r[0]),c=Ry);const h=r[a%s],f=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Ry.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Ry),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let v=Math.pow(c.distanceToSquared(h),p),x=Math.pow(h.distanceToSquared(f),p),y=Math.pow(f.distanceToSquared(u),p);x<1e-4&&(x=1),v<1e-4&&(v=x),y<1e-4&&(y=x),bM.initNonuniformCatmullRom(c.x,h.x,f.x,u.x,v,x,y),TM.initNonuniformCatmullRom(c.y,h.y,f.y,u.y,v,x,y),EM.initNonuniformCatmullRom(c.z,h.z,f.z,u.z,v,x,y)}else this.curveType==="catmullrom"&&(bM.initCatmullRom(c.x,h.x,f.x,u.x,this.tension),TM.initCatmullRom(c.y,h.y,f.y,u.y,this.tension),EM.initCatmullRom(c.z,h.z,f.z,u.z,this.tension));return n.set(bM.calc(l),TM.calc(l),EM.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new N().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function OR(i,e,t,n,r){const s=(n-e)*.5,o=(r-t)*.5,a=i*i,l=i*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*i+t}function iq(i,e){const t=1-i;return t*t*e}function rq(i,e){return 2*(1-i)*i*e}function sq(i,e){return i*i*e}function Rg(i,e,t,n){return iq(i,e)+rq(i,t)+sq(i,n)}function oq(i,e){const t=1-i;return t*t*t*e}function aq(i,e){const t=1-i;return 3*t*t*i*e}function lq(i,e){return 3*(1-i)*i*i*e}function cq(i,e){return i*i*i*e}function Lg(i,e,t,n,r){return oq(i,e)+aq(i,t)+lq(i,n)+cq(i,r)}class pA extends Da{constructor(e=new be,t=new be,n=new be,r=new be){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new be){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Lg(e,r.x,s.x,o.x,a.x),Lg(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class BF extends Da{constructor(e=new N,t=new N,n=new N,r=new N){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new N){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Lg(e,r.x,s.x,o.x,a.x),Lg(e,r.y,s.y,o.y,a.y),Lg(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mA extends Da{constructor(e=new be,t=new be){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new be){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new be){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class HF extends Da{constructor(e=new N,t=new N){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new N){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new N){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gA extends Da{constructor(e=new be,t=new be,n=new be){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new be){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Rg(e,r.x,s.x,o.x),Rg(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vA extends Da{constructor(e=new N,t=new N,n=new N){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new N){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Rg(e,r.x,s.x,o.x),Rg(e,r.y,s.y,o.y),Rg(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yA extends Da{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new be){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return n.set(OR(a,l.x,c.x,u.x,h.x),OR(a,l.y,c.y,u.y,h.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new be().fromArray(r))}return this}}var c_=Object.freeze({__proto__:null,ArcCurve:OF,CatmullRomCurve3:zF,CubicBezierCurve:pA,CubicBezierCurve3:BF,EllipseCurve:pw,LineCurve:mA,LineCurve3:HF,QuadraticBezierCurve:gA,QuadraticBezierCurve3:vA,SplineCurve:yA});class GF extends Da{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new c_[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new c_[r.type]().fromJSON(r))}return this}}class i0 extends GF{constructor(e){super(),this.type="Path",this.currentPoint=new be,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new mA(this.currentPoint.clone(),new be(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new gA(this.currentPoint.clone(),new be(e,t),new be(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new pA(this.currentPoint.clone(),new be(e,t),new be(n,r),new be(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new yA(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const c=new pw(e,t,n,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class j0 extends yt{constructor(e=[new be(0,-.5),new be(.5,0),new be(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=mi(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,h=new N,f=new be,p=new N,v=new N,x=new N;let y=0,g=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:y=e[_+1].x-e[_].x,g=e[_+1].y-e[_].y,p.x=g*1,p.y=-y,p.z=g*0,x.copy(p),p.normalize(),l.push(p.x,p.y,p.z);break;case e.length-1:l.push(x.x,x.y,x.z);break;default:y=e[_+1].x-e[_].x,g=e[_+1].y-e[_].y,p.x=g*1,p.y=-y,p.z=g*0,v.copy(p),p.x+=x.x,p.y+=x.y,p.z+=x.z,p.normalize(),l.push(p.x,p.y,p.z),x.copy(v)}for(let _=0;_<=t;_++){const w=n+_*u*r,S=Math.sin(w),C=Math.cos(w);for(let E=0;E<=e.length-1;E++){h.x=e[E].x*S,h.y=e[E].y,h.z=e[E].x*C,o.push(h.x,h.y,h.z),f.x=_/t,f.y=E/(e.length-1),a.push(f.x,f.y);const A=l[3*E+0]*S,T=l[3*E+1],L=l[3*E+0]*C;c.push(A,T,L)}}for(let _=0;_<t;_++)for(let w=0;w<e.length-1;w++){const S=w+_*e.length,C=S,E=S+e.length,A=S+e.length+1,T=S+1;s.push(C,E,T),s.push(A,T,E)}this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("uv",new lt(a,2)),this.setAttribute("normal",new lt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new j0(e.points,e.segments,e.phiStart,e.phiLength)}}class mw extends j0{constructor(e=1,t=1,n=4,r=8){const s=new i0;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new mw(e.radius,e.length,e.capSegments,e.radialSegments)}}class X0 extends yt{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new N,u=new be;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,f=3;h<=t;h++,f+=3){const p=n+h/t*r;c.x=e*Math.cos(p),c.y=e*Math.sin(p),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[f]/e+1)/2,u.y=(o[f+1]/e+1)/2,l.push(u.x,u.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("normal",new lt(a,3)),this.setAttribute("uv",new lt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new X0(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Tr extends yt{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],f=[],p=[];let v=0;const x=[],y=n/2;let g=0;_(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(u),this.setAttribute("position",new lt(h,3)),this.setAttribute("normal",new lt(f,3)),this.setAttribute("uv",new lt(p,2));function _(){const S=new N,C=new N;let E=0;const A=(t-e)/n;for(let T=0;T<=s;T++){const L=[],M=T/s,R=M*(t-e)+e;for(let D=0;D<=r;D++){const F=D/r,z=F*l+a,q=Math.sin(z),H=Math.cos(z);C.x=R*q,C.y=-M*n+y,C.z=R*H,h.push(C.x,C.y,C.z),S.set(q,A,H).normalize(),f.push(S.x,S.y,S.z),p.push(F,1-M),L.push(v++)}x.push(L)}for(let T=0;T<r;T++)for(let L=0;L<s;L++){const M=x[L][T],R=x[L+1][T],D=x[L+1][T+1],F=x[L][T+1];e>0&&(u.push(M,R,F),E+=3),t>0&&(u.push(R,D,F),E+=3)}c.addGroup(g,E,0),g+=E}function w(S){const C=v,E=new be,A=new N;let T=0;const L=S===!0?e:t,M=S===!0?1:-1;for(let D=1;D<=r;D++)h.push(0,y*M,0),f.push(0,M,0),p.push(.5,.5),v++;const R=v;for(let D=0;D<=r;D++){const z=D/r*l+a,q=Math.cos(z),H=Math.sin(z);A.x=L*H,A.y=y*M,A.z=L*q,h.push(A.x,A.y,A.z),f.push(0,M,0),E.x=q*.5+.5,E.y=H*.5*M+.5,p.push(E.x,E.y),v++}for(let D=0;D<r;D++){const F=C+D,z=R+D;S===!0?u.push(z,z+1,F):u.push(z+1,z,F),T+=3}c.addGroup(g,T,S===!0?1:2),g+=T}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tr(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Wp extends Tr{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Wp(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mu extends yt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];a(r),c(n),u(),this.setAttribute("position",new lt(s,3)),this.setAttribute("normal",new lt(s.slice(),3)),this.setAttribute("uv",new lt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(_){const w=new N,S=new N,C=new N;for(let E=0;E<t.length;E+=3)p(t[E+0],w),p(t[E+1],S),p(t[E+2],C),l(w,S,C,_)}function l(_,w,S,C){const E=C+1,A=[];for(let T=0;T<=E;T++){A[T]=[];const L=_.clone().lerp(S,T/E),M=w.clone().lerp(S,T/E),R=E-T;for(let D=0;D<=R;D++)D===0&&T===E?A[T][D]=L:A[T][D]=L.clone().lerp(M,D/R)}for(let T=0;T<E;T++)for(let L=0;L<2*(E-T)-1;L++){const M=Math.floor(L/2);L%2===0?(f(A[T][M+1]),f(A[T+1][M]),f(A[T][M])):(f(A[T][M+1]),f(A[T+1][M+1]),f(A[T+1][M]))}}function c(_){const w=new N;for(let S=0;S<s.length;S+=3)w.x=s[S+0],w.y=s[S+1],w.z=s[S+2],w.normalize().multiplyScalar(_),s[S+0]=w.x,s[S+1]=w.y,s[S+2]=w.z}function u(){const _=new N;for(let w=0;w<s.length;w+=3){_.x=s[w+0],_.y=s[w+1],_.z=s[w+2];const S=y(_)/2/Math.PI+.5,C=g(_)/Math.PI+.5;o.push(S,1-C)}v(),h()}function h(){for(let _=0;_<o.length;_+=6){const w=o[_+0],S=o[_+2],C=o[_+4],E=Math.max(w,S,C),A=Math.min(w,S,C);E>.9&&A<.1&&(w<.2&&(o[_+0]+=1),S<.2&&(o[_+2]+=1),C<.2&&(o[_+4]+=1))}}function f(_){s.push(_.x,_.y,_.z)}function p(_,w){const S=_*3;w.x=e[S+0],w.y=e[S+1],w.z=e[S+2]}function v(){const _=new N,w=new N,S=new N,C=new N,E=new be,A=new be,T=new be;for(let L=0,M=0;L<s.length;L+=9,M+=6){_.set(s[L+0],s[L+1],s[L+2]),w.set(s[L+3],s[L+4],s[L+5]),S.set(s[L+6],s[L+7],s[L+8]),E.set(o[M+0],o[M+1]),A.set(o[M+2],o[M+3]),T.set(o[M+4],o[M+5]),C.copy(_).add(w).add(S).divideScalar(3);const R=y(C);x(E,M+0,_,R),x(A,M+2,w,R),x(T,M+4,S,R)}}function x(_,w,S,C){C<0&&_.x===1&&(o[w]=_.x-1),S.x===0&&S.z===0&&(o[w]=C/2/Math.PI+.5)}function y(_){return Math.atan2(_.z,-_.x)}function g(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mu(e.vertices,e.indices,e.radius,e.details)}}class gw extends mu{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new gw(e.radius,e.detail)}}const Ly=new N,Dy=new N,AM=new N,Iy=new An;class VF extends yt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Ph*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],h=new Array(3),f={},p=[];for(let v=0;v<l;v+=3){o?(c[0]=o.getX(v),c[1]=o.getX(v+1),c[2]=o.getX(v+2)):(c[0]=v,c[1]=v+1,c[2]=v+2);const{a:x,b:y,c:g}=Iy;if(x.fromBufferAttribute(a,c[0]),y.fromBufferAttribute(a,c[1]),g.fromBufferAttribute(a,c[2]),Iy.getNormal(AM),h[0]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,h[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,h[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let _=0;_<3;_++){const w=(_+1)%3,S=h[_],C=h[w],E=Iy[u[_]],A=Iy[u[w]],T=`${S}_${C}`,L=`${C}_${S}`;L in f&&f[L]?(AM.dot(f[L].normal)<=s&&(p.push(E.x,E.y,E.z),p.push(A.x,A.y,A.z)),f[L]=null):T in f||(f[T]={index0:c[_],index1:c[w],normal:AM.clone()})}}for(const v in f)if(f[v]){const{index0:x,index1:y}=f[v];Ly.fromBufferAttribute(a,x),Dy.fromBufferAttribute(a,y),p.push(Ly.x,Ly.y,Ly.z),p.push(Dy.x,Dy.y,Dy.z)}this.setAttribute("position",new lt(p,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Lh extends i0{constructor(e){super(e),this.uuid=vo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new i0().fromJSON(r))}return this}}const uq={triangulate:function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=WF(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,f,p;if(n&&(s=mq(i,e,s,t)),i.length>80*t){a=c=i[0],l=u=i[1];for(let v=t;v<r;v+=t)h=i[v],f=i[v+1],h<a&&(a=h),f<l&&(l=f),h>c&&(c=h),f>u&&(u=f);p=Math.max(c-a,u-l),p=p!==0?32767/p:0}return r0(s,o,t,a,l,p,0),o}};function WF(i,e,t,n,r){let s,o;if(r===Eq(i,e,t,n)>0)for(s=e;s<t;s+=n)o=zR(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=zR(s,i[s],i[s+1],o);return o&&vw(o,o.next)&&(o0(o),o=o.next),o}function jh(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(vw(t,t.next)||ri(t.prev,t,t.next)===0)){if(o0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function r0(i,e,t,n,r,s,o){if(!i)return;!o&&s&&_q(i,n,r,s);let a=i,l,c;for(;i.prev!==i.next;){if(l=i.prev,c=i.next,s?fq(i,n,r,s):hq(i)){e.push(l.i/t|0),e.push(i.i/t|0),e.push(c.i/t|0),o0(i),i=c.next,a=c.next;continue}if(i=c,i===a){o?o===1?(i=dq(jh(i),e,t),r0(i,e,t,n,r,s,2)):o===2&&pq(i,e,t,n,r,s):r0(jh(i),e,t,n,r,s,1);break}}}function hq(i){const e=i.prev,t=i,n=i.next;if(ri(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,c=n.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,f=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c;let v=n.next;for(;v!==e;){if(v.x>=u&&v.x<=f&&v.y>=h&&v.y<=p&&xd(r,a,s,l,o,c,v.x,v.y)&&ri(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function fq(i,e,t,n){const r=i.prev,s=i,o=i.next;if(ri(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,f=o.y,p=a<l?a<c?a:c:l<c?l:c,v=u<h?u<f?u:f:h<f?h:f,x=a>l?a>c?a:c:l>c?l:c,y=u>h?u>f?u:f:h>f?h:f,g=IT(p,v,e,t,n),_=IT(x,y,e,t,n);let w=i.prevZ,S=i.nextZ;for(;w&&w.z>=g&&S&&S.z<=_;){if(w.x>=p&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&xd(a,u,l,h,c,f,w.x,w.y)&&ri(w.prev,w,w.next)>=0||(w=w.prevZ,S.x>=p&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&xd(a,u,l,h,c,f,S.x,S.y)&&ri(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;w&&w.z>=g;){if(w.x>=p&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&xd(a,u,l,h,c,f,w.x,w.y)&&ri(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=_;){if(S.x>=p&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&xd(a,u,l,h,c,f,S.x,S.y)&&ri(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function dq(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!vw(r,s)&&jF(r,n,n.next,s)&&s0(r,s)&&s0(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),o0(n),o0(n.next),n=i=s),n=n.next}while(n!==i);return jh(n)}function pq(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Mq(o,a)){let l=XF(o,a);o=jh(o,o.next),l=jh(l,l.next),r0(o,e,t,n,r,s,0),r0(l,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function mq(i,e,t,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,c=WF(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Sq(c));for(r.sort(gq),s=0;s<r.length;s++)t=vq(r[s],t);return t}function gq(i,e){return i.x-e.x}function vq(i,e){const t=yq(i,e);if(!t)return e;const n=XF(t,i);return jh(n,n.next),jh(t,t.next)}function yq(i,e){let t=e,n=-1/0,r;const s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const f=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=s&&f>n&&(n=f,r=t.x<t.next.x?t:t.next,f===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let u=1/0,h;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&xd(o<c?s:n,o,l,c,o<c?n:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),s0(t,i)&&(h<u||h===u&&(t.x>r.x||t.x===r.x&&xq(r,t)))&&(r=t,u=h)),t=t.next;while(t!==a);return r}function xq(i,e){return ri(i.prev,i,e.prev)<0&&ri(e.next,i,i.next)<0}function _q(i,e,t,n){let r=i;do r.z===0&&(r.z=IT(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,wq(r)}function wq(i){let e,t,n,r,s,o,a,l,c=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,c*=2}while(o>1);return i}function IT(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Sq(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function xd(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function Mq(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!bq(i,e)&&(s0(i,e)&&s0(e,i)&&Tq(i,e)&&(ri(i.prev,i,e.prev)||ri(i,e.prev,e))||vw(i,e)&&ri(i.prev,i,i.next)>0&&ri(e.prev,e,e.next)>0)}function ri(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function vw(i,e){return i.x===e.x&&i.y===e.y}function jF(i,e,t,n){const r=Fy(ri(i,e,t)),s=Fy(ri(i,e,n)),o=Fy(ri(t,n,i)),a=Fy(ri(t,n,e));return!!(r!==s&&o!==a||r===0&&Uy(i,t,e)||s===0&&Uy(i,n,e)||o===0&&Uy(t,i,n)||a===0&&Uy(t,e,n))}function Uy(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Fy(i){return i>0?1:i<0?-1:0}function bq(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&jF(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function s0(i,e){return ri(i.prev,i,i.next)<0?ri(i,e,i.next)>=0&&ri(i,i.prev,e)>=0:ri(i,e,i.prev)<0||ri(i,i.next,e)<0}function Tq(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function XF(i,e){const t=new UT(i.i,i.x,i.y),n=new UT(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function zR(i,e,t,n){const r=new UT(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function o0(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function UT(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Eq(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class tl{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return tl.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];BR(e),HR(n,e);let o=e.length;t.forEach(BR);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,HR(n,t[l]);const a=uq.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function BR(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function HR(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Y0 extends yt{constructor(e=new Lh([new be(.5,.5),new be(-.5,.5),new be(-.5,-.5),new be(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new lt(r,3)),this.setAttribute("uv",new lt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,p=t.bevelThickness!==void 0?t.bevelThickness:.2,v=t.bevelSize!==void 0?t.bevelSize:p-.1,x=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3;const g=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:Aq;let w,S=!1,C,E,A,T;g&&(w=g.getSpacedPoints(u),S=!0,f=!1,C=g.computeFrenetFrames(u,!1),E=new N,A=new N,T=new N),f||(y=0,p=0,v=0,x=0);const L=a.extractPoints(c);let M=L.shape;const R=L.holes;if(!tl.isClockWise(M)){M=M.reverse();for(let ne=0,Y=R.length;ne<Y;ne++){const de=R[ne];tl.isClockWise(de)&&(R[ne]=de.reverse())}}const F=tl.triangulateShape(M,R),z=M;for(let ne=0,Y=R.length;ne<Y;ne++){const de=R[ne];M=M.concat(de)}function q(ne,Y,de){return Y||console.error("THREE.ExtrudeGeometry: vec does not exist"),ne.clone().addScaledVector(Y,de)}const H=M.length,$=F.length;function U(ne,Y,de){let ve,Se,Te;const Ee=ne.x-Y.x,Re=ne.y-Y.y,K=de.x-ne.x,k=de.y-ne.y,ue=Ee*Ee+Re*Re,me=Ee*k-Re*K;if(Math.abs(me)>Number.EPSILON){const Me=Math.sqrt(ue),ge=Math.sqrt(K*K+k*k),Ye=Y.x-Re/Me,Ie=Y.y+Ee/Me,ze=de.x-k/ge,Je=de.y+K/ge,Fe=((ze-Ye)*k-(Je-Ie)*K)/(Ee*k-Re*K);ve=Ye+Ee*Fe-ne.x,Se=Ie+Re*Fe-ne.y;const Xe=ve*ve+Se*Se;if(Xe<=2)return new be(ve,Se);Te=Math.sqrt(Xe/2)}else{let Me=!1;Ee>Number.EPSILON?K>Number.EPSILON&&(Me=!0):Ee<-Number.EPSILON?K<-Number.EPSILON&&(Me=!0):Math.sign(Re)===Math.sign(k)&&(Me=!0),Me?(ve=-Re,Se=Ee,Te=Math.sqrt(ue)):(ve=Ee,Se=Re,Te=Math.sqrt(ue/2))}return new be(ve/Te,Se/Te)}const X=[];for(let ne=0,Y=z.length,de=Y-1,ve=ne+1;ne<Y;ne++,de++,ve++)de===Y&&(de=0),ve===Y&&(ve=0),X[ne]=U(z[ne],z[de],z[ve]);const j=[];let B,Z=X.concat();for(let ne=0,Y=R.length;ne<Y;ne++){const de=R[ne];B=[];for(let ve=0,Se=de.length,Te=Se-1,Ee=ve+1;ve<Se;ve++,Te++,Ee++)Te===Se&&(Te=0),Ee===Se&&(Ee=0),B[ve]=U(de[ve],de[Te],de[Ee]);j.push(B),Z=Z.concat(B)}for(let ne=0;ne<y;ne++){const Y=ne/y,de=p*Math.cos(Y*Math.PI/2),ve=v*Math.sin(Y*Math.PI/2)+x;for(let Se=0,Te=z.length;Se<Te;Se++){const Ee=q(z[Se],X[Se],ve);he(Ee.x,Ee.y,-de)}for(let Se=0,Te=R.length;Se<Te;Se++){const Ee=R[Se];B=j[Se];for(let Re=0,K=Ee.length;Re<K;Re++){const k=q(Ee[Re],B[Re],ve);he(k.x,k.y,-de)}}}const ie=v+x;for(let ne=0;ne<H;ne++){const Y=f?q(M[ne],Z[ne],ie):M[ne];S?(A.copy(C.normals[0]).multiplyScalar(Y.x),E.copy(C.binormals[0]).multiplyScalar(Y.y),T.copy(w[0]).add(A).add(E),he(T.x,T.y,T.z)):he(Y.x,Y.y,0)}for(let ne=1;ne<=u;ne++)for(let Y=0;Y<H;Y++){const de=f?q(M[Y],Z[Y],ie):M[Y];S?(A.copy(C.normals[ne]).multiplyScalar(de.x),E.copy(C.binormals[ne]).multiplyScalar(de.y),T.copy(w[ne]).add(A).add(E),he(T.x,T.y,T.z)):he(de.x,de.y,h/u*ne)}for(let ne=y-1;ne>=0;ne--){const Y=ne/y,de=p*Math.cos(Y*Math.PI/2),ve=v*Math.sin(Y*Math.PI/2)+x;for(let Se=0,Te=z.length;Se<Te;Se++){const Ee=q(z[Se],X[Se],ve);he(Ee.x,Ee.y,h+de)}for(let Se=0,Te=R.length;Se<Te;Se++){const Ee=R[Se];B=j[Se];for(let Re=0,K=Ee.length;Re<K;Re++){const k=q(Ee[Re],B[Re],ve);S?he(k.x,k.y+w[u-1].y,w[u-1].x+de):he(k.x,k.y,h+de)}}}V(),te();function V(){const ne=r.length/3;if(f){let Y=0,de=H*Y;for(let ve=0;ve<$;ve++){const Se=F[ve];le(Se[2]+de,Se[1]+de,Se[0]+de)}Y=u+y*2,de=H*Y;for(let ve=0;ve<$;ve++){const Se=F[ve];le(Se[0]+de,Se[1]+de,Se[2]+de)}}else{for(let Y=0;Y<$;Y++){const de=F[Y];le(de[2],de[1],de[0])}for(let Y=0;Y<$;Y++){const de=F[Y];le(de[0]+H*u,de[1]+H*u,de[2]+H*u)}}n.addGroup(ne,r.length/3-ne,0)}function te(){const ne=r.length/3;let Y=0;fe(z,Y),Y+=z.length;for(let de=0,ve=R.length;de<ve;de++){const Se=R[de];fe(Se,Y),Y+=Se.length}n.addGroup(ne,r.length/3-ne,1)}function fe(ne,Y){let de=ne.length;for(;--de>=0;){const ve=de;let Se=de-1;Se<0&&(Se=ne.length-1);for(let Te=0,Ee=u+y*2;Te<Ee;Te++){const Re=H*Te,K=H*(Te+1),k=Y+ve+Re,ue=Y+Se+Re,me=Y+Se+K,Me=Y+ve+K;G(k,ue,me,Me)}}}function he(ne,Y,de){l.push(ne),l.push(Y),l.push(de)}function le(ne,Y,de){Q(ne),Q(Y),Q(de);const ve=r.length/3,Se=_.generateTopUV(n,r,ve-3,ve-2,ve-1);J(Se[0]),J(Se[1]),J(Se[2])}function G(ne,Y,de,ve){Q(ne),Q(Y),Q(ve),Q(Y),Q(de),Q(ve);const Se=r.length/3,Te=_.generateSideWallUV(n,r,Se-6,Se-3,Se-2,Se-1);J(Te[0]),J(Te[1]),J(Te[3]),J(Te[1]),J(Te[2]),J(Te[3])}function Q(ne){r.push(l[ne*3+0]),r.push(l[ne*3+1]),r.push(l[ne*3+2])}function J(ne){s.push(ne.x),s.push(ne.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return Cq(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];n.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new c_[r.type]().fromJSON(r)),new Y0(n,e.options)}}const Aq={generateTopUV:function(i,e,t,n,r){const s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],c=e[r*3],u=e[r*3+1];return[new be(s,o),new be(a,l),new be(c,u)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[n*3],u=e[n*3+1],h=e[n*3+2],f=e[r*3],p=e[r*3+1],v=e[r*3+2],x=e[s*3],y=e[s*3+1],g=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new be(o,1-l),new be(c,1-h),new be(f,1-v),new be(x,1-g)]:[new be(a,1-l),new be(u,1-h),new be(p,1-v),new be(y,1-g)]}};function Cq(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class iu extends mu{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new iu(e.radius,e.detail)}}class Go extends mu{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Go(e.radius,e.detail)}}class yw extends yt{constructor(e=.5,t=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],l=[],c=[],u=[];let h=e;const f=(t-e)/r,p=new N,v=new be;for(let x=0;x<=r;x++){for(let y=0;y<=n;y++){const g=s+y/n*o;p.x=h*Math.cos(g),p.y=h*Math.sin(g),l.push(p.x,p.y,p.z),c.push(0,0,1),v.x=(p.x/t+1)/2,v.y=(p.y/t+1)/2,u.push(v.x,v.y)}h+=f}for(let x=0;x<r;x++){const y=x*(n+1);for(let g=0;g<n;g++){const _=g+y,w=_,S=_+n+1,C=_+n+2,E=_+1;a.push(w,S,E),a.push(S,C,E)}}this.setIndex(a),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(c,3)),this.setAttribute("uv",new lt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yw(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class xw extends yt{constructor(e=new Lh([new be(0,.5),new be(-.5,-.5),new be(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new lt(r,3)),this.setAttribute("normal",new lt(s,3)),this.setAttribute("uv",new lt(o,2));function c(u){const h=r.length/3,f=u.extractPoints(t);let p=f.shape;const v=f.holes;tl.isClockWise(p)===!1&&(p=p.reverse());for(let y=0,g=v.length;y<g;y++){const _=v[y];tl.isClockWise(_)===!0&&(v[y]=_.reverse())}const x=tl.triangulateShape(p,v);for(let y=0,g=v.length;y<g;y++){const _=v[y];p=p.concat(_)}for(let y=0,g=p.length;y<g;y++){const _=p[y];r.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let y=0,g=x.length;y<g;y++){const _=x[y],w=_[0]+h,S=_[1]+h,C=_[2]+h;n.push(w,S,C),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Pq(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];n.push(o)}return new xw(n,e.curveSegments)}}function Pq(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Lr extends yt{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new N,f=new N,p=[],v=[],x=[],y=[];for(let g=0;g<=n;g++){const _=[],w=g/n;let S=0;g===0&&o===0?S=.5/t:g===n&&l===Math.PI&&(S=-.5/t);for(let C=0;C<=t;C++){const E=C/t;h.x=-e*Math.cos(r+E*s)*Math.sin(o+w*a),h.y=e*Math.cos(o+w*a),h.z=e*Math.sin(r+E*s)*Math.sin(o+w*a),v.push(h.x,h.y,h.z),f.copy(h).normalize(),x.push(f.x,f.y,f.z),y.push(E+S,1-w),_.push(c++)}u.push(_)}for(let g=0;g<n;g++)for(let _=0;_<t;_++){const w=u[g][_+1],S=u[g][_],C=u[g+1][_],E=u[g+1][_+1];(g!==0||o>0)&&p.push(w,S,E),(g!==n-1||l<Math.PI)&&p.push(S,C,E)}this.setIndex(p),this.setAttribute("position",new lt(v,3)),this.setAttribute("normal",new lt(x,3)),this.setAttribute("uv",new lt(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lr(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class _w extends mu{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _w(e.radius,e.detail)}}class fo extends yt{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new N,h=new N,f=new N;for(let p=0;p<=n;p++)for(let v=0;v<=r;v++){const x=v/r*s,y=p/n*Math.PI*2;h.x=(e+t*Math.cos(y))*Math.cos(x),h.y=(e+t*Math.cos(y))*Math.sin(x),h.z=t*Math.sin(y),a.push(h.x,h.y,h.z),u.x=e*Math.cos(x),u.y=e*Math.sin(x),f.subVectors(h,u).normalize(),l.push(f.x,f.y,f.z),c.push(v/r),c.push(p/n)}for(let p=1;p<=n;p++)for(let v=1;v<=r;v++){const x=(r+1)*p+v-1,y=(r+1)*(p-1)+v-1,g=(r+1)*(p-1)+v,_=(r+1)*p+v;o.push(x,y,_),o.push(y,g,_)}this.setIndex(o),this.setAttribute("position",new lt(a,3)),this.setAttribute("normal",new lt(l,3)),this.setAttribute("uv",new lt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fo(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class fl extends yt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],u=[],h=new N,f=new N,p=new N,v=new N,x=new N,y=new N,g=new N;for(let w=0;w<=n;++w){const S=w/n*s*Math.PI*2;_(S,s,o,e,p),_(S+.01,s,o,e,v),y.subVectors(v,p),g.addVectors(v,p),x.crossVectors(y,g),g.crossVectors(x,y),x.normalize(),g.normalize();for(let C=0;C<=r;++C){const E=C/r*Math.PI*2,A=-t*Math.cos(E),T=t*Math.sin(E);h.x=p.x+(A*g.x+T*x.x),h.y=p.y+(A*g.y+T*x.y),h.z=p.z+(A*g.z+T*x.z),l.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),c.push(f.x,f.y,f.z),u.push(w/n),u.push(C/r)}}for(let w=1;w<=n;w++)for(let S=1;S<=r;S++){const C=(r+1)*(w-1)+(S-1),E=(r+1)*w+(S-1),A=(r+1)*w+S,T=(r+1)*(w-1)+S;a.push(C,E,T),a.push(E,A,T)}this.setIndex(a),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(c,3)),this.setAttribute("uv",new lt(u,2));function _(w,S,C,E,A){const T=Math.cos(w),L=Math.sin(w),M=C/S*w,R=Math.cos(M);A.x=E*(2+R)*.5*T,A.y=E*(2+R)*L*.5,A.z=E*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fl(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class ww extends yt{constructor(e=new vA(new N(-1,-1,0),new N(-1,1,0),new N(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new N,l=new N,c=new be;let u=new N;const h=[],f=[],p=[],v=[];x(),this.setIndex(v),this.setAttribute("position",new lt(h,3)),this.setAttribute("normal",new lt(f,3)),this.setAttribute("uv",new lt(p,2));function x(){for(let w=0;w<t;w++)y(w);y(s===!1?t:0),_(),g()}function y(w){u=e.getPointAt(w/t,u);const S=o.normals[w],C=o.binormals[w];for(let E=0;E<=r;E++){const A=E/r*Math.PI*2,T=Math.sin(A),L=-Math.cos(A);l.x=L*S.x+T*C.x,l.y=L*S.y+T*C.y,l.z=L*S.z+T*C.z,l.normalize(),f.push(l.x,l.y,l.z),a.x=u.x+n*l.x,a.y=u.y+n*l.y,a.z=u.z+n*l.z,h.push(a.x,a.y,a.z)}}function g(){for(let w=1;w<=t;w++)for(let S=1;S<=r;S++){const C=(r+1)*(w-1)+(S-1),E=(r+1)*w+(S-1),A=(r+1)*w+S,T=(r+1)*(w-1)+S;v.push(C,E,T),v.push(E,A,T)}}function _(){for(let w=0;w<=t;w++)for(let S=0;S<=r;S++)c.x=w/t,c.y=S/r,p.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ww(new c_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class xA extends yt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new N,s=new N;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],f=h.start,p=h.count;for(let v=f,x=f+p;v<x;v+=3)for(let y=0;y<3;y++){const g=a.getX(v+y),_=a.getX(v+(y+1)%3);r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,_),GR(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,h=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,h),GR(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new lt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function GR(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var VR=Object.freeze({__proto__:null,BoxGeometry:un,CapsuleGeometry:mw,CircleGeometry:X0,ConeGeometry:Wp,CylinderGeometry:Tr,DodecahedronGeometry:gw,EdgesGeometry:VF,ExtrudeGeometry:Y0,IcosahedronGeometry:iu,LatheGeometry:j0,OctahedronGeometry:Go,PlaneGeometry:Ot,PolyhedronGeometry:mu,RingGeometry:yw,ShapeGeometry:xw,SphereGeometry:Lr,TetrahedronGeometry:_w,TorusGeometry:fo,TorusKnotGeometry:fl,TubeGeometry:ww,WireframeGeometry:xA});class YF extends Di{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ge(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class qF extends Ft{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class hn extends Di{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ge(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ms,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gs extends hn{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ge(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ge(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ge(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class KF extends Di{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ge(16777215),this.specular=new Ge(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ms,this.combine=k0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _A extends Di{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ge(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class u_ extends Di{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class ZF extends Di{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ms,this.combine=k0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wA extends Di{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ge(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QF extends vr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Sh(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function JF(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function $F(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function FT(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function SA(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}function Rq(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],f=[];for(let p=0;p<c.times.length;++p){const v=c.times[p]*r;if(!(v<t||v>=n)){h.push(c.times[p]);for(let x=0;x<u;++x)f.push(c.values[p*u+x])}}h.length!==0&&(c.times=Sh(h,c.times.constructor),c.values=Sh(f,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function Lq(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=i.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(c===void 0)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let f=0;const p=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);const v=a.times.length-1;let x;if(s<=a.times[0]){const g=u,_=h-u;x=a.values.slice(g,_)}else if(s>=a.times[v]){const g=v*h+u,_=g+h-u;x=a.values.slice(g,_)}else{const g=a.createInterpolant(),_=u,w=h-u;g.evaluate(s),x=g.resultBuffer.slice(_,w)}l==="quaternion"&&new Qt().fromArray(x).normalize().conjugate().toArray(x);const y=c.times.length;for(let g=0;g<y;++g){const _=g*p+f;if(l==="quaternion")Qt.multiplyQuaternionsFlat(c.values,_,x,0,c.values,_);else{const w=p-f*2;for(let S=0;S<w;++S)c.values[_+S]-=x[S]}}}return i.blendMode=$E,i}const Dq={convertArray:Sh,isTypedArray:JF,getKeyframeOrder:$F,sortedArray:FT,flattenJSON:SA,subclip:Rq,makeClipAdditive:Lq};class jp{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ek extends jp{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:xh,endingEnd:xh}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case _h:s=e,a=2*t-n;break;case Zg:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case _h:o=e,l=2*n-t;break;case Zg:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=(n-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,f=this._weightPrev,p=this._weightNext,v=(n-t)/(r-t),x=v*v,y=x*v,g=-f*y+2*f*x-f*v,_=(1+f)*y+(-1.5-2*f)*x+(-.5+f)*v+1,w=(-1-p)*y+(1.5+p)*x+.5*v,S=p*y-p*x;for(let C=0;C!==a;++C)s[C]=g*o[u+C]+_*o[c+C]+w*o[l+C]+S*o[h+C];return s}}class MA extends jp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(n-t)/(r-t),h=1-u;for(let f=0;f!==a;++f)s[f]=o[c+f]*h+o[l+f]*u;return s}}class tk extends jp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ia{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Sh(t,this.TimeBufferType),this.values=Sh(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Sh(e.times,Array),values:Sh(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new tk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new MA(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ek(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case pp:t=this.InterpolantFactoryMethodDiscrete;break;case mp:t=this.InterpolantFactoryMethodLinear;break;case Xx:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pp;case this.InterpolantFactoryMethodLinear:return mp;case this.InterpolantFactoryMethodSmooth:return Xx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&JF(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Xx,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{const h=a*n,f=h-n,p=h+n;for(let v=0;v!==n;++v){const x=t[h+v];if(x!==t[f+v]||x!==t[p+v]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*n,f=o*n;for(let p=0;p!==n;++p)t[f+p]=t[h+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ia.prototype.TimeBufferType=Float32Array;Ia.prototype.ValueBufferType=Float32Array;Ia.prototype.DefaultInterpolation=mp;class af extends Ia{constructor(e,t,n){super(e,t,n)}}af.prototype.ValueTypeName="bool";af.prototype.ValueBufferType=Array;af.prototype.DefaultInterpolation=pp;af.prototype.InterpolantFactoryMethodLinear=void 0;af.prototype.InterpolantFactoryMethodSmooth=void 0;class bA extends Ia{}bA.prototype.ValueTypeName="color";class Xh extends Ia{}Xh.prototype.ValueTypeName="number";class nk extends jp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Qt.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Yh extends Ia{InterpolantFactoryMethodLinear(e){return new nk(this.times,this.values,this.getValueSize(),e)}}Yh.prototype.ValueTypeName="quaternion";Yh.prototype.InterpolantFactoryMethodSmooth=void 0;class lf extends Ia{constructor(e,t,n){super(e,t,n)}}lf.prototype.ValueTypeName="string";lf.prototype.ValueBufferType=Array;lf.prototype.DefaultInterpolation=pp;lf.prototype.InterpolantFactoryMethodLinear=void 0;lf.prototype.InterpolantFactoryMethodSmooth=void 0;class qh extends Ia{}qh.prototype.ValueTypeName="vector";class xp{constructor(e="",t=-1,n=[],r=rw){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=vo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Uq(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(Ia.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=$F(l);l=FT(l,1,u),c=FT(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Xh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let f=r[h];f||(r[h]=f=[]),f.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(h,f,p,v,x){if(p.length!==0){const y=[],g=[];SA(p,y,g,v),y.length!==0&&x.push(new h(f,y,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const f=c[h].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const p={};let v;for(v=0;v<f.length;v++)if(f[v].morphTargets)for(let x=0;x<f[v].morphTargets.length;x++)p[f[v].morphTargets[x]]=-1;for(const x in p){const y=[],g=[];for(let _=0;_!==f[v].morphTargets.length;++_){const w=f[v];y.push(w.time),g.push(w.morphTarget===x?1:0)}r.push(new Xh(".morphTargetInfluence["+x+"]",y,g))}l=p.length*o}else{const p=".bones["+t[h].name+"]";n(qh,p+".position",f,"pos",r),n(Yh,p+".quaternion",f,"rot",r),n(qh,p+".scale",f,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Iq(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xh;case"vector":case"vector2":case"vector3":case"vector4":return qh;case"color":return bA;case"quaternion":return Yh;case"bool":case"boolean":return af;case"string":return lf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Uq(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Iq(i.type);if(i.times===void 0){const t=[],n=[];SA(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Hl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Xp{constructor(e,t,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,f=c.length;h<f;h+=2){const p=c[h],v=c[h+1];if(p.global&&(p.lastIndex=0),p.test(u))return v}return null}}}const ik=new Xp;class Dr{constructor(e){this.manager=e!==void 0?e:ik,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Dr.DEFAULT_MATERIAL_NAME="__DEFAULT";const Cl={};class Fq extends Error{constructor(e,t){super(e),this.response=t}}class Vs extends Dr{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Hl.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Cl[e]!==void 0){Cl[e].push({onLoad:t,onProgress:n,onError:r});return}Cl[e]=[],Cl[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Cl[e],h=c.body.getReader(),f=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),p=f?parseInt(f):0,v=p!==0;let x=0;const y=new ReadableStream({start(g){_();function _(){h.read().then(({done:w,value:S})=>{if(w)g.close();else{x+=S.byteLength;const C=new ProgressEvent("progress",{lengthComputable:v,loaded:x,total:p});for(let E=0,A=u.length;E<A;E++){const T=u[E];T.onProgress&&T.onProgress(C)}g.enqueue(S),_()}},w=>{g.error(w)})}}});return new Response(y)}else throw new Fq(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),f=h&&h[1]?h[1].toLowerCase():void 0,p=new TextDecoder(f);return c.arrayBuffer().then(v=>p.decode(v))}}}).then(c=>{Hl.add(e,c);const u=Cl[e];delete Cl[e];for(let h=0,f=u.length;h<f;h++){const p=u[h];p.onLoad&&p.onLoad(c)}}).catch(c=>{const u=Cl[e];if(u===void 0)throw this.manager.itemError(e),c;delete Cl[e];for(let h=0,f=u.length;h<f;h++){const p=u[h];p.onError&&p.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class kq extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Vs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=xp.parse(e[n]);t.push(r)}return t}}class Nq extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new dw,l=new Vs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(h){l.load(e[h],function(f){const p=s.parse(f,!0);o[h]={width:p.width,height:p.height,format:p.format,mipmaps:p.mipmaps},c+=1,c===6&&(p.mipmapCount===1&&(a.minFilter=gn),a.image=o,a.format=p.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let h=0,f=e.length;h<f;++h)u(h);else l.load(e,function(h){const f=s.parse(h,!0);if(f.isCubemap){const p=f.mipmaps.length/f.mipmapCount;for(let v=0;v<p;v++){o[v]={mipmaps:[]};for(let x=0;x<f.mipmapCount;x++)o[v].mipmaps.push(f.mipmaps[v*f.mipmapCount+x]),o[v].format=f.format,o[v].width=f.width,o[v].height=f.height}a.image=o}else a.image.width=f.width,a.image.height=f.height,a.mipmaps=f.mipmaps;f.mipmapCount===1&&(a.minFilter=gn),a.format=f.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class a0 extends Dr{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Hl.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=n0("img");function l(){u(),Hl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class cf extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=new B0;s.colorSpace=Wt;const o=new a0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class rk extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Jo,a=new Vs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:ds,o.wrapT=c.wrapT!==void 0?c.wrapT:ds,o.magFilter=c.magFilter!==void 0?c.magFilter:gn,o.minFilter=c.minFilter!==void 0?c.minFilter:gn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=uo),c.mipmapCount===1&&(o.minFilter=gn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},n,r),o}}class _i extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=new Cn,o=new a0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class gu extends Kt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ge(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class TA extends gu{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Kt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ge(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const CM=new Ze,WR=new N,jR=new N;class EA{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new be(512,512),this.map=null,this.mapPass=null,this.matrix=new Ze,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new H0,this._frameExtents=new be(1,1),this._viewportCount=1,this._viewports=[new Pt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;WR.setFromMatrixPosition(e.matrixWorld),t.position.copy(WR),jR.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jR),t.updateMatrixWorld(),CM.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CM),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(CM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Oq extends EA{constructor(){super(new Un(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=gp*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class q0 extends gu{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Kt.DEFAULT_UP),this.updateMatrix(),this.target=new Kt,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Oq}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const XR=new Ze,zm=new N,PM=new N;class zq extends EA{constructor(){super(new Un(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new be(4,2),this._viewportCount=6,this._viewports=[new Pt(2,1,1,1),new Pt(0,1,1,1),new Pt(3,1,1,1),new Pt(1,1,1,1),new Pt(3,0,1,1),new Pt(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),zm.setFromMatrixPosition(e.matrixWorld),n.position.copy(zm),PM.copy(n.position),PM.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(PM),n.updateMatrixWorld(),r.makeTranslation(-zm.x,-zm.y,-zm.z),XR.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(XR)}}class Gl extends gu{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new zq}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Bq extends EA{constructor(){super(new yo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Fi extends gu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Kt.DEFAULT_UP),this.updateMatrix(),this.target=new Kt,this.shadow=new Bq}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class nc extends gu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class AA extends gu{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class sk{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new N)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class ok extends gu{constructor(e=new sk,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Sw extends Dr{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new Vs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ge().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new Ge().setHex(o.value);break;case"v2":r.uniforms[s].value=new be().fromArray(o.value);break;case"v3":r.uniforms[s].value=new N().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Pt().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Nt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Ze().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new be().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new be().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Sw.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:YF,SpriteMaterial:uA,RawShaderMaterial:qF,ShaderMaterial:Ft,PointsMaterial:of,MeshPhysicalMaterial:gs,MeshStandardMaterial:hn,MeshPhongMaterial:KF,MeshToonMaterial:_A,MeshNormalMaterial:u_,MeshLambertMaterial:ZF,MeshDepthMaterial:pu,MeshDistanceMaterial:cw,MeshBasicMaterial:Yt,MeshMatcapMaterial:wA,LineDashedMaterial:QF,LineBasicMaterial:vr,Material:Di};return new t[e]}}class Wc{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Mw extends yt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class ak extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Vs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(p,v){if(t[v]!==void 0)return t[v];const y=p.interleavedBuffers[v],g=s(p,y.buffer),_=vd(y.type,g),w=new V0(_,y.stride);return w.uuid=y.uuid,t[v]=w,w}function s(p,v){if(n[v]!==void 0)return n[v];const y=p.arrayBuffers[v],g=new Uint32Array(y).buffer;return n[v]=g,g}const o=e.isInstancedBufferGeometry?new Mw:new yt,a=e.data.index;if(a!==void 0){const p=vd(a.type,a.array);o.setIndex(new wt(p,1))}const l=e.data.attributes;for(const p in l){const v=l[p];let x;if(v.isInterleavedBufferAttribute){const y=r(e.data,v.data);x=new Ls(y,v.itemSize,v.offset,v.normalized)}else{const y=vd(v.type,v.array),g=v.isInstancedBufferAttribute?nu:wt;x=new g(y,v.itemSize,v.normalized)}v.name!==void 0&&(x.name=v.name),v.usage!==void 0&&x.setUsage(v.usage),o.setAttribute(p,x)}const c=e.data.morphAttributes;if(c)for(const p in c){const v=c[p],x=[];for(let y=0,g=v.length;y<g;y++){const _=v[y];let w;if(_.isInterleavedBufferAttribute){const S=r(e.data,_.data);w=new Ls(S,_.itemSize,_.offset,_.normalized)}else{const S=vd(_.type,_.array);w=new wt(S,_.itemSize,_.normalized)}_.name!==void 0&&(w.name=_.name),x.push(w)}o.morphAttributes[p]=x}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let p=0,v=h.length;p!==v;++p){const x=h[p];o.addGroup(x.start,x.count,x.materialIndex)}const f=e.data.boundingSphere;if(f!==void 0){const p=new N;f.center!==void 0&&p.fromArray(f.center),o.boundingSphere=new Li(p,f.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Hq extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=this.path===""?Wc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Vs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?Wc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Vs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),t!==void 0){let h=!1;for(const f in o)if(o[f].data instanceof HTMLImageElement){h=!0;break}h===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new Lh().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new W0().fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new ak;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in VR?a=VR[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new Sw;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=xp.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(u)}else return l.data?{data:vd(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new Xp(t);s=new a0(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const h=e[c],f=h.url;if(Array.isArray(f)){const p=[];for(let v=0,x=f.length;v<x;v++){const y=f[v],g=a(y);g!==null&&(g instanceof HTMLImageElement?p.push(g):p.push(new Jo(g.data,g.width,g.height)))}r[h.uuid]=new wh(p)}else{const p=a(h.url);r[h.uuid]=new wh(p)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:vd(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new a0(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let h=0,f=c.length;h<f;h++){const p=c[h],v=await s(p);v!==null&&(v instanceof HTMLImageElement?u.push(v):u.push(new Jo(v.data,v.width,v.height)))}n[l.uuid]=new wh(u)}else{const u=await s(l.url);n[l.uuid]=new wh(u)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new B0,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Jo:u=new Cn,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=n(a.mapping,Gq)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=n(a.wrap[0],YR),u.wrapT=n(a.wrap[1],YR)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=n(a.minFilter,qR)),a.magFilter!==void 0&&(u.magFilter=n(a.magFilter,qR)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,n,r,s){let o;function a(f){return t[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),t[f]}function l(f){if(f!==void 0){if(Array.isArray(f)){const p=[];for(let v=0,x=f.length;v<x;v++){const y=f[v];n[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),p.push(n[y])}return p}return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),n[f]}}function c(f){return r[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),r[f]}let u,h;switch(e.type){case"Scene":o=new yp,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ge(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new uw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new G0(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Un(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new yo(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new nc(e.color,e.intensity);break;case"DirectionalLight":o=new Fi(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Gl(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new AA(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new q0(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new TA(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new ok().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),h=l(e.material),o=new hA(u,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),h=l(e.material),o=new Ae(u,h);break;case"InstancedMesh":u=a(e.geometry),h=l(e.material);const f=e.count,p=e.instanceMatrix,v=e.instanceColor;o=new fw(u,h,f),o.instanceMatrix=new nu(new Float32Array(p.array),16),v!==void 0&&(o.instanceColor=new nu(new Float32Array(v.array),v.itemSize));break;case"BatchedMesh":u=a(e.geometry),h=l(e.material),o=new kF(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(x=>{const y=new vn;y.min.fromArray(x.boxMin),y.max.fromArray(x.boxMax);const g=new Li;return g.radius=x.sphereRadius,g.center.fromArray(x.sphereCenter),{boxInitialized:x.boxInitialized,box:y,sphereInitialized:x.sphereInitialized,sphere:g}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=c(e.colorsTexture.uuid));break;case"LOD":o=new FF;break;case"Line":o=new Xt(a(e.geometry),l(e.material));break;case"LineLoop":o=new fA(a(e.geometry),l(e.material));break;case"LineSegments":o=new La(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new ca(a(e.geometry),l(e.material));break;case"Sprite":o=new UF(l(e.material));break;case"Group":o=new ho;break;case"Bone":o=new hw;break;default:o=new Kt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const f=e.children;for(let p=0;p<f.length;p++)o.add(this.parseObject(f[p],t,n,r,s))}if(e.animations!==void 0){const f=e.animations;for(let p=0;p<f.length;p++){const v=f[p];o.animations.push(s[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const f=e.levels;for(let p=0;p<f.length;p++){const v=f[p],x=o.getObjectByProperty("uuid",v.object);x!==void 0&&o.addLevel(x,v.distance,v.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new Kt}})}}const Gq={UVMapping:Q_,CubeReflectionMapping:Xl,CubeRefractionMapping:tu,EquirectangularReflectionMapping:Ca,EquirectangularRefractionMapping:Kg,CubeUVReflectionMapping:Hp},YR={RepeatWrapping:xn,ClampToEdgeWrapping:ds,MirroredRepeatWrapping:dp},qR={NearestFilter:wn,NearestMipmapNearestFilter:J_,NearestMipmapLinearFilter:yh,LinearFilter:gn,LinearMipmapNearestFilter:kd,LinearMipmapLinearFilter:uo};class lk extends Dr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Hl.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{r&&r(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Hl.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),Hl.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Hl.add(e,l),s.manager.itemStart(e)}}let ky;class CA{static getContext(){return ky===void 0&&(ky=new(window.AudioContext||window.webkitAudioContext)),ky}static setContext(e){ky=e}}class Vq extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Vs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);CA.getContext().decodeAudioData(c,function(h){t(h)}).catch(a)}catch(c){a(c)}},n,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const KR=new Ze,ZR=new Ze,Xu=new Ze;class Wq{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Un,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Un,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Xu.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Ph*t.fov*.5)/t.zoom;let a,l;ZR.elements[12]=-r,KR.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Xu.elements[0]=2*t.near/(l-a),Xu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Xu),a=-o*t.aspect-s,l=o*t.aspect-s,Xu.elements[0]=2*t.near/(l-a),Xu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Xu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(ZR),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(KR)}}class bw{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=QR(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=QR();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function QR(){return performance.now()}const Yu=new N,JR=new Qt,jq=new N,qu=new N;class Xq extends Kt{constructor(){super(),this.type="AudioListener",this.context=CA.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bw}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Yu,JR,jq),qu.set(0,0,-1).applyQuaternion(JR),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Yu.x,r),t.positionY.linearRampToValueAtTime(Yu.y,r),t.positionZ.linearRampToValueAtTime(Yu.z,r),t.forwardX.linearRampToValueAtTime(qu.x,r),t.forwardY.linearRampToValueAtTime(qu.y,r),t.forwardZ.linearRampToValueAtTime(qu.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(Yu.x,Yu.y,Yu.z),t.setOrientation(qu.x,qu.y,qu.z,n.x,n.y,n.z)}}class ck extends Kt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Ku=new N,$R=new Qt,Yq=new N,Zu=new N;class qq extends ck{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Ku,$R,Yq),Zu.set(0,0,1).applyQuaternion($R);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ku.x,n),t.positionY.linearRampToValueAtTime(Ku.y,n),t.positionZ.linearRampToValueAtTime(Ku.z,n),t.orientationX.linearRampToValueAtTime(Zu.x,n),t.orientationY.linearRampToValueAtTime(Zu.y,n),t.orientationZ.linearRampToValueAtTime(Zu.z,n)}else t.setPosition(Ku.x,Ku.y,Ku.z),t.setOrientation(Zu.x,Zu.y,Zu.z)}}class Kq{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class uk{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(n,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){a.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){Qt.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;Qt.multiplyQuaternionsFlat(e,o,e,t,e,n),Qt.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const PA="\\[\\]\\.:\\/",Zq=new RegExp("["+PA+"]","g"),RA="[^"+PA+"]",Qq="[^"+PA.replace("\\.","")+"]",Jq=/((?:WC+[\/:])*)/.source.replace("WC",RA),$q=/(WCOD+)?/.source.replace("WCOD",Qq),eK=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",RA),tK=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",RA),nK=new RegExp("^"+Jq+$q+eK+tK+"$"),iK=["material","materials","bones","map"];class rK{constructor(e,t,n){const r=n||cn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class cn{constructor(e,t,n){this.path=t,this.parsedPath=n||cn.parseTrackName(t),this.node=cn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new cn.Composite(e,t,n):new cn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Zq,"")}static parseTrackName(e){const t=nK.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);iK.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=n(a.children);if(l)return l}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=cn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}cn.Composite=rK;cn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};cn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};cn.prototype.GetterByBindingType=[cn.prototype._getValue_direct,cn.prototype._getValue_array,cn.prototype._getValue_arrayElement,cn.prototype._getValue_toArray];cn.prototype.SetterByBindingTypeAndVersioning=[[cn.prototype._setValue_direct,cn.prototype._setValue_direct_setNeedsUpdate,cn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[cn.prototype._setValue_array,cn.prototype._setValue_array_setNeedsUpdate,cn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[cn.prototype._setValue_arrayElement,cn.prototype._setValue_arrayElement_setNeedsUpdate,cn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[cn.prototype._setValue_fromArray,cn.prototype._setValue_fromArray_setNeedsUpdate,cn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class sK{constructor(){this.isAnimationObjectGroup=!0,this.uuid=vo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const f=arguments[u],p=f.uuid;let v=t[p];if(v===void 0){v=l++,t[p]=v,e.push(f);for(let x=0,y=o;x!==y;++x)s[x].push(new cn(f,n[x],r[x]))}else if(v<c){a=e[v];const x=--c,y=e[x];t[y.uuid]=v,e[v]=y,t[p]=x,e[x]=f;for(let g=0,_=o;g!==_;++g){const w=s[g],S=w[x];let C=w[v];w[v]=S,C===void 0&&(C=new cn(f,n[g],r[g])),w[x]=C}}else e[v]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const h=s++,f=e[h];t[f.uuid]=u,e[u]=f,t[c]=h,e[h]=l;for(let p=0,v=r;p!==v;++p){const x=n[p],y=x[h],g=x[u];x[u]=y,x[h]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,h=t[u];if(h!==void 0)if(delete t[u],h<s){const f=--s,p=e[f],v=--o,x=e[v];t[p.uuid]=h,e[h]=p,t[x.uuid]=f,e[f]=x,e.pop();for(let y=0,g=r;y!==g;++y){const _=n[y],w=_[f],S=_[v];_[h]=w,_[f]=S,_.pop()}}else{const f=--o,p=e[f];f>0&&(t[p.uuid]=h),e[h]=p,e.pop();for(let v=0,x=r;v!==x;++v){const y=n[v];y[h]=y[f],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=new Array(c);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(h);for(let f=u,p=l.length;f!==p;++f){const v=l[f];h[f]=new cn(v,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class hk{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:xh,endingEnd:xh};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=lF,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case $E:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case rw:default:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===cF;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(n===aF){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=_h,r.endingEnd=_h):(e?r.endingStart=this.zeroSlopeAtStart?_h:xh:r.endingStart=Zg,t?r.endingEnd=this.zeroSlopeAtEnd?_h:xh:r.endingEnd=Zg)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}const oK=new Float32Array(1);class LA extends hl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let h=0;h!==s;++h){const f=r[h],p=f.name;let v=u[p];if(v!==void 0)++v.referenceCount,o[h]=v;else{if(v=o[h],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,p));continue}const x=t&&t._propertyBindings[h].binding.parsedPath;v=new uk(cn.create(n,p,x),f.ValueTypeName,f.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,p),o[h]=v}a[h].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,f=(e._localRoot||this._root).uuid;delete h[f],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new MA(new Float32Array(2),new Float32Array(2),1,oK),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?xp.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=rw),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===n)return h;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new hk(this,o,t,n);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?xp.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,t[u]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class We{constructor(e){this.value=e}clone(){return new We(this.value.clone===void 0?this.value:this.value.clone())}}let aK=0;class lK extends hl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:aK++}),this.name="",this.usage=e0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class h_ extends V0{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class cK{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const eL=new Ze;class Yp{constructor(e,t,n=0,r=1/0){this.ray=new la(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Rh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return eL.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(eL),this}intersectObject(e,t=!0,n=[]){return kT(e,this,n,t),n.sort(tL),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)kT(e[r],this,n,t);return n.sort(tL),n}}function tL(i,e){return i.distance-e.distance}function kT(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let o=0,a=s.length;o<a;o++)kT(s[o],e,t,!0)}}class Kh{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(mi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class uK{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class DA{constructor(e,t,n,r){DA.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const nL=new be;class hK{constructor(e=new be(1/0,1/0),t=new be(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=nL.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,nL).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const iL=new N,Ny=new N;class Us{constructor(e=new N,t=new N){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){iL.subVectors(e,this.start),Ny.subVectors(this.end,this.start);const n=Ny.dot(Ny);let s=Ny.dot(iL)/n;return t&&(s=mi(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const rL=new N;class fk extends Kt{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new yt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new lt(r,3));const s=new vr({fog:!1,toneMapped:!1});this.cone=new La(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),rL.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(rL),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Sc=new N,Oy=new Ze,RM=new Ze;class fK extends La{constructor(e){const t=dk(e),n=new yt,r=[],s=[],o=new Ge(0,0,1),a=new Ge(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new lt(r,3)),n.setAttribute("color",new lt(s,3));const l=new vr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");RM.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Oy.multiplyMatrices(RM,a.matrixWorld),Sc.setFromMatrixPosition(Oy),r.setXYZ(o,Sc.x,Sc.y,Sc.z),Oy.multiplyMatrices(RM,a.parent.matrixWorld),Sc.setFromMatrixPosition(Oy),r.setXYZ(o+1,Sc.x,Sc.y,Sc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function dk(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,dk(i.children[t]));return e}class pk extends Ae{constructor(e,t,n){const r=new Lr(t,4,2),s=new Yt({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const dK=new N,sL=new Ge,oL=new Ge;class mk extends Kt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Go(t);r.rotateY(Math.PI*.5),this.material=new Yt({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new wt(o,3)),this.add(new Ae(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");sL.copy(this.light.color),oL.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?sL:oL;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(dK.setFromMatrixPosition(this.light.matrixWorld).negate())}}class pK extends La{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ge(n),r=new Ge(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let f=0,p=0,v=-a;f<=t;f++,v+=o){l.push(-a,0,v,a,0,v),l.push(v,0,-a,v,0,a);const x=f===s?n:r;x.toArray(c,p),p+=3,x.toArray(c,p),p+=3,x.toArray(c,p),p+=3,x.toArray(c,p),p+=3}const u=new yt;u.setAttribute("position",new lt(l,3)),u.setAttribute("color",new lt(c,3));const h=new vr({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class mK extends La{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Ge(s),o=new Ge(o);const a=[],l=[];if(t>1)for(let h=0;h<t;h++){const f=h/t*(Math.PI*2),p=Math.sin(f)*e,v=Math.cos(f)*e;a.push(0,0,0),a.push(p,0,v);const x=h&1?s:o;l.push(x.r,x.g,x.b),l.push(x.r,x.g,x.b)}for(let h=0;h<n;h++){const f=h&1?s:o,p=e-e/n*h;for(let v=0;v<r;v++){let x=v/r*(Math.PI*2),y=Math.sin(x)*p,g=Math.cos(x)*p;a.push(y,0,g),l.push(f.r,f.g,f.b),x=(v+1)/r*(Math.PI*2),y=Math.sin(x)*p,g=Math.cos(x)*p,a.push(y,0,g),l.push(f.r,f.g,f.b)}}const c=new yt;c.setAttribute("position",new lt(a,3)),c.setAttribute("color",new lt(l,3));const u=new vr({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const aL=new N,zy=new N,lL=new N;class gk extends Kt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new yt;r.setAttribute("position",new lt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new vr({fog:!1,toneMapped:!1});this.lightPlane=new Xt(r,s),this.add(this.lightPlane),r=new yt,r.setAttribute("position",new lt([0,0,0,0,0,1],3)),this.targetLine=new Xt(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),aL.setFromMatrixPosition(this.light.matrixWorld),zy.setFromMatrixPosition(this.light.target.matrixWorld),lL.subVectors(zy,aL),this.lightPlane.lookAt(zy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(zy),this.targetLine.scale.z=lL.length()}}const By=new N,fi=new Gp;class gK extends La{constructor(e){const t=new yt,n=new vr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(v,x){l(v),l(x)}function l(v){r.push(0,0,0),s.push(0,0,0),o[v]===void 0&&(o[v]=[]),o[v].push(r.length/3-1)}t.setAttribute("position",new lt(r,3)),t.setAttribute("color",new lt(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Ge(16755200),u=new Ge(16711680),h=new Ge(43775),f=new Ge(16777215),p=new Ge(3355443);this.setColors(c,u,h,f,p)}setColors(e,t,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;fi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ti("c",t,e,fi,0,0,-1),Ti("t",t,e,fi,0,0,1),Ti("n1",t,e,fi,-n,-r,-1),Ti("n2",t,e,fi,n,-r,-1),Ti("n3",t,e,fi,-n,r,-1),Ti("n4",t,e,fi,n,r,-1),Ti("f1",t,e,fi,-n,-r,1),Ti("f2",t,e,fi,n,-r,1),Ti("f3",t,e,fi,-n,r,1),Ti("f4",t,e,fi,n,r,1),Ti("u1",t,e,fi,n*.7,r*1.1,-1),Ti("u2",t,e,fi,-n*.7,r*1.1,-1),Ti("u3",t,e,fi,0,r*2,-1),Ti("cf1",t,e,fi,-n,0,1),Ti("cf2",t,e,fi,n,0,1),Ti("cf3",t,e,fi,0,-r,1),Ti("cf4",t,e,fi,0,r,1),Ti("cn1",t,e,fi,-n,0,-1),Ti("cn2",t,e,fi,n,0,-1),Ti("cn3",t,e,fi,0,-r,-1),Ti("cn4",t,e,fi,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ti(i,e,t,n,r,s,o){By.set(r,s,o).unproject(n);const a=e[i];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],By.x,By.y,By.z)}}const Hy=new vn;class vK extends La{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new yt;s.setIndex(new wt(n,1)),s.setAttribute("position",new wt(r,3)),super(s,new vr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Hy.setFromObject(this.object),Hy.isEmpty())return;const t=Hy.min,n=Hy.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yK extends La{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new yt;s.setIndex(new wt(n,1)),s.setAttribute("position",new lt(r,3)),super(s,new vr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class xK extends Xt{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new yt;o.setAttribute("position",new lt(s,3)),o.computeBoundingSphere(),super(o,new vr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new yt;l.setAttribute("position",new lt(a,3)),l.computeBoundingSphere(),this.add(new Ae(l,new Yt({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const cL=new N;let Gy,LM;class _K extends Kt{constructor(e=new N(0,0,1),t=new N(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",Gy===void 0&&(Gy=new yt,Gy.setAttribute("position",new lt([0,0,0,0,1,0],3)),LM=new Tr(0,.5,1,5,1),LM.translate(0,-.5,0)),this.position.copy(t),this.line=new Xt(Gy,new vr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ae(LM,new Yt({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{cL.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(cL,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class vk extends La{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new yt;r.setAttribute("position",new lt(t,3)),r.setAttribute("color",new lt(n,3));const s=new vr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new Ge,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yk{constructor(){this.type="ShapePath",this.color=new Ge,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new i0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(g){const _=[];for(let w=0,S=g.length;w<S;w++){const C=g[w],E=new Lh;E.curves=C.curves,_.push(E)}return _}function n(g,_){const w=_.length;let S=!1;for(let C=w-1,E=0;E<w;C=E++){let A=_[C],T=_[E],L=T.x-A.x,M=T.y-A.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(A=_[E],L=-L,T=_[C],M=-M),g.y<A.y||g.y>T.y)continue;if(g.y===A.y){if(g.x===A.x)return!0}else{const R=M*(g.x-A.x)-L*(g.y-A.y);if(R===0)return!0;if(R<0)continue;S=!S}}else{if(g.y!==A.y)continue;if(T.x<=g.x&&g.x<=A.x||A.x<=g.x&&g.x<=T.x)return!0}}return S}const r=tl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Lh,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],f=[];let p=[],v=0,x;f[v]=void 0,p[v]=[];for(let g=0,_=s.length;g<_;g++)a=s[g],x=a.getPoints(),o=r(x),o=e?!o:o,o?(!u&&f[v]&&v++,f[v]={s:new Lh,p:x},f[v].s.curves=a.curves,u&&v++,p[v]=[]):p[v].push({h:a,p:x[0]});if(!f[0])return t(s);if(f.length>1){let g=!1,_=0;for(let w=0,S=f.length;w<S;w++)h[w]=[];for(let w=0,S=f.length;w<S;w++){const C=p[w];for(let E=0;E<C.length;E++){const A=C[E];let T=!0;for(let L=0;L<f.length;L++)n(A.p,f[L].p)&&(w!==L&&_++,T?(T=!1,h[L].push(A)):g=!0);T&&h[w].push(A)}}_>0&&g===!1&&(p=h)}let y;for(let g=0,_=f.length;g<_;g++){l=f[g].s,c.push(l),y=p[g];for(let w=0,S=y.length;w<S;w++)l.holes.push(y[w].h)}return c}}class xk extends hl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class wK extends vi{constructor(e=1,t=1,n=1,r={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...r,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:rf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=rf);const SK=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:ta,AddEquation:Dc,AddOperation:nF,AdditiveAnimationBlendMode:$E,AdditiveBlending:ea,AgXToneMapping:rF,AlphaFormat:YE,AlwaysCompare:xF,AlwaysDepth:C1,AlwaysStencilFunc:AT,AmbientLight:nc,AnimationAction:hk,AnimationClip:xp,AnimationLoader:kq,AnimationMixer:LA,AnimationObjectGroup:sK,AnimationUtils:Dq,ArcCurve:OF,ArrayCamera:DF,ArrowHelper:_K,AttachedBindMode:ET,Audio:ck,AudioAnalyser:Kq,AudioContext:CA,AudioListener:Xq,AudioLoader:Vq,AxesHelper:vk,BackSide:Vi,BasicDepthPacking:hF,BasicShadowMap:kU,BatchedMesh:kF,Bone:hw,BooleanKeyframeTrack:af,Box2:hK,Box3:vn,Box3Helper:yK,BoxGeometry:un,BoxHelper:vK,BufferAttribute:wt,BufferGeometry:yt,BufferGeometryLoader:ak,ByteType:WE,Cache:Hl,Camera:Gp,CameraHelper:gK,CanvasTexture:NF,CapsuleGeometry:mw,CatmullRomCurve3:zF,CineonToneMapping:VE,CircleGeometry:X0,ClampToEdgeWrapping:ds,Clock:bw,Color:Ge,ColorKeyframeTrack:bA,ColorManagement:on,CompressedArrayTexture:tq,CompressedCubeTexture:nq,CompressedTexture:dw,CompressedTextureLoader:Nq,ConeGeometry:Wp,ConstantAlphaFactor:$U,ConstantColorFactor:QU,Controls:xk,CubeCamera:oA,CubeReflectionMapping:Xl,CubeRefractionMapping:tu,CubeTexture:B0,CubeTextureLoader:cf,CubeUVReflectionMapping:Hp,CubicBezierCurve:pA,CubicBezierCurve3:BF,CubicInterpolant:ek,CullFaceBack:MT,CullFaceFront:FU,CullFaceFrontBack:UV,CullFaceNone:UU,Curve:Da,CurvePath:GF,CustomBlending:NU,CustomToneMapping:iF,CylinderGeometry:Tr,Cylindrical:uK,Data3DTexture:iA,DataArrayTexture:ow,DataTexture:Jo,DataTextureLoader:rk,DataUtils:fg,DecrementStencilOp:jV,DecrementWrapStencilOp:YV,DefaultLoadingManager:ik,DepthFormat:Vc,DepthStencilFormat:Wh,DepthTexture:aw,DetachedBindMode:oF,DirectionalLight:Fi,DirectionalLightHelper:gk,DiscreteInterpolant:tk,DisplayP3ColorSpace:sw,DodecahedronGeometry:gw,DoubleSide:_n,DstAlphaFactor:XU,DstColorFactor:qU,DynamicCopyUsage:lW,DynamicDrawUsage:nW,DynamicReadUsage:sW,EdgesGeometry:VF,EllipseCurve:pw,EqualCompare:mF,EqualDepth:R1,EqualStencilFunc:QV,EquirectangularReflectionMapping:Ca,EquirectangularRefractionMapping:Kg,Euler:ms,EventDispatcher:hl,ExtrudeGeometry:Y0,FileLoader:Vs,Float16BufferAttribute:ZW,Float32BufferAttribute:lt,FloatType:Hi,Fog:uw,FogExp2:G0,FramebufferTexture:eq,FrontSide:wo,Frustum:H0,GLBufferAttribute:cK,GLSL1:uW,GLSL3:CT,GreaterCompare:gF,GreaterDepth:D1,GreaterEqualCompare:yF,GreaterEqualDepth:L1,GreaterEqualStencilFunc:tW,GreaterStencilFunc:$V,GridHelper:pK,Group:ho,HalfFloatType:Zi,HemisphereLight:TA,HemisphereLightHelper:mk,IcosahedronGeometry:iu,ImageBitmapLoader:lk,ImageLoader:a0,ImageUtils:SF,IncrementStencilOp:WV,IncrementWrapStencilOp:XV,InstancedBufferAttribute:nu,InstancedBufferGeometry:Mw,InstancedInterleavedBuffer:h_,InstancedMesh:fw,Int16BufferAttribute:qW,Int32BufferAttribute:KW,Int8BufferAttribute:jW,IntType:$_,InterleavedBuffer:V0,InterleavedBufferAttribute:Ls,Interpolant:jp,InterpolateDiscrete:pp,InterpolateLinear:mp,InterpolateSmooth:Xx,InvertStencilOp:qV,KeepStencilOp:oh,KeyframeTrack:Ia,LOD:FF,LatheGeometry:j0,Layers:Rh,LessCompare:pF,LessDepth:P1,LessEqualCompare:tA,LessEqualDepth:Hh,LessEqualStencilFunc:JV,LessStencilFunc:ZV,Light:gu,LightProbe:ok,Line:Xt,Line3:Us,LineBasicMaterial:vr,LineCurve:mA,LineCurve3:HF,LineDashedMaterial:QF,LineLoop:fA,LineSegments:La,LinearDisplayP3ColorSpace:z0,LinearFilter:gn,LinearInterpolant:MA,LinearMipMapLinearFilter:OV,LinearMipMapNearestFilter:NV,LinearMipmapLinearFilter:uo,LinearMipmapNearestFilter:kd,LinearSRGBColorSpace:Wi,LinearToneMapping:GE,LinearTransfer:Qg,Loader:Dr,LoaderUtils:Wc,LoadingManager:Xp,LoopOnce:aF,LoopPingPong:cF,LoopRepeat:lF,LuminanceAlphaFormat:ZE,LuminanceFormat:KE,MOUSE:ao,Material:Di,MaterialLoader:Sw,MathUtils:Ai,Matrix2:DA,Matrix3:Nt,Matrix4:Ze,MaxEquation:HU,Mesh:Ae,MeshBasicMaterial:Yt,MeshDepthMaterial:pu,MeshDistanceMaterial:cw,MeshLambertMaterial:ZF,MeshMatcapMaterial:wA,MeshNormalMaterial:u_,MeshPhongMaterial:KF,MeshPhysicalMaterial:gs,MeshStandardMaterial:hn,MeshToonMaterial:_A,MinEquation:BU,MirroredRepeatWrapping:dp,MixOperation:tF,MultiplyBlending:TT,MultiplyOperation:k0,NearestFilter:wn,NearestMipMapLinearFilter:kV,NearestMipMapNearestFilter:FV,NearestMipmapLinearFilter:yh,NearestMipmapNearestFilter:J_,NeutralToneMapping:sF,NeverCompare:dF,NeverDepth:A1,NeverStencilFunc:KV,NoBlending:ba,NoColorSpace:zl,NoToneMapping:Ta,NormalAnimationBlendMode:rw,NormalBlending:Ch,NotEqualCompare:vF,NotEqualDepth:I1,NotEqualStencilFunc:eW,NumberKeyframeTrack:Xh,Object3D:Kt,ObjectLoader:Hq,ObjectSpaceNormalMap:fF,OctahedronGeometry:Go,OneFactor:VU,OneMinusConstantAlphaFactor:eF,OneMinusConstantColorFactor:JU,OneMinusDstAlphaFactor:YU,OneMinusDstColorFactor:KU,OneMinusSrcAlphaFactor:E1,OneMinusSrcColorFactor:jU,OrthographicCamera:yo,P3Primaries:$g,PCFShadowMap:zp,PCFSoftShadowMap:Ji,PMREMGenerator:PT,Path:i0,PerspectiveCamera:Un,Plane:Vr,PlaneGeometry:Ot,PlaneHelper:xK,PointLight:Gl,PointLightHelper:pk,Points:ca,PointsMaterial:of,PolarGridHelper:mK,PolyhedronGeometry:mu,PositionalAudio:qq,PropertyBinding:cn,PropertyMixer:uk,QuadraticBezierCurve:gA,QuadraticBezierCurve3:vA,Quaternion:Qt,QuaternionKeyframeTrack:Yh,QuaternionLinearInterpolant:nk,RED_GREEN_RGTC2_Format:r_,RED_RGTC1_Format:JE,REVISION:rf,RGBADepthPacking:sf,RGBAFormat:fr,RGBAIntegerFormat:iw,RGBA_ASTC_10x10_Format:J1,RGBA_ASTC_10x5_Format:K1,RGBA_ASTC_10x6_Format:Z1,RGBA_ASTC_10x8_Format:Q1,RGBA_ASTC_12x10_Format:$1,RGBA_ASTC_12x12_Format:e_,RGBA_ASTC_4x4_Format:H1,RGBA_ASTC_5x4_Format:G1,RGBA_ASTC_5x5_Format:V1,RGBA_ASTC_6x5_Format:W1,RGBA_ASTC_6x6_Format:j1,RGBA_ASTC_8x5_Format:X1,RGBA_ASTC_8x6_Format:Y1,RGBA_ASTC_8x8_Format:q1,RGBA_BPTC_Format:Cg,RGBA_ETC2_EAC_Format:B1,RGBA_PVRTC_2BPPV1_Format:N1,RGBA_PVRTC_4BPPV1_Format:k1,RGBA_S3TC_DXT1_Format:Tg,RGBA_S3TC_DXT3_Format:Eg,RGBA_S3TC_DXT5_Format:Ag,RGBDepthPacking:BV,RGBFormat:qE,RGBIntegerFormat:zV,RGB_BPTC_SIGNED_Format:t_,RGB_BPTC_UNSIGNED_Format:n_,RGB_ETC1_Format:O1,RGB_ETC2_Format:z1,RGB_PVRTC_2BPPV1_Format:F1,RGB_PVRTC_4BPPV1_Format:U1,RGB_S3TC_DXT1_Format:bg,RGDepthPacking:HV,RGFormat:QE,RGIntegerFormat:nw,RawShaderMaterial:qF,Ray:la,Raycaster:Yp,Rec709Primaries:Jg,RectAreaLight:AA,RedFormat:N0,RedIntegerFormat:O0,ReinhardToneMapping:Bp,RenderTarget:MF,RepeatWrapping:xn,ReplaceStencilOp:VV,ReverseSubtractEquation:zU,RingGeometry:yw,SIGNED_RED_GREEN_RGTC2_Format:s_,SIGNED_RED_RGTC1_Format:i_,SRGBColorSpace:Wt,SRGBTransfer:Nn,Scene:yp,ShaderChunk:Gt,ShaderLib:wa,ShaderMaterial:Ft,ShadowMaterial:YF,Shape:Lh,ShapeGeometry:xw,ShapePath:yk,ShapeUtils:tl,ShortType:jE,Skeleton:W0,SkeletonHelper:fK,SkinnedMesh:hA,Source:wh,Sphere:Li,SphereGeometry:Lr,Spherical:Kh,SphericalHarmonics3:sk,SplineCurve:yA,SpotLight:q0,SpotLightHelper:fk,Sprite:UF,SpriteMaterial:uA,SrcAlphaFactor:T1,SrcAlphaSaturateFactor:ZU,SrcColorFactor:WU,StaticCopyUsage:aW,StaticDrawUsage:e0,StaticReadUsage:rW,StereoCamera:Wq,StreamCopyUsage:cW,StreamDrawUsage:iW,StreamReadUsage:oW,StringKeyframeTrack:lf,SubtractEquation:OU,SubtractiveBlending:bT,TOUCH:lo,TangentSpaceNormalMap:du,TetrahedronGeometry:_w,Texture:Cn,TextureLoader:_i,TextureUtils:IY,TorusGeometry:fo,TorusKnotGeometry:fl,Triangle:An,TriangleFanDrawMode:o_,TriangleStripDrawMode:eA,TrianglesDrawMode:uF,TubeGeometry:ww,UVMapping:Q_,Uint16BufferAttribute:rA,Uint32BufferAttribute:sA,Uint8BufferAttribute:XW,Uint8ClampedBufferAttribute:YW,Uniform:We,UniformsGroup:lK,UniformsLib:it,UniformsUtils:Is,UnsignedByteType:Pa,UnsignedInt248Type:Vh,UnsignedInt5999Type:XE,UnsignedIntType:Yl,UnsignedShort4444Type:ew,UnsignedShort5551Type:tw,UnsignedShortType:Gh,VSMShadowMap:ya,Vector2:be,Vector3:N,Vector4:Pt,VectorKeyframeTrack:qh,VideoTexture:$Y,WebGL3DRenderTarget:FW,WebGLArrayRenderTarget:UW,WebGLCoordinateSystem:Ja,WebGLCubeRenderTarget:aA,WebGLMultipleRenderTargets:wK,WebGLRenderTarget:vi,WebGLRenderer:cA,WebGLUtils:LF,WebGPUCoordinateSystem:t0,WireframeGeometry:xA,WrapAroundEnding:Zg,ZeroCurvatureEnding:xh,ZeroFactor:GU,ZeroSlopeEnding:_h,ZeroStencilOp:GV,createCanvasElement:wF},Symbol.toStringTag,{value:"Module"})),uL={type:"change"},IA={type:"start"},_k={type:"end"},Vy=new la,hL=new Vr,MK=Math.cos(70*Ai.DEG2RAD),qi=new N,Ts=2*Math.PI,Tn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},DM=1e-6;let UA=class extends xk{constructor(e,t=null){super(e,t),this.state=Tn.NONE,this.enabled=!0,this.target=new N,this.cursor=new N,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ao.ROTATE,MIDDLE:ao.DOLLY,RIGHT:ao.PAN},this.touches={ONE:lo.ROTATE,TWO:lo.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new N,this._lastQuaternion=new Qt,this._lastTargetPosition=new N,this._quat=new Qt().setFromUnitVectors(e.up,new N(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Kh,this._sphericalDelta=new Kh,this._scale=1,this._panOffset=new N,this._rotateStart=new be,this._rotateEnd=new be,this._rotateDelta=new be,this._panStart=new be,this._panEnd=new be,this._panDelta=new be,this._dollyStart=new be,this._dollyEnd=new be,this._dollyDelta=new be,this._dollyDirection=new N,this._mouse=new be,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=TK.bind(this),this._onPointerDown=bK.bind(this),this._onPointerUp=EK.bind(this),this._onContextMenu=IK.bind(this),this._onMouseWheel=PK.bind(this),this._onKeyDown=RK.bind(this),this._onTouchStart=LK.bind(this),this._onTouchMove=DK.bind(this),this._onMouseDown=AK.bind(this),this._onMouseMove=CK.bind(this),this._interceptControlDown=UK.bind(this),this._interceptControlUp=FK.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(uL),this.update(),this.state=Tn.NONE}update(e=null){const t=this.object.position;qi.copy(t).sub(this.target),qi.applyQuaternion(this._quat),this._spherical.setFromVector3(qi),this.autoRotate&&this.state===Tn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=Ts:n>Math.PI&&(n-=Ts),r<-Math.PI?r+=Ts:r>Math.PI&&(r-=Ts),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(qi.setFromSpherical(this._spherical),qi.applyQuaternion(this._quatInverse),t.copy(this.target).add(qi),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=qi.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new N(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const c=new N(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),o=qi.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(Vy.origin.copy(this.object.position),Vy.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Vy.direction))<MK?this.object.lookAt(this.target):(hL.setFromNormalAndCoplanarPoint(this.object.up,this.target),Vy.intersectPlane(hL,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>DM||8*(1-this._lastQuaternion.dot(this.object.quaternion))>DM||this._lastTargetPosition.distanceToSquared(this.target)>DM?(this.dispatchEvent(uL),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Ts/60*this.autoRotateSpeed*e:Ts/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){qi.setFromMatrixColumn(t,0),qi.multiplyScalar(-e),this._panOffset.add(qi)}_panUp(e,t){this.screenSpacePanning===!0?qi.setFromMatrixColumn(t,1):(qi.setFromMatrixColumn(t,0),qi.crossVectors(this.object.up,qi)),qi.multiplyScalar(e),this._panOffset.add(qi)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;qi.copy(r).sub(this.target);let s=qi.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,o=n.width,a=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ts*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ts*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(Ts*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-Ts*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(Ts*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-Ts*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ts*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ts*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new be,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}};function bK(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function TK(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function EK(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(_k),this.state=Tn.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function AK(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case ao.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=Tn.DOLLY;break;case ao.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=Tn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=Tn.ROTATE}break;case ao.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=Tn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=Tn.PAN}break;default:this.state=Tn.NONE}this.state!==Tn.NONE&&this.dispatchEvent(IA)}function CK(i){switch(this.state){case Tn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case Tn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case Tn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function PK(i){this.enabled===!1||this.enableZoom===!1||this.state!==Tn.NONE||(i.preventDefault(),this.dispatchEvent(IA),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(_k))}function RK(i){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(i)}function LK(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case lo.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=Tn.TOUCH_ROTATE;break;case lo.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=Tn.TOUCH_PAN;break;default:this.state=Tn.NONE}break;case 2:switch(this.touches.TWO){case lo.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=Tn.TOUCH_DOLLY_PAN;break;case lo.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=Tn.TOUCH_DOLLY_ROTATE;break;default:this.state=Tn.NONE}break;default:this.state=Tn.NONE}this.state!==Tn.NONE&&this.dispatchEvent(IA)}function DK(i){switch(this._trackPointer(i),this.state){case Tn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case Tn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case Tn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case Tn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=Tn.NONE}}function IK(i){this.enabled!==!1&&i.preventDefault()}function UK(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function FK(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.19.2
 * @author George Michael Brower
 * @license MIT
 */class nl{constructor(e,t,n,r,s="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(s),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),nl.nextNameID=nl.nextNameID||0,this.$name.id=`lil-gui-name-${++nl.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",o=>o.stopPropagation()),this.domElement.addEventListener("keyup",o=>o.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.textContent=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled?this:(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e),this)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.getValue()!==e&&(this.object[this.property]=e,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class kK extends nl{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function NT(i){let e,t;return(e=i.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=i.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=i.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t?"#"+t:!1}const NK={isPrimitive:!0,match:i=>typeof i=="string",fromHexString:NT,toHexString:NT},l0={isPrimitive:!0,match:i=>typeof i=="number",fromHexString:i=>parseInt(i.substring(1),16),toHexString:i=>"#"+i.toString(16).padStart(6,0)},OK={isPrimitive:!1,match:i=>Array.isArray(i),fromHexString(i,e,t=1){const n=l0.fromHexString(i);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(n&255)/255*t},toHexString([i,e,t],n=1){n=255/n;const r=i*n<<16^e*n<<8^t*n<<0;return l0.toHexString(r)}},zK={isPrimitive:!1,match:i=>Object(i)===i,fromHexString(i,e,t=1){const n=l0.fromHexString(i);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(n&255)/255*t},toHexString({r:i,g:e,b:t},n=1){n=255/n;const r=i*n<<16^e*n<<8^t*n<<0;return l0.toHexString(r)}},BK=[NK,l0,OK,zK];function HK(i){return BK.find(e=>e.match(i))}class GK extends nl{constructor(e,t,n,r){super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=HK(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=NT(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class IM extends nl{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class VK extends nl{constructor(e,t,n,r,s,o){super(e,t,n,"number"),this._initInput(),this.min(r),this.max(s);const a=o!==void 0;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=t*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=()=>{let _=parseFloat(this.$input.value);isNaN(_)||(this._stepExplicit&&(_=this._snap(_)),this.setValue(this._clamp(_)))},n=_=>{const w=parseFloat(this.$input.value);isNaN(w)||(this._snapClampSetValue(w+_),this.$input.value=this.getValue())},r=_=>{_.key==="Enter"&&this.$input.blur(),_.code==="ArrowUp"&&(_.preventDefault(),n(this._step*this._arrowKeyMultiplier(_))),_.code==="ArrowDown"&&(_.preventDefault(),n(this._step*this._arrowKeyMultiplier(_)*-1))},s=_=>{this._inputFocused&&(_.preventDefault(),n(this._step*this._normalizeMouseWheel(_)))};let o=!1,a,l,c,u,h;const f=5,p=_=>{a=_.clientX,l=c=_.clientY,o=!0,u=this.getValue(),h=0,window.addEventListener("mousemove",v),window.addEventListener("mouseup",x)},v=_=>{if(o){const w=_.clientX-a,S=_.clientY-l;Math.abs(S)>f?(_.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(w)>f&&x()}if(!o){const w=_.clientY-c;h-=w*this._step*this._arrowKeyMultiplier(_),u+h>this._max?h=this._max-u:u+h<this._min&&(h=this._min-u),this._snapClampSetValue(u+h)}c=_.clientY},x=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",x)},y=()=>{this._inputFocused=!0},g=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",r),this.$input.addEventListener("wheel",s,{passive:!1}),this.$input.addEventListener("mousedown",p),this.$input.addEventListener("focus",y),this.$input.addEventListener("blur",g)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=(g,_,w,S,C)=>(g-_)/(w-_)*(C-S)+S,t=g=>{const _=this.$slider.getBoundingClientRect();let w=e(g,_.left,_.right,this._min,this._max);this._snapClampSetValue(w)},n=g=>{this._setDraggingStyle(!0),t(g.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)},r=g=>{t(g.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let o=!1,a,l;const c=g=>{g.preventDefault(),this._setDraggingStyle(!0),t(g.touches[0].clientX),o=!1},u=g=>{g.touches.length>1||(this._hasScrollBar?(a=g.touches[0].clientX,l=g.touches[0].clientY,o=!0):c(g),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",f))},h=g=>{if(o){const _=g.touches[0].clientX-a,w=g.touches[0].clientY-l;Math.abs(_)>Math.abs(w)?c(g):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",f))}else g.preventDefault(),t(g.touches[0].clientX)},f=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",f)},p=this._callOnFinishChange.bind(this),v=400;let x;const y=g=>{if(Math.abs(g.deltaX)<Math.abs(g.deltaY)&&this._hasScrollBar)return;g.preventDefault();const w=this._normalizeMouseWheel(g)*this._step;this._snapClampSetValue(this.getValue()+w),this.$input.value=this.getValue(),clearTimeout(x),x=setTimeout(p,v)};this.$slider.addEventListener("mousedown",n),this.$slider.addEventListener("touchstart",u,{passive:!1}),this.$slider.addEventListener("wheel",y,{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class WK extends nl{constructor(e,t,n,r){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(r)}options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(t=>{const n=document.createElement("option");n.textContent=t,this.$select.appendChild(n)}),this.updateDisplay(),this}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.textContent=t===-1?e:this._names[t],this}}class jK extends nl{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const XK=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: none;
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
  }
  .lil-gui button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function YK(i){const e=document.createElement("style");e.innerHTML=i;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}let fL=!1;class FA{constructor({parent:e,autoPlace:t=e===void 0,container:n,width:r,title:s="Controls",closeFolders:o=!1,injectStyles:a=!0,touchStyles:l=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",c=>{(c.code==="Enter"||c.code==="Space")&&(c.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),l&&this.domElement.classList.add("allow-touch-styles"),!fL&&a&&(YK(XK),fL=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=o}add(e,t,n,r,s){if(Object(n)===n)return new WK(this,e,t,n);const o=e[t];switch(typeof o){case"number":return new VK(this,e,t,n,r,s);case"boolean":return new kK(this,e,t);case"string":return new jK(this,e,t);case"function":return new IM(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,o)}addColor(e,t,n=1){return new GK(this,e,t,n)}addFolder(e){const t=new FA({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof IM||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof IM)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const n=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.textContent=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(n=>n.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}let Tw=class{get number(){throw new Error("Lesson class must implement a getter for `number` property")}get title(){throw new Error("Lesson class must implement a getter for `title` property")}get link(){throw new Error("Lesson class must implement a getter for `link` property")}open(){throw new Error("Lesson class must implement an `open` method that implements current lesson logic")}close(){throw new Error("Lesson class must implement `close` method that release resources used by the lesson implementation")}};var Kd,Zd,Qd,yi,wk,Sk,Mk,bk,Tk,Ek,Ak,Ck,Pk,Rk;class Dt extends Tw{constructor(){super(...arguments);st(this,yi);oe(this,"object3d",null);oe(this,"scene");oe(this,"camera");oe(this,"renderer");oe(this,"guiControl");oe(this,"control");oe(this,"canvas");oe(this,"hasGuiTweaks");oe(this,"hasAnimation");st(this,Kd);st(this,Zd);st(this,Qd)}update(t){throw new Error("General lesson class with animations must implement an `update` method that implements current lesson logic")}animate(t=0){this.update(t),this.renderer.render(this.scene,this.camera),Ln(this,Kd,requestAnimationFrame(this.animate.bind(this)))}open(){this.init(),document.body.appendChild(this.canvas),this.hasAnimation&&this.animate()}close(){document.body.removeChild(this.canvas),this.dispose(),gt(this,Kd)&&cancelAnimationFrame(gt(this,Kd))}init(){W(this,yi,Rk).call(this),this.initScene(),this.initCamera(),this.initRenderer(),this.initControl(),this.initGuiControl(),this.hasGuiTweaks&&this.guiControl.show(!0)}initScene(){this.scene=new yp}initCamera(){this.camera=new Un(75,this.canvas.width/this.canvas.height),this.camera.position.z=3,this.scene.add(this.camera)}initRenderer(){let t=!1;window.devicePixelRatio<=1&&(t=!0),this.renderer=new cA({canvas:this.canvas,antialias:t}),this.resizeRenderer(),Ln(this,Qd,this.resizeRenderer.bind(this)),window.addEventListener("resize",gt(this,Qd))}initControl(){this.control=new UA(this.camera,this.canvas),this.control.enableDamping=!0}initGuiControl(){this.guiControl=new FA({width:300,title:"GUI"}),this.guiControl.hide(),Ln(this,Zd,W(this,yi,Pk).bind(this)),document.addEventListener("keydown",gt(this,Zd))}resizeRenderer(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.render(this.scene,this.camera)}dispose(){W(this,yi,wk).call(this),this.scene=null,this.camera=null,this.object3d=null,this.renderer=null,this.control=null,this.guiControl=null,this.canvas=null}}Kd=new WeakMap,Zd=new WeakMap,Qd=new WeakMap,yi=new WeakSet,wk=function(){W(this,yi,Sk).call(this),W(this,yi,Tk).call(this),W(this,yi,Ek).call(this),W(this,yi,Ak).call(this),W(this,yi,Ck).call(this)},Sk=function(){this.scene.traverse(t=>{t.isMesh&&(W(this,yi,Mk).call(this,t),W(this,yi,bk).call(this,t))})},Mk=function(t){t.geometry&&t.geometry.dispose()},bk=function(t){if(t.material){for(const n in t.material){const r=t.material[n];r&&typeof r.dispose=="function"&&r.dispose()}t.material.dispose()}},Tk=function(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0])},Ek=function(){this.renderer.dispose(),window.removeEventListener("resize",gt(this,Qd))},Ak=function(){this.control.dispose()},Ck=function(){this.guiControl.destroy(),document.removeEventListener("keydown",gt(this,Zd))},Pk=function(t){t.code==="KeyH"&&this.guiControl.show(this.guiControl._hidden)},Rk=function(){this.canvas=document.createElement("canvas")};let qK=class extends Dt{get number(){return"03"}get title(){return"First Three.js Project"}get link(){return"https://threejs-journey.com/lessons/first-threejs-project"}init(){super.init();const e=new un(1,1,1),t=new Yt({color:16711680});this.object3d=new Ae(e,t),this.scene.add(this.object3d),this.renderer.render(this.scene,this.camera)}},KK=class extends Dt{get number(){return"04"}get title(){return"Transform objects"}get link(){return"https://threejs-journey.com/lessons/transform-objects"}init(){super.init();const e=new vk(6);this.scene.add(e),this.object3d=new ho,this.object3d.scale.y=2,this.object3d.scale.x=.5,this.object3d.rotation.y=Math.PI*.25,this.scene.add(this.object3d);const t=new un(1,1,1),n=new Yt({color:16711680}),r=new Ae(t,n);r.position.x=-1.5,this.object3d.add(r);const s=new un(1,1,1),o=new Yt({color:65280}),a=new Ae(s,o);a.position.x=0,this.object3d.add(a);const l=new un(1,1,1),c=new Yt({color:255}),u=new Ae(l,c);u.position.x=1.5,this.object3d.add(u),this.camera.lookAt(r.position),this.renderer.render(this.scene,this.camera)}};function Il(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Lk(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var xo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_p={duration:.5,overwrite:!1,delay:0},kA,Xr,Zn,jo=1e8,On=1/jo,OT=Math.PI*2,ZK=OT/4,QK=0,Dk=Math.sqrt,JK=Math.cos,$K=Math.sin,pr=function(e){return typeof e=="string"},gi=function(e){return typeof e=="function"},ql=function(e){return typeof e=="number"},NA=function(e){return typeof e>"u"},ol=function(e){return typeof e=="object"},Fs=function(e){return e!==!1},OA=function(){return typeof window<"u"},Wy=function(e){return gi(e)||pr(e)},Ik=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Yr=Array.isArray,zT=/(?:-?\.?\d|\.)+/gi,Uk=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_d=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,UM=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Fk=/[+-]=-?[.\d]+/,kk=/[^,'"\[\]\s]+/gi,eZ=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ni,Ya,BT,zA,So={},f_={},Nk,Ok=function(e){return(f_=Zh(e,So))&&Ws},BA=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},c0=function(e,t){return!t&&console.warn(e)},zk=function(e,t){return e&&(So[e]=t)&&f_&&(f_[e]=t)||So},u0=function(){return 0},tZ={suppressEvents:!0,isStart:!0,kill:!1},Kx={suppressEvents:!0,kill:!1},nZ={suppressEvents:!0},HA={},jc=[],HT={},Bk,oo={},FM={},dL=30,Zx=[],GA="",VA=function(e){var t=e[0],n,r;if(ol(t)||gi(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(r=Zx.length;r--&&!Zx[r].targetTest(t););n=Zx[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new uN(e[r],n)))||e.splice(r,1);return e},Dh=function(e){return e._gsap||VA(Xo(e))[0]._gsap},Hk=function(e,t,n){return(n=e[t])&&gi(n)?e[t]():NA(n)&&e.getAttribute&&e.getAttribute(t)||n},ks=function(e,t){return(e=e.split(",")).forEach(t)||e},Ci=function(e){return Math.round(e*1e5)/1e5||0},hr=function(e){return Math.round(e*1e7)/1e7||0},Od=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+r:n==="-"?e-r:n==="*"?e*r:e/r},iZ=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},d_=function(){var e=jc.length,t=jc.slice(0),n,r;for(HT={},jc.length=0,n=0;n<e;n++)r=t[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},Gk=function(e,t,n,r){jc.length&&!Xr&&d_(),e.render(t,n,Xr&&t<0&&(e._initted||e._startAt)),jc.length&&!Xr&&d_()},Vk=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(kk).length<2?t:pr(e)?e.trim():e},Wk=function(e){return e},na=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},rZ=function(e){return function(t,n){for(var r in n)r in t||r==="duration"&&e||r==="ease"||(t[r]=n[r])}},Zh=function(e,t){for(var n in t)e[n]=t[n];return e},pL=function i(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=ol(t[n])?i(e[n]||(e[n]={}),t[n]):t[n]);return e},p_=function(e,t){var n={},r;for(r in e)r in t||(n[r]=e[r]);return n},Dg=function(e){var t=e.parent||ni,n=e.keyframes?rZ(Yr(e.keyframes)):na;if(Fs(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},sZ=function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0},jk=function(e,t,n,r,s){var o=e[r],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Ew=function(e,t,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[n]===t&&(e[n]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},ru=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Ih=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},oZ=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},GT=function(e,t,n,r){return e._startAt&&(Xr?e._startAt.revert(Kx):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},aZ=function i(e){return!e||e._ts&&i(e.parent)},mL=function(e){return e._repeat?wp(e._tTime,e=e.duration()+e._rDelay)*e:0},wp=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},m_=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Aw=function(e){return e._end=hr(e._start+(e._tDur/Math.abs(e._ts||e._rts||On)||0))},Cw=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=hr(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Aw(e),n._dirty||Ih(n,e)),e},Xk=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=m_(e.rawTime(),t),(!t._dur||K0(0,t.totalDuration(),n)-t._tTime>On)&&t.render(n,!0)),Ih(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-On}},Ka=function(e,t,n,r){return t.parent&&ru(t),t._start=hr((ql(n)?n:n||e!==ni?Oo(e,n,t):e._time)+t._delay),t._end=hr(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),jk(e,t,"_first","_last",e._sort?"_start":0),VT(t)||(e._recent=t),r||Xk(e,t),e._ts<0&&Cw(e,e._tTime),e},Yk=function(e,t){return(So.ScrollTrigger||BA("scrollTrigger",t))&&So.ScrollTrigger.create(t,e)},qk=function(e,t,n,r,s){if(jA(e,t,s),!e._initted)return 1;if(!n&&e._pt&&!Xr&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Bk!==co.frame)return jc.push(e),e._lazy=[s,r],1},lZ=function i(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||i(t))},VT=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},cZ=function(e,t,n,r){var s=e.ratio,o=t<0||!t&&(!e._start&&lZ(e)&&!(!e._initted&&VT(e))||(e._ts<0||e._dp._ts<0)&&!VT(e))?0:1,a=e._rDelay,l=0,c,u,h;if(a&&e._repeat&&(l=K0(0,e._tDur,t),u=wp(l,a),e._yoyo&&u&1&&(o=1-o),u!==wp(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Xr||r||e._zTime===On||!t&&e._zTime){if(!e._initted&&qk(e,t,r,n,l))return;for(h=e._zTime,e._zTime=t||(n?On:0),n||(n=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;t<0&&GT(e,t,n,!0),e._onUpdate&&!n&&po(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&po(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&ru(e,1),!n&&!Xr&&(po(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},uZ=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},Sp=function(e,t,n,r){var s=e._repeat,o=hr(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:hr(o*(s+1)+e._rDelay*s):o,a>0&&!r&&Cw(e,e._tTime=e._tDur*a),e.parent&&Aw(e),n||Ih(e.parent,e),e},gL=function(e){return e instanceof fs?Ih(e):Sp(e,e._dur)},hZ={_start:0,endTime:u0,totalDuration:u0},Oo=function i(e,t,n){var r=e.labels,s=e._recent||hZ,o=e.duration()>=jo?s.endTime(!1):e._dur,a,l,c;return pr(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),c=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?s:n).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&n&&(l=l/100*(Yr(n)?n[0]:n).totalDuration()),a>1?i(e,t.substr(0,a-1),n)+l:o+l)):t==null?o:+t},Ig=function(e,t,n){var r=ql(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s],a,l;if(r&&(o.duration=t[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=Fs(l.vars.inherit)&&l.parent;o.immediateRender=Fs(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new zi(t[0],o,t[s+1])},vu=function(e,t){return e||e===0?t(e):t},K0=function(e,t,n){return n<e?e:n>t?t:n},jr=function(e,t){return!pr(e)||!(t=eZ.exec(e))?"":t[1]},fZ=function(e,t,n){return vu(n,function(r){return K0(e,t,r)})},WT=[].slice,Kk=function(e,t){return e&&ol(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ol(e[0]))&&!e.nodeType&&e!==Ya},dZ=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(r){var s;return pr(r)&&!t||Kk(r,1)?(s=n).push.apply(s,Xo(r)):n.push(r)})||n},Xo=function(e,t,n){return Zn&&!t&&Zn.selector?Zn.selector(e):pr(e)&&!n&&(BT||!Mp())?WT.call((t||zA).querySelectorAll(e),0):Yr(e)?dZ(e,n):Kk(e)?WT.call(e,0):e?[e]:[]},jT=function(e){return e=Xo(e)[0]||c0("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return Xo(t,n.querySelectorAll?n:n===e?c0("Invalid scope")||zA.createElement("div"):e)}},Zk=function(e){return e.sort(function(){return .5-Math.random()})},Qk=function(e){if(gi(e))return e;var t=ol(e)?e:{each:e},n=Uh(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=t.axis,u=r,h=r;return pr(r)?u=h={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(u=r[0],h=r[1]),function(f,p,v){var x=(v||t).length,y=o[x],g,_,w,S,C,E,A,T,L;if(!y){if(L=t.grid==="auto"?0:(t.grid||[1,jo])[1],!L){for(A=-jo;A<(A=v[L++].getBoundingClientRect().left)&&L<x;);L<x&&L--}for(y=o[x]=[],g=l?Math.min(L,x)*u-.5:r%L,_=L===jo?0:l?x*h/L-.5:r/L|0,A=0,T=jo,E=0;E<x;E++)w=E%L-g,S=_-(E/L|0),y[E]=C=c?Math.abs(c==="y"?S:w):Dk(w*w+S*S),C>A&&(A=C),C<T&&(T=C);r==="random"&&Zk(y),y.max=A-T,y.min=T,y.v=x=(parseFloat(t.amount)||parseFloat(t.each)*(L>x?x-1:c?c==="y"?x/L:L:Math.max(L,x/L))||0)*(r==="edges"?-1:1),y.b=x<0?s-x:s,y.u=jr(t.amount||t.each)||0,n=n&&x<0?aN(n):n}return x=(y[f]-y.min)/y.max||0,hr(y.b+(n?n(x):x)*y.v)+y.u}},XT=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=hr(Math.round(parseFloat(n)/e)*e*t);return(r-r%1)/t+(ql(n)?0:jr(n))}},Jk=function(e,t){var n=Yr(e),r,s;return!n&&ol(e)&&(r=n=e.radius||jo,e.values?(e=Xo(e.values),(s=!ql(e[0]))&&(r*=r)):e=XT(e.increment)),vu(t,n?gi(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=jo,u=0,h=e.length,f,p;h--;)s?(f=e[h].x-a,p=e[h].y-l,f=f*f+p*p):f=Math.abs(e[h]-a),f<c&&(c=f,u=h);return u=!r||c<=r?e[u]:o,s||u===o||ql(o)?u:u+jr(o)}:XT(e))},$k=function(e,t,n,r){return vu(Yr(e)?!t:n===!0?!!(n=0):!r,function(){return Yr(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*r)/r})},pZ=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduce(function(s,o){return o(s)},r)}},mZ=function(e,t){return function(n){return e(parseFloat(n))+(t||jr(n))}},gZ=function(e,t,n){return tN(e,t,0,1,n)},eN=function(e,t,n){return vu(n,function(r){return e[~~t(r)]})},vZ=function i(e,t,n){var r=t-e;return Yr(e)?eN(e,i(0,e.length),t):vu(n,function(s){return(r+(s-e)%r)%r+e})},yZ=function i(e,t,n){var r=t-e,s=r*2;return Yr(e)?eN(e,i(0,e.length-1),t):vu(n,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},h0=function(e){for(var t=0,n="",r,s,o,a;~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(a?kk:zT),n+=e.substr(t,r-t)+$k(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},tN=function(e,t,n,r,s){var o=t-e,a=r-n;return vu(s,function(l){return n+((l-e)/o*a||0)})},xZ=function i(e,t,n,r){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var o=pr(e),a={},l,c,u,h,f;if(n===!0&&(r=1)&&(n=null),o)e={p:e},t={p:t};else if(Yr(e)&&!Yr(t)){for(u=[],h=e.length,f=h-2,c=1;c<h;c++)u.push(i(e[c-1],e[c]));h--,s=function(v){v*=h;var x=Math.min(f,~~v);return u[x](v-x)},n=t}else r||(e=Zh(Yr(e)?[]:{},e));if(!u){for(l in t)WA.call(a,e,l,"get",t[l]);s=function(v){return qA(v,a)||(o?e.p:e)}}}return vu(n,s)},vL=function(e,t,n){var r=e.labels,s=jo,o,a,l;for(o in r)a=r[o]-t,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},po=function(e,t,n){var r=e.vars,s=r[t],o=Zn,a=e._ctx,l,c,u;if(s)return l=r[t+"Params"],c=r.callbackScope||e,n&&jc.length&&d_(),a&&(Zn=a),u=l?s.apply(c,l):s.call(c),Zn=o,u},pg=function(e){return ru(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Xr),e.progress()<1&&po(e,"onInterrupt"),e},wd,nN=[],iN=function(e){if(e)if(e=!e.name&&e.default||e,OA()||e.headless){var t=e.name,n=gi(e),r=t&&!n&&e.init?function(){this._props=[]}:e,s={init:u0,render:qA,add:WA,kill:FZ,modifier:UZ,rawVars:0},o={targetTest:0,get:0,getSetter:YA,aliases:{},register:0};if(Mp(),e!==r){if(oo[t])return;na(r,na(p_(e,s),o)),Zh(r.prototype,Zh(s,p_(e,o))),oo[r.prop=t]=r,e.targetTest&&(Zx.push(r),HA[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}zk(t,r),e.register&&e.register(Ws,r,Ns)}else nN.push(e)},Dn=255,mg={aqua:[0,Dn,Dn],lime:[0,Dn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Dn],navy:[0,0,128],white:[Dn,Dn,Dn],olive:[128,128,0],yellow:[Dn,Dn,0],orange:[Dn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Dn,0,0],pink:[Dn,192,203],cyan:[0,Dn,Dn],transparent:[Dn,Dn,Dn,0]},kM=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*Dn+.5|0},rN=function(e,t,n){var r=e?ql(e)?[e>>16,e>>8&Dn,e&Dn]:0:mg.black,s,o,a,l,c,u,h,f,p,v;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),mg[e])r=mg[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&Dn,r&Dn,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&Dn,e&Dn]}else if(e.substr(0,3)==="hsl"){if(r=v=e.match(zT),!t)l=+r[0]%360/360,c=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(c+1):u+c-u*c,s=u*2-o,r.length>3&&(r[3]*=1),r[0]=kM(l+1/3,s,o),r[1]=kM(l,s,o),r[2]=kM(l-1/3,s,o);else if(~e.indexOf("="))return r=e.match(Uk),n&&r.length<4&&(r[3]=1),r}else r=e.match(zT)||mg.transparent;r=r.map(Number)}return t&&!v&&(s=r[0]/Dn,o=r[1]/Dn,a=r[2]/Dn,h=Math.max(s,o,a),f=Math.min(s,o,a),u=(h+f)/2,h===f?l=c=0:(p=h-f,c=u>.5?p/(2-h-f):p/(h+f),l=h===s?(o-a)/p+(o<a?6:0):h===o?(a-s)/p+2:(s-o)/p+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(u*100+.5)),n&&r.length<4&&(r[3]=1),r},sN=function(e){var t=[],n=[],r=-1;return e.split(Xc).forEach(function(s){var o=s.match(_d)||[];t.push.apply(t,o),n.push(r+=o.length+1)}),t.c=n,t},yL=function(e,t,n){var r="",s=(e+r).match(Xc),o=t?"hsla(":"rgba(",a=0,l,c,u,h;if(!s)return e;if(s=s.map(function(f){return(f=rN(f,t,1))&&o+(t?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),n&&(u=sN(e),l=n.c,l.join(r)!==u.c.join(r)))for(c=e.replace(Xc,"1").split(_d),h=c.length-1;a<h;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:n).shift());if(!c)for(c=e.split(Xc),h=c.length-1;a<h;a++)r+=c[a]+s[a];return r+c[h]},Xc=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in mg)i+="|"+e+"\\b";return new RegExp(i+")","gi")}(),_Z=/hsl[a]?\(/,oN=function(e){var t=e.join(" "),n;if(Xc.lastIndex=0,Xc.test(t))return n=_Z.test(t),e[1]=yL(e[1],n),e[0]=yL(e[0],n,sN(e[1])),!0},f0,co=function(){var i=Date.now,e=500,t=33,n=i(),r=n,s=1e3/240,o=s,a=[],l,c,u,h,f,p,v=function x(y){var g=i()-r,_=y===!0,w,S,C,E;if((g>e||g<0)&&(n+=g-t),r+=g,C=r-n,w=C-o,(w>0||_)&&(E=++h.frame,f=C-h.time*1e3,h.time=C=C/1e3,o+=w+(w>=s?4:s-w),S=1),_||(l=c(x)),S)for(p=0;p<a.length;p++)a[p](C,f,E,y)};return h={time:0,frame:0,tick:function(){v(!0)},deltaRatio:function(y){return f/(1e3/(y||60))},wake:function(){Nk&&(!BT&&OA()&&(Ya=BT=window,zA=Ya.document||{},So.gsap=Ws,(Ya.gsapVersions||(Ya.gsapVersions=[])).push(Ws.version),Ok(f_||Ya.GreenSockGlobals||!Ya.gsap&&Ya||{}),nN.forEach(iN)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&h.sleep(),c=u||function(y){return setTimeout(y,o-h.time*1e3+1|0)},f0=1,v(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(l),f0=0,c=u0},lagSmoothing:function(y,g){e=y||1/0,t=Math.min(g||33,e)},fps:function(y){s=1e3/(y||240),o=h.time*1e3+s},add:function(y,g,_){var w=g?function(S,C,E,A){y(S,C,E,A),h.remove(w)}:y;return h.remove(y),a[_?"unshift":"push"](w),Mp(),w},remove:function(y,g){~(g=a.indexOf(y))&&a.splice(g,1)&&p>=g&&p--},_listeners:a},h}(),Mp=function(){return!f0&&co.wake()},an={},wZ=/^[\d.\-M][\d.\-,\s]/,SZ=/["']/g,MZ=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,o=n.length,a,l,c;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),t[r]=isNaN(c)?c.replace(SZ,"").trim():+c,r=l.substr(a+1).trim();return t},bZ=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<n?e.indexOf(")",n+1):n)},TZ=function(e){var t=(e+"").split("("),n=an[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[MZ(t[1])]:bZ(e).split(",").map(Vk)):an._CE&&wZ.test(e)?an._CE("",e):n},aN=function(e){return function(t){return 1-e(1-t)}},lN=function i(e,t){for(var n=e._first,r;n;)n instanceof fs?i(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?i(n.timeline,t):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=t)),n=n._next},Uh=function(e,t){return e&&(gi(e)?e:an[e]||TZ(e))||t},uf=function(e,t,n,r){n===void 0&&(n=function(l){return 1-t(1-l)}),r===void 0&&(r=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:n,easeInOut:r},o;return ks(e,function(a){an[a]=So[a]=s,an[o=a.toLowerCase()]=n;for(var l in s)an[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=an[a+"."+l]=s[l]}),s},cN=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},NM=function i(e,t,n){var r=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),o=s/OT*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*$K((u-o)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:cN(a);return s=OT/s,l.config=function(c,u){return i(e,c,u)},l},OM=function i(e,t){t===void 0&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},r=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:cN(n);return r.config=function(s){return i(e,s)},r};ks("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,e){var t=e<5?e+1:e;uf(i+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});an.Linear.easeNone=an.none=an.Linear.easeIn;uf("Elastic",NM("in"),NM("out"),NM());(function(i,e){var t=1/e,n=2*t,r=2.5*t,s=function(a){return a<t?i*a*a:a<n?i*Math.pow(a-1.5/e,2)+.75:a<r?i*(a-=2.25/e)*a+.9375:i*Math.pow(a-2.625/e,2)+.984375};uf("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);uf("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});uf("Circ",function(i){return-(Dk(1-i*i)-1)});uf("Sine",function(i){return i===1?1:-JK(i*ZK)+1});uf("Back",OM("in"),OM("out"),OM());an.SteppedEase=an.steps=So.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,r=e+(t?0:1),s=t?1:0,o=1-On;return function(a){return((r*K0(0,o,a)|0)+s)*n}}};_p.ease=an["quad.out"];ks("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return GA+=i+","+i+"Params,"});var uN=function(e,t){this.id=QK++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Hk,this.set=t?t.getSetter:YA},d0=function(){function i(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Sp(this,+t.duration,1,1),this.data=t.data,Zn&&(this._ctx=Zn,Zn.data.push(this)),f0||co.wake()}var e=i.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,Sp(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(Mp(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Cw(this,n),!s._dp||s.parent||Xk(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Ka(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===On||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),Gk(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+mL(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+mL(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?wp(this._tTime,s)+1:1},e.timeScale=function(n,r){if(!arguments.length)return this._rts===-On?0:this._rts;if(this._rts===n)return this;var s=this.parent&&this._ts?m_(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-On?0:this._rts,this.totalTime(K0(-Math.abs(this._delay),this._tDur,s),r!==!1),Aw(this),oZ(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Mp(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==On&&(this._tTime-=On)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Ka(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Fs(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?m_(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=nZ);var r=Xr;return Xr=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),Xr=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,gL(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,gL(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(Oo(this,n),Fs(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,Fs(r))},e.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-On:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-On,this},e.isActive=function(){var n=this.parent||this._dp,r=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-On)},e.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=r)):delete o[n],this):o[n]},e.then=function(n){var r=this;return new Promise(function(s){var o=gi(n)?n:Wk,a=function(){var c=r.then;r.then=null,gi(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){pg(this)},i}();na(d0.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-On,_prom:0,_ps:!1,_rts:1});var fs=function(i){Lk(e,i);function e(n,r){var s;return n===void 0&&(n={}),s=i.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=Fs(n.sortChildren),ni&&Ka(n.parent||ni,Il(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&Yk(Il(s),n.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,o){return Ig(0,arguments,this),this},t.from=function(r,s,o){return Ig(1,arguments,this),this},t.fromTo=function(r,s,o,a){return Ig(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,Dg(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new zi(r,s,Oo(this,o),1),this},t.call=function(r,s,o){return Ka(this,zi.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,l,c,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=u,o.parent=this,new zi(r,o,Oo(this,l)),this},t.staggerFrom=function(r,s,o,a,l,c,u){return o.runBackwards=1,Dg(o).immediateRender=Fs(o.immediateRender),this.staggerTo(r,s,o,a,l,c,u)},t.staggerFromTo=function(r,s,o,a,l,c,u,h){return a.startAt=o,Dg(a).immediateRender=Fs(a.immediateRender),this.staggerTo(r,s,a,l,c,u,h)},t.render=function(r,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=r<=0?0:hr(r),h=this._zTime<0!=r<0&&(this._initted||!c),f,p,v,x,y,g,_,w,S,C,E,A;if(this!==ni&&u>l&&r>=0&&(u=l),u!==this._tTime||o||h){if(a!==this._time&&c&&(u+=this._time-a,r+=this._time-a),f=u,S=this._start,w=this._ts,g=!w,h&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(E=this._yoyo,y=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(y*100+r,s,o);if(f=hr(u%y),u===l?(x=this._repeat,f=c):(x=~~(u/y),x&&x===u/y&&(f=c,x--),f>c&&(f=c)),C=wp(this._tTime,y),!a&&this._tTime&&C!==x&&this._tTime-C*y-this._dur<=0&&(C=x),E&&x&1&&(f=c-f,A=1),x!==C&&!this._lock){var T=E&&C&1,L=T===(E&&x&1);if(x<C&&(T=!T),a=T?0:u%c?c:u,this._lock=1,this.render(a||(A?0:hr(x*y)),s,!c)._lock=0,this._tTime=u,!s&&this.parent&&po(this,"onRepeat"),this.vars.repeatRefresh&&!A&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,L&&(this._lock=2,a=T?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!A&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;lN(this,A)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=uZ(this,hr(a),hr(f)),_&&(u-=f-(f=_._start))),this._tTime=u,this._time=f,this._act=!w,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&f&&!s&&!x&&(po(this,"onStart"),this._tTime!==u))return this;if(f>=a&&r>=0)for(p=this._first;p;){if(v=p._next,(p._act||f>=p._start)&&p._ts&&_!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(f-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(f-p._start)*p._ts,s,o),f!==this._time||!this._ts&&!g){_=0,v&&(u+=this._zTime=-On);break}}p=v}else{p=this._last;for(var M=r<0?r:f;p;){if(v=p._prev,(p._act||M<=p._end)&&p._ts&&_!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(M-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(M-p._start)*p._ts,s,o||Xr&&(p._initted||p._startAt)),f!==this._time||!this._ts&&!g){_=0,v&&(u+=this._zTime=M?-On:On);break}}p=v}}if(_&&!s&&(this.pause(),_.render(f>=a?0:-On)._zTime=f>=a?1:-1,this._ts))return this._start=S,Aw(this),this.render(r,s,o);this._onUpdate&&!s&&po(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&a)&&(S===this._start||Math.abs(w)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&ru(this,1),!s&&!(r<0&&!a)&&(u||a||!l)&&(po(this,u===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(ql(s)||(s=Oo(this,s,r)),!(r instanceof d0)){if(Yr(r))return r.forEach(function(a){return o.add(a,s)}),this;if(pr(r))return this.addLabel(r,s);if(gi(r))r=zi.delayedCall(0,r);else return this}return this!==r?Ka(this,r,s):this},t.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-jo);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof zi?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return pr(r)?this.removeLabel(r):gi(r)?this.killTweensOf(r):(Ew(this,r),r===this._recent&&(this._recent=this._last),Ih(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=hr(co.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=Oo(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=zi.delayedCall(0,s||u0,o);return a.data="isPause",this._hasPause=1,Ka(this,a,Oo(this,r))},t.removePause=function(r){var s=this._first;for(r=Oo(this,r);s;)s._start===r&&s.data==="isPause"&&ru(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)kc!==a[l]&&a[l].kill(r,s);return this},t.getTweensOf=function(r,s){for(var o=[],a=Xo(r),l=this._first,c=ql(s),u;l;)l instanceof zi?iZ(l._targets,a)&&(c?(!kc||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},t.tweenTo=function(r,s){s=s||{};var o=this,a=Oo(o,r),l=s,c=l.startAt,u=l.onStart,h=l.onStartParams,f=l.immediateRender,p,v=zi.to(o,na({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||On,onStart:function(){if(o.pause(),!p){var y=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());v._dur!==y&&Sp(v,y,0,1).render(v._time,!0,!0),p=1}u&&u.apply(v,h||[])}},s));return f?v.render(0):v},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,na({startAt:{time:Oo(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),vL(this,Oo(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),vL(this,Oo(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+On)},t.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return Ih(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return i.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Ih(this)},t.totalDuration=function(r){var s=0,o=this,a=o._last,l=jo,c,u,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(h=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ka(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;Sp(o,o===ni&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(ni._ts&&(Gk(ni,m_(r,ni)),Bk=co.frame),co.frame>=dL){dL+=xo.autoSleep||120;var s=ni._first;if((!s||!s._ts)&&xo.autoSleep&&co._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||co.sleep()}}},e}(d0);na(fs.prototype,{_lock:0,_hasPause:0,_forcing:0});var EZ=function(e,t,n,r,s,o,a){var l=new Ns(this._pt,e,t,0,1,gN,null,s),c=0,u=0,h,f,p,v,x,y,g,_;for(l.b=n,l.e=r,n+="",r+="",(g=~r.indexOf("random("))&&(r=h0(r)),o&&(_=[n,r],o(_,e,t),n=_[0],r=_[1]),f=n.match(UM)||[];h=UM.exec(r);)v=h[0],x=r.substring(c,h.index),p?p=(p+1)%5:x.substr(-5)==="rgba("&&(p=1),v!==f[u++]&&(y=parseFloat(f[u-1])||0,l._pt={_next:l._pt,p:x||u===1?x:",",s:y,c:v.charAt(1)==="="?Od(y,v)-y:parseFloat(v)-y,m:p&&p<4?Math.round:0},c=UM.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,(Fk.test(r)||g)&&(l.e=0),this._pt=l,l},WA=function(e,t,n,r,s,o,a,l,c,u){gi(r)&&(r=r(s||0,e,o));var h=e[t],f=n!=="get"?n:gi(h)?c?e[t.indexOf("set")||!gi(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():h,p=gi(h)?c?LZ:pN:XA,v;if(pr(r)&&(~r.indexOf("random(")&&(r=h0(r)),r.charAt(1)==="="&&(v=Od(f,r)+(jr(f)||0),(v||v===0)&&(r=v))),!u||f!==r||YT)return!isNaN(f*r)&&r!==""?(v=new Ns(this._pt,e,t,+f||0,r-(f||0),typeof h=="boolean"?IZ:mN,0,p),c&&(v.fp=c),a&&v.modifier(a,this,e),this._pt=v):(!h&&!(t in e)&&BA(t,r),EZ.call(this,e,t,f,r,p,l||xo.stringFilter,c))},AZ=function(e,t,n,r,s){if(gi(e)&&(e=Ug(e,s,t,n,r)),!ol(e)||e.style&&e.nodeType||Yr(e)||Ik(e))return pr(e)?Ug(e,s,t,n,r):e;var o={},a;for(a in e)o[a]=Ug(e[a],s,t,n,r);return o},hN=function(e,t,n,r,s,o){var a,l,c,u;if(oo[e]&&(a=new oo[e]).init(s,a.rawVars?t[e]:AZ(t[e],r,s,o,n),n,r,o)!==!1&&(n._pt=l=new Ns(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==wd))for(c=n._ptLookup[n._targets.indexOf(s)],u=a._props.length;u--;)c[a._props[u]]=l;return a},kc,YT,jA=function i(e,t,n){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.runBackwards,h=r.yoyoEase,f=r.keyframes,p=r.autoRevert,v=e._dur,x=e._startAt,y=e._targets,g=e.parent,_=g&&g.data==="nested"?g.vars.targets:y,w=e._overwrite==="auto"&&!kA,S=e.timeline,C,E,A,T,L,M,R,D,F,z,q,H,$;if(S&&(!f||!s)&&(s="none"),e._ease=Uh(s,_p.ease),e._yEase=h?aN(Uh(h===!0?s:h,_p.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!S&&!!r.runBackwards,!S||f&&!r.stagger){if(D=y[0]?Dh(y[0]).harness:0,H=D&&r[D.prop],C=p_(r,HA),x&&(x._zTime<0&&x.progress(1),t<0&&u&&a&&!p?x.render(-1,!0):x.revert(u&&v?Kx:tZ),x._lazy=0),o){if(ru(e._startAt=zi.set(y,na({data:"isStart",overwrite:!1,parent:g,immediateRender:!0,lazy:!x&&Fs(l),startAt:null,delay:0,onUpdate:c&&function(){return po(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Xr||!a&&!p)&&e._startAt.revert(Kx),a&&v&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(u&&v&&!x){if(t&&(a=!1),A=na({overwrite:!1,data:"isFromStart",lazy:a&&!x&&Fs(l),immediateRender:a,stagger:0,parent:g},C),H&&(A[D.prop]=H),ru(e._startAt=zi.set(y,A)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Xr?e._startAt.revert(Kx):e._startAt.render(-1,!0)),e._zTime=t,!a)i(e._startAt,On,On);else if(!t)return}for(e._pt=e._ptCache=0,l=v&&Fs(l)||l&&!v,E=0;E<y.length;E++){if(L=y[E],R=L._gsap||VA(y)[E]._gsap,e._ptLookup[E]=z={},HT[R.id]&&jc.length&&d_(),q=_===y?E:_.indexOf(L),D&&(F=new D).init(L,H||C,e,q,_)!==!1&&(e._pt=T=new Ns(e._pt,L,F.name,0,1,F.render,F,0,F.priority),F._props.forEach(function(U){z[U]=T}),F.priority&&(M=1)),!D||H)for(A in C)oo[A]&&(F=hN(A,C,e,q,L,_))?F.priority&&(M=1):z[A]=T=WA.call(e,L,A,"get",C[A],q,_,0,r.stringFilter);e._op&&e._op[E]&&e.kill(L,e._op[E]),w&&e._pt&&(kc=e,ni.killTweensOf(L,z,e.globalTime(t)),$=!e.parent,kc=0),e._pt&&l&&(HT[R.id]=1)}M&&vN(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!$,f&&t<=0&&S.render(jo,!0,!0)},CZ=function(e,t,n,r,s,o,a,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,h,f,p;if(!c)for(c=e._ptCache[t]=[],f=e._ptLookup,p=e._targets.length;p--;){if(u=f[p][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return YT=1,e.vars[t]="+=0",jA(e,a),YT=0,l?c0(t+" not eligible for reset"):1;c.push(u)}for(p=c.length;p--;)h=c[p],u=h._pt||h,u.s=(r||r===0)&&!s?r:u.s+(r||0)+o*u.c,u.c=n-u.s,h.e&&(h.e=Ci(n)+jr(h.e)),h.b&&(h.b=u.s+jr(h.b))},PZ=function(e,t){var n=e[0]?Dh(e[0]).harness:0,r=n&&n.aliases,s,o,a,l;if(!r)return t;s=Zh({},t);for(o in r)if(o in s)for(l=r[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},RZ=function(e,t,n,r){var s=t.ease||r||"power1.inOut",o,a;if(Yr(t))a=n[e]||(n[e]=[]),t.forEach(function(l,c){return a.push({t:c/(t.length-1)*100,v:l,e:s})});else for(o in t)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},Ug=function(e,t,n,r,s){return gi(e)?e.call(t,n,r,s):pr(e)&&~e.indexOf("random(")?h0(e):e},fN=GA+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",dN={};ks(fN+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return dN[i]=1});var zi=function(i){Lk(e,i);function e(n,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=i.call(this,o?r:Dg(r))||this;var l=a.vars,c=l.duration,u=l.delay,h=l.immediateRender,f=l.stagger,p=l.overwrite,v=l.keyframes,x=l.defaults,y=l.scrollTrigger,g=l.yoyoEase,_=r.parent||ni,w=(Yr(n)||Ik(n)?ql(n[0]):"length"in r)?[n]:Xo(n),S,C,E,A,T,L,M,R;if(a._targets=w.length?VA(w):c0("GSAP target "+n+" not found. https://gsap.com",!xo.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,v||f||Wy(c)||Wy(u)){if(r=a.vars,S=a.timeline=new fs({data:"nested",defaults:x||{},targets:_&&_.data==="nested"?_.vars.targets:w}),S.kill(),S.parent=S._dp=Il(a),S._start=0,f||Wy(c)||Wy(u)){if(A=w.length,M=f&&Qk(f),ol(f))for(T in f)~fN.indexOf(T)&&(R||(R={}),R[T]=f[T]);for(C=0;C<A;C++)E=p_(r,dN),E.stagger=0,g&&(E.yoyoEase=g),R&&Zh(E,R),L=w[C],E.duration=+Ug(c,Il(a),C,L,w),E.delay=(+Ug(u,Il(a),C,L,w)||0)-a._delay,!f&&A===1&&E.delay&&(a._delay=u=E.delay,a._start+=u,E.delay=0),S.to(L,E,M?M(C,L,w):0),S._ease=an.none;S.duration()?c=u=0:a.timeline=0}else if(v){Dg(na(S.vars.defaults,{ease:"none"})),S._ease=Uh(v.ease||r.ease||"none");var D=0,F,z,q;if(Yr(v))v.forEach(function(H){return S.to(w,H,">")}),S.duration();else{E={};for(T in v)T==="ease"||T==="easeEach"||RZ(T,v[T],E,v.easeEach);for(T in E)for(F=E[T].sort(function(H,$){return H.t-$.t}),D=0,C=0;C<F.length;C++)z=F[C],q={ease:z.e,duration:(z.t-(C?F[C-1].t:0))/100*c},q[T]=z.v,S.to(w,q,D),D+=q.duration;S.duration()<c&&S.to({},{duration:c-S.duration()})}}c||a.duration(c=S.duration())}else a.timeline=0;return p===!0&&!kA&&(kc=Il(a),ni.killTweensOf(w),kc=0),Ka(_,Il(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!c&&!v&&a._start===hr(_._time)&&Fs(h)&&aZ(Il(a))&&_.data!=="nested")&&(a._tTime=-On,a.render(Math.max(0,-u)||0)),y&&Yk(Il(a),y),a}var t=e.prototype;return t.render=function(r,s,o){var a=this._time,l=this._tDur,c=this._dur,u=r<0,h=r>l-On&&!u?l:r<On?0:r,f,p,v,x,y,g,_,w,S;if(!c)cZ(this,r,s,o);else if(h!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(f=h,w=this.timeline,this._repeat){if(x=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(x*100+r,s,o);if(f=hr(h%x),h===l?(v=this._repeat,f=c):(v=~~(h/x),v&&v===hr(h/x)&&(f=c,v--),f>c&&(f=c)),g=this._yoyo&&v&1,g&&(S=this._yEase,f=c-f),y=wp(this._tTime,x),f===a&&!o&&this._initted&&v===y)return this._tTime=h,this;v!==y&&(w&&this._yEase&&lN(w,g),this.vars.repeatRefresh&&!g&&!this._lock&&this._time!==x&&this._initted&&(this._lock=o=1,this.render(hr(x*v),!0).invalidate()._lock=0))}if(!this._initted){if(qk(this,u?r:f,o,s,h))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&v!==y))return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=h,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(S||this._ease)(f/c),this._from&&(this.ratio=_=1-_),f&&!a&&!s&&!v&&(po(this,"onStart"),this._tTime!==h))return this;for(p=this._pt;p;)p.r(_,p.d),p=p._next;w&&w.render(r<0?r:w._dur*w._ease(f/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&GT(this,r,s,o),po(this,"onUpdate")),this._repeat&&v!==y&&this.vars.onRepeat&&!s&&this.parent&&po(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&GT(this,r,!0,!0),(r||!c)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&ru(this,1),!s&&!(u&&!a)&&(h||a||g)&&(po(this,h===l?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a,l){f0||co.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||jA(this,c),u=this._ease(c/this._dur),CZ(this,r,s,o,a,u,c,l)?this.resetTo(r,s,o,a,1):(Cw(this,0),this.parent||jk(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?pg(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,kc&&kc.vars.overwrite!==!0)._first||pg(this),this.parent&&o!==this.timeline.totalDuration()&&Sp(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=r?Xo(r):a,c=this._ptLookup,u=this._pt,h,f,p,v,x,y,g;if((!s||s==="all")&&sZ(a,l))return s==="all"&&(this._pt=0),pg(this);for(h=this._op=this._op||[],s!=="all"&&(pr(s)&&(x={},ks(s,function(_){return x[_]=1}),s=x),s=PZ(a,s)),g=a.length;g--;)if(~l.indexOf(a[g])){f=c[g],s==="all"?(h[g]=s,v=f,p={}):(p=h[g]=h[g]||{},v=s);for(x in v)y=f&&f[x],y&&((!("kill"in y.d)||y.d.kill(x)===!0)&&Ew(this,y,"_pt"),delete f[x]),p!=="all"&&(p[x]=1)}return this._initted&&!this._pt&&u&&pg(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return Ig(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return Ig(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return ni.killTweensOf(r,s,o)},e}(d0);na(zi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ks("staggerTo,staggerFrom,staggerFromTo",function(i){zi[i]=function(){var e=new fs,t=WT.call(arguments,0);return t.splice(i==="staggerFromTo"?5:4,0,0),e[i].apply(e,t)}});var XA=function(e,t,n){return e[t]=n},pN=function(e,t,n){return e[t](n)},LZ=function(e,t,n,r){return e[t](r.fp,n)},DZ=function(e,t,n){return e.setAttribute(t,n)},YA=function(e,t){return gi(e[t])?pN:NA(e[t])&&e.setAttribute?DZ:XA},mN=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},IZ=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},gN=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},qA=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},UZ=function(e,t,n,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,t,n),s=o},FZ=function(e){for(var t=this._pt,n,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?Ew(this,t,"_pt"):t.dep||(n=1),t=r;return!n},kZ=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},vN=function(e){for(var t=e._pt,n,r,s,o;t;){for(n=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=n}e._pt=s},Ns=function(){function i(t,n,r,s,o,a,l,c,u){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||mN,this.d=l||this,this.set=c||XA,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=i.prototype;return e.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=kZ,this.m=n,this.mt=s,this.tween=r},i}();ks(GA+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return HA[i]=1});So.TweenMax=So.TweenLite=zi;So.TimelineLite=So.TimelineMax=fs;ni=new fs({sortChildren:!1,defaults:_p,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});xo.stringFilter=oN;var Fh=[],Qx={},NZ=[],xL=0,OZ=0,zM=function(e){return(Qx[e]||NZ).map(function(t){return t()})},qT=function(){var e=Date.now(),t=[];e-xL>2&&(zM("matchMediaInit"),Fh.forEach(function(n){var r=n.queries,s=n.conditions,o,a,l,c;for(a in r)o=Ya.matchMedia(r[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(n.revert(),l&&t.push(n))}),zM("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(r){return n.add(null,r)})}),xL=e,zM("matchMedia"))},yN=function(){function i(t,n){this.selector=n&&jT(n),this.data=[],this._r=[],this.isReverted=!1,this.id=OZ++,t&&this.add(t)}var e=i.prototype;return e.add=function(n,r,s){gi(n)&&(s=r,r=n,n=gi);var o=this,a=function(){var c=Zn,u=o.selector,h;return c&&c!==o&&c.data.push(o),s&&(o.selector=jT(s)),Zn=o,h=r.apply(o,arguments),gi(h)&&o._r.push(h),Zn=c,o.selector=u,o.isReverted=!1,h};return o.last=a,n===gi?a(o,function(l){return o.add(null,l)}):n?o[n]=a:a},e.ignore=function(n){var r=Zn;Zn=null,n(this),Zn=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof i?n.push.apply(n,r.getTweens()):r instanceof zi&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n?function(){for(var a=s.getTweens(),l=s.data.length,c;l--;)c=s.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(n)}),l=s.data.length;l--;)c=s.data[l],c instanceof fs?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof zi)&&c.revert&&c.revert(n);s._r.forEach(function(u){return u(n,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),r)for(var o=Fh.length;o--;)Fh[o].id===this.id&&Fh.splice(o,1)},e.revert=function(n){this.kill(n||{})},i}(),zZ=function(){function i(t){this.contexts=[],this.scope=t,Zn&&Zn.data.push(this)}var e=i.prototype;return e.add=function(n,r,s){ol(n)||(n={matches:n});var o=new yN(0,s||this.scope),a=o.conditions={},l,c,u;Zn&&!o.selector&&(o.selector=Zn.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=n;for(c in n)c==="all"?u=1:(l=Ya.matchMedia(n[c]),l&&(Fh.indexOf(o)<0&&Fh.push(o),(a[c]=l.matches)&&(u=1),l.addListener?l.addListener(qT):l.addEventListener("change",qT)));return u&&r(o,function(h){return o.add(null,h)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},i}(),g_={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(r){return iN(r)})},timeline:function(e){return new fs(e)},getTweensOf:function(e,t){return ni.getTweensOf(e,t)},getProperty:function(e,t,n,r){pr(e)&&(e=Xo(e)[0]);var s=Dh(e||{}).get,o=n?Wk:Vk;return n==="native"&&(n=""),e&&(t?o((oo[t]&&oo[t].get||s)(e,t,n,r)):function(a,l,c){return o((oo[a]&&oo[a].get||s)(e,a,l,c))})},quickSetter:function(e,t,n){if(e=Xo(e),e.length>1){var r=e.map(function(u){return Ws.quickSetter(u,t,n)}),s=r.length;return function(u){for(var h=s;h--;)r[h](u)}}e=e[0]||{};var o=oo[t],a=Dh(e),l=a.harness&&(a.harness.aliases||{})[t]||t,c=o?function(u){var h=new o;wd._pt=0,h.init(e,n?u+n:u,wd,0,[e]),h.render(1,h),wd._pt&&qA(1,wd)}:a.set(e,l);return o?c:function(u){return c(e,l,n?u+n:u,a,1)}},quickTo:function(e,t,n){var r,s=Ws.to(e,Zh((r={},r[t]="+=0.1",r.paused=!0,r),n||{})),o=function(l,c,u){return s.resetTo(t,l,c,u)};return o.tween=s,o},isTweening:function(e){return ni.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Uh(e.ease,_p.ease)),pL(_p,e||{})},config:function(e){return pL(xo,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!oo[a]&&!So[a]&&c0(t+" effect requires "+a+" plugin.")}),FM[t]=function(a,l,c){return n(Xo(a),na(l||{},s),c)},o&&(fs.prototype[t]=function(a,l,c){return this.add(FM[t](a,ol(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){an[e]=Uh(t)},parseEase:function(e,t){return arguments.length?Uh(e,t):an},getById:function(e){return ni.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new fs(e),r,s;for(n.smoothChildTiming=Fs(e.smoothChildTiming),ni.remove(n),n._dp=0,n._time=n._tTime=ni._time,r=ni._first;r;)s=r._next,(t||!(!r._dur&&r instanceof zi&&r.vars.onComplete===r._targets[0]))&&Ka(n,r,r._start-r._delay),r=s;return Ka(ni,n,0),n},context:function(e,t){return e?new yN(e,t):Zn},matchMedia:function(e){return new zZ(e)},matchMediaRefresh:function(){return Fh.forEach(function(e){var t=e.conditions,n,r;for(r in t)t[r]&&(t[r]=!1,n=1);n&&e.revert()})||qT()},addEventListener:function(e,t){var n=Qx[e]||(Qx[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=Qx[e],r=n&&n.indexOf(t);r>=0&&n.splice(r,1)},utils:{wrap:vZ,wrapYoyo:yZ,distribute:Qk,random:$k,snap:Jk,normalize:gZ,getUnit:jr,clamp:fZ,splitColor:rN,toArray:Xo,selector:jT,mapRange:tN,pipe:pZ,unitize:mZ,interpolate:xZ,shuffle:Zk},install:Ok,effects:FM,ticker:co,updateRoot:fs.updateRoot,plugins:oo,globalTimeline:ni,core:{PropTween:Ns,globals:zk,Tween:zi,Timeline:fs,Animation:d0,getCache:Dh,_removeLinkedListItem:Ew,reverting:function(){return Xr},context:function(e){return e&&Zn&&(Zn.data.push(e),e._ctx=Zn),Zn},suppressOverwrites:function(e){return kA=e}}};ks("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return g_[i]=zi[i]});co.add(fs.updateRoot);wd=g_.to({},{duration:0});var BZ=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},HZ=function(e,t){var n=e._targets,r,s,o;for(r in t)for(s=n.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=BZ(o,r)),o&&o.modifier&&o.modifier(t[r],e,n[s],r))},BM=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(pr(s)&&(l={},ks(s,function(u){return l[u]=1}),s=l),t){l={};for(c in s)l[c]=t(s[c]);s=l}HZ(a,s)}}}},Ws=g_.registerPlugin({name:"attr",init:function(e,t,n,r,s){var o,a,l;this.tween=n;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],r,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)Xr?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},BM("roundProps",XT),BM("modifiers"),BM("snap",Jk))||g_;zi.version=fs.version=Ws.version="3.12.5";Nk=1;OA()&&Mp();an.Power0;an.Power1;an.Power2;an.Power3;an.Power4;an.Linear;an.Quad;an.Cubic;an.Quart;an.Quint;an.Strong;an.Elastic;an.Back;an.SteppedEase;an.Bounce;an.Sine;an.Expo;an.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _L,Nc,zd,KA,Mh,wL,ZA,GZ=function(){return typeof window<"u"},Kl={},lh=180/Math.PI,Bd=Math.PI/180,qf=Math.atan2,SL=1e8,QA=/([A-Z])/g,VZ=/(left|right|width|margin|padding|x)/i,WZ=/[\s,\(]\S/,$a={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},KT=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},jZ=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},XZ=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},YZ=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},xN=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},_N=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},qZ=function(e,t,n){return e.style[t]=n},KZ=function(e,t,n){return e.style.setProperty(t,n)},ZZ=function(e,t,n){return e._gsap[t]=n},QZ=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},JZ=function(e,t,n,r,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},$Z=function(e,t,n,r,s){var o=e._gsap;o[t]=n,o.renderTransform(s,o)},si="transform",Os=si+"Origin",eQ=function i(e,t){var n=this,r=this.target,s=r.style,o=r._gsap;if(e in Kl&&s){if(this.tfm=this.tfm||{},e!=="transform")e=$a[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return n.tfm[a]=kl(r,a)}):this.tfm[e]=o.x?o[e]:kl(r,e),e===Os&&(this.tfm.zOrigin=o.zOrigin);else return $a.transform.split(",").forEach(function(a){return i.call(n,a,t)});if(this.props.indexOf(si)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Os,t,"")),e=si}(s||t)&&this.props.push(e,t,s[e])},wN=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},tQ=function(){var e=this.props,t=this.target,n=t.style,r=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(QA,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=ZA(),(!s||!s.isStart)&&!n[si]&&(wN(n),r.zOrigin&&n[Os]&&(n[Os]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},SN=function(e,t){var n={target:e,props:[],revert:tQ,save:eQ};return e._gsap||Ws.core.getCache(e),t&&t.split(",").forEach(function(r){return n.save(r)}),n},MN,ZT=function(e,t){var n=Nc.createElementNS?Nc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Nc.createElement(e);return n&&n.style?n:Nc.createElement(e)},il=function i(e,t,n){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(QA,"-$1").toLowerCase())||r.getPropertyValue(t)||!n&&i(e,bp(t)||t,1)||""},ML="O,Moz,ms,Ms,Webkit".split(","),bp=function(e,t,n){var r=t||Mh,s=r.style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(ML[o]+e in s););return o<0?null:(o===3?"ms":o>=0?ML[o]:"")+e},QT=function(){GZ()&&window.document&&(_L=window,Nc=_L.document,zd=Nc.documentElement,Mh=ZT("div")||{style:{}},ZT("div"),si=bp(si),Os=si+"Origin",Mh.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",MN=!!bp("perspective"),ZA=Ws.core.reverting,KA=1)},HM=function i(e){var t=ZT("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(zd.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),zd.removeChild(t),this.style.cssText=s,o},bL=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},bN=function(e){var t;try{t=e.getBBox()}catch{t=HM.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===HM||(t=HM.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+bL(e,["x","cx","x1"])||0,y:+bL(e,["y","cy","y1"])||0,width:0,height:0}:t},TN=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&bN(e))},Qh=function(e,t){if(t){var n=e.style,r;t in Kl&&t!==Os&&(t=si),n.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(r==="--"?t:t.replace(QA,"-$1").toLowerCase())):n.removeAttribute(t)}},Oc=function(e,t,n,r,s,o){var a=new Ns(e._pt,t,n,0,1,o?_N:xN);return e._pt=a,a.b=r,a.e=s,e._props.push(n),a},TL={deg:1,rad:1,turn:1},nQ={grid:1,flex:1},su=function i(e,t,n,r){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=Mh.style,l=VZ.test(t),c=e.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),h=100,f=r==="px",p=r==="%",v,x,y,g;if(r===o||!s||TL[r]||TL[o])return s;if(o!=="px"&&!f&&(s=i(e,t,n,"px")),g=e.getCTM&&TN(e),(p||o==="%")&&(Kl[t]||~t.indexOf("adius")))return v=g?e.getBBox()[l?"width":"height"]:e[u],Ci(p?s/v*h:s/100*v);if(a[l?"width":"height"]=h+(f?o:r),x=~t.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,g&&(x=(e.ownerSVGElement||{}).parentNode),(!x||x===Nc||!x.appendChild)&&(x=Nc.body),y=x._gsap,y&&p&&y.width&&l&&y.time===co.time&&!y.uncache)return Ci(s/y.width*h);if(p&&(t==="height"||t==="width")){var _=e.style[t];e.style[t]=h+r,v=e[u],_?e.style[t]=_:Qh(e,t)}else(p||o==="%")&&!nQ[il(x,"display")]&&(a.position=il(e,"position")),x===e&&(a.position="static"),x.appendChild(Mh),v=Mh[u],x.removeChild(Mh),a.position="absolute";return l&&p&&(y=Dh(x),y.time=co.time,y.width=x[u]),Ci(f?v*s/h:v&&s?h/v*s:0)},kl=function(e,t,n,r){var s;return KA||QT(),t in $a&&t!=="transform"&&(t=$a[t],~t.indexOf(",")&&(t=t.split(",")[0])),Kl[t]&&t!=="transform"?(s=m0(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:y_(il(e,Os))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=v_[t]&&v_[t](e,t,n)||il(e,t)||Hk(e,t)||(t==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?su(e,t,s,n)+n:s},iQ=function(e,t,n,r){if(!n||n==="none"){var s=bp(t,e,1),o=s&&il(e,s,1);o&&o!==n?(t=s,n=o):t==="borderColor"&&(n=il(e,"borderTopColor"))}var a=new Ns(this._pt,e.style,t,0,1,gN),l=0,c=0,u,h,f,p,v,x,y,g,_,w,S,C;if(a.b=n,a.e=r,n+="",r+="",r==="auto"&&(x=e.style[t],e.style[t]=r,r=il(e,t)||r,x?e.style[t]=x:Qh(e,t)),u=[n,r],oN(u),n=u[0],r=u[1],f=n.match(_d)||[],C=r.match(_d)||[],C.length){for(;h=_d.exec(r);)y=h[0],_=r.substring(l,h.index),v?v=(v+1)%5:(_.substr(-5)==="rgba("||_.substr(-5)==="hsla(")&&(v=1),y!==(x=f[c++]||"")&&(p=parseFloat(x)||0,S=x.substr((p+"").length),y.charAt(1)==="="&&(y=Od(p,y)+S),g=parseFloat(y),w=y.substr((g+"").length),l=_d.lastIndex-w.length,w||(w=w||xo.units[t]||S,l===r.length&&(r+=w,a.e+=w)),S!==w&&(p=su(e,t,x,w)||0),a._pt={_next:a._pt,p:_||c===1?_:",",s:p,c:g-p,m:v&&v<4||t==="zIndex"?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r=t==="display"&&r==="none"?_N:xN;return Fk.test(r)&&(a.e=0),this._pt=a,a},EL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},rQ=function(e){var t=e.split(" "),n=t[0],r=t[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(e=n,n=r,r=e),t[0]=EL[n]||n,t[1]=EL[r]||r,t.join(" ")},sQ=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,r=n.style,s=t.u,o=n._gsap,a,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],Kl[a]&&(l=1,a=a==="transformOrigin"?Os:si),Qh(n,a);l&&(Qh(n,si),o&&(o.svg&&n.removeAttribute("transform"),m0(n,1),o.uncache=1,wN(r)))}},v_={clearProps:function(e,t,n,r,s){if(s.data!=="isFromStart"){var o=e._pt=new Ns(e._pt,t,n,0,0,sQ);return o.u=r,o.pr=-10,o.tween=s,e._props.push(n),1}}},p0=[1,0,0,1,0,0],EN={},AN=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},AL=function(e){var t=il(e,si);return AN(t)?p0:t.substr(7).match(Uk).map(Ci)},JA=function(e,t){var n=e._gsap||Dh(e),r=e.style,s=AL(e),o,a,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?p0:s):(s===p0&&!e.offsetParent&&e!==zd&&!n.svg&&(l=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(c=1,a=e.nextElementSibling,zd.appendChild(e)),s=AL(e),l?r.display=l:Qh(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):zd.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},JT=function(e,t,n,r,s,o){var a=e._gsap,l=s||JA(e,!0),c=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,f=a.yOffset||0,p=l[0],v=l[1],x=l[2],y=l[3],g=l[4],_=l[5],w=t.split(" "),S=parseFloat(w[0])||0,C=parseFloat(w[1])||0,E,A,T,L;n?l!==p0&&(A=p*y-v*x)&&(T=S*(y/A)+C*(-x/A)+(x*_-y*g)/A,L=S*(-v/A)+C*(p/A)-(p*_-v*g)/A,S=T,C=L):(E=bN(e),S=E.x+(~w[0].indexOf("%")?S/100*E.width:S),C=E.y+(~(w[1]||w[0]).indexOf("%")?C/100*E.height:C)),r||r!==!1&&a.smooth?(g=S-c,_=C-u,a.xOffset=h+(g*p+_*x)-g,a.yOffset=f+(g*v+_*y)-_):a.xOffset=a.yOffset=0,a.xOrigin=S,a.yOrigin=C,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!n,e.style[Os]="0px 0px",o&&(Oc(o,a,"xOrigin",c,S),Oc(o,a,"yOrigin",u,C),Oc(o,a,"xOffset",h,a.xOffset),Oc(o,a,"yOffset",f,a.yOffset)),e.setAttribute("data-svg-origin",S+" "+C)},m0=function(e,t){var n=e._gsap||new uN(e);if("x"in n&&!t&&!n.uncache)return n;var r=e.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=il(e,Os)||"0",u,h,f,p,v,x,y,g,_,w,S,C,E,A,T,L,M,R,D,F,z,q,H,$,U,X,j,B,Z,ie,V,te;return u=h=f=x=y=g=_=w=S=0,p=v=1,n.svg=!!(e.getCTM&&TN(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[si]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[si]!=="none"?l[si]:"")),r.scale=r.rotate=r.translate="none"),A=JA(e,n.svg),n.svg&&(n.uncache?(U=e.getBBox(),c=n.xOrigin-U.x+"px "+(n.yOrigin-U.y)+"px",$=""):$=!t&&e.getAttribute("data-svg-origin"),JT(e,$||c,!!$||n.originIsAbsolute,n.smooth!==!1,A)),C=n.xOrigin||0,E=n.yOrigin||0,A!==p0&&(R=A[0],D=A[1],F=A[2],z=A[3],u=q=A[4],h=H=A[5],A.length===6?(p=Math.sqrt(R*R+D*D),v=Math.sqrt(z*z+F*F),x=R||D?qf(D,R)*lh:0,_=F||z?qf(F,z)*lh+x:0,_&&(v*=Math.abs(Math.cos(_*Bd))),n.svg&&(u-=C-(C*R+E*F),h-=E-(C*D+E*z))):(te=A[6],ie=A[7],j=A[8],B=A[9],Z=A[10],V=A[11],u=A[12],h=A[13],f=A[14],T=qf(te,Z),y=T*lh,T&&(L=Math.cos(-T),M=Math.sin(-T),$=q*L+j*M,U=H*L+B*M,X=te*L+Z*M,j=q*-M+j*L,B=H*-M+B*L,Z=te*-M+Z*L,V=ie*-M+V*L,q=$,H=U,te=X),T=qf(-F,Z),g=T*lh,T&&(L=Math.cos(-T),M=Math.sin(-T),$=R*L-j*M,U=D*L-B*M,X=F*L-Z*M,V=z*M+V*L,R=$,D=U,F=X),T=qf(D,R),x=T*lh,T&&(L=Math.cos(T),M=Math.sin(T),$=R*L+D*M,U=q*L+H*M,D=D*L-R*M,H=H*L-q*M,R=$,q=U),y&&Math.abs(y)+Math.abs(x)>359.9&&(y=x=0,g=180-g),p=Ci(Math.sqrt(R*R+D*D+F*F)),v=Ci(Math.sqrt(H*H+te*te)),T=qf(q,H),_=Math.abs(T)>2e-4?T*lh:0,S=V?1/(V<0?-V:V):0),n.svg&&($=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!AN(il(e,si)),$&&e.setAttribute("transform",$))),Math.abs(_)>90&&Math.abs(_)<270&&(s?(p*=-1,_+=x<=0?180:-180,x+=x<=0?180:-180):(v*=-1,_+=_<=0?180:-180)),t=t||n.uncache,n.x=u-((n.xPercent=u&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=h-((n.yPercent=h&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=f+o,n.scaleX=Ci(p),n.scaleY=Ci(v),n.rotation=Ci(x)+a,n.rotationX=Ci(y)+a,n.rotationY=Ci(g)+a,n.skewX=_+a,n.skewY=w+a,n.transformPerspective=S+o,(n.zOrigin=parseFloat(c.split(" ")[2])||!t&&n.zOrigin||0)&&(r[Os]=y_(c)),n.xOffset=n.yOffset=0,n.force3D=xo.force3D,n.renderTransform=n.svg?aQ:MN?CN:oQ,n.uncache=0,n},y_=function(e){return(e=e.split(" "))[0]+" "+e[1]},GM=function(e,t,n){var r=jr(t);return Ci(parseFloat(t)+parseFloat(su(e,"x",n+"px",r)))+r},oQ=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,CN(e,t)},Qu="0deg",Bm="0px",Ju=") ",CN=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,c=n.rotation,u=n.rotationY,h=n.rotationX,f=n.skewX,p=n.skewY,v=n.scaleX,x=n.scaleY,y=n.transformPerspective,g=n.force3D,_=n.target,w=n.zOrigin,S="",C=g==="auto"&&e&&e!==1||g===!0;if(w&&(h!==Qu||u!==Qu)){var E=parseFloat(u)*Bd,A=Math.sin(E),T=Math.cos(E),L;E=parseFloat(h)*Bd,L=Math.cos(E),o=GM(_,o,A*L*-w),a=GM(_,a,-Math.sin(E)*-w),l=GM(_,l,T*L*-w+w)}y!==Bm&&(S+="perspective("+y+Ju),(r||s)&&(S+="translate("+r+"%, "+s+"%) "),(C||o!==Bm||a!==Bm||l!==Bm)&&(S+=l!==Bm||C?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Ju),c!==Qu&&(S+="rotate("+c+Ju),u!==Qu&&(S+="rotateY("+u+Ju),h!==Qu&&(S+="rotateX("+h+Ju),(f!==Qu||p!==Qu)&&(S+="skew("+f+", "+p+Ju),(v!==1||x!==1)&&(S+="scale("+v+", "+x+Ju),_.style[si]=S||"translate(0, 0)"},aQ=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,c=n.skewX,u=n.skewY,h=n.scaleX,f=n.scaleY,p=n.target,v=n.xOrigin,x=n.yOrigin,y=n.xOffset,g=n.yOffset,_=n.forceCSS,w=parseFloat(o),S=parseFloat(a),C,E,A,T,L;l=parseFloat(l),c=parseFloat(c),u=parseFloat(u),u&&(u=parseFloat(u),c+=u,l+=u),l||c?(l*=Bd,c*=Bd,C=Math.cos(l)*h,E=Math.sin(l)*h,A=Math.sin(l-c)*-f,T=Math.cos(l-c)*f,c&&(u*=Bd,L=Math.tan(c-u),L=Math.sqrt(1+L*L),A*=L,T*=L,u&&(L=Math.tan(u),L=Math.sqrt(1+L*L),C*=L,E*=L)),C=Ci(C),E=Ci(E),A=Ci(A),T=Ci(T)):(C=h,T=f,E=A=0),(w&&!~(o+"").indexOf("px")||S&&!~(a+"").indexOf("px"))&&(w=su(p,"x",o,"px"),S=su(p,"y",a,"px")),(v||x||y||g)&&(w=Ci(w+v-(v*C+x*A)+y),S=Ci(S+x-(v*E+x*T)+g)),(r||s)&&(L=p.getBBox(),w=Ci(w+r/100*L.width),S=Ci(S+s/100*L.height)),L="matrix("+C+","+E+","+A+","+T+","+w+","+S+")",p.setAttribute("transform",L),_&&(p.style[si]=L)},lQ=function(e,t,n,r,s){var o=360,a=pr(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?lh:1),c=l-r,u=r+c+"deg",h,f;return a&&(h=s.split("_")[1],h==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),h==="cw"&&c<0?c=(c+o*SL)%o-~~(c/o)*o:h==="ccw"&&c>0&&(c=(c-o*SL)%o-~~(c/o)*o)),e._pt=f=new Ns(e._pt,t,n,r,c,jZ),f.e=u,f.u="deg",e._props.push(n),f},CL=function(e,t){for(var n in t)e[n]=t[n];return e},cQ=function(e,t,n){var r=CL({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,c,u,h,f,p,v;r.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),o[si]=t,a=m0(n,1),Qh(n,si),n.setAttribute("transform",c)):(c=getComputedStyle(n)[si],o[si]=t,a=m0(n,1),o[si]=c);for(l in Kl)c=r[l],u=a[l],c!==u&&s.indexOf(l)<0&&(p=jr(c),v=jr(u),h=p!==v?su(n,l,c,v):parseFloat(c),f=parseFloat(u),e._pt=new Ns(e._pt,a,l,h,f-h,KT),e._pt.u=v||0,e._props.push(l));CL(a,r)};ks("padding,margin,Width,Radius",function(i,e){var t="Top",n="Right",r="Bottom",s="Left",o=(e<3?[t,n,r,s]:[t+s,t+n,r+n,r+s]).map(function(a){return e<2?i+a:"border"+a+i});v_[e>1?"border"+i:i]=function(a,l,c,u,h){var f,p;if(arguments.length<4)return f=o.map(function(v){return kl(a,v,c)}),p=f.join(" "),p.split(f[0]).length===5?f[0]:p;f=(u+"").split(" "),p={},o.forEach(function(v,x){return p[v]=f[x]=f[x]||f[(x-1)/2|0]}),a.init(l,p,h)}});var PN={name:"css",register:QT,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,s){var o=this._props,a=e.style,l=n.vars.startAt,c,u,h,f,p,v,x,y,g,_,w,S,C,E,A,T;KA||QT(),this.styles=this.styles||SN(e),T=this.styles.props,this.tween=n;for(x in t)if(x!=="autoRound"&&(u=t[x],!(oo[x]&&hN(x,t,n,r,e,s)))){if(p=typeof u,v=v_[x],p==="function"&&(u=u.call(n,r,e,s),p=typeof u),p==="string"&&~u.indexOf("random(")&&(u=h0(u)),v)v(this,e,x,u,n)&&(A=1);else if(x.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(x)+"").trim(),u+="",Xc.lastIndex=0,Xc.test(c)||(y=jr(c),g=jr(u)),g?y!==g&&(c=su(e,x,c,g)+g):y&&(u+=y),this.add(a,"setProperty",c,u,r,s,0,0,x),o.push(x),T.push(x,0,a[x]);else if(p!=="undefined"){if(l&&x in l?(c=typeof l[x]=="function"?l[x].call(n,r,e,s):l[x],pr(c)&&~c.indexOf("random(")&&(c=h0(c)),jr(c+"")||c==="auto"||(c+=xo.units[x]||jr(kl(e,x))||""),(c+"").charAt(1)==="="&&(c=kl(e,x))):c=kl(e,x),f=parseFloat(c),_=p==="string"&&u.charAt(1)==="="&&u.substr(0,2),_&&(u=u.substr(2)),h=parseFloat(u),x in $a&&(x==="autoAlpha"&&(f===1&&kl(e,"visibility")==="hidden"&&h&&(f=0),T.push("visibility",0,a.visibility),Oc(this,a,"visibility",f?"inherit":"hidden",h?"inherit":"hidden",!h)),x!=="scale"&&x!=="transform"&&(x=$a[x],~x.indexOf(",")&&(x=x.split(",")[0]))),w=x in Kl,w){if(this.styles.save(x),S||(C=e._gsap,C.renderTransform&&!t.parseTransform||m0(e,t.parseTransform),E=t.smoothOrigin!==!1&&C.smooth,S=this._pt=new Ns(this._pt,a,si,0,1,C.renderTransform,C,0,-1),S.dep=1),x==="scale")this._pt=new Ns(this._pt,C,"scaleY",C.scaleY,(_?Od(C.scaleY,_+h):h)-C.scaleY||0,KT),this._pt.u=0,o.push("scaleY",x),x+="X";else if(x==="transformOrigin"){T.push(Os,0,a[Os]),u=rQ(u),C.svg?JT(e,u,0,E,0,this):(g=parseFloat(u.split(" ")[2])||0,g!==C.zOrigin&&Oc(this,C,"zOrigin",C.zOrigin,g),Oc(this,a,x,y_(c),y_(u)));continue}else if(x==="svgOrigin"){JT(e,u,1,E,0,this);continue}else if(x in EN){lQ(this,C,x,f,_?Od(f,_+u):u);continue}else if(x==="smoothOrigin"){Oc(this,C,"smooth",C.smooth,u);continue}else if(x==="force3D"){C[x]=u;continue}else if(x==="transform"){cQ(this,u,e);continue}}else x in a||(x=bp(x)||x);if(w||(h||h===0)&&(f||f===0)&&!WZ.test(u)&&x in a)y=(c+"").substr((f+"").length),h||(h=0),g=jr(u)||(x in xo.units?xo.units[x]:y),y!==g&&(f=su(e,x,c,g)),this._pt=new Ns(this._pt,w?C:a,x,f,(_?Od(f,_+h):h)-f,!w&&(g==="px"||x==="zIndex")&&t.autoRound!==!1?YZ:KT),this._pt.u=g||0,y!==g&&g!=="%"&&(this._pt.b=c,this._pt.r=XZ);else if(x in a)iQ.call(this,e,x,c,_?_+u:u);else if(x in e)this.add(e,x,c||e[x],_?_+u:u,r,s);else if(x!=="parseTransform"){BA(x,u);continue}w||(x in a?T.push(x,0,a[x]):T.push(x,1,c||e[x])),o.push(x)}}A&&vN(this)},render:function(e,t){if(t.tween._time||!ZA())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:kl,aliases:$a,getSetter:function(e,t,n){var r=$a[t];return r&&r.indexOf(",")<0&&(t=r),t in Kl&&t!==Os&&(e._gsap.x||kl(e,"x"))?n&&wL===n?t==="scale"?QZ:ZZ:(wL=n||{})&&(t==="scale"?JZ:$Z):e.style&&!NA(e.style[t])?qZ:~t.indexOf("-")?KZ:YA(e,t)},core:{_removeProperty:Qh,_getMatrix:JA}};Ws.utils.checkPrefix=bp;Ws.core.getStyleSaver=SN;(function(i,e,t,n){var r=ks(i+","+e+","+t,function(s){Kl[s]=1});ks(e,function(s){xo.units[s]="deg",EN[s]=1}),$a[r[13]]=i+","+e,ks(n,function(s){var o=s.split(":");$a[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ks("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){xo.units[i]="px"});Ws.registerPlugin(PN);var Zl=Ws.registerPlugin(PN)||Ws;Zl.core.Tween;let uQ=class extends Dt{constructor(){super(...arguments);oe(this,"animations",[]);oe(this,"hasAnimation",!0)}get number(){return"05"}get title(){return"Animations"}get link(){return"https://threejs-journey.com/lessons/animations"}update(t){this.object3d.position.x=Math.sin(t/1e3),this.object3d.position.y=Math.cos(t/1e3)}init(){super.init();const t=new un(1,1,1),n=new Yt({color:255});this.object3d=new Ae(t,n),this.scene.add(this.object3d),this.animations.push(Zl.to(this.object3d.position,{z:-3,delay:1,duration:1})),this.animations.push(Zl.to(this.object3d.position,{z:0,delay:2,duration:1}))}dispose(){super.dispose(),this.animations.forEach(t=>t.kill()),this.animations=[]}};var Jd,$d,li,RN,LN,$T,DN,IN,UN,FN,kN,NN,ON,H4;let hQ=(H4=class extends Dt{constructor(){super(...arguments);st(this,li);oe(this,"hasAnimation",!0);st(this,Jd);st(this,$d)}get number(){return"06"}get title(){return"Cameras"}get link(){return"https://threejs-journey.com/lessons/cameras"}update(){W(this,li,RN).call(this)}init(){super.init(),W(this,li,IN).call(this),W(this,li,DN).call(this)}dispose(){super.dispose(),W(this,li,UN).call(this),W(this,li,kN).call(this)}initControl(){W(this,li,$T).call(this),W(this,li,FN).call(this)}initOrthographicCamera(){const t=this.canvas.width/this.canvas.height;this.camera=new yo(-t,t,1,-1),this.camera.position.z=3}},Jd=new WeakMap,$d=new WeakMap,li=new WeakSet,RN=function(){this.control.update(),this.camera.lookAt(this.object3d.position)},LN=function(){this.control=new UA(this.camera,this.canvas),this.control.enableDamping=!0},$T=function(){function t(n,r){this.x=0,this.y=0,this.boundUpdateCoordinates=null,this.init=function(){this.boundUpdateCoordinates=this.updateCoordindates.bind(this),r.addEventListener("mousemove",this.boundUpdateCoordinates)},this.update=function(s=5){const o=2*Math.PI*this.x;n.position.x=Math.cos(o)*s,n.position.z=Math.sin(o)*s,n.position.y=this.y*s},this.updateCoordindates=function(s){this.x=s.offsetX/r.width-.5,this.y=(s.offsetY/r.height-.5)*-1},this.dispose=function(){r.removeEventListener("mousemove",this.boundUpdateCoordinates)}}this.control=new t(this.camera,this.canvas),this.control.init()},DN=function(){const t=new un(1,1,1),n=new Yt({color:65280});this.object3d=new Ae(t,n),this.scene.add(this.object3d)},IN=function(){Ln(this,Jd,W(this,li,ON).bind(this)),document.addEventListener("keydown",gt(this,Jd))},UN=function(){document.removeEventListener("keydown",gt(this,Jd))},FN=function(){Ln(this,$d,W(this,li,NN).bind(this)),document.addEventListener("keydown",gt(this,$d))},kN=function(){document.removeEventListener("keydown",gt(this,$d))},NN=function(t){switch(t.code){case"KeyR":W(this,li,LN).call(this);break;case"KeyC":W(this,li,$T).call(this);break}},ON=function(t){switch(t.code){case"KeyP":this.initCamera();break;case"KeyO":this.initOrthographicCamera();break}},H4);var ep,ll,zN,BN,HN,GN,G4;let fQ=(G4=class extends Dt{constructor(){super(...arguments);st(this,ll);oe(this,"hasAnimation",!0);st(this,ep)}get number(){return"07"}get title(){return"Fullscreen and resizing"}get link(){return"https://threejs-journey.com/lessons/fullscreen-and-resizing"}update(){this.control.update()}init(){super.init(),W(this,ll,GN).call(this),W(this,ll,zN).call(this)}dispose(){super.dispose(),W(this,ll,BN).call(this)}},ep=new WeakMap,ll=new WeakSet,zN=function(){Ln(this,ep,W(this,ll,HN).bind(this)),document.addEventListener("keydown",gt(this,ep))},BN=function(){document.removeEventListener("keydown",gt(this,ep))},HN=function(t){t.code==="KeyF"&&(document.fullscreenElement?document.exitFullscreen():this.canvas.requestFullscreen())},GN=function(){const t=new un(1,1,1),n=new Yt({color:16777215});this.object3d=new Ae(t,n),this.scene.add(this.object3d)},G4);var cu,VN,WN,jN,V4;let dQ=(V4=class extends Dt{constructor(){super(...arguments);st(this,cu);oe(this,"hasAnimation",!0)}get number(){return"08"}get title(){return"Geometries"}get link(){return"https://threejs-journey.com/lessons/geometries"}update(){this.control.update()}init(){super.init(),W(this,cu,VN).call(this)}},cu=new WeakSet,VN=function(){const t=new Yt({color:16777215,wireframe:!0});this.mesh=new Ae(W(this,cu,WN).call(this),t),this.scene.add(this.mesh)},WN=function(){const t=new yt;return t.setAttribute("position",W(this,cu,jN).call(this)),t},jN=function(){const r=new Float32Array(450);for(let s=0;s<450;s++)r[s]=(Math.random()-.5)*2;return new wt(r,3)},V4);var Fp,XN,YN,W4;let pQ=(W4=class extends Dt{constructor(){super(...arguments);st(this,Fp);oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"09"}get title(){return"Debug UI"}get link(){return"https://threejs-journey.com/lessons/debug-ui"}update(){this.control.update()}init(){super.init(),W(this,Fp,YN).call(this),W(this,Fp,XN).call(this)}},Fp=new WeakSet,XN=function(){this.guiControl.add(this.mesh.position,"y").min(-2).max(2).step(.01).name("elevation"),this.guiControl.add(this.mesh,"visible"),this.guiControl.add(this.mesh.material,"wireframe"),this.guiControl.addColor({color:this.mesh.material.color.getHex()},"color").onChange(t=>{this.mesh.material.color.setHex(t)}),this.guiControl.add({spin:()=>{Zl.to(this.mesh.rotation,{y:this.mesh.rotation.y+Math.PI*2})}},"spin"),this.guiControl.add({subdivisions:1},"subdivisions").min(1).max(20).step(1).onFinishChange(t=>{this.mesh.geometry.dispose(),this.mesh.geometry=new un(1,1,1,t,t,t)})},YN=function(){const t=new un(1,1,1),n=new Yt({color:14253554,wireframe:!0});this.mesh=new Ae(t,n),this.scene.add(this.mesh)},W4);var uu,qN,KN,ZN,j4;let mQ=(j4=class extends Dt{constructor(){super(...arguments);st(this,uu);oe(this,"loaderManager");oe(this,"textureLoader");oe(this,"doorMapTexture");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"10"}get title(){return"Textures"}get link(){return"https://threejs-journey.com/lessons/textures"}update(){this.control.update()}init(){super.init(),W(this,uu,qN).call(this),W(this,uu,KN).call(this),W(this,uu,ZN).call(this)}},uu=new WeakSet,qN=function(){this.loaderManager=new Xp,this.textureLoader=new _i(this.loaderManager),this.texture=this.textureLoader.load("/three.js-journey/media/images/textures/door/color.jpg"),this.texture.colorSpace=Wt},KN=function(){const t=new un(1,1,1),n=new Yt({map:this.texture});this.mesh=new Ae(t,n),this.scene.add(this.mesh)},ZN=function(){this.guiControl.add(this.texture.repeat,"x").min(1).max(5).step(.01).name("textureX"),this.guiControl.add(this.texture.repeat,"y").min(1).max(5).step(.01).name("textureY"),this.guiControl.add({offset:0},"offset").min(0).max(1).step(.01).name("textureOffset").onChange(t=>{this.texture.offset.x=t,this.texture.offset.y=t}),this.guiControl.add({rotation:0},"rotation").min(0).max(2*Math.PI).step(.01).onChange(t=>{this.texture.center.x=.5,this.texture.center.y=.5,this.texture.rotation=t}),this.guiControl.add({addXRepeat:()=>{this.texture.wrapS=xn,this.texture.needsUpdate=!0}},"addXRepeat").name("Repeat texture in X"),this.guiControl.add({addYRepeat:()=>{this.texture.wrapT=xn,this.texture.needsUpdate=!0}},"addYRepeat").name("Repeat texture in Y"),this.guiControl.add({updateMinFilterToLinearFilter:()=>{this.texture.minFilter=uo,this.texture.generateMipmaps=!0,this.texture.needsUpdate=!0}},"updateMinFilterToLinearFilter").name("Update min filter to linear filter"),this.guiControl.add({updateMinFilterToNearestFilter:()=>{this.texture.minFilter=wn,this.texture.generateMipmaps=!1,this.texture.needsUpdate=!0}},"updateMinFilterToNearestFilter").name("Update min filter to nearest filter"),this.guiControl.add({updateMagFilterToLinearFilter:()=>{this.texture.magFilter=gn,this.texture.needsUpdate=!0}},"updateMagFilterToLinearFilter").name("Update mag filter to linear filter"),this.guiControl.add({updateMagFilterToNearestFilter:()=>{this.texture.magFilter=wn,this.texture.needsUpdate=!0}},"updateMagFilterToNearestFilter").name("Update mag filter to nearest filter")},j4);class Z0 extends rk{constructor(e){super(e),this.type=Zi}parse(e){const o=function(T,L){switch(T){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},u=`
`,h=function(T,L,M){L=L||1024;let D=T.pos,F=-1,z=0,q="",H=String.fromCharCode.apply(null,new Uint16Array(T.subarray(D,D+128)));for(;0>(F=H.indexOf(u))&&z<L&&D<T.byteLength;)q+=H,z+=H.length,D+=128,H+=String.fromCharCode.apply(null,new Uint16Array(T.subarray(D,D+128)));return-1<F?(T.pos+=z+F+1,q+H.slice(0,F)):!1},f=function(T){const L=/^#\?(\S+)/,M=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,R=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,D=/^\s*FORMAT=(\S+)\s*$/,F=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,z={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let q,H;for((T.pos>=T.byteLength||!(q=h(T)))&&o(1,"no header found"),(H=q.match(L))||o(3,"bad initial token"),z.valid|=1,z.programtype=H[1],z.string+=q+`
`;q=h(T),q!==!1;){if(z.string+=q+`
`,q.charAt(0)==="#"){z.comments+=q+`
`;continue}if((H=q.match(M))&&(z.gamma=parseFloat(H[1])),(H=q.match(R))&&(z.exposure=parseFloat(H[1])),(H=q.match(D))&&(z.valid|=2,z.format=H[1]),(H=q.match(F))&&(z.valid|=4,z.height=parseInt(H[1],10),z.width=parseInt(H[2],10)),z.valid&2&&z.valid&4)break}return z.valid&2||o(3,"missing format specifier"),z.valid&4||o(3,"missing image size specifier"),z},p=function(T,L,M){const R=L;if(R<8||R>32767||T[0]!==2||T[1]!==2||T[2]&128)return new Uint8Array(T);R!==(T[2]<<8|T[3])&&o(3,"wrong scanline width");const D=new Uint8Array(4*L*M);D.length||o(4,"unable to allocate buffer space");let F=0,z=0;const q=4*R,H=new Uint8Array(4),$=new Uint8Array(q);let U=M;for(;U>0&&z<T.byteLength;){z+4>T.byteLength&&o(1),H[0]=T[z++],H[1]=T[z++],H[2]=T[z++],H[3]=T[z++],(H[0]!=2||H[1]!=2||(H[2]<<8|H[3])!=R)&&o(3,"bad rgbe scanline format");let X=0,j;for(;X<q&&z<T.byteLength;){j=T[z++];const Z=j>128;if(Z&&(j-=128),(j===0||X+j>q)&&o(3,"bad scanline data"),Z){const ie=T[z++];for(let V=0;V<j;V++)$[X++]=ie}else $.set(T.subarray(z,z+j),X),X+=j,z+=j}const B=R;for(let Z=0;Z<B;Z++){let ie=0;D[F]=$[Z+ie],ie+=R,D[F+1]=$[Z+ie],ie+=R,D[F+2]=$[Z+ie],ie+=R,D[F+3]=$[Z+ie],F+=4}U--}return D},v=function(T,L,M,R){const D=T[L+3],F=Math.pow(2,D-128)/255;M[R+0]=T[L+0]*F,M[R+1]=T[L+1]*F,M[R+2]=T[L+2]*F,M[R+3]=1},x=function(T,L,M,R){const D=T[L+3],F=Math.pow(2,D-128)/255;M[R+0]=fg.toHalfFloat(Math.min(T[L+0]*F,65504)),M[R+1]=fg.toHalfFloat(Math.min(T[L+1]*F,65504)),M[R+2]=fg.toHalfFloat(Math.min(T[L+2]*F,65504)),M[R+3]=fg.toHalfFloat(1)},y=new Uint8Array(e);y.pos=0;const g=f(y),_=g.width,w=g.height,S=p(y.subarray(y.pos),_,w);let C,E,A;switch(this.type){case Hi:A=S.length/4;const T=new Float32Array(A*4);for(let M=0;M<A;M++)v(S,M*4,T,M*4);C=T,E=Hi;break;case Zi:A=S.length/4;const L=new Uint16Array(A*4);for(let M=0;M<A;M++)x(S,M*4,L,M*4);C=L,E=Zi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:_,height:w,data:C,header:g.string,gamma:g.gamma,exposure:g.exposure,type:E}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(o,a){switch(o.type){case Hi:case Zi:o.colorSpace=Wi,o.minFilter=gn,o.magFilter=gn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,n,r)}}var Kr,QN,JN,$N,eO,tO,nO,iO,X4;let gQ=(X4=class extends Dt{constructor(){super(...arguments);st(this,Kr);oe(this,"plane");oe(this,"torus");oe(this,"sphere");oe(this,"doorColorTexture");oe(this,"doorAlphaTexture");oe(this,"doorAmbientOcclusionTexture");oe(this,"doorHeightTexture");oe(this,"doorMetalnessTexture");oe(this,"doorRoughnessTexture");oe(this,"doorNormalTexture");oe(this,"matcapTexture");oe(this,"gradientTexture");oe(this,"material");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"11"}get title(){return"Materials"}get link(){return"https://threejs-journey.com/lessons/materials"}update(t){this.control.update(),this.plane.rotation.x=1e-4*t,this.plane.rotation.y=1e-4*t,this.sphere.rotation.x=1e-4*t,this.sphere.rotation.y=1e-4*t,this.torus.rotation.x=1e-4*t,this.torus.rotation.y=1e-4*t}init(){super.init(),W(this,Kr,eO).call(this),W(this,Kr,JN).call(this),W(this,Kr,$N).call(this),W(this,Kr,iO).call(this),W(this,Kr,nO).call(this),W(this,Kr,tO).call(this),W(this,Kr,QN).call(this),this.sphere.position.x=-2,this.torus.position.x=2}dispose(){super.dispose(),this.plane=null,this.sphere=null,this.torus=null}},Kr=new WeakSet,QN=function(){this.guiControl.add(this.material,"metalness").min(0).max(1).step(.001),this.guiControl.add(this.material,"roughness").min(0).max(1).step(.001),this.guiControl.add(this.material,"clearcoat").min(0).max(1).step(.001),this.guiControl.add(this.material,"clearcoatRoughness").min(0).max(1).step(.001),this.guiControl.add(this.material,"sheen").min(0).max(1).step(.001),this.guiControl.add(this.material,"sheenRoughness").min(0).max(1).step(.001),this.guiControl.addColor(this.material,"sheenColor"),this.guiControl.add(this.material,"iridescence").min(0).max(1).step(1e-4),this.guiControl.add(this.material,"iridescenceIOR").min(1).max(2.333).step(1e-4),this.guiControl.add(this.material.iridescenceThicknessRange,"0").min(1).max(1e3).step(1).name("iridescenceThicknessRange - 0"),this.guiControl.add(this.material.iridescenceThicknessRange,"1").min(1).max(1e3).step(1).name("iridescenceThicknessRange - 1"),this.guiControl.add(this.material,"transmission").min(0).max(1).step(1e-4),this.guiControl.add(this.material,"ior").min(1).max(10).step(1e-4),this.guiControl.add(this.material,"thickness").min(0).max(1).step(1e-4)},JN=function(){const t=new _i;this.doorColorTexture=t.load("/three.js-journey/media/images/textures/door/color.jpg"),this.doorAlphaTexture=t.load("/three.js-journey/media/images/textures/door/alpha.jpg"),this.doorAmbientOcclusionTexture=t.load("/three.js-journey/media/images/textures/door/ambientOcclusion.jpg"),this.doorHeightTexture=t.load("/three.js-journey/media/images/textures/door/height.jpg"),this.doorMetalnessTexture=t.load("/three.js-journey/media/images/textures/door/metalness.jpg"),this.doorRoughnessTexture=t.load("/three.js-journey/media/images/textures/door/roughness.jpg"),this.doorNormalTexture=t.load("/three.js-journey/media/images/textures/door/normal.jpg"),this.doorColorTexture.colorSpace=Wt,this.matcapTexture=t.load("/three.js-journey/media/images/textures/matcaps/7.png"),this.gradientTexture=t.load("/three.js-journey/media/images/textures/gradients/3.jpg"),this.gradientTexture.generateMipmaps=!1,this.gradientTexture.minFilter=wn,this.gradientTexture.magFilter=wn},$N=function(){this.material=new gs,this.material.side=_n,this.material.transparent=!0,this.material.alphaMap=this.doorAlphaTexture},eO=function(){new Z0().load("/three.js-journey/media/images/environmentMaps/2k.hdr",n=>{n.mapping=Ca,this.scene.background=n,this.scene.environment=n})},tO=function(){const t=new fo(.5,.2,64,28);this.torus=new Ae(t,this.material),this.scene.add(this.torus)},nO=function(){const t=new Lr(.5,64,64);this.sphere=new Ae(t,this.material),this.scene.add(this.sphere)},iO=function(){const t=new Ot(1,1,100,100);this.plane=new Ae(t,this.material),this.scene.add(this.plane)},X4);class vQ extends Dr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Vs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){const l=s.parse(JSON.parse(a));t&&t(l)},n,r)}parse(e){return new yQ(e)}}class yQ{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const n=[],r=xQ(e,t,this.data);for(let s=0,o=r.length;s<o;s++)n.push(...r[s].toShapes());return n}}function xQ(i,e,t){const n=Array.from(i),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<n.length;c++){const u=n[c];if(u===`
`)a=0,l-=s;else{const h=_Q(u,r,a,l,t);a+=h.offsetX,o.push(h.path)}}return o}function _Q(i,e,t,n,r){const s=r.glyphs[i]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+i+'" does not exists in font family '+r.familyName+".");return}const o=new yk;let a,l,c,u,h,f,p,v;if(s.o){const x=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let y=0,g=x.length;y<g;)switch(x[y++]){case"m":a=x[y++]*e+t,l=x[y++]*e+n,o.moveTo(a,l);break;case"l":a=x[y++]*e+t,l=x[y++]*e+n,o.lineTo(a,l);break;case"q":c=x[y++]*e+t,u=x[y++]*e+n,h=x[y++]*e+t,f=x[y++]*e+n,o.quadraticCurveTo(h,f,c,u);break;case"b":c=x[y++]*e+t,u=x[y++]*e+n,h=x[y++]*e+t,f=x[y++]*e+n,p=x[y++]*e+t,v=x[y++]*e+n,o.bezierCurveTo(h,f,p,v,c,u);break}}return{offsetX:s.ha*e,path:o}}class wQ extends Y0{constructor(e,t={}){const n=t.font;if(n===void 0)super();else{const r=n.generateShapes(e,t.size);t.depth===void 0&&t.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=t.depth!==void 0?t.depth:t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}var cl,rO,sO,oO,aO,Y4;let SQ=(Y4=class extends Dt{constructor(){super(...arguments);st(this,cl);oe(this,"material");oe(this,"hasAnimation",!0)}get number(){return"12"}get title(){return"3D Text"}get link(){return"https://threejs-journey.com/lessons/3d-text"}update(){this.control.update()}init(){super.init(),W(this,cl,sO).call(this),W(this,cl,oO).call(this),W(this,cl,rO).call(this)}dispose(){super.dispose(),this.material=null}},cl=new WeakSet,rO=function(){this.camera.position.z=2,this.camera.position.y=1,this.camera.position.x=1},sO=function(){const n=new _i().load("/three.js-journey/media/images/textures/matcaps/1.png");n.colorSpace=Wt,this.material=new wA({matcap:n})},oO=function(){new vQ().load("/three.js-journey/media/fonts/helvetiker_regular.typeface.json",n=>{const r=new wQ("Three.js rocks!",{font:n,size:.3,height:.2,curveSegments:12,bevelEnabled:!0,bevelThickness:.03,bevelSize:.02,bevelOffset:0,bevelSegments:5});r.center(),this.mesh=new Ae(r,this.material),this.scene.add(this.mesh),W(this,cl,aO).call(this,r.boundingBox)})},aO=function(t){const n=new fo(.2,.1,20,45),r=t.max.x-t.min.x,s=t.max.y-t.min.y,o=t.max.z-t.min.z,a=5;for(let l=0;l<100;l++){const c=new Ae(n,this.material);c.position.x=(r+a)/2*(-1)**Math.round(Math.random())+Math.random()*5,c.position.y=(s+a)/2*(-1)**Math.round(Math.random())+Math.random()*5,c.position.z=(o+a)/2*(-1)**Math.round(Math.random())+Math.random()*5,c.rotation.x=Math.random()*Math.PI,c.rotation.y=Math.random()*Math.PI;const u=Math.random()*2;c.scale.set(u,u,u),this.scene.add(c)}},Y4);class MQ extends Xt{constructor(e,t){const n=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new yt;r.setAttribute("position",new lt(n,3)),r.computeBoundingSphere();const s=new vr({fog:!1});super(r,s),this.light=e,this.color=t,this.type="RectAreaLightHelper";const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new yt;a.setAttribute("position",new lt(o,3)),a.computeBoundingSphere(),this.add(new Ae(a,new Yt({side:Vi,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}var Ut,lO,cO,uO,hO,fO,dO,pO,mO,gO,vO,yO,xO,ch,e2,Wa,q4;let bQ=(q4=class extends Dt{constructor(){super(...arguments);st(this,Ut);oe(this,"material");oe(this,"plane");oe(this,"box");oe(this,"sphere");oe(this,"torus");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"14"}get title(){return"Lights"}get link(){return"https://threejs-journey.com/lessons/lights"}update(t){this.control.update(),this.box.rotation.x=1e-4*t,this.box.rotation.y=1e-4*t,this.sphere.rotation.x=1e-4*t,this.sphere.rotation.y=1e-4*t,this.torus.rotation.x=1e-4*t,this.torus.rotation.y=1e-4*t}init(){super.init(),W(this,Ut,pO).call(this),W(this,Ut,mO).call(this),W(this,Ut,gO).call(this),W(this,Ut,vO).call(this),W(this,Ut,yO).call(this),W(this,Ut,xO).call(this),W(this,Ut,dO).call(this),W(this,Ut,fO).call(this),W(this,Ut,hO).call(this),W(this,Ut,uO).call(this),W(this,Ut,cO).call(this),W(this,Ut,lO).call(this)}dispose(){super.dispose(),this.plane=null,this.box=null,this.sphere=null,this.torus=null}},Ut=new WeakSet,lO=function(){const t=new q0(16716032,1,0,Math.PI*.1,.25,1);t.position.z=-3,t.position.x=-2,t.target.position.x=-3,this.scene.add(t),this.scene.add(t.target);const n=W(this,Ut,ch).call(this,t,"Spot Light");W(this,Ut,Wa).call(this,n,t,"distance"),W(this,Ut,Wa).call(this,n,t,"angle"),W(this,Ut,Wa).call(this,n,t,"penumbra"),W(this,Ut,Wa).call(this,n,t,"decay");const r=new fk(t);this.scene.add(r)},cO=function(){const t=new AA(65280,1,2.5,2.5);t.position.x=-2,t.position.z=2,t.lookAt(this.box.position),this.scene.add(t);const n=W(this,Ut,ch).call(this,t,"Rect Area Light");W(this,Ut,Wa).call(this,n,t,"width"),W(this,Ut,Wa).call(this,n,t,"height");const r=new MQ(t);this.scene.add(r)},uO=function(){const t=new Gl(15602090,1,0,2);t.position.x=2,t.position.z=2,this.scene.add(t);const n=W(this,Ut,ch).call(this,t,"Point Light");W(this,Ut,Wa).call(this,n,t,"distance"),W(this,Ut,Wa).call(this,n,t,"decay");const r=new pk(t,.2);this.scene.add(r)},hO=function(){const t=new TA(16711680,255,.5);this.scene.add(t);const n=W(this,Ut,ch).call(this,t,"Hemisphere Light");W(this,Ut,e2).call(this,n,t,"groundColor");const r=new mk(t,.2);this.scene.add(r)},fO=function(){const t=new Fi(65532,.9);t.position.set(5,1,0),this.scene.add(t),W(this,Ut,ch).call(this,t,"Directional Light");const n=new gk(t,.2);this.scene.add(n)},dO=function(){const t=new nc(16777215,.5);this.scene.add(t),W(this,Ut,ch).call(this,t,"Ambient Light")},pO=function(){this.material=new hn,this.material.roughness=.5},mO=function(){const t=new Ot(10,10);this.plane=new Ae(t,this.material),this.plane.rotation.x=-Math.PI/2,this.plane.position.y=-2,this.scene.add(this.plane)},gO=function(){const t=new un(1,1,1);this.box=new Ae(t,this.material),this.scene.add(this.box)},vO=function(){const t=new Lr(1);this.sphere=new Ae(t,this.material),this.sphere.position.x=2,this.scene.add(this.sphere)},yO=function(){const t=new fo(.7,.3);this.torus=new Ae(t,this.material),this.torus.position.x=-2,this.scene.add(this.torus)},xO=function(){this.camera.position.z=5},ch=function(t,n){const r=this.guiControl.addFolder(n);return W(this,Ut,Wa).call(this,r,t,"intensity"),W(this,Ut,e2).call(this,r,t,"color"),r},e2=function(t,n,r){t.addColor({color:n[r].getHex()},"color").onChange(s=>{n[r].setHex(s)})},Wa=function(t,n,r){t.add(n,r).min(0).max(5).step(.01)},q4);var Ri,_O,wO,SO,MO,bO,TO,EO,gg,K4;let TQ=(K4=class extends Dt{constructor(){super(...arguments);st(this,Ri);oe(this,"plane");oe(this,"sphere");oe(this,"sphereShadow");oe(this,"material");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"15"}get title(){return"Shadows"}get link(){return"https://threejs-journey.com/lessons/shadows"}update(t){this.control.update();const n=1.5;this.sphere.position.x=Math.cos(t/1e3)*n,this.sphere.position.z=Math.sin(t/1e3)*n,this.sphere.position.y=Math.abs(Math.sin(t/1e3)),this.sphereShadow.position.x=this.sphere.position.x,this.sphereShadow.position.z=this.sphere.position.z,this.sphereShadow.material.opacity=(1-this.sphere.position.y)*.3;const r=this.sphere.position.y*1.5;this.sphereShadow.scale.set(r,r,r)}init(){super.init(),W(this,Ri,wO).call(this),W(this,Ri,SO).call(this),W(this,Ri,bO).call(this),W(this,Ri,MO).call(this),W(this,Ri,TO).call(this),W(this,Ri,_O).call(this)}dispose(){super.dispose(),this.plane=null,this.sphere=null,this.sphereShadow=null,this.material=null}},Ri=new WeakSet,_O=function(){this.renderer.shadowMap.enabled=!1,this.renderer.shadowMap.type=Ji},wO=function(){this.material=new hn,W(this,Ri,EO).call(this)},SO=function(){const t=new Lr(.5);this.sphere=new Ae(t,this.material),this.sphere.castShadow=!0,this.sphere.receiveShadow=!1,this.scene.add(this.sphere)},MO=function(){const n=new _i().load("/three.js-journey/media/images/textures/shadows/simple.jpg");n.colorSpace=Wt;const r=new Ot(1,1),s=new Yt({color:0,transparent:!0,alphaMap:n});this.sphereShadow=new Ae(r,s),this.sphereShadow.rotation.x=-Math.PI/2,this.sphereShadow.position.y=this.plane.position.y+.001,this.scene.add(this.sphereShadow)},bO=function(){const t=new Ot(5,5);this.plane=new Ae(t,this.material),this.plane.rotation.x=-Math.PI/2,this.plane.position.y=-.5,this.plane.castShadow=!1,this.plane.receiveShadow=!0,this.scene.add(this.plane)},TO=function(){const t=new nc(16777215,2);this.scene.add(t),W(this,Ri,gg).call(this,t,"Ambient Light");const n=new Fi(16777215,1);n.position.x=3,n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=1,n.shadow.camera.far=6,n.shadow.camera.top=1,n.shadow.camera.bottom=-1,n.shadow.camera.right=1,n.shadow.camera.left=-1,this.scene.add(n),W(this,Ri,gg).call(this,n,"Directional Light");const r=new q0(16777215,1,0,Math.PI*.1);r.position.x=1,r.position.z=1,r.castShadow=!0,r.shadow.mapSize.width=1024,r.shadow.mapSize.height=1024,r.shadow.camera.near=1,r.shadow.camera.far=5,r.visible=!1,this.scene.add(r),this.scene.add(r.target),W(this,Ri,gg).call(this,r,"Spot Light"),this.guiControl.add(r,"visible").name("Enable Spotlight");const s=new Gl(16777215,1);s.position.x=1,s.position.z=-1,s.castShadow=!0,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.camera.near=.1,s.shadow.camera.far=4,s.visible=!1,this.scene.add(s),W(this,Ri,gg).call(this,s,"Point Light"),this.guiControl.add(s,"visible").name("Enable Point Light")},EO=function(){this.guiControl.add(this.material,"metalness").min(0).max(1).step(.001),this.guiControl.add(this.material,"roughness").min(0).max(1).step(.001)},gg=function(t,n){this.guiControl.addFolder(n).add(t,"intensity").min(0).max(5).step(.001)},K4);class Q0 extends Ae{constructor(){const e=Q0.SkyShader,t=new Ft({name:e.name,uniforms:Is.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:Vi,depthWrite:!1});super(new un(1,1,1),t),this.isSky=!0}}Q0.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new N},up:{value:new N(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const EQ="/three.js-journey/assets/alpha-oYUXAV8U.webp",AQ="/three.js-journey/assets/arm-rmC2KtbT.webp",CQ="/three.js-journey/assets/diffuse-BiGrMCC3.webp",PQ="/three.js-journey/assets/displacement-CKqTQH1-.webp",RQ="/three.js-journey/assets/normal-Cn3WmhCd.webp",LQ="/three.js-journey/assets/arm-DyzoCEM3.webp",DQ="/three.js-journey/assets/diffuse-3lwd3U-t.webp",IQ="/three.js-journey/assets/normal-iYA-jasx.webp",UQ="/three.js-journey/assets/arm-WvlYQgg6.webp",FQ="/three.js-journey/assets/diffuse-Ca4I2Dwk.webp",kQ="/three.js-journey/assets/normal-CEkQghNg.webp",NQ="/three.js-journey/assets/arm-CIirWEzm.webp",OQ="/three.js-journey/assets/diffuse-Bt2KqQCc.webp",zQ="/three.js-journey/assets/normal-CzXVEdvu.webp",BQ="/three.js-journey/assets/arm-BpdijVEA.webp",HQ="/three.js-journey/assets/diffuse-BtOV6iYR.webp",GQ="/three.js-journey/assets/normal-B1F88-Fh.webp",VQ="/three.js-journey/assets/alpha-C_QdxHjX.webp",WQ="/three.js-journey/assets/normal-CnTtXT1a.webp",jQ="/three.js-journey/assets/ambientOcclusion-DWqpmaJh.webp",XQ="/three.js-journey/assets/color-D6TT9ASI.webp",YQ="/three.js-journey/assets/height-vbXR4p20.webp",qQ="/three.js-journey/assets/metalness-DWD7jlG_.webp",KQ="/three.js-journey/assets/roughness-Cy_48OtR.webp";var jt,AO,CO,PO,RO,Jx,LO,$x,DO,IO,UO,FO,kO,NO,t2,uh,Z4;let ZQ=(Z4=class extends Dt{constructor(){super(...arguments);st(this,jt);oe(this,"ghostViolet");oe(this,"ghostPink");oe(this,"ghostRed");oe(this,"textureLoader");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"16"}get title(){return"Haunted House"}get link(){return"https://threejs-journey.com/lessons/haunted-house"}update(t){const n=t*.001;this.control.update(),W(this,jt,Jx).call(this,this.ghostViolet,n*.5,4,2.34,3.45),W(this,jt,Jx).call(this,this.ghostPink,-n*.38,5,2.34,3.45),W(this,jt,Jx).call(this,this.ghostRed,n*.23,6,2.34,3.45)}init(){super.init(),W(this,jt,NO).call(this),W(this,jt,UO).call(this),W(this,jt,FO).call(this),W(this,jt,kO).call(this),W(this,jt,RO).call(this),W(this,jt,CO).call(this),W(this,jt,PO).call(this),W(this,jt,AO).call(this)}dispose(){super.dispose(),this.textureLoader=null,this.ghostViolet=null,this.ghostPink=null,this.ghostRed=null}},jt=new WeakSet,AO=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji},CO=function(){const t=new Q0;t.material.uniforms.turbidity.value=10,t.material.uniforms.rayleigh.value=3,t.material.uniforms.mieCoefficient.value=.1,t.material.uniforms.mieDirectionalG.value=.95,t.material.uniforms.sunPosition.value.set(.3,-.038,-.95),t.scale.set(100,100,100),this.scene.add(t)},PO=function(){const t=new G0("#04343f",.1);this.scene.fog=t},RO=function(){const t=new ho,n=this.textureLoader.load(LQ),r=this.textureLoader.load(IQ),s=this.textureLoader.load(DQ);s.colorSpace=Wt;const o=new Ae(new un(4,3,4),new hn({map:s,normalMap:r,roughnessMap:n,metalnessMap:n,aoMap:n}));o.position.y=o.geometry.parameters.height*.5,o.castShadow=!0,o.receiveShadow=!0,t.add(o);const a=this.textureLoader.load(UQ),l=this.textureLoader.load(kQ),c=this.textureLoader.load(FQ);c.colorSpace=Wt,a.repeat.set(3,1),l.repeat.set(3,1),c.repeat.set(3,1),a.wrapS=xn,l.wrapS=xn,c.wrapS=xn;const u=new Ae(new Wp(o.geometry.parameters.width,2,4),new hn({map:c,normalMap:l,roughnessMap:a,metalnessMap:a,aoMap:a}));u.position.y=o.geometry.parameters.height+u.geometry.parameters.height*.5,u.rotation.y=Math.PI*.25,u.castShadow=!0,t.add(u);const h=this.textureLoader.load(VQ),f=this.textureLoader.load(jQ),p=this.textureLoader.load(YQ),v=this.textureLoader.load(qQ),x=this.textureLoader.load(KQ),y=this.textureLoader.load(WQ),g=this.textureLoader.load(XQ);g.colorSpace=Wt;const _=new Ae(new Ot(1.5,2.3,100,100),new hn({transparent:!0,map:g,alphaMap:h,aoMap:f,metalnessMap:v,roughnessMap:x,normalMap:y,displacementMap:p,displacementScale:.15,displacementBias:-.04}));_.position.y=_.geometry.parameters.height*.5,_.position.z=o.geometry.parameters.depth*.5+.01,t.add(_);const w=new Gl("#ff7d46",5);w.position.z=o.geometry.parameters.depth*.5+.1,w.position.y=_.geometry.parameters.height+.1,t.add(w),W(this,jt,IO).call(this,_.position.z,_.geometry.parameters.width),W(this,jt,DO).call(this,o.geometry.parameters.width),W(this,jt,LO).call(this),this.scene.add(t)},Jx=function(t,n,r,s,o){const a=n;t.position.x=Math.cos(a)*r,t.position.z=Math.sin(a)*r,t.position.y=Math.sin(a)*Math.sin(a*s)*Math.sin(a*o)},LO=function(){this.ghostViolet=new Gl("#8800ff",6),this.ghostPink=new Gl("#ff0088",6),this.ghostRed=new Gl("#ff0000",6),W(this,jt,$x).call(this,this.ghostViolet),W(this,jt,$x).call(this,this.ghostPink),W(this,jt,$x).call(this,this.ghostRed),this.scene.add(this.ghostViolet,this.ghostPink,this.ghostRed)},$x=function(t){t.castShadow=!0,t.shadow.mapSize.width=256,t.shadow.mapSize.height=256,t.shadow.camera.far=10},DO=function(t){const n=this.textureLoader.load(BQ),r=this.textureLoader.load(GQ),s=this.textureLoader.load(HQ);s.colorSpace=Wt,s.repeat.set(.3,.4),r.repeat.set(.3,.4),n.repeat.set(.3,.4);const o=new un(.6,1,.3),a=new hn({map:s,normalMap:r,roughnessMap:n,metalnessMap:n,aoMap:n}),l=new ho;for(let c=0;c<30;c++){const u=new Ae(o,a),h=Math.random()*2*Math.PI,f=t*.5+1.5+Math.random()*4;u.position.y=u.geometry.parameters.height*.5-Math.random()*.4,u.position.x=Math.cos(h)*f,u.position.z=Math.sin(h)*f,u.rotation.x=(Math.random()-.5)*.4,u.rotation.y=(Math.random()-.5)*.4,u.rotation.z=(Math.random()-.5)*.4,u.castShadow=!0,u.receiveShadow=!0,l.add(u)}this.scene.add(l)},IO=function(t,n){const r=this.textureLoader.load(NQ),s=this.textureLoader.load(zQ),o=this.textureLoader.load(OQ);o.colorSpace=Wt,o.repeat.set(2,1),s.repeat.set(2,1),r.repeat.set(2,1),o.wrapS=xn,s.wrapS=xn,r.wrapS=xn;const a=new Lr(.5),l=new hn({map:o,normalMap:s,roughnessMap:r,metalnessMap:r,aoMap:r,color:"#ccffcc"}),c=n*.5-.1,u=a.parameters.radius-.3,h=t+a.parameters.radius-.3,f=new Ae(a,l);f.position.x=c,f.position.y=u,f.position.z=h,f.rotation.x=-.75,this.scene.add(f),W(this,jt,uh).call(this,f,"Bush 1");const p=new Ae(a,l);p.position.x=-c,p.position.y=u,p.position.z=h,p.scale.set(.8,.8,.8),p.rotation.x=-.75,this.scene.add(p),W(this,jt,uh).call(this,p,"Bush 2");const v=new Ae(a,l),x=.6;v.position.x=c+.6,v.position.z=h,v.scale.set(x,x,x),v.position.y=u*x,v.rotation.x=-.75,this.scene.add(v),W(this,jt,uh).call(this,v,"Bush 3")},UO=function(){this.camera.position.y=5,this.camera.position.x=5,this.camera.position.z=7,W(this,jt,uh).call(this,this.camera,"Camera")},FO=function(){const t=new nc("#86cdff",.275);W(this,jt,t2).call(this,t,"Ambient Light"),this.scene.add(t);const n=new Fi("#86cdff",1);n.position.x=1,n.position.y=3,n.position.z=-5,n.castShadow=!0,n.shadow.mapSize.width=256,n.shadow.mapSize.height=256,n.shadow.camera.top=8,n.shadow.camera.bottom=-8,n.shadow.camera.right=8,n.shadow.camera.left=-8,n.shadow.camera.near=1,n.shadow.camera.far=20,W(this,jt,t2).call(this,n,"Directional Light"),this.scene.add(n)},kO=function(){const t=this.textureLoader.load(EQ),n=this.textureLoader.load(CQ),r=this.textureLoader.load(AQ),s=this.textureLoader.load(RQ),o=this.textureLoader.load(PQ);n.colorSpace=Wt,n.repeat.set(8,8),r.repeat.set(8,8),s.repeat.set(8,8),o.repeat.set(8,8),n.wrapS=xn,r.wrapS=xn,s.wrapS=xn,o.wrapS=xn,n.wrapT=xn,r.wrapT=xn,s.wrapT=xn,o.wrapT=xn;const a=new Ae(new Ot(20,20,100,100),new hn({transparent:!0,alphaMap:t,map:n,roughnessMap:r,metalnessMap:r,aoMap:r,normalMap:s,displacementMap:o,displacementScale:.3,displacementBias:-.2}));a.rotation.x=-Math.PI*.5,a.receiveShadow=!0,W(this,jt,uh).call(this,a,"Floor"),this.scene.add(a)},NO=function(){this.textureLoader=new _i},t2=function(t,n){const r=W(this,jt,uh).call(this,t,n);return r.add(t,"intensity").min(0).max(10).step(.01),r.addColor({color:t.color.getHex()},"color").onChange(s=>{t.color.setHex(s)}),r},uh=function(t,n){const r=this.guiControl.addFolder(n);return r.add(t.position,"x").min(-8).max(8).step(.01),r.add(t.position,"y").min(-8).max(8).step(.01),r.add(t.position,"z").min(-8).max(8).step(.01),r},Z4);var K_,OO,Q4;let QQ=(Q4=class extends Dt{constructor(){super(...arguments);st(this,K_);oe(this,"particles");oe(this,"hasAnimation",!0)}get number(){return"17"}get title(){return"Particles"}get link(){return"https://threejs-journey.com/lessons/particles"}update(t){this.control.update();const n=this.particles.geometry.attributes.position;for(let r=0;r<n.array.length;r+=3)n.array[r+1]=Math.sin(t*.001+n.array[r]);n.needsUpdate=!0}init(){super.init(),W(this,K_,OO).call(this)}dispose(){super.dispose(),this.particles=null}},K_=new WeakSet,OO=function(){const r=new yt,s=new Float32Array(3e3),o=new Float32Array(3e3);for(let u=0;u<s.length;u++)s[u]=(Math.random()-.5)*5,o[u]=Math.random();r.setAttribute("position",new wt(s,3)),r.setAttribute("color",new wt(o,3));const l=new _i().load("/three.js-journey/media/images/textures/particles/2.png"),c=new of({size:.1,sizeAttenuation:!0,transparent:!0,alphaMap:l});c.depthWrite=!1,c.blending=ea,c.vertexColors=!0,this.particles=new ca(r,c),this.scene.add(this.particles)},Q4);var zn,n2,i2,r2,zO,Cc,s2,BO,J4;let JQ=(J4=class extends Dt{constructor(){super(...arguments);st(this,zn);oe(this,"galaxy");oe(this,"galaxyMaterial");oe(this,"galaxyGeometry");oe(this,"galaxyTweaks");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"18"}get title(){return"Galaxy Generator"}get link(){return"https://threejs-journey.com/lessons/galaxy-generator"}update(t){this.control.update();const n=t*.001;this.galaxy.rotation.y=n*.2}init(){super.init(),W(this,zn,BO).call(this),W(this,zn,zO).call(this),W(this,zn,i2).call(this)}dispose(){W(this,zn,r2).call(this),super.dispose()}},zn=new WeakSet,n2=function(){W(this,zn,r2).call(this),W(this,zn,i2).call(this)},i2=function(){this.galaxyGeometry=new yt;const t=this.galaxyTweaks.particles*3,n=new Float32Array(t),r=new Float32Array(t),s=new Ge(this.galaxyTweaks.insideColor),o=new Ge(this.galaxyTweaks.outsideColor);for(let a=0;a<t;a+=3){const l=a/3,c=Math.random()*this.galaxyTweaks.radius,u=2*Math.PI*(l%this.galaxyTweaks.branches/this.galaxyTweaks.branches),h=this.galaxyTweaks.spin*c,f=Math.pow(Math.random(),this.galaxyTweaks.gravityStrength)*Math.pow(-1,Math.round(Math.random()))*this.galaxyTweaks.offset*c,p=Math.pow(Math.random(),this.galaxyTweaks.gravityStrength)*Math.pow(-1,Math.round(Math.random()))*this.galaxyTweaks.offset*c,v=Math.pow(Math.random(),this.galaxyTweaks.gravityStrength)*Math.pow(-1,Math.round(Math.random()))*this.galaxyTweaks.offset*c;n[a]=Math.cos(u+h)*c+f,n[a+1]=p,n[a+2]=Math.sin(u+h)*c+v;const y=s.clone().lerp(o,c/this.galaxyTweaks.radius);r[a]=y.r,r[a+1]=y.g,r[a+2]=y.b}this.galaxyGeometry.setAttribute("position",new wt(n,3)),this.galaxyGeometry.setAttribute("color",new wt(r,3)),this.galaxyMaterial=new of({size:this.galaxyTweaks.size,sizeAttenuation:!0,depthWrite:!1,blending:ea,vertexColors:!0}),this.galaxy=new ca(this.galaxyGeometry,this.galaxyMaterial),this.scene.add(this.galaxy)},r2=function(){this.galaxyGeometry.dispose(),this.galaxyMaterial.dispose(),this.scene.remove(this.galaxy),this.galaxyGeometry=null,this.galaxyMaterial=null,this.galaxy=null},zO=function(){this.galaxyTweaks={particles:2e4,size:.01,radius:4,branches:7,spin:.7,offset:.3,gravityStrength:5,insideColor:"#ff6030",outsideColor:"#1b3984"},W(this,zn,Cc).call(this,"particles",100,1e5,1),W(this,zn,Cc).call(this,"size",.01,1,.01),W(this,zn,Cc).call(this,"radius",1,20,.1),W(this,zn,Cc).call(this,"branches",2,20,1),W(this,zn,Cc).call(this,"spin",.2,20,.1),W(this,zn,Cc).call(this,"offset",.1,20,.1),W(this,zn,Cc).call(this,"gravityStrength",1,20,1),W(this,zn,s2).call(this,"insideColor"),W(this,zn,s2).call(this,"outsideColor")},Cc=function(t,n,r,s){this.guiControl.add(this.galaxyTweaks,t).min(n).max(r).step(s).onFinishChange(W(this,zn,n2).bind(this))},s2=function(t){this.guiControl.addColor(this.galaxyTweaks,t).onFinishChange(W(this,zn,n2).bind(this))},BO=function(){this.camera.position.x=3,this.camera.position.y=3,this.camera.position.z=5},J4);class qp{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=VM(),this._delta=0,this._elapsed=0,this._timescale=1,this._usePageVisibilityAPI=typeof document<"u"&&document.hidden!==void 0,this._usePageVisibilityAPI===!0&&(this._pageVisibilityHandler=$Q.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=VM()-this._startTime,this}dispose(){return this._usePageVisibilityAPI===!0&&document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this}update(e){return this._usePageVisibilityAPI===!0&&document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:VM())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function VM(){return performance.now()}function $Q(){document.hidden===!1&&this.reset()}const eJ="/three.js-journey/assets/3-CO1hT6T5.jpg";var Ah,tp,np,I0,ip,rp,zt,HO,GO,VO,e1,WO,jO,XO,YO,qO,KO,ZO,QO,JO,$O,ez,tz,nz,iz,rz,sz,$4;let tJ=($4=class extends Dt{constructor(){super(...arguments);st(this,zt);oe(this,"particles");oe(this,"meshes",[]);oe(this,"material");oe(this,"cameraGroup");oe(this,"timer");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);st(this,Ah,5);st(this,tp,null);st(this,np,null);st(this,I0,0);st(this,ip);st(this,rp)}get number(){return"19"}get title(){return"Scroll based animation"}get link(){return"https://threejs-journey.com/lessons/scroll-based-animation"}update(t){this.timer.update(t);const n=this.timer.getDelta();for(const r of this.meshes)r.rotation.x+=n*.1,r.rotation.y+=n*.3;if(gt(this,tp)&&gt(this,np)){const r=gt(this,tp)-this.cameraGroup.position.x,s=gt(this,np)-this.cameraGroup.position.y;this.cameraGroup.position.x+=r*2*n,this.cameraGroup.position.y+=s*2*n}}open(){W(this,zt,GO).call(this),W(this,zt,e1).call(this,"My portfolio","start"),W(this,zt,e1).call(this,"My projects","end"),W(this,zt,e1).call(this,"Contact me","start"),super.open()}close(){W(this,zt,WO).call(this),W(this,zt,VO).call(this),super.close()}init(){super.init(),W(this,zt,jO).call(this),W(this,zt,HO).call(this),W(this,zt,rz).call(this),W(this,zt,iz).call(this),W(this,zt,nz).call(this),W(this,zt,ez).call(this),W(this,zt,tz).call(this),W(this,zt,sz).call(this),W(this,zt,$O).call(this),W(this,zt,ZO).call(this),W(this,zt,YO).call(this)}initCamera(){this.cameraGroup=new ho,this.camera=new Un(75,this.canvas.width/this.canvas.height),this.camera.position.z=3,this.cameraGroup.add(this.camera),this.scene.add(this.cameraGroup)}dispose(){super.dispose(),W(this,zt,QO).call(this),W(this,zt,qO).call(this),W(this,zt,XO).call(this),this.particles=null,this.meshes=[],this.cameraGroup=null,this.timer=null}},Ah=new WeakMap,tp=new WeakMap,np=new WeakMap,I0=new WeakMap,ip=new WeakMap,rp=new WeakMap,zt=new WeakSet,HO=function(){this.renderer.setClearAlpha(0)},GO=function(){document.body.style.overflow="visible",document.body.style.backgroundColor="#1e1a20"},VO=function(){document.body.style.overflow="hidden",document.body.style.backgroundColor=null},e1=function(t,n){const r=document.createElement("section"),s=document.createElement("h2");s.textContent=t,r.className="section",r.style.display="flex",r.style.alignItems="center",r.style.justifyContent=n,r.style.paddingLeft="8em",r.style.paddingRight="8em",r.style.fontSize="2rem",r.style.height="100vh",r.style.textTransform="uppercase",r.appendChild(s),document.body.appendChild(r)},WO=function(){document.querySelectorAll(".section").forEach(n=>n.remove())},jO=function(){this.control.dispose()},XO=function(){this.timer.dispose()},YO=function(){Ln(this,rp,W(this,zt,KO).bind(this)),window.addEventListener("mousemove",gt(this,rp))},qO=function(){window.removeEventListener("mousemove",gt(this,rp))},KO=function(t){Ln(this,tp,t.clientX/window.innerWidth-.5),Ln(this,np,-(t.clientY/window.innerHeight)-.5)},ZO=function(){Ln(this,ip,W(this,zt,JO).bind(this)),window.addEventListener("scroll",gt(this,ip))},QO=function(){window.removeEventListener("scroll",gt(this,ip))},JO=function(){const t=window.scrollY/window.innerHeight,n=Math.round(t);this.camera.position.y=-t*gt(this,Ah),gt(this,I0)!==n&&(Ln(this,I0,n),Zl.to(this.meshes[n].rotation,{duration:1.5,ease:"power2.inOut",x:"+=6",y:"+=3",z:"+=1.5"}))},$O=function(){for(let t=0;t<this.meshes.length;t++)this.meshes[t].position.y=-gt(this,Ah)*t,this.meshes[t].position.x=1.5*Math.pow(-1,t%2)},ez=function(){const t=new Ae(new fo(.75,.3,16,60),this.material);t.geometry.name="Torus";const n=new Ae(new Wp(.75,1.5,32),this.material);n.geometry.name="Cone";const r=new Ae(new fl(.8,.25,100,16),this.material);r.geometry.name="Torus Knot",this.meshes.push(t),this.meshes.push(n),this.meshes.push(r),this.scene.add(...this.meshes)},tz=function(){const n=new Float32Array(600);for(let s=0;s<n.length;s+=3)n[s]=(Math.random()-.5)*10,n[s+1]=gt(this,Ah)/2-Math.random()*gt(this,Ah)*this.meshes.length,n[s+2]=(Math.random()-.5)*10;const r=new yt;r.setAttribute("position",new wt(n,3)),this.particles=new ca(r,new of({size:.02,sizeAttenuation:!0,color:this.material.color.getHex()})),this.scene.add(this.particles)},nz=function(){const n=new _i().load(eJ);n.magFilter=wn,this.material=new _A({color:"#ffeded",gradientMap:n})},iz=function(){const t=new Fi(16777215,3);t.position.set(4,2),this.scene.add(t)},rz=function(){this.timer=new qp},sz=function(){this.guiControl.addColor({color:this.material.color.getHex()},"color").onChange(t=>{this.material.color.setHex(t),this.particles.material.color.setHex(t)});for(const t of this.meshes){const n=t.geometry.name,r=this.guiControl.addFolder(n.charAt(0).toUpperCase()+n.slice(1));r.add(t.position,"y").min(-100).max(100).step(.01),r.add(t.position,"x").min(-100).max(100).step(.01)}},$4);var Gs,t1,n1,oz,az;class nJ{constructor(e){st(this,Gs);oe(this,"meshes",{});oe(this,"instance");oe(this,"boxGeometry");oe(this,"sphereGeometry");oe(this,"planeGeometry");oe(this,"planeMaterial");oe(this,"meshMaterial");this.instance=e,W(this,Gs,oz).call(this),W(this,Gs,az).call(this)}addBox(e,t,n,r,s){const o=new Ae(this.boxGeometry,this.meshMaterial);o.scale.set(t,n,r),W(this,Gs,t1).call(this,o,s),W(this,Gs,n1).call(this,e,o)}addSphere(e,t,n){const r=new Ae(this.sphereGeometry,this.meshMaterial);W(this,Gs,t1).call(this,r,n,t),W(this,Gs,n1).call(this,e,r)}addPlane(e,t){const n=new Ae(this.planeGeometry,this.planeMaterial);n.rotation.x=-Math.PI/2,W(this,Gs,t1).call(this,n,t,1),W(this,Gs,n1).call(this,e,n)}dispose(){for(const e in this.meshes)this.instance.remove(this.meshes[e])}}Gs=new WeakSet,t1=function(e,t,n=null){e.castShadow=!0,e.receiveShadow=!0,e.position.copy(t),n&&e.scale.set(n,n,n)},n1=function(e,t){this.meshes[e]=t,this.instance.add(t)},oz=function(){this.sphereGeometry=new Lr(1),this.planeGeometry=new Ot(8,8,8),this.boxGeometry=new un(1,1,1)},az=function(){this.meshMaterial=new hn({metalness:.3,roughness:.4}),this.planeMaterial=new hn({color:7829367,metalness:.3,roughness:.4})};const iJ="/three.js-journey/assets/nx-B1qAN98K.png",rJ="/three.js-journey/assets/ny-C02qeYUz.png",sJ="/three.js-journey/assets/nz-EWNLxSEp.png",oJ="/three.js-journey/assets/px-BQkunSVR.png",aJ="/three.js-journey/assets/py-BLoW9UYQ.png",lJ="/three.js-journey/assets/pz-DHteryXs.png";class cJ{static setup(e,t,n){this.initLights(e),this.initEnvMap(e),this.setupCamera(t),this.setupRenderer(n)}static setupCamera(e){e.fov=75,e.near=.1,e.far=100,e.position.set(-3,3,3)}static setupRenderer(e){e.shadowMap.enabled=!0,e.shadowMap.type=Ji}static initLights(e){const t=new nc(16777215,2.1);e.add(t);const n=new Fi(16777215,.6);n.castShadow=!0,n.shadow.mapSize.set(1024,1024),n.shadow.camera.far=15,n.shadow.camera.left=-7,n.shadow.camera.top=7,n.shadow.camera.right=7,n.shadow.camera.bottom=-7,n.position.set(5,5,5),e.add(n)}static initEnvMap(e){const t=new cf;e.environment=t.load([oJ,iJ,aJ,rJ,lJ,sJ]),e.environmentIntensity=.5}}class PL{static addAction(e,t,n){e.add({exec:t},"exec").name(n)}}var Pn,lz,cz,uz,o2,a2,hz,i1,fz,dz,pz,mz,eU;let uJ=(eU=class extends Dt{constructor(){super(...arguments);st(this,Pn);oe(this,"threeWorld");oe(this,"physicsWorld");oe(this,"timer");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"20"}get title(){return"Physics"}get link(){return"https://threejs-journey.com/lessons/physics"}update(t){this.timer.update(t),this.physicsWorld.postMessage({type:"update",payload:{delta:this.timer.getDelta()}}),this.control.update()}init(){super.init(),cJ.setup(this.scene,this.camera,this.renderer),W(this,Pn,mz).call(this),W(this,Pn,fz).call(this),W(this,Pn,dz).call(this),W(this,Pn,pz).call(this),W(this,Pn,uz).call(this,{x:0,y:0,z:0}),W(this,Pn,o2).call(this,.5,{x:0,y:3,z:0}),W(this,Pn,a2).call(this,1,1,1,{x:3,y:3,z:0})}dispose(){super.dispose(),W(this,Pn,cz).call(this),W(this,Pn,lz).call(this),this.physicsWorld.terminate()}},Pn=new WeakSet,lz=function(){this.threeWorld.dispose()},cz=function(){this.physicsWorld.postMessage({type:"dispose"})},uz=function(t){const n=W(this,Pn,i1).call(this);this.threeWorld.addPlane(n,t),this.physicsWorld.postMessage({type:"add",payload:{bodyType:"plane",id:n,position:t}})},o2=function(t,n){const r=W(this,Pn,i1).call(this);this.threeWorld.addSphere(r,t,n),this.physicsWorld.postMessage({type:"add",payload:{bodyType:"sphere",id:r,radius:t,position:n}})},a2=function(t,n,r,s){const o=W(this,Pn,i1).call(this);this.threeWorld.addBox(o,t,n,r,s),this.physicsWorld.postMessage({type:"add",payload:{bodyType:"box",id:o,width:t/2,height:n/2,depth:r/2,position:s}})},hz=function(){this.physicsWorld.onmessage=t=>{const{type:n,payload:r}=t.data;switch(n){case"refresh":for(const s of r){const o=this.threeWorld.meshes[s.id];o.position.copy(s.position),o.quaternion.copy(s.quaternion)}break}}},i1=function(){return Date.now().toString(36)+Math.random().toString(36).substring(2,9)},fz=function(){this.threeWorld=new nJ(this.scene)},dz=function(){this.physicsWorld=new Worker(new URL("/three.js-journey/assets/worker-DOS562_J.js",import.meta.url),{type:"module"}),this.physicsWorld.postMessage({type:"init",payload:{gravity:-9.8,friction:.1,restitution:.7}}),W(this,Pn,hz).call(this)},pz=function(){PL.addAction(this.guiControl,()=>{W(this,Pn,o2).call(this,Math.random(),{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})},"Create Sphere"),PL.addAction(this.guiControl,()=>{W(this,Pn,a2).call(this,Math.random(),Math.random(),Math.random(),{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})},"Create Box")},mz=function(){this.timer=new qp},eU);function hJ(i,e=!1){const t=i[0].index!==null,n=new Set(Object.keys(i[0].attributes)),r=new Set(Object.keys(i[0].morphAttributes)),s={},o={},a=i[0].morphTargetsRelative,l=new yt;let c=0;for(let u=0;u<i.length;++u){const h=i[u];let f=0;if(t!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const p in h.attributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),f++}if(f!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const p in h.morphAttributes){if(!r.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;o[p]===void 0&&(o[p]=[]),o[p].push(h.morphAttributes[p])}if(e){let p;if(t)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,u),c+=p}}if(t){let u=0;const h=[];for(let f=0;f<i.length;++f){const p=i[f].index;for(let v=0;v<p.count;++v)h.push(p.getX(v)+u);u+=i[f].attributes.position.count}l.setIndex(h)}for(const u in s){const h=RL(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,h)}for(const u in o){const h=o[u][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let f=0;f<h;++f){const p=[];for(let x=0;x<o[u].length;++x)p.push(o[u][x][f]);const v=RL(p);if(!v)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(v)}}return l}function RL(i){let e,t,n,r=-1,s=0;for(let c=0;c<i.length;++c){const u=i[c];if(e===void 0&&(e=u.array.constructor),e!==u.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=u.itemSize),t!==u.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=u.normalized),n!==u.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=u.gpuType),r!==u.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=u.count*t}const o=new e(s),a=new wt(o,t,n);let l=0;for(let c=0;c<i.length;++c){const u=i[c];if(u.isInterleavedBufferAttribute){const h=l/t;for(let f=0,p=u.count;f<p;f++)for(let v=0;v<t;v++){const x=u.getComponent(f,v);a.setComponent(f+h,v,x)}}else o.set(u.array,l);l+=u.count*t}return r!==void 0&&(a.gpuType=r),a}function fJ(i,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},n=i.getIndex(),r=i.getAttribute("position"),s=n?n.count:r.count;let o=0;const a=Object.keys(i.attributes),l={},c={},u=[],h=["getX","getY","getZ","getW"],f=["setX","setY","setZ","setW"];for(let _=0,w=a.length;_<w;_++){const S=a[_],C=i.attributes[S];l[S]=new C.constructor(new C.array.constructor(C.count*C.itemSize),C.itemSize,C.normalized);const E=i.morphAttributes[S];E&&(c[S]||(c[S]=[]),E.forEach((A,T)=>{const L=new A.array.constructor(A.count*A.itemSize);c[S][T]=new A.constructor(L,A.itemSize,A.normalized)}))}const p=e*.5,v=Math.log10(1/e),x=Math.pow(10,v),y=p*x;for(let _=0;_<s;_++){const w=n?n.getX(_):_;let S="";for(let C=0,E=a.length;C<E;C++){const A=a[C],T=i.getAttribute(A),L=T.itemSize;for(let M=0;M<L;M++)S+=`${~~(T[h[M]](w)*x+y)},`}if(S in t)u.push(t[S]);else{for(let C=0,E=a.length;C<E;C++){const A=a[C],T=i.getAttribute(A),L=i.morphAttributes[A],M=T.itemSize,R=l[A],D=c[A];for(let F=0;F<M;F++){const z=h[F],q=f[F];if(R[q](o,T[z](w)),L)for(let H=0,$=L.length;H<$;H++)D[H][q](o,L[H][z](w))}}t[S]=o,u.push(o),o++}}const g=i.clone();for(const _ in i.attributes){const w=l[_];if(g.setAttribute(_,new w.constructor(w.array.slice(0,o*w.itemSize),w.itemSize,w.normalized)),_ in c)for(let S=0;S<c[_].length;S++){const C=c[_][S];g.morphAttributes[_][S]=new C.constructor(C.array.slice(0,o*C.itemSize),C.itemSize,C.normalized)}}return g.setIndex(u),g}function LL(i,e){if(e===uF)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===o_||e===eA){let t=i.getIndex();if(t===null){const o=[],a=i.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,r=[];if(e===o_)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}class nr extends Dr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new vJ(t)}),this.register(function(t){return new yJ(t)}),this.register(function(t){return new AJ(t)}),this.register(function(t){return new CJ(t)}),this.register(function(t){return new PJ(t)}),this.register(function(t){return new _J(t)}),this.register(function(t){return new wJ(t)}),this.register(function(t){return new SJ(t)}),this.register(function(t){return new MJ(t)}),this.register(function(t){return new gJ(t)}),this.register(function(t){return new bJ(t)}),this.register(function(t){return new xJ(t)}),this.register(function(t){return new EJ(t)}),this.register(function(t){return new TJ(t)}),this.register(function(t){return new pJ(t)}),this.register(function(t){return new RJ(t)}),this.register(function(t){return new LJ(t)})}load(e,t,n,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=Wc.extractUrlBase(e);o=Wc.resolveURL(c,this.path)}else o=Wc.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Vs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===gz){try{o[en.KHR_BINARY_GLTF]=new DJ(e)}catch(h){r&&r(h);return}s=JSON.parse(o[en.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new jJ(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](c);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const h=s.extensionsUsed[u],f=s.extensionsRequired||[];switch(h){case en.KHR_MATERIALS_UNLIT:o[h]=new mJ;break;case en.KHR_DRACO_MESH_COMPRESSION:o[h]=new IJ(s,this.dracoLoader);break;case en.KHR_TEXTURE_TRANSFORM:o[h]=new UJ;break;case en.KHR_MESH_QUANTIZATION:o[h]=new FJ;break;default:f.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function dJ(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const en={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class pJ{constructor(e){this.parser=e,this.name=en.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new Ge(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],Wi);const h=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new Fi(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Gl(u),c.distance=h;break;case"spot":c=new q0(u),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Ul(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class mJ{constructor(){this.name=en.KHR_MATERIALS_UNLIT}getMaterialType(){return Yt}extendParams(e,t,n){const r=[];e.color=new Ge(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Wi),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,Wt))}return Promise.all(r)}}class gJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class vJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new be(a,a)}return Promise.all(s)}}class yJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class xJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class _J{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ge(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Wi)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Wt)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class wJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class SJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ge().setRGB(a[0],a[1],a[2],Wi),Promise.all(s)}}class MJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class bJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Ge().setRGB(a[0],a[1],a[2],Wi),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Wt)),Promise.all(s)}}class TJ{constructor(e){this.parser=e,this.name=en.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class EJ{constructor(e){this.parser=e,this.name=en.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:gs}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class AJ{constructor(e){this.parser=e,this.name=en.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class CJ{constructor(e){this.parser=e,this.name=en.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class PJ{constructor(e){this.parser=e,this.name=en.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class RJ{constructor(e){this.name=en.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,f=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,h,f,r.mode,r.filter).then(function(p){return p.buffer}):o.ready.then(function(){const p=new ArrayBuffer(u*h);return o.decodeGltfBuffer(new Uint8Array(p),u,h,f,r.mode,r.filter),p})})}else return null}}class LJ{constructor(e){this.name=en.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==zo.TRIANGLES&&c.mode!==zo.TRIANGLE_STRIP&&c.mode!==zo.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),h=u.isGroup?u.children:[u],f=c[0].count,p=[];for(const v of h){const x=new Ze,y=new N,g=new Qt,_=new N(1,1,1),w=new fw(v.geometry,v.material,f);for(let S=0;S<f;S++)l.TRANSLATION&&y.fromBufferAttribute(l.TRANSLATION,S),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,S),l.SCALE&&_.fromBufferAttribute(l.SCALE,S),w.setMatrixAt(S,x.compose(y,g,_));for(const S in l)if(S==="_COLOR_0"){const C=l[S];w.instanceColor=new nu(C.array,C.itemSize,C.normalized)}else S!=="TRANSLATION"&&S!=="ROTATION"&&S!=="SCALE"&&v.geometry.setAttribute(S,l[S]);Kt.prototype.copy.call(w,v),this.parser.assignFinalMaterial(w),p.push(w)}return u.isGroup?(u.clear(),u.add(...p),u):p[0]}))}}const gz="glTF",Hm=12,DL={JSON:1313821514,BIN:5130562};class DJ{constructor(e){this.name=en.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Hm),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==gz)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Hm,s=new DataView(e,Hm);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===DL.JSON){const c=new Uint8Array(e,Hm+o,a);this.content=n.decode(c)}else if(l===DL.BIN){const c=Hm+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class IJ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=en.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const h=l2[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=l2[u]||u.toLowerCase();if(o[u]!==void 0){const f=n.accessors[e.attributes[u]],p=Hd[f.componentType];c[h]=p.name,l[h]=f.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h,f){r.decodeDracoFile(u,function(p){for(const v in p.attributes){const x=p.attributes[v],y=l[v];y!==void 0&&(x.normalized=y)}h(p)},a,c,Wi,f)})})}}class UJ{constructor(){this.name=en.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class FJ{constructor(){this.name=en.KHR_MESH_QUANTIZATION}}class vz extends jp{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=r-t,h=(n-t)/u,f=h*h,p=f*h,v=e*c,x=v-c,y=-2*p+3*f,g=p-f,_=1-y,w=g-f+h;for(let S=0;S!==a;S++){const C=o[x+S+a],E=o[x+S+l]*u,A=o[v+S+a],T=o[v+S]*u;s[S]=_*C+w*E+y*A+g*T}return s}}const kJ=new Qt;class NJ extends vz{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return kJ.fromArray(s).normalize().toArray(s),s}}const zo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Hd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},IL={9728:wn,9729:gn,9984:J_,9985:kd,9986:yh,9987:uo},UL={33071:ds,33648:dp,10497:xn},WM={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},l2={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Mc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},OJ={CUBICSPLINE:void 0,LINEAR:mp,STEP:pp},jM={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function zJ(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new hn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:wo})),i.DefaultMaterial}function $u(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Ul(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function BJ(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(h.POSITION!==void 0&&(n=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(n){const f=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):i.attributes.position;o.push(f)}if(r){const f=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):i.attributes.normal;a.push(f)}if(s){const f=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):i.attributes.color;l.push(f)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],f=c[2];return n&&(i.morphAttributes.position=u),r&&(i.morphAttributes.normal=h),s&&(i.morphAttributes.color=f),i.morphTargetsRelative=!0,i})}function HJ(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function GJ(i){let e;const t=i.extensions&&i.extensions[en.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+XM(t.attributes):e=i.indices+":"+XM(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+XM(i.targets[n]);return e}function XM(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function c2(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function VJ(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const WJ=new Ze;class jJ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new dJ,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,s=!1,o=-1;if(typeof navigator<"u"){const a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);r=n&&l?parseInt(l[1],10):-1,s=a.indexOf("Firefox")>-1,o=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||s&&o<98?this.textureLoader=new _i(this.options.manager):this.textureLoader=new lk(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Vs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return $u(s,a,r),Ul(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[en.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(Wc.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=WM[r.type],a=Hd[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new wt(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=WM[r.type],c=Hd[r.componentType],u=c.BYTES_PER_ELEMENT,h=u*l,f=r.byteOffset||0,p=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,v=r.normalized===!0;let x,y;if(p&&p!==h){const g=Math.floor(f/p),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let w=t.cache.get(_);w||(x=new c(a,g*p,r.count*p/u),w=new V0(x,p/u),t.cache.add(_,w)),y=new Ls(w,l,f%p/u,v)}else a===null?x=new c(r.count*l):x=new c(a,f,r.count*l),y=new wt(x,l,v);if(r.sparse!==void 0){const g=WM.SCALAR,_=Hd[r.sparse.indices.componentType],w=r.sparse.indices.byteOffset||0,S=r.sparse.values.byteOffset||0,C=new _(o[1],w,r.sparse.count*g),E=new c(o[2],S,r.sparse.count*l);a!==null&&(y=new wt(y.array.slice(),y.itemSize,y.normalized)),y.normalized=!1;for(let A=0,T=C.length;A<T;A++){const L=C[A];if(y.setX(L,E[A*l]),l>=2&&y.setY(L,E[A*l+1]),l>=3&&y.setZ(L,E[A*l+2]),l>=4&&y.setW(L,E[A*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}y.normalized=v}return y})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const f=(s.samplers||{})[o.sampler]||{};return u.magFilter=IL[f.magFilter]||gn,u.minFilter=IL[f.minFilter]||uo,u.wrapS=UL[f.wrapS]||xn,u.wrapT=UL[f.wrapT]||xn,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const f=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(f),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(f,p){let v=f;t.isImageBitmapLoader===!0&&(v=function(x){const y=new Cn(x);y.needsUpdate=!0,f(y)}),t.load(Wc.resolveURL(h,s.path),v,void 0,p)})}).then(function(h){return c===!0&&a.revokeObjectURL(l),Ul(h,o),h.userData.mimeType=o.mimeType||VJ(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[en.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[en.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[en.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new of,Di.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new vr,Di.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return hn}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[en.KHR_MATERIALS_UNLIT]){const h=r[en.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Ge(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const f=h.baseColorFactor;a.color.setRGB(f[0],f[1],f[2],Wi),a.opacity=f[3]}h.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",h.baseColorTexture,Wt)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=_n);const u=s.alphaMode||jM.OPAQUE;if(u===jM.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===jM.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Yt&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new be(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(s.occlusionTexture!==void 0&&o!==Yt&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Yt){const h=s.emissiveFactor;a.emissive=new Ge().setRGB(h[0],h[1],h[2],Wi)}return s.emissiveTexture!==void 0&&o!==Yt&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Wt)),Promise.all(c).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Ul(h,s),t.associations.set(h,{materials:e}),s.extensions&&$u(r,h,s),h})}createUniqueName(e){const t=cn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[en.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return FL(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=GJ(c),h=r[u];if(h)o.push(h.promise);else{let f;c.extensions&&c.extensions[en.KHR_DRACO_MESH_COMPRESSION]?f=s(c):f=FL(new yt,c,t),r[u]={primitive:c,promise:f},o.push(f)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?zJ(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let p=0,v=u.length;p<v;p++){const x=u[p],y=o[p];let g;const _=c[p];if(y.mode===zo.TRIANGLES||y.mode===zo.TRIANGLE_STRIP||y.mode===zo.TRIANGLE_FAN||y.mode===void 0)g=s.isSkinnedMesh===!0?new hA(x,_):new Ae(x,_),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),y.mode===zo.TRIANGLE_STRIP?g.geometry=LL(g.geometry,eA):y.mode===zo.TRIANGLE_FAN&&(g.geometry=LL(g.geometry,o_));else if(y.mode===zo.LINES)g=new La(x,_);else if(y.mode===zo.LINE_STRIP)g=new Xt(x,_);else if(y.mode===zo.LINE_LOOP)g=new fA(x,_);else if(y.mode===zo.POINTS)g=new ca(x,_);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);Object.keys(g.geometry.morphAttributes).length>0&&HJ(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),Ul(g,s),y.extensions&&$u(r,g,y),t.assignFinalMaterial(g),h.push(g)}for(let p=0,v=h.length;p<v;p++)t.associations.set(h[p],{meshes:e,primitives:p});if(h.length===1)return s.extensions&&$u(r,h[0],s),h[0];const f=new ho;s.extensions&&$u(r,f,s),t.associations.set(f,{meshes:e});for(let p=0,v=h.length;p<v;p++)f.add(h[p]);return f})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Un(Ai.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new yo(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Ul(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const h=o[c];if(h){a.push(h);const f=new Ze;s!==null&&f.fromArray(s.array,c*16),l.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new W0(a,l)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let h=0,f=r.channels.length;h<f;h++){const p=r.channels[h],v=r.samplers[p.sampler],x=p.target,y=x.node,g=r.parameters!==void 0?r.parameters[v.input]:v.input,_=r.parameters!==void 0?r.parameters[v.output]:v.output;x.node!==void 0&&(o.push(this.getDependency("node",y)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",_)),c.push(v),u.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(h){const f=h[0],p=h[1],v=h[2],x=h[3],y=h[4],g=[];for(let _=0,w=f.length;_<w;_++){const S=f[_],C=p[_],E=v[_],A=x[_],T=y[_];if(S===void 0)continue;S.updateMatrix&&S.updateMatrix();const L=n._createAnimationTracks(S,C,E,A,T);if(L)for(let M=0;M<L.length;M++)g.push(L[M])}return new xp(s,void 0,g)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(n.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],h=c[1],f=c[2];f!==null&&u.traverse(function(p){p.isSkinnedMesh&&p.bind(f,WJ)});for(let p=0,v=h.length;p<v;p++)u.add(h[p]);return u})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new hw:c.length>1?u=new ho:c.length===1?u=c[0]:u=new Kt,u!==c[0])for(let h=0,f=c.length;h<f;h++)u.add(c[h]);if(s.name&&(u.userData.name=s.name,u.name=o),Ul(u,s),s.extensions&&$u(n,u,s),s.matrix!==void 0){const h=new Ze;h.fromArray(s.matrix),u.applyMatrix4(h)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new ho;n.name&&(s.name=r.createUniqueName(n.name)),Ul(s,n),n.extensions&&$u(t,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,h=l.length;u<h;u++)s.add(l[u]);const c=u=>{const h=new Map;for(const[f,p]of r.associations)(f instanceof Di||f instanceof Cn)&&h.set(f,p);return u.traverse(f=>{const p=r.associations.get(f);p!=null&&h.set(f,p)}),h};return r.associations=c(s),s})}_createAnimationTracks(e,t,n,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];Mc[s.path]===Mc.weights?e.traverse(function(f){f.morphTargetInfluences&&l.push(f.name?f.name:f.uuid)}):l.push(a);let c;switch(Mc[s.path]){case Mc.weights:c=Xh;break;case Mc.rotation:c=Yh;break;case Mc.position:case Mc.scale:c=qh;break;default:switch(n.itemSize){case 1:c=Xh;break;case 2:case 3:default:c=qh;break}break}const u=r.interpolation!==void 0?OJ[r.interpolation]:mp,h=this._getArrayFromAccessor(n);for(let f=0,p=l.length;f<p;f++){const v=new c(l[f]+"."+Mc[s.path],t.array,h,u);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(v),o.push(v)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=c2(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const r=this instanceof Yh?NJ:vz;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function XJ(i,e,t){const n=e.attributes,r=new vn;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new N(l[0],l[1],l[2]),new N(c[0],c[1],c[2])),a.normalized){const u=c2(Hd[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new N,l=new N;for(let c=0,u=s.length;c<u;c++){const h=s[c];if(h.POSITION!==void 0){const f=t.json.accessors[h.POSITION],p=f.min,v=f.max;if(p!==void 0&&v!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(v[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(v[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(v[2]))),f.normalized){const x=c2(Hd[f.componentType]);l.multiplyScalar(x)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new Li;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function FL(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=l2[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return on.workingColorSpace!==Wi&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${on.workingColorSpace}" not supported.`),Ul(i,e),XJ(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?BJ(i,e.targets,t):i})}const YM=new WeakMap;class ir extends Dr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new Vs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},n,r)}parse(e,t,n=()=>{}){this.decodeDracoFile(e,t,null,null,Wt,n).catch(n)}decodeDracoFile(e,t,n,r,s=Wi,o=()=>{}){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:s};return this.decodeGeometry(e,a).then(t).catch(o)}decodeGeometry(e,t){const n=JSON.stringify(t);if(YM.has(e)){const l=YM.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,u)=>{r._callbacks[s]={resolve:c,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),YM.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new yt;e.index&&t.setIndex(new wt(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,a=r.itemSize,l=new wt(o,a);s==="color"&&(this._assignVertexColorSpace(l,r.vertexColorSpace),l.normalized=!(o instanceof Float32Array)),t.setAttribute(s,l)}return t}_assignVertexColorSpace(e,t){if(t!==Wt)return;const n=new Ge;for(let r=0,s=e.count;r<s;r++)n.fromBufferAttribute(e,r),on.toWorkingColorSpace(n,Wt),e.setXYZ(r,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new Vs(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=YJ.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function YJ(){let i,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(u){i.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(i)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const h=u.draco,f=new h.Decoder;try{const p=t(h,f,new Int8Array(l),c),v=p.attributes.map(x=>x.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{h.destroy(f)}});break}};function t(o,a,l,c){const u=c.attributeIDs,h=c.attributeTypes;let f,p;const v=a.GetEncodedGeometryType(l);if(v===o.TRIANGULAR_MESH)f=new o.Mesh,p=a.DecodeArrayToMesh(l,l.byteLength,f);else if(v===o.POINT_CLOUD)f=new o.PointCloud,p=a.DecodeArrayToPointCloud(l,l.byteLength,f);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||f.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());const x={index:null,attributes:[]};for(const y in u){const g=self[h[y]];let _,w;if(c.useUniqueIDs)w=u[y],_=a.GetAttributeByUniqueId(f,w);else{if(w=a.GetAttributeId(f,o[u[y]]),w===-1)continue;_=a.GetAttribute(f,w)}const S=r(o,a,f,y,g,_);y==="color"&&(S.vertexColorSpace=c.vertexColorSpace),x.attributes.push(S)}return v===o.TRIANGULAR_MESH&&(x.index=n(o,a,f)),o.destroy(f),x}function n(o,a,l){const u=l.num_faces()*3,h=u*4,f=o._malloc(h);a.GetTrianglesUInt32Array(l,h,f);const p=new Uint32Array(o.HEAPF32.buffer,f,u).slice();return o._free(f),{array:p,itemSize:1}}function r(o,a,l,c,u,h){const f=h.num_components(),v=l.num_points()*f,x=v*u.BYTES_PER_ELEMENT,y=s(o,u),g=o._malloc(x);a.GetAttributeDataArrayForAllPoints(l,h,y,x,g);const _=new u(o.HEAPF32.buffer,g,v).slice();return o._free(g),{name:c,array:_,itemSize:f}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var js,yz,xz,_z,wz,Sz,Mz,tU;let qJ=(tU=class extends Dt{constructor(){super(...arguments);st(this,js);oe(this,"timer");oe(this,"foxMixer",null);oe(this,"hasAnimation",!0)}get number(){return"21"}get title(){return"Imported models"}get link(){return"https://threejs-journey.com/lessons/imported-models"}update(t){this.timer.update(t),this.control.update(),this.foxMixer&&this.foxMixer.update(this.timer.getDelta())}init(){super.init(),W(this,js,wz).call(this),W(this,js,Mz).call(this),W(this,js,Sz).call(this),W(this,js,_z).call(this),W(this,js,yz).call(this),W(this,js,xz).call(this)}},js=new WeakSet,yz=function(){this.camera.fov=75,this.camera.near=.1,this.camera.far=100,this.camera.position.set(3,3,8)},xz=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji},_z=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/Duck/glTF-Draco/Duck.gltf",r=>{r.scene.position.set(3,0,3),this.scene.add(r.scene)}),t.load("/three.js-journey/media/models/FlightHelmet/glTF/FlightHelmet.gltf",r=>{r.scene.position.set(-3,0,-3),r.scene.scale.set(4,4,4),this.scene.add(r.scene)}),t.load("/three.js-journey/media/models/Fox/glTF/Fox.gltf",r=>{r.scene.scale.set(.025,.025,.025),this.scene.add(r.scene),this.foxMixer=new LA(r.scene),this.foxMixer.clipAction(r.animations[2]).play()})},wz=function(){this.timer=new qp},Sz=function(){const t=new Ot(10,10,10),n=new hn({roughness:.3,metalness:.7}),r=new Ae(t,n);r.rotation.x=-Math.PI/2,this.scene.add(r)},Mz=function(){const t=new nc(16777215,1);this.scene.add(t);const n=new Fi(16777215,3);n.position.set(3,3,0),n.castShadow=!0,n.shadow.mapSize.set(1024,1024),n.shadow.camera.far=15,n.shadow.camera.left=-7,n.shadow.camera.top=7,n.shadow.camera.right=7,n.shadow.camera.bottom=-7,this.scene.add(n)},tU);var sp,Xs,bz,Tz,Ez,Az,Cz,Pz,nU;let KJ=(nU=class extends Dt{constructor(){super(...arguments);st(this,Xs);oe(this,"raycaster");oe(this,"objs",[]);oe(this,"hasAnimation",!0);oe(this,"cursor");st(this,sp)}get number(){return"22"}get title(){return"Raycaster and Mouse Events"}get link(){return"https://threejs-journey.com/lessons/raycaster-and-mouse-events"}update(t){const n=t*.001;for(let s=0;s<this.objs.length;s++){const o=this.objs[s];o.position.y=Math.sin(n+s*10)*3,o.scale.set(1,1,1),o.material.color.set(16777215),o.name==="duck"&&o.scale.set(.008,.008,.008)}this.raycaster.setFromCamera(this.cursor,this.camera);const r=this.raycaster.intersectObjects(this.objs);for(const s of r){const o=s.object;o.scale.set(1.2,1.2,1.2),o.material.color.set(14824424),o.name==="duck"&&o.scale.set(.0085,.0085,.0085)}this.control.update()}init(){super.init(),W(this,Xs,Az).call(this),W(this,Xs,Ez).call(this),W(this,Xs,bz).call(this),W(this,Xs,Cz).call(this),W(this,Xs,Pz).call(this)}dispose(){this.canvas.removeEventListener("mousemove",gt(this,sp)),this.raycaster=null,super.dispose()}},sp=new WeakMap,Xs=new WeakSet,bz=function(){this.raycaster=new Yp(new N(0,0,0),new N(0,0,0)),this.cursor=new be(0,0),Ln(this,sp,W(this,Xs,Tz).bind(this)),this.canvas.addEventListener("mousemove",gt(this,sp))},Tz=function(t){this.cursor.x=(t.offsetX/this.canvas.width-.5)*2,this.cursor.y=-((t.offsetY/this.canvas.height-.5)*2)},Ez=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n);const r=1,s=new Lr(r);for(let o=0;o<3;o++){if(o===1)continue;const a=new hn({metalness:.7,roughness:.3}),l=new Ae(s,a);l.castShadow=!0,l.receiveShadow=!0,l.position.set(-3+o*r*3,0,0),this.objs.push(l),this.scene.add(l)}t.load("/three.js-journey/media/models/Duck/glTF-Draco/Duck.gltf",o=>{const a=o.scene.children[0].children[0];a.name="duck",a.scale.set(.008,.008,.008),a.rotation.y=-Math.PI/2,this.scene.add(a),this.objs.push(a)})},Az=function(){const t=new nc(16777215,.9);this.scene.add(t);const n=new Fi(16777215,3);n.position.set(5,5,0),n.castShadow=!0,n.shadow.mapSize.set(1024,1024),n.shadow.camera.top=2,n.shadow.camera.bottom=-2,n.shadow.camera.right=2,n.shadow.camera.left=-2,n.shadow.camera.far=10,this.scene.add(n)},Cz=function(){this.camera.position.z=5},Pz=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji},nU);var oa,Rz,Lz,Dz,Iz,Uz,iU;let ZJ=(iU=class extends Dt{constructor(){super(...arguments);st(this,oa);oe(this,"hasAnimation",!0)}get number(){return"23"}get title(){return"Custom models with Blender"}get link(){return"https://threejs-journey.com/lessons/custom-models-with-blender"}update(){this.control.update()}init(){super.init(),W(this,oa,Iz).call(this),W(this,oa,Uz).call(this),W(this,oa,Dz).call(this),W(this,oa,Rz).call(this),W(this,oa,Lz).call(this)}},oa=new WeakSet,Rz=function(){this.camera.position.set(2,2,4)},Lz=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji},Dz=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/Hamburger/hamburger.glb",r=>{r.scene.scale.set(.15,.15,.15),this.scene.add(r.scene)})},Iz=function(){const t=new nc(16777215,1);this.scene.add(t);const n=new Fi(16777215,3);n.position.set(-5,3,0),n.castShadow=!0,n.shadow.mapSize.set(1024,1024),n.shadow.camera.top=3,n.shadow.camera.bottom=-3,n.shadow.camera.right=3,n.shadow.camera.left=-3,n.shadow.camera.far=8,this.scene.add(n)},Uz=function(){const t=new Ot(5,5),n=new hn,r=new Ae(t,n);r.rotation.x=-Math.PI/2,r.receiveShadow=!0,this.scene.add(r)},iU);var Ys,Fz,kz,Nz,Oz,zz,Bz,rU;let QJ=(rU=class extends Dt{constructor(){super(...arguments);st(this,Ys);oe(this,"cubeCamera");oe(this,"holyDonut");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"24"}get title(){return"Environment map"}get link(){return"https://threejs-journey.com/lessons/environment-map"}update(t){this.control.update();const n=t*.001;this.holyDonut.rotation.x=Math.abs(Math.cos(n*.5))*Math.PI,this.cubeCamera.update(this.renderer,this.scene)}init(){super.init(),W(this,Ys,Nz).call(this),W(this,Ys,Bz).call(this),W(this,Ys,zz).call(this),W(this,Ys,Oz).call(this),W(this,Ys,kz).call(this),W(this,Ys,Fz).call(this)}},Ys=new WeakSet,Fz=function(){this.camera.position.set(1,1,6)},kz=function(){const t=this.guiControl.addFolder("Environment");t.add(this.scene,"environmentIntensity").min(0).max(10).step(.01).name("intensity"),t.add(this.scene.environmentRotation,"y").min(0).max(2*Math.PI).step(.01).name("rotation");const n=this.guiControl.addFolder("Background");n.add(this.scene,"backgroundIntensity").min(0).max(10).step(.01).name("intensity"),n.add(this.scene,"backgroundBlurriness").min(0).max(1).step(.01).name("blurriness"),n.add(this.scene.backgroundRotation,"y").min(0).max(2*Math.PI).step(.01).name("rotation")},Nz=function(){const n=new _i().load("/three.js-journey/media/images/environmentMaps/blockadesLabsSkybox/interior_views_cozy_wood_cabin_with_cauldron_and_p.jpg");n.colorSpace=Wt,n.mapping=Ca,this.scene.background=n;const r=new aA(64,{type:Zi});this.cubeCamera=new oA(.1,100,r),this.cubeCamera.layers.set(1),this.scene.environment=r.texture},Oz=function(){this.holyDonut=new Ae(new fo(4,.2),new Yt({color:new Ge(10,4,2)})),this.holyDonut.layers.enable(1),this.scene.add(this.holyDonut)},zz=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/FlightHelmet/glTF/FlightHelmet.gltf",r=>{r.scene.scale.set(3,3,3),r.scene.position.set(0,-1,0),this.scene.add(r.scene)})},Bz=function(){const t=new Ae(new fl(.5,.2),new hn({metalness:1,roughness:0,color:11184810}));t.position.set(-2,0,0),this.scene.add(t)},rU);var ji,Hz,Gz,Vz,Wz,jz,Xz,Yz,qz,Kz,sU;let JJ=(sU=class extends Dt{constructor(){super(...arguments);st(this,ji);oe(this,"directionalLight");oe(this,"textureLoader");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"25"}get title(){return"Realistic render"}get link(){return"https://threejs-journey.com/lessons/realistic-render"}update(){this.control.update()}init(){super.init(),W(this,ji,Vz).call(this),W(this,ji,Kz).call(this),W(this,ji,jz).call(this),W(this,ji,qz).call(this),W(this,ji,Yz).call(this),W(this,ji,Xz).call(this),W(this,ji,Hz).call(this),W(this,ji,Gz).call(this),W(this,ji,Wz).call(this)}},ji=new WeakSet,Hz=function(){this.camera.position.set(2,2,4)},Gz=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.toneMapping=ta,this.renderer.toneMappingExposure=1.5},Vz=function(){this.textureLoader=new _i},Wz=function(){this.guiControl.add(this.scene,"environmentIntensity").min(0).max(10).step(.01),this.guiControl.add(this.renderer,"toneMapping",{No:Ta,Linear:GE,Reinhard:Bp,Cineon:VE,ACESFilmic:ta}),this.guiControl.add(this.renderer,"toneMappingExposure").min(0).max(10).step(.01);const t=this.guiControl.addFolder("Light");t.add(this.directionalLight,"intensity").min(0).max(20).step(.01),t.add(this.directionalLight.position,"x").min(-10).max(10).step(.01),t.add(this.directionalLight.position,"y").min(-10).max(10).step(.01),t.add(this.directionalLight.position,"z").min(-10).max(10).step(.01),t.add(this.directionalLight.shadow,"bias").min(-.05).max(.05).step(.001),t.add(this.directionalLight.shadow,"normalBias").min(-.05).max(.05).step(.001)},jz=function(){this.directionalLight=new Fi(16777215,3),this.directionalLight.position.set(-8.5,4.27,3),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.set(512,512),this.directionalLight.shadow.camera.far=15,this.directionalLight.shadow.bias=-.011,this.directionalLight.shadow.normalBias=.009,this.directionalLight.target.position.set(0,.25,0),this.directionalLight.target.updateWorldMatrix(),this.scene.add(this.directionalLight)},Xz=function(){const t=this.textureLoader.load("/three.js-journey/media/images/textures/castle/castle_diff.jpg"),n=this.textureLoader.load("/three.js-journey/media/images/textures/castle/castle_arm.jpg"),r=this.textureLoader.load("/three.js-journey/media/images/textures/castle/castle_nor.png");t.colorSpace=Wt;const s=new Ae(new Ot(3,3),new hn({map:t,normalMap:r,aoMap:n,roughnessMap:n,metalnessMap:n}));s.position.set(0,1.5,-1.5),s.receiveShadow=!0,this.scene.add(s)},Yz=function(){const t=this.textureLoader.load("/three.js-journey/media/images/textures/wood/wood_diff.jpg"),n=this.textureLoader.load("/three.js-journey/media/images/textures/wood/wood_arm.jpg"),r=this.textureLoader.load("/three.js-journey/media/images/textures/wood/wood_nor.png");t.colorSpace=Wt;const s=new Ae(new Ot(3,3),new hn({map:t,normalMap:r,aoMap:n,metalnessMap:n,roughnessMap:n}));s.rotation.x=-Math.PI/2,s.receiveShadow=!0,this.scene.add(s)},qz=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/Hamburger/hamburger.glb",r=>{r.scene.scale.set(.15,.15,.15),r.scene.children.forEach(s=>{s.castShadow=!0,s.receiveShadow=!0}),this.scene.add(r.scene)})},Kz=function(){new Z0().load("/three.js-journey/media/images/environmentMaps/0/2k.hdr",n=>{n.mapping=Ca,this.scene.environment=n,this.scene.background=n})},sU);var jn,Zz,Qz,Jz,$z,eB,tB,nB,iB,rB,vg,oU;let $J=(oU=class extends Dt{constructor(){super(...arguments);st(this,jn);oe(this,"animation",null);oe(this,"currentAction",null);oe(this,"actions",[]);oe(this,"timer");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"26"}get title(){return"Code structuring for bigger projects"}get link(){return"https://threejs-journey.com/lessons/code-structuring-for-bigger-projects"}update(t){this.timer.update(t),this.animation&&this.animation.update(this.timer.getDelta()),this.control.update()}init(){super.init(),W(this,jn,Jz).call(this),W(this,jn,rB).call(this),W(this,jn,$z).call(this),W(this,jn,tB).call(this),W(this,jn,eB).call(this),W(this,jn,Qz).call(this),W(this,jn,Zz).call(this)}},jn=new WeakSet,Zz=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.toneMapping=ta},Qz=function(){this.camera.position.set(3,2,3)},Jz=function(){this.timer=new qp},$z=function(){const t=new _i,n=t.load("/three.js-journey/media/images/textures/dirt/color.jpg"),r=t.load("/three.js-journey/media/images/textures/dirt/normal.jpg");n.colorSpace=Wt,n.repeat.set(2,2),r.repeat.set(2,2),n.wrapS=xn,n.wrapT=xn,r.wrapS=xn,r.wrapT=xn;const s=new Ae(new X0(2.5),new hn({map:n,normalMap:r}));s.rotation.x=-Math.PI/2,s.receiveShadow=!0,this.scene.add(s)},eB=function(){const t=new cf;this.scene.environment=t.load(["/three.js-journey/media/images/environmentMaps/3/px.jpg","/three.js-journey/media/images/environmentMaps/3/nx.jpg","/three.js-journey/media/images/environmentMaps/3/py.jpg","/three.js-journey/media/images/environmentMaps/3/ny.jpg","/three.js-journey/media/images/environmentMaps/3/pz.jpg","/three.js-journey/media/images/environmentMaps/3/nz.jpg"])},tB=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/Fox/glTF/Fox.gltf",r=>{r.scene.scale.set(.015,.015,.015),r.scene.traverse(s=>{s.isMesh&&(s.castShadow=!0,s.receiveShadow=!0)}),this.scene.add(r.scene),W(this,jn,nB).call(this,r.scene,r.animations),W(this,jn,vg).call(this,"survey"),W(this,jn,iB).call(this)})},nB=function(t,n){this.animation=new LA(t),this.actions.survey=this.animation.clipAction(n[0]),this.actions.walk=this.animation.clipAction(n[1]),this.actions.run=this.animation.clipAction(n[2])},iB=function(){const t=this.guiControl.addFolder("Fox");t.add({survey:()=>{W(this,jn,vg).call(this,"survey")}},"survey"),t.add({walk:()=>{W(this,jn,vg).call(this,"walk")}},"walk"),t.add({run:()=>{W(this,jn,vg).call(this,"run")}},"run")},rB=function(){const t=new Fi(16777215,3);t.position.set(3,2,0),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.camera.far=10,this.scene.add(t)},vg=function(t){const n=this.actions[t];n==null||n.reset(),n==null||n.play(),this.currentAction&&(n==null||n.crossFadeFrom(this.currentAction,1)),this.currentAction=n},oU);var e$=`uniform vec2 uFrequency;
uniform float uTime;

varying vec2 vUv;
varying float vElevation;

void main() {
    vec4 modelPosition  = modelMatrix * vec4(position, 1.0);

    vElevation       = sin(modelPosition.x * uFrequency.x - uTime) * 0.1;
    vElevation      += sin(modelPosition.y * uFrequency.y - uTime) * 0.1;
    modelPosition.z += vElevation;

    vec4 viewPosition      = viewMatrix * modelPosition;
    vec4 projectedPosition = projectionMatrix * viewPosition;

    gl_Position = projectedPosition;

    vUv = uv;
}`,t$=`uniform sampler2D uTexture;
varying vec2 vUv;
varying float vElevation;

void main() {
    vec4 texture = texture2D(uTexture, vUv);
    vec3 color   = texture.rgb * (vElevation + 0.3) * (1.0 / 0.6);
    gl_FragColor = vec4(color, 1);
}`;const n$="/three.js-journey/assets/argentinian-flag-YNgkmkdk.png";var kp,sB,oB,aU;let i$=(aU=class extends Dt{constructor(){super(...arguments);st(this,kp);oe(this,"material");oe(this,"hasAnimation",!0)}get number(){return"27"}get title(){return"Shaders"}get link(){return"https://threejs-journey.com/lessons/shaders"}update(t){this.material.uniforms.uTime.value=t*.001,this.control.update()}init(){super.init(),W(this,kp,sB).call(this),W(this,kp,oB).call(this)}},kp=new WeakSet,sB=function(){const n=new _i().load(n$),r=new Ot(2,2,64,64);this.material=new Ft({vertexShader:e$,fragmentShader:t$,uniforms:{uFrequency:{value:new be(10,5)},uTime:{value:0},uTexture:{value:n}}});const s=new Ae(r,this.material);s.scale.y=2/3,this.scene.add(s)},oB=function(){const t=this.guiControl.addFolder("Frequency");t.add(this.material.uniforms.uFrequency.value,"x").min(0).max(20),t.add(this.material.uniforms.uFrequency.value,"y").min(0).max(20)},aU);var r$=`varying vec2 vUv;

void main() {
    gl_Position =
    projectionMatrix *
    viewMatrix       *
    modelMatrix      *
    vec4(position, 1.0);

    vUv = uv;
}`,s$=`#define PI 3.1415926535897932384626433832795

varying vec2 vUv;

vec2 rotate(vec2 uv, float rotation, vec2 mid) {
    return vec2(
    cos(rotation) * (uv.x - mid.x) + sin(rotation) * (uv.y - mid.y) + mid.x,
    cos(rotation) * (uv.y - mid.y) - sin(rotation) * (uv.x - mid.x) + mid.y
    );
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}
vec2 _fade(vec2 t) {
    return t*t*t*(t*(t*6.0-15.0)+10.0);
}

vec4 _permute(vec4 x) {
    return mod(((x*34.0)+1.0)*x, 289.0);
}

float cnoise(vec2 P) {
    vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);
    vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);
    Pi = mod(Pi, 289.0);
    vec4 ix = Pi.xzxz;
    vec4 iy = Pi.yyww;
    vec4 fx = Pf.xzxz;
    vec4 fy = Pf.yyww;
    vec4 i = _permute(_permute(ix) + iy);
    vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0;
    vec4 gy = abs(gx) - 0.5;
    vec4 tx = floor(gx + 0.5);
    gx = gx - tx;
    vec2 g00 = vec2(gx.x,gy.x);
    vec2 g10 = vec2(gx.y,gy.y);
    vec2 g01 = vec2(gx.z,gy.z);
    vec2 g11 = vec2(gx.w,gy.w);
    vec4 norm = 1.79284291400159 - 0.85373472095314 *
    vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));
    g00 *= norm.x;
    g01 *= norm.y;
    g10 *= norm.z;
    g11 *= norm.w;
    float n00 = dot(g00, vec2(fx.x, fy.x));
    float n10 = dot(g10, vec2(fx.y, fy.y));
    float n01 = dot(g01, vec2(fx.z, fy.z));
    float n11 = dot(g11, vec2(fx.w, fy.w));
    vec2 fade_xy = _fade(Pf.xy);
    vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);
    float n_xy = mix(n_x.x, n_x.y, fade_xy.y);
    return 2.3 * n_xy;
}

void main() {
    float strength  = step(0.9, sin(cnoise(vUv * 10.0) * 20.0));
    strength        = clamp(strength, 0.0, 1.0);
    vec3 blackColor = vec3(0.0);
    vec3 uvColor    = vec3(vUv, 1.0);
    vec3 mixedColor = mix(blackColor, uvColor, strength);

    gl_FragColor = vec4(mixedColor, 1.0);
}`,Z_,aB,lU;let o$=(lU=class extends Dt{constructor(){super(...arguments);st(this,Z_);oe(this,"hasAnimation",!0)}get number(){return"28"}get title(){return"Shader patterns"}get link(){return"https://threejs-journey.com/lessons/shader-patterns"}update(){this.control.update()}init(){super.init(),W(this,Z_,aB).call(this)}},Z_=new WeakSet,aB=function(){const t=new Ot(2,2,64,64),n=new Ft({vertexShader:r$,fragmentShader:s$,side:_n}),r=new Ae(t,n);this.scene.add(r)},lU);var a$=`#define PI 3.1415926535897932384626433832795

uniform float uTime;
uniform float uSmallWaveElevation;
uniform float uSmallWaveSpeed;
uniform float uSmallWaveFrequency;
uniform float uSmallWaveIteration;
uniform float uBigWaveElevation;
uniform float uBigWaveSpeed;
uniform vec2  uBigWaveFrequency;

varying float vElevation;
varying float vBigWaveElevation;

vec4 _permute(vec4 x) {
    return mod(((x*34.0)+1.0)*x, 289.0);
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 _fade(vec3 t) {
    return t*t*t*(t*(t*6.0-15.0)+10.0);
}

float cnoise(vec3 P) {
    vec3 Pi0 = floor(P);
    vec3 Pi1 = Pi0 + vec3(1.0);
    Pi0 = mod(Pi0, 289.0);
    Pi1 = mod(Pi1, 289.0);
    vec3 Pf0 = fract(P);
    vec3 Pf1 = Pf0 - vec3(1.0);
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;

    vec4 ixy = _permute(_permute(ix) + iy);
    vec4 ixy0 = _permute(ixy + iz0);
    vec4 ixy1 = _permute(ixy + iz1);

    vec4 gx0 = ixy0 / 7.0;
    vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);

    vec4 gx1 = ixy1 / 7.0;
    vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);

    vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
    vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
    vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
    vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
    vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
    vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
    vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
    vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

    vec4 norm0 = _taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = _taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;

    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);

    vec3 fade_xyz = _fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float cwave(
    float position,
    float frequency,
    float uBigWaveSpeed,
    float uTime
) {
    return sin(position * 2.0 * PI * frequency + uTime * uBigWaveSpeed);
}

void main() {
    vec4 modelPosition  = modelMatrix * vec4(position, 1.0);

    float elevation = cwave(
        modelPosition.x,
        uBigWaveFrequency.x,
        uBigWaveSpeed,
        uTime
    ) * cwave(
        modelPosition.z,
        uBigWaveFrequency.y,
        uBigWaveSpeed,
        uTime
    ) * uBigWaveElevation;

    for (float i = 1.0; i <= uSmallWaveIteration; i++) {
        float noiseElevation = cnoise(
            vec3(
                modelPosition.xz * uSmallWaveFrequency * i,
                uTime * uSmallWaveSpeed
            )
        ) * uSmallWaveElevation / i;
        elevation -= abs(noiseElevation);
    }

    modelPosition.y += elevation;

    vec4 viewPosition      = viewMatrix * modelPosition;
    vec4 projectedPosition = projectionMatrix * viewPosition;
    gl_Position            = projectedPosition;

    vElevation        = elevation;
    vBigWaveElevation = uBigWaveElevation;
}`,l$=`uniform vec3 uDepthColor;
uniform vec3 uSurfaceColor;

varying float vElevation;
varying float vBigWaveElevation;

void main() {
    float strength = ((vElevation / vBigWaveElevation) + 1.0) / 2.0;
    vec3 color     = mix(uDepthColor, uSurfaceColor, strength);
    gl_FragColor   = vec4(color, 1.0);

    #include <colorspace_fragment>
}`,Bn,lB,cB,uB,u2,hB,hh,r1,fB,cU;let c$=(cU=class extends Dt{constructor(){super(...arguments);st(this,Bn);oe(this,"mesh");oe(this,"timer");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"29"}get title(){return"Raging sea"}get link(){return"https://threejs-journey.com/lessons/raging-sea"}update(t){this.timer.update(t),this.control.update(),this.mesh.material.uniforms.uTime.value=this.timer.getElapsed()}init(){super.init(),W(this,Bn,uB).call(this),W(this,Bn,cB).call(this),W(this,Bn,lB).call(this),W(this,Bn,fB).call(this)}dispose(){super.dispose(),this.timer.dispose(),this.timer=null}},Bn=new WeakSet,lB=function(){const t=this.guiControl.addFolder("Small Waves"),n=this.guiControl.addFolder("Big Waves"),r=n.addFolder("Frequency");W(this,Bn,hh).call(this,t,"uSmallWaveElevation",0,4,.001),W(this,Bn,hh).call(this,t,"uSmallWaveFrequency",0,10,.001),W(this,Bn,hh).call(this,t,"uSmallWaveSpeed",0,5,.001),W(this,Bn,hh).call(this,t,"uSmallWaveIteration",0,5,1),W(this,Bn,hh).call(this,n,"uBigWaveElevation",0,4,.001),W(this,Bn,hB).call(this,r,"uBigWaveFrequency",0,4,.001),W(this,Bn,hh).call(this,n,"uBigWaveSpeed",0,10,.001),W(this,Bn,u2).call(this,this.guiControl,"uDepthColor"),W(this,Bn,u2).call(this,this.guiControl,"uSurfaceColor")},cB=function(){this.mesh=new Ae(new Ot(4,4,512,512),new Ft({vertexShader:a$,fragmentShader:l$,uniforms:{uTime:{value:0},uBigWaveElevation:{value:.3},uBigWaveFrequency:{value:new be(.5,.3)},uBigWaveSpeed:{value:1.5},uSmallWaveElevation:{value:.2},uSmallWaveFrequency:{value:3},uSmallWaveSpeed:{value:.3},uSmallWaveIteration:{value:3},uDepthColor:{value:new Ge(1599121)},uSurfaceColor:{value:new Ge(10213631)}}})),this.mesh.rotation.x=-Math.PI/2,this.scene.add(this.mesh)},uB=function(){this.timer=new qp},u2=function(t,n){const r=this.mesh.material.uniforms[n].value;t.addColor({color:r.getHexString()},"color").onChange(s=>{r.set(s)}).name(n)},hB=function(t,n,r,s,o){W(this,Bn,r1).call(this,t,this.mesh.material.uniforms[n].value,"x",r,s,o,"x"),W(this,Bn,r1).call(this,t,this.mesh.material.uniforms[n].value,"y",r,s,o,"y")},hh=function(t,n,r,s,o){W(this,Bn,r1).call(this,t,this.mesh.material.uniforms[n],"value",r,s,o,n)},r1=function(t,n,r,s,o,a,l){t.add(n,r).min(s).max(o).step(a).name(l)},fB=function(){this.camera.position.set(3,3,1)},cU);var u$=`uniform float uTime;
uniform float uSize;

attribute vec3  aOffset;
attribute float aScale;

varying vec3 vColor;

void main() {
    vec4 modelPosition  = modelMatrix * vec4(position, 1.0);
    float radius        = length(modelPosition.xyz);
    float angle         = atan(modelPosition.z, modelPosition.x);
    float angleOffset   = (1.0 / radius) * 0.2 * uTime;
    angle              += angleOffset;
    modelPosition.x     = cos(angle) * radius;
    modelPosition.z     = sin(angle) * radius;
    modelPosition.xyz  += aOffset;

    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position  = projectionPosition;
    gl_PointSize = uSize * aScale;
    gl_PointSize *= (1.0 / -viewPosition.z);

    vColor = color;
}`,h$=`varying vec3 vColor;

void main() {
    float strength = 1.0 - (distance(vec2(0.5), gl_PointCoord) * 2.0);
    strength = pow(strength, 10.0);
    vec3 mixedColor = mix(vec3(0.0), vColor, strength);
    gl_FragColor = vec4(mixedColor, 1.0);
    #include <colorspace_fragment>
}`,yn,dB,h2,pB,mB,gB,vB,f2,d2,fh,p2,uU;let f$=(uU=class extends Dt{constructor(){super(...arguments);st(this,yn);oe(this,"galaxy");oe(this,"galaxyMaterial");oe(this,"galaxyGeometry");oe(this,"galaxyParams",{particles:3e4,particleSize:50,particleOffset:.3,branches:7,radius:6,gravityStrength:5,innerColor:"#ff6030",outerColor:"#1b3984"});oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"30"}get title(){return"Animated galaxy"}get link(){return"https://threejs-journey.com/lessons/animated-galaxy"}update(t){this.galaxyMaterial.uniforms.uTime.value=t*.001,this.control.update()}init(){super.init(),W(this,yn,pB).call(this),W(this,yn,h2).call(this),W(this,yn,dB).call(this)}dispose(){W(this,yn,p2).call(this),super.dispose()}},yn=new WeakSet,dB=function(){this.camera.position.set(1,5,10)},h2=function(){W(this,yn,mB).call(this),W(this,yn,gB).call(this),W(this,yn,vB).call(this)},pB=function(){W(this,yn,fh).call(this,"particles",100,1e6,1),W(this,yn,fh).call(this,"particleSize",.01,100,.01),W(this,yn,fh).call(this,"particleOffset",.01,10,.01),W(this,yn,fh).call(this,"branches",1,20,1),W(this,yn,fh).call(this,"radius",1,20,.1),W(this,yn,fh).call(this,"gravityStrength",1,20,1),W(this,yn,d2).call(this,"innerColor"),W(this,yn,d2).call(this,"outerColor")},mB=function(){this.galaxyGeometry=new yt;const t=this.galaxyParams.particles,n=this.galaxyParams.particleOffset,r=this.galaxyParams.branches,s=this.galaxyParams.radius,o=this.galaxyParams.gravityStrength,a=new Ge(this.galaxyParams.innerColor),l=new Ge(this.galaxyParams.outerColor),c=2*Math.PI/r,u=t*3,h=new Float32Array(u),f=new Float32Array(u),p=new Float32Array(u),v=new Float32Array(t);for(let w=0;w<t;w+=1){const S=w*3,C=s*Math.random(),E=Math.pow(Math.random(),o)*Math.pow(-1,Math.round(Math.random()))*C*n,A=Math.pow(Math.random(),o)*Math.pow(-1,Math.round(Math.random()))*C*n,T=Math.pow(Math.random(),o)*Math.pow(-1,Math.round(Math.random()))*C*n;let L=c*(w%r);h[S+0]=Math.cos(L)*C+E,h[S+1]=A,h[S+2]=Math.sin(L)*C+T;const M=new Ge().lerpColors(a,l,C/s);f[S+0]=M.r,f[S+1]=M.g,f[S+2]=M.b,p[S+0]=E,p[S+1]=A,p[S+2]=T,v[w]=Math.random()}const x=new wt(h,3),y=new wt(f,3),g=new wt(p,3),_=new wt(v,1);this.galaxyGeometry.setAttribute("position",x),this.galaxyGeometry.setAttribute("color",y),this.galaxyGeometry.setAttribute("aOffset",g),this.galaxyGeometry.setAttribute("aScale",_)},gB=function(){this.galaxyMaterial=new Ft({depthWrite:!1,vertexColors:!0,blending:ea,vertexShader:u$,fragmentShader:h$,uniforms:{uSize:{value:this.galaxyParams.particleSize*this.renderer.getPixelRatio()},uTime:{value:0}}})},vB=function(){this.galaxy=new ca(this.galaxyGeometry,this.galaxyMaterial),this.scene.add(this.galaxy)},f2=function(t,n){this.galaxyParams[t]=n,W(this,yn,p2).call(this),W(this,yn,h2).call(this)},d2=function(t){this.guiControl.addColor({value:this.galaxyParams[t]},"value").name(t).onFinishChange(n=>{W(this,yn,f2).call(this,t,n)})},fh=function(t,n,r,s){this.guiControl.add({value:this.galaxyParams[t]},"value").min(n).max(r).step(s).name(t).onFinishChange(o=>{W(this,yn,f2).call(this,t,o)})},p2=function(){this.galaxyGeometry.dispose(),this.galaxyMaterial.dispose(),this.scene.remove(this.galaxy),this.galaxyGeometry=null,this.galaxyMaterial=null,this.galaxy=null},uU);var d$=`#include <common>

uniform float uTime;

mat2 get2dRotateMatrix(float angle) {
    return mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
}`,p$=`#include <uv_vertex>
float angle        = sin(position.y + uTime) * 0.4;
mat2  rotateMatrix = get2dRotateMatrix(angle);`,m$=`#include <beginnormal_vertex>
objectNormal.xz = rotateMatrix * objectNormal.xz;`,g$=`#include <begin_vertex>
transformed.xz = rotateMatrix * transformed.xz;`,Cr,yB,m2,xB,_B,wB,SB,MB,hU;let v$=(hU=class extends Dt{constructor(){super(...arguments);st(this,Cr);oe(this,"modelMaterial");oe(this,"modelUniforms",{uTime:{value:0}});oe(this,"customDepthMaterial");oe(this,"hasAnimation",!0)}get number(){return"31"}get title(){return"Modified materials"}get link(){return"https://threejs-journey.com/lessons/modified-materials"}update(t){this.modelUniforms.uTime.value=t*.001,this.control.update()}init(){super.init(),W(this,Cr,xB).call(this),W(this,Cr,_B).call(this),W(this,Cr,SB).call(this),W(this,Cr,MB).call(this),W(this,Cr,wB).call(this)}},Cr=new WeakSet,yB=function(){this.modelMaterial.onBeforeCompile=W(this,Cr,m2).bind(this),this.customDepthMaterial.onBeforeCompile=W(this,Cr,m2).bind(this)},m2=function(t){t.uniforms.uTime=this.modelUniforms.uTime,t.vertexShader=t.vertexShader.replace("#include <common>",d$),t.vertexShader=t.vertexShader.replace("#include <uv_vertex>",p$),t.vertexShader=t.vertexShader.replace("#include <beginnormal_vertex>",m$),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",g$)},xB=function(){const n=new cf().load(["/three.js-journey/media/images/environmentMaps/3/px.jpg","/three.js-journey/media/images/environmentMaps/3/nx.jpg","/three.js-journey/media/images/environmentMaps/3/py.jpg","/three.js-journey/media/images/environmentMaps/3/ny.jpg","/three.js-journey/media/images/environmentMaps/3/pz.jpg","/three.js-journey/media/images/environmentMaps/3/nz.jpg"]);this.scene.background=n,this.scene.environment=n,this.scene.backgroundIntensity=1,this.scene.environmentIntensity=1},_B=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/LeePerrySmith/LeePerrySmith.glb",r=>{const s=new _i,o=s.load("/three.js-journey/media/models/LeePerrySmith/normal.jpg"),a=s.load("/three.js-journey/media/models/LeePerrySmith/color.jpg");a.colorSpace=Wt;const l=r.scene.children[0];l.receiveShadow=!0,l.castShadow=!0,this.modelMaterial=l.material,this.modelMaterial.map=a,this.modelMaterial.normalMap=o,this.customDepthMaterial=new pu({depthPacking:sf}),l.customDepthMaterial=this.customDepthMaterial,this.scene.add(l),W(this,Cr,yB).call(this)})},wB=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=zp,this.renderer.toneMapping=ta,this.renderer.toneMappingExposure=1},SB=function(){const t=new Fi(16777215,3);t.position.set(4,1,0),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.camera.far=15,t.shadow.normalBias=.05,this.scene.add(t)},MB=function(){this.camera.position.set(-1,3,10)},hU);const y$="/three.js-journey/assets/perlin-CqwIJTvm.png",x$="/three.js-journey/assets/bakedModel-EZnnxNa-.glb";var _$=`uniform float     uTime;
uniform sampler2D uPerlinNoiseTexture;

varying vec2 vUv;

vec2 rotate2D(vec2 value, float angle) {
    float s = sin(angle);
    float c = cos(angle);
    mat2 m = mat2(c, s, -s, c);
    return m * value;
}

void main() {
    vec4 modelPosition = modelMatrix * vec4(position, 1.0);

    float rotationNoise = texture(
        uPerlinNoiseTexture,
        vec2(0.5, modelPosition.y * 0.1 - uTime * 0.02)
    ).r;
    float angle      = rotationNoise * 5.0;
    modelPosition.xz = rotate2D(modelPosition.xz, angle);

    float windNoiseX = texture(
        uPerlinNoiseTexture,
        vec2(0.25, uTime * 0.01)
    ).r;
    float windNoiseZ = texture(
        uPerlinNoiseTexture,
        vec2(0.75, uTime * 0.01)
    ).r;
    vec2 windOffset   = vec2(windNoiseX - 0.5, windNoiseZ - 0.5);
    windOffset       *= pow(uv.y, 2.0) * 10.0;
    modelPosition.xz += windOffset;

    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vUv = uv;
}`,w$=`uniform float     uTime;
uniform sampler2D uPerlinNoiseTexture;

varying vec2 vUv;

void main() {
    vec2 smokeUv  = vUv;
    smokeUv.x    *= 0.5;
    smokeUv.y    *= 0.3;
    smokeUv.y    -= uTime * 0.03;
    float smoke   = texture(uPerlinNoiseTexture, smokeUv).r;

    smoke  = smoothstep(0.4, 1.0, smoke);
    smoke *= smoothstep(0.0, 0.1, vUv.x);
    smoke *= smoothstep(1.0, 0.9, vUv.x);
    smoke *= smoothstep(0.0, 0.1, vUv.y);
    smoke *= smoothstep(1.0, 0.4, vUv.y);

    gl_FragColor = vec4(0.6, 0.3, 0.2, smoke);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,hu,bB,TB,EB,fU;let S$=(fU=class extends Dt{constructor(){super(...arguments);st(this,hu);oe(this,"smokeMaterial",null);oe(this,"hasAnimation",!0)}get number(){return"32"}get title(){return"Coffee Smoke"}get link(){return"https://threejs-journey.com/lessons/coffee-smoke-shader"}update(t){this.smokeMaterial&&(this.smokeMaterial.uniforms.uTime.value=t*.001),this.control.update()}init(){super.init(),W(this,hu,TB).call(this),W(this,hu,EB).call(this)}},hu=new WeakSet,bB=function(){const n=new _i().load(y$);n.wrapS=xn,n.wrapT=xn;const r=new Ot(1,1,16,64);this.smokeMaterial=new Ft({transparent:!0,depthWrite:!1,side:_n,vertexShader:_$,fragmentShader:w$,uniforms:{uPerlinNoiseTexture:new We(n),uTime:new We(0)}});const s=new Ae(r,this.smokeMaterial);s.scale.set(1.5,6,1.5),s.position.y=4.83,this.scene.add(s)},TB=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load(x$,r=>{this.scene.add(r.scene),W(this,hu,bB).call(this)})},EB=function(){this.camera.position.set(3,9,6)},fU);var M$=`uniform float uTime;

varying vec3 vModelPosition;
varying vec3 vNormalPosition;

float random2D(vec2 value) {
    return fract(sin(dot(value.xy, vec2(12.9898,78.233))) * 43758.5453123);
}

void main() {
    vec4 normalPosition   = modelMatrix * vec4(normal, 0.0);
    vec4 modelPosition    = modelMatrix * vec4(position, 1.0);
    float glitchFactor    = uTime - modelPosition.y;
    float glitchStrength  = sin(glitchFactor)        +
                            sin(glitchFactor * 3.45) +
                            sin(glitchFactor * 8.76);
    float glitchRandomX   = random2D(modelPosition.xz + uTime) - 0.5;
    float glitchRandomZ   = random2D(modelPosition.zx + uTime) - 0.5;
    glitchStrength       /= 3.0;
    glitchStrength        = smoothstep(0.3, 1.0, glitchStrength);
    glitchStrength       *= 0.25;
    modelPosition.x      += glitchRandomX * glitchStrength;
    modelPosition.z      += glitchRandomZ * glitchStrength;

    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vModelPosition  = modelPosition.xyz;
    vNormalPosition = normalPosition.xyz;
}`,b$=`uniform float uTime;
uniform vec3  uColor;

varying vec3 vModelPosition;
varying vec3 vNormalPosition;

void main() {
    float stripe = mod((vModelPosition.y - (uTime * 0.02)) * 20.0, 1.0);
    stripe       = pow(stripe, 2.0);

    vec3 normal = normalize(vNormalPosition);
    if (!gl_FrontFacing) {
        normal *= -1.0;
    }
    vec3 viewDirection = normalize(vModelPosition - cameraPosition);
    float fresnel      = 1.0 + dot(viewDirection, normal);
    fresnel            = pow(fresnel, 2.0);

    float fallof = smoothstep(0.8, 0.0, fresnel);

    float holographic  = stripe * fresnel;
    holographic       += fresnel * 1.25;
    holographic       *= fallof;

    gl_FragColor = vec4(uColor, holographic);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,ul,AB,CB,PB,RB,dU;let T$=(dU=class extends Dt{constructor(){super(...arguments);st(this,ul);oe(this,"suzanne",null);oe(this,"torusKnot");oe(this,"sphere");oe(this,"material");oe(this,"hologramColor","#70c1ff");oe(this,"backgroundColor","#1d1f2a");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"33"}get title(){return"Hologram"}get link(){return"https://threejs-journey.com/lessons/hologram-shader"}update(t){const n=t*.001,r=-n*.1,s=n*.2;this.material.uniforms.uTime.value=n,this.suzanne&&(this.suzanne.rotation.x=r,this.suzanne.rotation.y=s),this.sphere.rotation.x=r,this.sphere.rotation.y=s,this.torusKnot.rotation.x=r,this.torusKnot.rotation.y=s,this.control.update()}init(){super.init(),W(this,ul,AB).call(this),W(this,ul,CB).call(this),W(this,ul,PB).call(this),W(this,ul,RB).call(this)}},ul=new WeakSet,AB=function(){this.guiControl.addColor({backgroundColor:this.backgroundColor},"backgroundColor").onChange(t=>{this.renderer.setClearColor(t)}),this.guiControl.addColor({hologramColor:this.hologramColor},"hologramColor").onChange(t=>{this.material.uniforms.uColor.value.set(t)})},CB=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),this.material=new Ft({transparent:!0,side:_n,depthWrite:!1,blending:ea,vertexShader:M$,fragmentShader:b$,uniforms:{uTime:new We(0),uColor:new We(new Ge(this.hologramColor))}}),this.sphere=new Ae(new Lr(1),this.material),this.sphere.position.x=-3,this.scene.add(this.sphere),this.torusKnot=new Ae(new fl(.6,.25,128,32),this.material),this.torusKnot.position.x=3,this.scene.add(this.torusKnot),t.load("/three.js-journey/media/models/Suzanne/suzanne.glb",r=>{r.scene.traverse(o=>{o.isMesh&&(this.suzanne=o,this.suzanne.material=this.material,this.scene.add(this.suzanne))})})},PB=function(){this.camera.position.set(3,3,3)},RB=function(){this.renderer.setClearColor(this.backgroundColor)},dU);var E$=`uniform float uProgress;
uniform float uSize;

attribute float aTimeMultiplier;
attribute float aScale;

float remap(float value, float originMin, float originMax, float destinationMin, float destinationMax) {
    return destinationMin                    +
           (value - originMin)               *
           (destinationMax - destinationMin) /
           (originMax - originMin);
}

void main() {
    vec3 transformed = position;
    float progress   = uProgress * aTimeMultiplier;

    float explodeProgress = remap(progress, 0.0, 0.1, 0.0, 1.0);
    explodeProgress       = clamp(explodeProgress, 0.0, 1.0);
    explodeProgress       = 1.0 - pow(1.0 - explodeProgress, 3.0);
    transformed           = mix(vec3(0.0), transformed, explodeProgress);

    float fallProgress  = remap(progress, 0.1, 1.0, 0.0, 1.0);
    fallProgress        = clamp(fallProgress, 0.0, 1.0);
    transformed.y      -= 0.2 * fallProgress;

    float sizeOpeningProgress = remap(progress, 0.0, 0.125, 0.0, 1.0);
    float sizeClosingProgress = remap(progress, 0.125, 1.0, 1.0, 0.0);
    float sizeProgress        = min(sizeOpeningProgress, sizeClosingProgress);
    sizeProgress              = clamp(sizeProgress, 0.0, 1.0);

    float twinklingProgress = remap(progress, 0.2, 0.8, 0.0, 1.0);
    twinklingProgress       = clamp(twinklingProgress, 0.0, 1.0);
    float twinklingSize     = sin(progress * 30.0) * 0.5 + 0.5;
    twinklingSize           = 1.0 - twinklingSize * twinklingProgress;

    vec4 modelPosition      = modelMatrix      * vec4(transformed, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position   = projectionPosition;
    gl_PointSize  = uSize;
    gl_PointSize *= aScale;
    gl_PointSize *= (1.0 / -viewPosition.z);
    gl_PointSize *= sizeProgress;
    gl_PointSize *= twinklingSize;

    if (gl_PointSize < 1.0) {
        gl_Position = vec4(9999.9);
    }
}`,A$=`uniform vec3      uColor;
uniform sampler2D uTexture;

void main() {
    float alpha = texture(uTexture, gl_PointCoord).r;

    gl_FragColor = vec4(uColor, alpha);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,fu,LB,DB,IB;class C${constructor(e=null){st(this,fu);oe(this,"instance");oe(this,"texture");oe(this,"material");oe(this,"geometry");oe(this,"textures",["/three.js-journey/media/images/textures/particles/1.png","/three.js-journey/media/images/textures/particles/2.png","/three.js-journey/media/images/textures/particles/3.png","/three.js-journey/media/images/textures/particles/4.png","/three.js-journey/media/images/textures/particles/5.png","/three.js-journey/media/images/textures/particles/6.png","/three.js-journey/media/images/textures/particles/7.png","/three.js-journey/media/images/textures/particles/8.png","/three.js-journey/media/images/textures/particles/9.png","/three.js-journey/media/images/textures/particles/10.png","/three.js-journey/media/images/textures/particles/11.png","/three.js-journey/media/images/textures/particles/12.png","/three.js-journey/media/images/textures/particles/13.png"]);oe(this,"parameters",{position:new N(0,0,0),particles:1e3,particleSize:.05,particleColor:"#8affff",radius:3,texture:10});e&&(this.parameters=e),W(this,fu,LB).call(this)}dispose(){this.geometry.dispose(),this.material.dispose(),this.texture.dispose(),this.instance=null,this.geometry=null,this.material=null,this.texture=null}}fu=new WeakSet,LB=function(){W(this,fu,DB).call(this),W(this,fu,IB).call(this),this.instance=new ca(this.geometry,this.material),this.instance.position.copy(this.parameters.position)},DB=function(){const e=this.parameters.particles,t=e*3,n=new Float32Array(t),r=new Float32Array(e),s=new Float32Array(e);for(let o=0;o<e;o++){const a=o*3,l=new Kh(this.parameters.radius*(.75+.25*Math.random()),Math.random()*Math.PI,Math.random()*2*Math.PI),c=new N().setFromSpherical(l);n[a+0]=c.x,n[a+1]=c.y,n[a+2]=c.z,r[o]=Math.random(),s[o]=1+Math.random()}this.geometry=new yt,this.geometry.setAttribute("position",new lt(n,3)),this.geometry.setAttribute("aScale",new lt(r,1)),this.geometry.setAttribute("aTimeMultiplier",new lt(s,1))},IB=function(){const e=new _i;this.texture=e.load(this.textures[this.parameters.texture]),this.texture.flipY=!1,this.material=new Ft({transparent:!0,blending:ea,depthWrite:!1,vertexShader:E$,fragmentShader:A$,uniforms:{uSize:new We(this.parameters.particleSize),uTexture:new We(this.texture),uColor:new We(new Ge(this.parameters.particleColor)),uProgress:new We(0)}})};var op,Ol,tr,UB,FB,g2,kB,v2,y2,NB,pU;let P$=(pU=class extends Dt{constructor(){super(...arguments);st(this,tr);oe(this,"fireworks",[]);oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0);st(this,op);st(this,Ol,{turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.95,elevation:-2.2,azimuth:180})}get number(){return"34"}get title(){return"Fireworks"}get link(){return"https://threejs-journey.com/lessons/fireworks-shaders"}update(){this.control.update()}init(){super.init(),W(this,tr,UB).call(this),W(this,tr,g2).call(this),W(this,tr,FB).call(this),W(this,tr,NB).call(this)}resizeRenderer(){super.resizeRenderer(),this.fireworks.length&&this.fireworks.forEach(t=>{W(this,tr,y2).call(this,t)})}dispose(){W(this,tr,kB).call(this),this.canvas.removeEventListener("click",gt(this,op)),super.dispose()}},op=new WeakMap,Ol=new WeakMap,tr=new WeakSet,UB=function(){const t=new Q0;t.scale.setScalar(45e4);const n=new N,r=t.material.uniforms;r.turbidity.value=gt(this,Ol).turbidity,r.rayleigh.value=gt(this,Ol).rayleigh,r.mieCoefficient.value=gt(this,Ol).mieCoefficient,r.mieDirectionalG.value=gt(this,Ol).mieDirectionalG;const s=Ai.degToRad(90-gt(this,Ol).elevation),o=Ai.degToRad(gt(this,Ol).azimuth);n.setFromSphericalCoords(1,s,o),r.sunPosition.value.copy(n),this.scene.add(t)},FB=function(){Ln(this,op,W(this,tr,g2).bind(this)),this.canvas.addEventListener("click",gt(this,op))},g2=function(){const t=new C$({position:new N((Math.random()-.5)*3,(Math.random()-.5)*3,(Math.random()-.5)*3),particles:1500+Math.floor(1e3*Math.random()),particleSize:.08+.02*Math.random(),particleColor:`rgb(${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())})`,radius:1+Math.random(),texture:Math.floor(12*Math.random())});W(this,tr,y2).call(this,t),this.scene.add(t.instance),this.fireworks.push(t),Zl.to(t.material.uniforms.uProgress,{value:1,duration:3,ease:"linear",onComplete:()=>{W(this,tr,v2).call(this,t)}})},kB=function(){this.fireworks.forEach(t=>{t.instance&&W(this,tr,v2).call(this,t)}),this.fireworks=[]},v2=function(t){this.scene.remove(t.instance),t.dispose()},y2=function(t){t.material.uniforms.uSize.value=t.parameters.particleSize*this.canvas.height*this.renderer.getPixelRatio()},NB=function(){this.camera.position.set(4,4,4)},pU);var R$=`varying vec3 vPosition;
varying vec3 vNormal;

void main() {
    vec4 modelPosition      = modelMatrix * vec4(position, 1.0);
    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;
    vec4 modelNormal        = normalize(modelMatrix * vec4(normal, 0.0));

    gl_Position = projectionPosition;
    vPosition   = modelPosition.xyz;
    vNormal     = modelNormal.xyz;
}`,L$=`uniform vec3 uColor;

varying vec3 vPosition;
varying vec3 vNormal;

vec3 genAmbLight(vec3 color, float intensity) {
    return color * intensity;
}
vec3 genDirLight(
    vec3  color,
    float intensity,
    vec3  lightPosition,
    vec3  normal,
    vec3  viewDirection,
    float specularFactor
) {
    vec3  lightDirection = normalize(lightPosition);
    float shading        = dot(lightDirection, normal);
    shading              = max(0.0, shading);

    vec3  lightReflection = normalize(reflect(-lightDirection, normal));
    float specular        = -dot(viewDirection, lightReflection);
    specular              = max(0.0, specular);
    specular              = pow(specular, specularFactor);

    return color * intensity * (shading + specular);
}
vec3 genPointLight(
    vec3  color,
    float intensity,
    vec3  fragPosition,
    vec3  lightPosition,
    vec3  normal,
    vec3  viewDirection,
    float specularFactor,
    float decayFactor
) {
    vec3  lightDelta     = lightPosition - fragPosition;
    vec3  lightDirection = normalize(lightDelta);
    float shading        = dot(lightDirection, normal);
    shading              = max(0.0, shading);

    vec3  lightReflection = normalize(reflect(-lightDirection, normal));
    float specular        = -dot(viewDirection, lightReflection);
    specular              = max(0.0, specular);
    specular              = pow(specular, specularFactor);

    float decay = 1.0 - length(lightDelta) * decayFactor;
    decay       = max(0.0, decay);

    return color * intensity * decay * (shading + specular);
}

void main() {
    vec3 viewDirection = normalize(vPosition - cameraPosition);

    vec3 color    = uColor;
    vec3 ambLight = genAmbLight(
        vec3(1.0),
        0.03
    );
    vec3 dirLight = genDirLight(
        vec3(0.1, 0.1, 1.0),
        1.0,
        vec3(0.0, 0.0, 3.0),
        vNormal,
        viewDirection,
        20.0
    );
    vec3 pointLight1 = genPointLight(
        vec3(1.0, 0.1, 0.1),
        1.0,
        vPosition,
        vec3(0.0, 2.5, 0.0),
        vNormal,
        viewDirection,
        20.0,
        0.25
    );
    vec3 pointLight2 = genPointLight(
        vec3(0.1, 1.0, 0.5),
        1.0,
        vPosition,
        vec3(2.0, 2.0, 2.0),
        vNormal,
        viewDirection,
        20.0,
        0.2
    );
    vec3 totalLight = ambLight + dirLight + pointLight1 + pointLight2;
    vec3 finalColor = color * totalLight;

    gl_FragColor = vec4(finalColor, 1.0);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,aa,OB,zB,BB,HB,GB,mU;let D$=(mU=class extends Dt{constructor(){super(...arguments);st(this,aa);oe(this,"suzanne",null);oe(this,"torusKnot");oe(this,"sphere");oe(this,"material");oe(this,"materialColor","#ffffff");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"35"}get title(){return"Lights Shading"}get link(){return"https://threejs-journey.com/lessons/lights-shading-shaders"}update(t){const n=t*.001;this.suzanne&&(this.suzanne.rotation.x=-n*.1,this.suzanne.rotation.y=n*.2),this.sphere.rotation.x=-n*.1,this.sphere.rotation.y=n*.2,this.torusKnot.rotation.x=-n*.1,this.torusKnot.rotation.y=n*.2,this.control.update()}init(){super.init(),W(this,aa,zB).call(this),W(this,aa,BB).call(this),W(this,aa,HB).call(this),W(this,aa,GB).call(this),W(this,aa,OB).call(this)}},aa=new WeakSet,OB=function(){this.camera.position.set(5,5,5)},zB=function(){this.guiControl.addColor({color:this.materialColor},"color").onChange(t=>{this.material.uniforms.uColor.value.set(t)})},BB=function(){this.material=new Ft({vertexShader:R$,fragmentShader:L$,uniforms:{uColor:new We(new Ge(this.materialColor))}})},HB=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),this.sphere=new Ae(new Lr,this.material),this.sphere.position.x=-3,this.scene.add(this.sphere),this.torusKnot=new Ae(new fl(.6,.25,128,32),this.material),this.torusKnot.position.x=3,this.scene.add(this.torusKnot),t.load("/three.js-journey/media/models/Suzanne/suzanne.glb",r=>{this.suzanne=r.scene,this.suzanne.traverse(s=>{s.isMesh&&(s.material=this.material)}),this.scene.add(this.suzanne)})},GB=function(){const t=new Ae(new Ot,new Yt({}));t.position.set(0,0,3),t.material.side=_n,t.material.color.setRGB(.1,.1,1),this.scene.add(t);const n=new Ae(new iu(.1,2),new Yt({}));n.position.set(0,2.5,0),n.material.color.setRGB(1,.1,.1),this.scene.add(n);const r=new Ae(new iu(.1,2),new Yt({}));r.position.set(2,2,2),r.material.color.setRGB(.1,1,.5),this.scene.add(r)},mU);var I$=`uniform float uTime;
uniform float uNormalShift;
uniform float uBigWavesElevation;
uniform vec2  uBigWavesFrequency;
uniform float uBigWavesSpeed;
uniform float uSmallWavesElevation;
uniform float uSmallWavesFrequency;
uniform float uSmallWavesSpeed;
uniform float uSmallWavesIterations;

varying vec3 vPosition;
varying vec3 vNormal;

vec4 _permute(vec4 x) {
    return mod(((x*34.0)+1.0)*x, 289.0);
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 _fade(vec3 t) {
    return t*t*t*(t*(t*6.0-15.0)+10.0);
}

float calcPerlinNoise(vec3 P) {
    vec3 Pi0 = floor(P);
    vec3 Pi1 = Pi0 + vec3(1.0);
    Pi0 = mod(Pi0, 289.0);
    Pi1 = mod(Pi1, 289.0);
    vec3 Pf0 = fract(P);
    vec3 Pf1 = Pf0 - vec3(1.0);
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;

    vec4 ixy = _permute(_permute(ix) + iy);
    vec4 ixy0 = _permute(ixy + iz0);
    vec4 ixy1 = _permute(ixy + iz1);

    vec4 gx0 = ixy0 / 7.0;
    vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);

    vec4 gx1 = ixy1 / 7.0;
    vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);

    vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
    vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
    vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
    vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
    vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
    vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
    vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
    vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

    vec4 norm0 = _taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = _taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;

    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);

    vec3 fade_xyz = _fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
vec3 calcWave(
    vec3  position,
    vec2  bigWavesFrequency,
    float bigWavesElevation,
    float bigWavesSpeed,
    float smallWavesFrequency,
    float smallWavesElevation,
    float smallWavesSpeed,
    float smallWavesIterations,
    float time
) {
    position.y =
        sin(position.x * bigWavesFrequency.x + time * bigWavesSpeed) *
        sin(position.z * bigWavesFrequency.y + time * bigWavesSpeed) *
        bigWavesElevation;

    for(float i = 1.0; i <= smallWavesIterations; i++) {
        position.y -= abs(
            calcPerlinNoise(
                vec3(
                    position.xz * smallWavesFrequency * i,
                    time * smallWavesSpeed
                )
            ) * smallWavesElevation / i
        );
    }

    return position;
}

void main() {
    vec4 modelPosition  = modelMatrix * vec4(position, 1.0);
    vec3 iUnitPosition  = modelPosition.xyz + vec3(uNormalShift, 0.0, 0.0);
    vec3 jUnitPosition  = modelPosition.xyz + vec3(0.0, 0.0, -uNormalShift);
    modelPosition.xyz   = calcWave(
        modelPosition.xyz,
        uBigWavesFrequency,
        uBigWavesElevation,
        uBigWavesSpeed,
        uSmallWavesFrequency,
        uSmallWavesElevation,
        uSmallWavesSpeed,
        uSmallWavesIterations,
        uTime
    );
    iUnitPosition = calcWave(
        iUnitPosition.xyz,
        uBigWavesFrequency,
        uBigWavesElevation,
        uBigWavesSpeed,
        uSmallWavesFrequency,
        uSmallWavesElevation,
        uSmallWavesSpeed,
        uSmallWavesIterations,
        uTime
    );
    jUnitPosition = calcWave(
        jUnitPosition.xyz,
        uBigWavesFrequency,
        uBigWavesElevation,
        uBigWavesSpeed,
        uSmallWavesFrequency,
        uSmallWavesElevation,
        uSmallWavesSpeed,
        uSmallWavesIterations,
        uTime
    );
    vec3 iUnitVector = normalize(iUnitPosition - modelPosition.xyz);
    vec3 jUnitVector = normalize(jUnitPosition - modelPosition.xyz);

    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;
    vPosition   = modelPosition.xyz;
    vNormal     = cross(iUnitVector, jUnitVector);
}`,U$=`uniform float uBigWavesElevation;
uniform vec3  uDepthColor;
uniform vec3  uSurfaceColor;

varying vec3 vPosition;
varying vec3 vNormal;

vec3 genPointLight(
    vec3  color,
    float intensity,
    vec3  lightPosition,
    vec3  fragPosition,
    vec3  viewDirection,
    vec3  normal,
    float specularFactor,
    float decayFactor
) {
    vec3  lightVector    = lightPosition - fragPosition;
    vec3  lightDirection = normalize(lightVector);
    float shading        = dot(lightDirection, normal);
    shading              = max(0.0, shading);

    vec3  reflectionDirection = normalize(reflect(-lightDirection, normal));
    float specular            = -dot(reflectionDirection, viewDirection);
    specular                  = max(0.0, specular);
    specular                  = pow(specular, specularFactor);

    float decay = 1.0 - length(lightVector) * decayFactor;
    decay       = max(0.0, decay);

    return color * intensity * decay * (shading + specular);
}

void main() {
    vec3 viewDirection = normalize(vPosition - cameraPosition);

    float mixStrength = smoothstep(
        -uBigWavesElevation,
        uBigWavesElevation,
        vPosition.y
    );
    vec3 color  = mix(uDepthColor, uSurfaceColor, mixStrength);
    vec3 light  = vec3(0.0);
    light      += genPointLight(
        vec3(1.0),
        4.0,
        vec3(0.0, 0.25, 0.0),
        vPosition,
        viewDirection,
        vNormal,
        50.0,
        0.95
    );
    color        *= light;
    gl_FragColor  = vec4(color, 1.0);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,In,VB,WB,x2,jB,ja,XB,YB,qB,gU;let F$=(gU=class extends Dt{constructor(){super(...arguments);st(this,In);oe(this,"seaMaterial");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"36"}get title(){return"Raging Sea Shading"}get link(){return"https://threejs-journey.com/lessons/raging-sea-shading-shaders"}update(t){this.seaMaterial.uniforms.uTime.value=t*.001,this.control.update()}init(){super.init(),W(this,In,WB).call(this),W(this,In,VB).call(this),W(this,In,qB).call(this),W(this,In,YB).call(this)}},In=new WeakSet,VB=function(){W(this,In,ja).call(this,"uBigWavesElevation",0,1,.001),W(this,In,jB).call(this,"uBigWavesFrequency",0,10,.001),W(this,In,ja).call(this,"uBigWavesSpeed",0,4,.001),W(this,In,ja).call(this,"uSmallWavesElevation",0,1,.001),W(this,In,ja).call(this,"uSmallWavesFrequency",0,10,.001),W(this,In,ja).call(this,"uSmallWavesSpeed",0,4,.001),W(this,In,ja).call(this,"uSmallWavesIterations",0,5,1),W(this,In,ja).call(this,"uNormalShift",.001,1,.001),W(this,In,x2).call(this,"uDepthColor"),W(this,In,x2).call(this,"uSurfaceColor")},WB=function(){const t=new Ot(2,2,512,512);t.deleteAttribute("normal"),t.deleteAttribute("uv"),this.seaMaterial=new Ft({vertexShader:I$,fragmentShader:U$,uniforms:{uTime:new We(0),uBigWavesElevation:new We(.2),uBigWavesFrequency:new We(new be(4,1.5)),uBigWavesSpeed:new We(1.5),uSmallWavesElevation:new We(.15),uSmallWavesFrequency:new We(2.9),uSmallWavesSpeed:new We(.8),uSmallWavesIterations:new We(3),uDepthColor:new We(new Ge("#ff4000")),uSurfaceColor:new We(new Ge("#151c37")),uNormalShift:new We(.01)}});const n=new Ae(t,this.seaMaterial);n.rotation.x=-Math.PI/2,this.scene.add(n)},x2=function(t){this.guiControl.addColor({[t]:this.seaMaterial.uniforms[t].value.getHexString()},t).name(t).onChange(n=>{this.seaMaterial.uniforms[t].value.set(n)})},jB=function(t,n,r,s){const o=this.guiControl.addFolder(t);W(this,In,ja).call(this,"x",n,r,s,this.seaMaterial.uniforms[t].value.x,o,a=>{this.seaMaterial.uniforms[t].value.x=a}),W(this,In,ja).call(this,"y",n,r,s,this.seaMaterial.uniforms[t].value.y,o,a=>{this.seaMaterial.uniforms[t].value.y=a})},ja=function(t,n,r,s,o=null,a=null,l=null){let c=this.guiControl;a&&(c=a);let u;o?u=o:u=this.seaMaterial.uniforms[t].value;const h=c.add({[t]:u},t).min(n).max(r).step(s).name(t);W(this,In,XB).call(this,h,l)},XB=function(t,n=null){let r=s=>{this.seaMaterial.uniforms[t.property].value=s};n&&(r=n),t.onChange(r)},YB=function(){this.renderer.toneMapping=ta},qB=function(){this.camera.position.set(1,1,1)},gU);var k$=`varying vec3 vPosition;
varying vec3 vNormal;

void main() {
    vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vPosition = modelPosition.xyz;
    vNormal   = normalize(modelMatrix * vec4(normal, 0.0)).xyz;
}`,N$=`uniform vec3  uBaseColor;
uniform vec3  uColor;
uniform vec2  uResolution;
uniform float uRepetitions;

varying vec3 vPosition;
varying vec3 vNormal;

vec3 genAmbLight(vec3 color, float intensity) {
    return color * intensity;
}
vec3 genDirLight(
    vec3  color,
    float intensity,
    vec3  lightPosition,
    vec3  normal,
    vec3  viewDirection,
    float specularFactor
) {
    vec3  lightDirection = normalize(lightPosition);
    float shading        = dot(lightDirection, normal);
    shading              = max(0.0, shading);

    vec3  lightReflection = normalize(reflect(-lightDirection, normal));
    float specular        = -dot(viewDirection, lightReflection);
    specular              = max(0.0, specular);
    specular              = pow(specular, specularFactor);

    return color * intensity * (shading + specular);
}

vec3 halftone(
    vec2  uv,
    float repetitions,
    vec3  halftoneDir,
    float lowRadFactor,
    float highRadFactor,
    vec3  normal,
    vec3  pointColor,
    vec3  baseColor
) {
    float intensity  = dot(normal, halftoneDir);
    intensity        = smoothstep(lowRadFactor, highRadFactor, intensity);
    uv              *= repetitions;
    uv               = mod(uv, 1.0);
    float point      = distance(uv, vec2(0.5));
    point            = 1.0 - step(0.5 * intensity, point);
    return mix(baseColor, pointColor, point);
}

void main() {
    vec3 viewDirection = normalize(vPosition - cameraPosition);

    vec2 uv  = gl_FragCoord.xy;
         uv /= uResolution.y;

    vec3 color = uBaseColor;

    vec3 light  = vec3(0.0);
    light      += genAmbLight(vec3(1.0), 1.0);
    light      += genDirLight(
        vec3(1.0),
        1.0,
        vec3(1.0, 1.0, 0.0),
        vNormal,
        viewDirection,
        1.0
    );
    color *= light;

    color = halftone(
        uv,
        uRepetitions,
        normalize(vec3(0.0, -1.0, 0.0)),
        -0.8,
        1.5,
        vNormal,
        uColor,
        color
    );

    color = halftone(
        uv,
        uRepetitions * 2.0,
        normalize(vec3(1.0, 1.0, 0.0)),
        -0.8,
        1.5,
        vNormal,
        vec3(1.0),
        color
    );

    gl_FragColor = vec4(color, 1.0);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,U0,bo,KB,ZB,QB,JB,_2,vU;let O$=(vU=class extends Dt{constructor(){super(...arguments);st(this,bo);oe(this,"suzanne",null);oe(this,"torusKnot");oe(this,"sphere");oe(this,"halftoneMaterial");oe(this,"halftoneRepetitions",100);oe(this,"halftoneColor","#8e19b8");oe(this,"halftoneBaseColor","#ff794d");oe(this,"backgroundColor","#26132f");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);st(this,U0)}get number(){return"37"}get title(){return"Halftone Shading"}get link(){return"https://threejs-journey.com/lessons/halftone-shading-shaders"}update(t){const n=t*.001;this.suzanne&&(this.suzanne.rotation.x=-n*.1,this.suzanne.rotation.y=n*.2),this.sphere.rotation.x=-n*.1,this.sphere.rotation.y=n*.2,this.torusKnot.rotation.x=-n*.1,this.torusKnot.rotation.y=n*.2,this.control.update()}init(){super.init(),W(this,bo,KB).call(this),W(this,bo,ZB).call(this),W(this,bo,QB).call(this),W(this,bo,JB).call(this)}dispose(){this.canvas.removeEventListener("resize",gt(this,U0)),super.dispose()}},U0=new WeakMap,bo=new WeakSet,KB=function(){const t=this.guiControl.addFolder("Halftone Downward");t.add({repetitions:this.halftoneRepetitions},"repetitions").min(10).max(300).step(1).onChange(n=>{this.halftoneMaterial.uniforms.uRepetitions.value=n}),t.addColor({color:this.halftoneColor},"color").onChange(n=>{this.halftoneMaterial.uniforms.uColor.value.set(n)}),t.addColor({baseColor:this.halftoneBaseColor},"baseColor").onChange(n=>{this.halftoneMaterial.uniforms.uBaseColor.value.set(n)}),this.guiControl.addColor({backgroundColor:this.backgroundColor},"backgroundColor").onChange(n=>{this.renderer.setClearColor(n)})},ZB=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),this.halftoneMaterial=new Ft({vertexShader:k$,fragmentShader:N$,uniforms:{uBaseColor:new We(new Ge(this.halftoneBaseColor)),uColor:new We(new Ge(this.halftoneColor)),uRepetitions:new We(this.halftoneRepetitions),uResolution:new We(W(this,bo,_2).call(this))}}),this.sphere=new Ae(new Lr,this.halftoneMaterial),this.sphere.position.x=-3,this.scene.add(this.sphere),this.torusKnot=new Ae(new fl(.6,.25,128,32),this.halftoneMaterial),this.torusKnot.position.x=3,this.scene.add(this.torusKnot),t.load("/three.js-journey/media/models/Suzanne/suzanne.glb",r=>{r.scene.traverse(o=>{o.isMesh&&(o.material=this.halftoneMaterial,this.suzanne=o,this.scene.add(this.suzanne))})})},QB=function(){this.camera.position.set(3,3,3)},JB=function(){this.renderer.setClearColor(this.backgroundColor),Ln(this,U0,()=>{this.halftoneMaterial.uniforms.uResolution.value=W(this,bo,_2).call(this)})},_2=function(){return new be(this.canvas.width*this.renderer.getPixelRatio(),this.canvas.height*this.renderer.getPixelRatio())},vU);const z$="/three.js-journey/assets/day-DkcerPt2.jpg",B$="/three.js-journey/assets/night-BR_DbmEQ.jpg",H$="/three.js-journey/assets/specularCloud-DpLQ1-js.jpg";var G$=`varying vec3 vNormal;
varying vec3 vPosition;

void main() {
    vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vNormal   = (modelMatrix * vec4(normal, 1.0)).xyz;
    vPosition = modelPosition.xyz;
}`,V$=`varying vec3 vNormal;
varying vec3 vPosition;

uniform vec3 uSunDirection;
uniform vec3 uAtmosphereDayColor;
uniform vec3 uAtmosphereTwilightColor;

vec3 genAtmosphereColor(
    vec3  color,
    vec3  atmosphereDayColor,
    vec3  atmosphereTwilightColor,
    float fresnel,
    float sunOrientation
) {
    float atmosphereDayMix = smoothstep(-0.5, 1.0, sunOrientation);
    vec3  atmosphereColor  = mix(
        atmosphereTwilightColor,
        atmosphereDayColor,
        atmosphereDayMix
    );
    fresnel = pow(fresnel, 2.0);
    return mix(color, atmosphereColor, fresnel * atmosphereDayMix);
}

void main() {
    vec3  normal        = normalize(vNormal);
    vec3  viewDirection = normalize(vPosition - cameraPosition);
    float fresnel       = 1.0 + dot(viewDirection, normal);
    vec3  color         = vec3(0.0);

    float sunOrientation = dot(uSunDirection, normal);
    color                = genAtmosphereColor(
        color,
        uAtmosphereDayColor,
        uAtmosphereTwilightColor,
        fresnel,
        sunOrientation
    );

    float edgeAlpha = smoothstep(1.1, 1.5, fresnel);
    float dayAlpha  = smoothstep(0.0, 1.0, length(color));
    float alpha     = edgeAlpha * dayAlpha;

    gl_FragColor = vec4(color, alpha);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,W$=`varying vec2 vUv;
varying vec3 vNormal;
varying vec3 vPosition;

void main() {
    vec4 modelPosition      = modelMatrix * vec4(position, 1.0);
    vec4 viewPosition       = viewMatrix * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vUv       = uv;
    vNormal   = (modelMatrix * vec4(normal, 0.0)).xyz;
    vPosition = modelPosition.xyz;
}`,j$=`uniform sampler2D uDayTexture;
uniform sampler2D uNightTexture;
uniform sampler2D uSpecularCloudTexture;
uniform vec3      uSunDirection;
uniform vec3      uAtmosphereDayColor;
uniform vec3      uAtmosphereTwilightColor;

varying vec2 vUv;
varying vec3 vNormal;
varying vec3 vPosition;

vec3 genAtmosphereColor(
    vec3  color,
    vec3  atmosphereDayColor,
    vec3  atmosphereTwilightColor,
    float fresnel,
    float sunOrientation
) {
    float atmosphereDayMix = smoothstep(-0.5, 1.0, sunOrientation);
    vec3  atmosphereColor  = mix(
        atmosphereTwilightColor,
        atmosphereDayColor,
        atmosphereDayMix
    );
    fresnel = pow(fresnel, 2.0);
    return mix(color, atmosphereColor, fresnel * atmosphereDayMix);
}

void main() {
    vec3 normal        = normalize(vNormal);
    vec3 viewDirection = normalize(vPosition - cameraPosition);
    float fresnel      = dot(viewDirection, normal) + 1.0;

    vec3  color          = vec3(0.0);
    float sunOrientation = dot(uSunDirection, normal);
    float dayMix         = smoothstep(-0.25, 0.5, sunOrientation);
    vec3  dayColor       = texture(uDayTexture, vUv).rgb;
    vec3  nightColor     = texture(uNightTexture, vUv).rgb;
    color                = mix(nightColor, dayColor, dayMix);

    vec2  specularCloud  = texture(uSpecularCloudTexture, vUv).rg;
    float cloudMix       = smoothstep(0.5, 1.0, specularCloud.g);
    cloudMix            *= dayMix;
    color                = mix(color, vec3(1.0), cloudMix);

    vec3 atmosphereColor = genAtmosphereColor(
        color,
        uAtmosphereDayColor,
        uAtmosphereTwilightColor,
        fresnel,
        sunOrientation
    );
    color = atmosphereColor;

    vec3  reflectDirection  = normalize(reflect(-uSunDirection, normal));
    float specular          = -1.0 * dot(viewDirection, reflectDirection);
    specular                = max(0.0, specular);
    specular                = pow(specular, 32.0);
    specular               *= specularCloud.r;
    vec3 specularColor      = vec3(1.0);
    specularColor           = mix(specularColor, atmosphereColor, fresnel);
    color                  += specular * specularColor;

    gl_FragColor = vec4(color, 1.0);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,Pr,$B,w2,e5,t5,n5,i5,r5,yU;let X$=(yU=class extends Dt{constructor(){super(...arguments);st(this,Pr);oe(this,"earth");oe(this,"earthMaterial");oe(this,"earthGeometry");oe(this,"earthParameters",{atmosphereDayColor:"#00aaff",atmosphereTwilightColor:"#ff6600"});oe(this,"atmosphere");oe(this,"atmosphereMaterial");oe(this,"sun");oe(this,"sunDirection");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"38"}get title(){return"Earth"}get link(){return"https://threejs-journey.com/lessons/earth-shaders"}update(t){const n=t*.001;this.earth.rotation.y=.1*n,this.control.update()}init(){super.init(),W(this,Pr,e5).call(this),W(this,Pr,n5).call(this),W(this,Pr,t5).call(this),W(this,Pr,$B).call(this),W(this,Pr,i5).call(this),W(this,Pr,r5).call(this)}},Pr=new WeakSet,$B=function(){const t=new Kh;t.setFromCartesianCoords(...this.sun.position),this.guiControl.add(t,"phi").min(0).max(Math.PI).step(.1).onChange(n=>{t.phi=n,W(this,Pr,w2).call(this,t)}),this.guiControl.add(t,"theta").min(0).max(2*Math.PI).step(.1).onChange(n=>{t.theta=n,W(this,Pr,w2).call(this,t)}),this.guiControl.addColor(this.earthParameters,"atmosphereDayColor").onChange(n=>{this.earthMaterial.uniforms.uAtmosphereDayColor.value.set(n),this.atmosphereMaterial.uniforms.uAtmosphereDayColor.value.set(n)}),this.guiControl.addColor(this.earthParameters,"atmosphereTwilightColor").onChange(n=>{this.earthMaterial.uniforms.uAtmosphereTwilightColor.value.set(n),this.atmosphereMaterial.uniforms.uAtmosphereTwilightColor.value.set(n)})},w2=function(t){this.sun.position.setFromSpherical(t),this.sunDirection.set(...this.sun.position).normalize(),this.earthMaterial.uniforms.uSunDirection.value=this.sunDirection,this.atmosphereMaterial.uniforms.uSunDirection.value=this.sunDirection},e5=function(){this.sun=new Ae(new iu(.1,2),new Yt({})),this.sun.position.set(0,0,10),this.scene.add(this.sun),this.sunDirection=new N(...this.sun.position).normalize()},t5=function(){this.atmosphereMaterial=new Ft({vertexShader:G$,fragmentShader:V$,side:Vi,transparent:!0,uniforms:{uSunDirection:new We(this.sunDirection),uAtmosphereDayColor:new We(new Ge(this.earthParameters.atmosphereDayColor)),uAtmosphereTwilightColor:new We(new Ge(this.earthParameters.atmosphereTwilightColor))}}),this.atmosphere=new Ae(this.earthGeometry,this.atmosphereMaterial),this.atmosphere.scale.set(1.04,1.04,1.04),this.scene.add(this.atmosphere)},n5=function(){const t=new _i,n=Math.floor(this.renderer.capabilities.getMaxAnisotropy()/2),r=t.load(z$);r.colorSpace=Wt,r.anisotropy=n;const s=t.load(B$);s.colorSpace=Wt,s.anisotropy=n;const o=t.load(H$);o.anisotropy=n,this.earthGeometry=new Lr(2,64,64),this.earthMaterial=new Ft({vertexShader:W$,fragmentShader:j$,uniforms:{uDayTexture:new We(r),uNightTexture:new We(s),uSpecularCloudTexture:new We(o),uSunDirection:new We(this.sunDirection),uAtmosphereDayColor:new We(new Ge(this.earthParameters.atmosphereDayColor)),uAtmosphereTwilightColor:new We(new Ge(this.earthParameters.atmosphereTwilightColor))}}),this.earth=new Ae(this.earthGeometry,this.earthMaterial),this.scene.add(this.earth)},i5=function(){this.camera.fov=25,this.camera.position.set(12,6,4),this.camera.updateProjectionMatrix()},r5=function(){this.renderer.setClearColor("#000011")},yU);var Y$=`uniform sampler2D uPictureTexture;
uniform sampler2D uDisplacementTexture;
uniform vec2      uResolution;

attribute float aDisplacementRandomFactor;
attribute float aDisplacementRandomAngle;

varying vec3 vColor;

void main() {
    vec3  newPosition        = position;
    float displacementFactor = texture(uDisplacementTexture, uv).r;
    displacementFactor       = smoothstep(0.1, 0.3, displacementFactor);
    float radius             = 0.2;
    vec3  displacementDir    = vec3(
        sin(aDisplacementRandomAngle) * radius,
        cos(aDisplacementRandomAngle) * radius,
        1.0
    );
    displacementDir  = normalize(displacementDir);
    newPosition     +=
        aDisplacementRandomFactor * displacementFactor * displacementDir;

    vec4 modelPosition      = modelMatrix      * vec4(newPosition, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    float sizeFactor = texture(uPictureTexture, uv).r;

    gl_Position   = projectionPosition;
    gl_PointSize  = 0.15 * sizeFactor;
    gl_PointSize *= uResolution.y;
    gl_PointSize *= -1.0 / viewPosition.z;

    vColor = vec3(pow(sizeFactor, 2.0));
}`,q$=`varying vec3 vColor;

void main() {
    float distanceToCenter = length(gl_PointCoord - vec2(0.5));
    if (distanceToCenter > 0.5) {
        discard;
    }

    gl_FragColor = vec4(vColor, 1.0);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`;const K$="/three.js-journey/assets/picture-1-CcRZvoBz.png",Z$="/three.js-journey/assets/glow-UcE5q2Bs.png";var ap,lp,Ui,s5,o5,a5,l5,c5,u5,h5,f5,S2,xU;let Q$=(xU=class extends Dt{constructor(){super(...arguments);st(this,Ui);oe(this,"particles");oe(this,"particleGeometry");oe(this,"raycaster");oe(this,"interactiveCanvas");oe(this,"interactiveCanvasTexture");oe(this,"interactiveCanvasContext");oe(this,"interactiveCanvasImage");oe(this,"interactiveCanvasPlane");oe(this,"pointer",{x:null,y:null,prevX:null,prevY:null});oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0);st(this,ap);st(this,lp)}get number(){return"39"}get title(){return"Particles Cursor Animation"}get link(){return"https://threejs-journey.com/lessons/particles-cursor-animation-shader"}update(){if(this.control.update(),this.pointer.x&&this.pointer.y&&this.pointer.prevX&&this.pointer.prevY){this.raycaster.setFromCamera(this.pointer,this.camera);const t=this.raycaster.intersectObject(this.interactiveCanvasPlane);W(this,Ui,s5).call(this,t)}}init(){super.init(),this.raycaster=new Yp,W(this,Ui,o5).call(this),W(this,Ui,a5).call(this),W(this,Ui,l5).call(this),W(this,Ui,c5).call(this),W(this,Ui,u5).call(this),W(this,Ui,h5).call(this)}dispose(){this.canvas.removeEventListener("pointermove",gt(this,ap)),this.canvas.removeEventListener("resize",gt(this,lp)),super.dispose()}},ap=new WeakMap,lp=new WeakMap,Ui=new WeakSet,s5=function(t){W(this,Ui,S2).call(this),t.length&&W(this,Ui,f5).call(this,t[0].uv),this.interactiveCanvasTexture.needsUpdate=!0},o5=function(){this.interactiveCanvas=document.createElement("canvas"),this.interactiveCanvas.width=128,this.interactiveCanvas.height=128,this.interactiveCanvasTexture=new NF(this.interactiveCanvas),this.interactiveCanvasContext=this.interactiveCanvas.getContext("2d"),this.interactiveCanvasImage=new Image,this.interactiveCanvasImage.src=Z$,this.interactiveCanvasPlane=new Ae(new Ot(10,10,1,1),new Yt({side:_n})),this.interactiveCanvasPlane.visible=!1,W(this,Ui,S2).call(this)},a5=function(){const n=new _i().load(K$);this.particleGeometry=new Ot(this.interactiveCanvasPlane.geometry.parameters.width,this.interactiveCanvasPlane.geometry.parameters.height,128,128),this.particleGeometry.setIndex(null),this.particleGeometry.deleteAttribute("normal");const r=new Float32Array(this.particleGeometry.attributes.position.count),s=new Float32Array(this.particleGeometry.attributes.position.count);for(let o=0;o<r.length;o++)r[o]=Math.random(),s[o]=2*Math.PI*Math.random();this.particleGeometry.setAttribute("aDisplacementRandomFactor",new wt(r,1)),this.particleGeometry.setAttribute("aDisplacementRandomAngle",new wt(s,1)),this.particles=new ca(this.particleGeometry,new Ft({vertexShader:Y$,fragmentShader:q$,uniforms:{uPictureTexture:new We(n),uDisplacementTexture:new We(this.interactiveCanvasTexture),uResolution:new We(new be(this.canvas.width*this.renderer.getPixelRatio(),this.canvas.height*this.renderer.getPixelRatio()))},blending:ea})),this.scene.add(this.particles)},l5=function(){this.camera.fov=35,this.camera.position.set(0,0,18),this.camera.updateProjectionMatrix()},c5=function(){this.renderer.setClearColor("#181818")},u5=function(){Ln(this,ap,t=>{this.pointer.prevX=this.pointer.x,this.pointer.prevY=this.pointer.y,this.pointer.x=(t.offsetX/this.canvas.width-.5)*2,this.pointer.y=-((t.offsetY/this.canvas.height-.5)*2)}),this.canvas.addEventListener("pointermove",gt(this,ap))},h5=function(){Ln(this,lp,()=>{this.particles.material.uniforms.uResolution.value.set(this.canvas.width*this.renderer.getPixelRatio(),this.canvas.height*this.renderer.getPixelRatio())}),this.canvas.addEventListener("resize",gt(this,lp))},f5=function(t){const n=t.x*this.interactiveCanvas.width,r=(1-t.y)*this.interactiveCanvas.height,s=.15*this.interactiveCanvas.width;let o=Math.hypot(this.pointer.x-this.pointer.prevX,this.pointer.y-this.pointer.prevY)*500;o=Math.min(1,o),this.pointer.prevX=this.pointer.x,this.pointer.prevY=this.pointer.y,this.interactiveCanvasContext.save(),this.interactiveCanvasContext.globalCompositeOperation="lighten",this.interactiveCanvasContext.globalAlpha=o,this.interactiveCanvasContext.drawImage(this.interactiveCanvasImage,n-s/2,r-s/2,s,s),this.interactiveCanvasContext.restore()},S2=function(){this.interactiveCanvasContext.save(),this.interactiveCanvasContext.globalAlpha=.02,this.interactiveCanvasContext.fillRect(0,0,this.interactiveCanvas.width,this.interactiveCanvas.height),this.interactiveCanvasContext.restore()},xU);var J$=`uniform float uProgress;
uniform float uSize;
uniform vec2  uResolution;
uniform vec3  uWarmColor;
uniform vec3  uCoolColor;

attribute float aSize;
attribute vec3  aTargetPosition;

varying vec3 vColor;

vec4 _permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

float calcSimplexNoise3d(vec3 v) {
    const vec2  C = vec2(1.0 / 6.0, 1.0 / 3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);

    
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;

    
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );

    
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

    
    i = mod(i, 289.0 );
    vec4 p = _permute(
        _permute(
            _permute(i.z + vec4(0.0, i1.z, i2.z, 1.0 )) +
            i.y                                         +
            vec4(0.0, i1.y, i2.y, 1.0 )
        )   +
        i.x +
        vec4(0.0, i1.x, i2.x, 1.0)
    );

    
    
    float n_ = 1.0/7.0; 
    vec3  ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    

    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );

    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;

    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);

    
    vec4 norm = _taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

    
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot(m * m, vec4(dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));
}

void main() {
    float frequency     = 0.2;
    float originNoise   = calcSimplexNoise3d(position * frequency);
    float targetNoise   = calcSimplexNoise3d(aTargetPosition * frequency);
    float noise         = mix(originNoise, targetNoise, uProgress);
    noise               = smoothstep(-1.0, 1.0, noise);
    float duration      = 0.4;
    float delay         = (1.0 - duration) * noise;
    float end           = delay + duration;
    float progress      = smoothstep(delay, end, uProgress);
    vec3  finalPosition = mix(position, aTargetPosition, progress);

    vec4 modelPosition      = modelMatrix      * vec4(finalPosition, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position   = projectionPosition;
    gl_PointSize  = aSize * uSize * uResolution.y;
    gl_PointSize *= (-1.0 / viewPosition.z);

    vColor = mix(uWarmColor, uCoolColor, noise);
}`,$$=`varying vec3 vColor;

void main() {
    float distanceToCenter = length(gl_PointCoord - vec2(0.5));
    float alpha            = (0.05 / distanceToCenter) - 0.1;

    gl_FragColor = vec4(vColor, alpha);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`;const eee="/three.js-journey/assets/models-Bt460700.glb";var cp,Yn,d5,p5,m5,M2,g5,v5,y5,x5,b2,T2,_U;let tee=(_U=class extends Dt{constructor(){super(...arguments);st(this,Yn);oe(this,"mesh");oe(this,"currentMeshIndex",0);oe(this,"meshPositions",[]);oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);oe(this,"rendererParams",{clearColor:"#160920"});st(this,cp)}get number(){return"40"}get title(){return"Particles Morphing"}get link(){return"https://threejs-journey.com/lessons/particles-morphing-shader"}update(){this.control.update()}init(){super.init(),W(this,Yn,g5).call(this),W(this,Yn,p5).call(this),W(this,Yn,v5).call(this),W(this,Yn,y5).call(this),W(this,Yn,d5).call(this),W(this,Yn,x5).call(this)}dispose(){this.canvas.removeEventListener("resize",gt(this,cp)),super.dispose()}},cp=new WeakMap,Yn=new WeakSet,d5=function(){this.guiControl.addColor({clearColor:this.rendererParams.clearColor},"clearColor").onChange(n=>{this.renderer.setClearColor(n)}),this.guiControl.add(this.mesh.material.uniforms.uProgress,"value").min(0).max(1).step(.001).name("uProgress").listen(),this.guiControl.addColor({uWarmColor:this.mesh.material.uniforms.uWarmColor.value.getHexString()},"uWarmColor").onChange(n=>{this.mesh.material.uniforms.uWarmColor.value.set(n)}),this.guiControl.addColor({uCoolColor:this.mesh.material.uniforms.uCoolColor.value.getHexString()},"uCoolColor").onChange(n=>{this.mesh.material.uniforms.uCoolColor.value.set(n)});const t=n=>{W(this,Yn,M2).call(this,n),Zl.fromTo(this.mesh.material.uniforms.uProgress,{value:0},{value:1,ease:"linear",duration:3,onComplete:()=>{this.currentMeshIndex=n}})};this.guiControl.add({morphToFirstMesh:()=>{t(0)}},"morphToFirstMesh"),this.guiControl.add({morphToSecondMesh:()=>{t(1)}},"morphToSecondMesh"),this.guiControl.add({morphToThirdMesh:()=>{t(2)}},"morphToThirdMesh"),this.guiControl.add({morphToFourthMesh:()=>{t(3)}},"morphToFourthMesh")},p5=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load(eee,r=>{const s=r.scene.children.map(o=>o.geometry);W(this,Yn,m5).call(this,s),W(this,Yn,M2).call(this,1)})},m5=function(t){const n=t.reduce((s,o)=>Math.max(s,o.attributes.position.count),0);for(const s of t){const o=s.attributes.position,a=new Float32Array(n*3);for(let l=0;l<n;l++){const c=l*3;if(l<o.count)a[c+0]=o.array[c+0],a[c+1]=o.array[c+1],a[c+2]=o.array[c+2];else{const u=Math.floor((o.count-1)*Math.random())*3;a[c+0]=o.array[u+0],a[c+1]=o.array[u+1],a[c+2]=o.array[u+2]}}this.meshPositions.push(new wt(a,3))}const r=new Float32Array(n*1);for(let s=0;s<r.length;s++)r[s]=Math.random();this.mesh.geometry.setAttribute("aSize",new wt(r,1))},M2=function(t){this.mesh.geometry.setAttribute("position",this.meshPositions[this.currentMeshIndex]),this.mesh.geometry.setAttribute("aTargetPosition",this.meshPositions[t])},g5=function(){const t=new yt,n=new Ft({vertexShader:J$,fragmentShader:$$,uniforms:{uSize:new We(.4),uResolution:new We(new be(W(this,Yn,b2).call(this),W(this,Yn,T2).call(this))),uProgress:new We(0),uWarmColor:new We(new Ge("#ff7300")),uCoolColor:new We(new Ge("#0091ff"))},blending:ea,depthWrite:!1});this.mesh=new ca(t,n),this.mesh.frustumCulled=!1,this.scene.add(this.mesh)},v5=function(){this.camera.fov=35,this.camera.position.set(0,0,16),this.camera.updateProjectionMatrix()},y5=function(){this.renderer.setClearColor(this.rendererParams.clearColor)},x5=function(){Ln(this,cp,()=>{this.mesh.material.uniforms.uResolution.value.set(W(this,Yn,b2).call(this),W(this,Yn,T2).call(this))}),this.canvas.addEventListener("resize",gt(this,cp))},b2=function(){return this.canvas.width*this.renderer.getPixelRatio()},T2=function(){return this.canvas.height*this.renderer.getPixelRatio()},_U);class yu{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const nee=new yo(-1,1,1,-1,0,1);class iee extends yt{constructor(){super(),this.setAttribute("position",new lt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new lt([0,2,0,0,2,0],2))}}const ree=new iee;class Kp{constructor(e){this._mesh=new Ae(ree,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,nee)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class see{constructor(e,t,n){this.variables=[],this.currentTextureIndex=0;let r=Hi;const s={passThruTexture:{value:null}},o=c(h(),s),a=new Kp(o);this.setDataType=function(f){return r=f,this},this.addVariable=function(f,p,v){const x=this.createShaderMaterial(p),y={name:f,initialValueTexture:v,material:x,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:wn,magFilter:wn};return this.variables.push(y),y},this.setVariableDependencies=function(f,p){f.dependencies=p},this.init=function(){if(n.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let f=0;f<this.variables.length;f++){const p=this.variables[f];p.renderTargets[0]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),p.renderTargets[1]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),this.renderTexture(p.initialValueTexture,p.renderTargets[0]),this.renderTexture(p.initialValueTexture,p.renderTargets[1]);const v=p.material,x=v.uniforms;if(p.dependencies!==null)for(let y=0;y<p.dependencies.length;y++){const g=p.dependencies[y];if(g.name!==p.name){let _=!1;for(let w=0;w<this.variables.length;w++)if(g.name===this.variables[w].name){_=!0;break}if(!_)return"Variable dependency not found. Variable="+p.name+", dependency="+g.name}x[g.name]={value:null},v.fragmentShader=`
uniform sampler2D `+g.name+`;
`+v.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){const f=this.currentTextureIndex,p=this.currentTextureIndex===0?1:0;for(let v=0,x=this.variables.length;v<x;v++){const y=this.variables[v];if(y.dependencies!==null){const g=y.material.uniforms;for(let _=0,w=y.dependencies.length;_<w;_++){const S=y.dependencies[_];g[S.name].value=S.renderTargets[f].texture}}this.doRenderTarget(y.material,y.renderTargets[p])}this.currentTextureIndex=p},this.getCurrentRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){a.dispose();const f=this.variables;for(let p=0;p<f.length;p++){const v=f[p];v.initialValueTexture&&v.initialValueTexture.dispose();const x=v.renderTargets;for(let y=0;y<x.length;y++)x[y].dispose()}};function l(f){f.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=l;function c(f,p){p=p||{};const v=new Ft({name:"GPUComputationShader",uniforms:p,vertexShader:u(),fragmentShader:f});return l(v),v}this.createShaderMaterial=c,this.createRenderTarget=function(f,p,v,x,y,g){return f=f||e,p=p||t,v=v||ds,x=x||ds,y=y||wn,g=g||wn,new vi(f,p,{wrapS:v,wrapT:x,minFilter:y,magFilter:g,format:fr,type:r,depthBuffer:!1})},this.createTexture=function(){const f=new Float32Array(e*t*4),p=new Jo(f,e,t,fr,Hi);return p.needsUpdate=!0,p},this.renderTexture=function(f,p){s.passThruTexture.value=f,this.doRenderTarget(o,p),s.passThruTexture.value=null},this.doRenderTarget=function(f,p){const v=n.getRenderTarget(),x=n.xr.enabled,y=n.shadowMap.autoUpdate;n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,a.material=f,n.setRenderTarget(p),a.render(n),a.material=o,n.xr.enabled=x,n.shadowMap.autoUpdate=y,n.setRenderTarget(v)};function u(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function h(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}}const oee={name:"DotScreenShader",uniforms:{tDiffuse:{value:null},tSize:{value:new be(256,256)},center:{value:new be(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform vec2 center;
		uniform float angle;
		uniform float scale;
		uniform vec2 tSize;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		float pattern() {

			float s = sin( angle ), c = cos( angle );

			vec2 tex = vUv * tSize - center;
			vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;

			return ( sin( point.x ) * sin( point.y ) ) * 4.0;

		}

		void main() {

			vec4 color = texture2D( tDiffuse, vUv );

			float average = ( color.r + color.g + color.b ) / 3.0;

			gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );

		}`};class aee extends yu{constructor(e,t,n){super();const r=oee;this.uniforms=Is.clone(r.uniforms),e!==void 0&&this.uniforms.center.value.copy(e),t!==void 0&&(this.uniforms.angle.value=t),n!==void 0&&(this.uniforms.scale.value=n),this.material=new Ft({name:r.name,uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.fsQuad=new Kp(this.material)}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.tSize.value.set(n.width,n.height),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const _5={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class dd extends yu{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Ft?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Is.clone(e.uniforms),this.material=new Ft({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Kp(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class kL extends yu{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class lee extends yu{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class cee{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const n=e.getSize(new be);this._width=n.width,this._height=n.height,t=new vi(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Zi}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new dd(_5),this.copyPass.material.blending=ba,this.clock=new bw}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}kL!==void 0&&(o instanceof kL?n=!0:o instanceof lee&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new be);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}const uee={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};class hee extends yu{constructor(e=64){super();const t=uee;this.uniforms=Is.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Ft({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new Kp(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=Ai.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=Ai.randFloat(-1,1),this.uniforms.seed_y.value=Ai.randFloat(-1,1),this.uniforms.distortion_x.value=Ai.randFloat(0,1),this.uniforms.distortion_y.value=Ai.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=Ai.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=Ai.randFloat(0,1),this.uniforms.distortion_y.value=Ai.randFloat(0,1),this.uniforms.seed_x.value=Ai.randFloat(-.3,.3),this.uniforms.seed_y.value=Ai.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=Ai.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const o=Ai.randFloat(0,1);t[s]=o}const r=new Jo(t,e,e,N0,Hi);return r.needsUpdate=!0,r}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class fee extends yu{constructor(e,t,n=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ge}render(e,t,n){const r=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=r}}const jy={name:"SMAAEdgesShader",defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new be(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		void SMAAEdgeDetectionVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAAEdgeDetectionVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
			vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );

			// Calculate color deltas:
			vec4 delta;
			vec3 C = texture2D( colorTex, texcoord ).rgb;

			vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
			vec3 t = abs( C - Cleft );
			delta.x = max( max( t.r, t.g ), t.b );

			vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
			t = abs( C - Ctop );
			delta.y = max( max( t.r, t.g ), t.b );

			// We do the usual threshold:
			vec2 edges = step( threshold, delta.xy );

			// Then discard if there is no edge:
			if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
				discard;

			// Calculate right and bottom deltas:
			vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
			t = abs( C - Cright );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
			t = abs( C - Cbottom );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the maximum delta in the direct neighborhood:
			float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

			// Calculate left-left and top-top deltas:
			vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
			t = abs( C - Cleftleft );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
			t = abs( C - Ctoptop );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the final maximum delta:
			maxDelta = max( max( maxDelta, delta.z ), delta.w );

			// Local contrast adaptation in action:
			edges.xy *= step( 0.5 * maxDelta, delta.xy );

			return vec4( edges, 0.0, 0.0 );
		}

		void main() {

			gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );

		}`},Xy={name:"SMAAWeightsShader",defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new be(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];
		varying vec2 vPixcoord;

		void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
			vPixcoord = texcoord / resolution;

			// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components

			// And these for the searches, they indicate the ends of the loops:
			vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );

		}

		void main() {

			vUv = uv;

			SMAABlendingWeightCalculationVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )

		uniform sampler2D tDiffuse;
		uniform sampler2D tArea;
		uniform sampler2D tSearch;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[3];
		varying vec2 vPixcoord;

		#if __VERSION__ == 100
		vec2 round( vec2 x ) {
			return sign( x ) * floor( abs( x ) + 0.5 );
		}
		#endif

		float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
			// Not required if searchTex accesses are set to point:
			// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);
			// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +
			//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;
			e.r = bias + e.r * scale;
			return 255.0 * texture2D( searchTex, e, 0.0 ).r;
		}

		float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			/**
				* @PSEUDO_GATHER4
				* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to
				* sample between edge, thus fetching four edges in a row.
				* Sampling with different offsets in each direction allows to disambiguate
				* which edges are active from the four fetched ones.
				*/
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			// We correct the previous (-0.25, -0.125) offset we applied:
			texcoord.x += 0.25 * resolution.x;

			// The searches are bias by 1, so adjust the coords accordingly:
			texcoord.x += resolution.x;

			// Disambiguate the length added by the last step:
			texcoord.x += 2.0 * resolution.x; // Undo last step
			texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);

			return texcoord.x;
		}

		float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			texcoord.x -= 0.25 * resolution.x;
			texcoord.x -= resolution.x;
			texcoord.x -= 2.0 * resolution.x;
			texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );

			return texcoord.x;
		}

		float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y; // WebGL port note: Changed sign
			texcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y; // WebGL port note: Changed sign
			texcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
			// Rounding prevents precision errors of bilinear filtering:
			vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;

			// We do a scale and bias for mapping to texel space:
			texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );

			// Move to proper place, according to the subpixel offset:
			texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;

			return texture2D( areaTex, texcoord, 0.0 ).rg;
		}

		vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
			vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );

			vec2 e = texture2D( edgesTex, texcoord ).rg;

			if ( e.g > 0.0 ) { // Edge at north
				vec2 d;

				// Find the distance to the left:
				vec2 coords;
				coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
				coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)
				d.x = coords.x;

				// Now fetch the left crossing edges, two at a time using bilinear
				// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to
				// discern what value each edge has:
				float e1 = texture2D( edgesTex, coords, 0.0 ).r;

				// Find the distance to the right:
				coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
				d.y = coords.x;

				// We want the distances to be in pixel units (doing this here allow to
				// better interleave arithmetic and memory accesses):
				d = d / resolution.x - pixcoord.x;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the right crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;

				// Ok, we know how this pattern looks like, now it is time for getting
				// the actual area:
				weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
			}

			if ( e.r > 0.0 ) { // Edge at west
				vec2 d;

				// Find the distance to the top:
				vec2 coords;

				coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
				coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;
				d.x = coords.y;

				// Fetch the top crossing edges:
				float e1 = texture2D( edgesTex, coords, 0.0 ).g;

				// Find the distance to the bottom:
				coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
				d.y = coords.y;

				// We want the distances to be in pixel units:
				d = d / resolution.y - pixcoord.y;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the bottom crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;

				// Get the area for this direction:
				weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
			}

			return weights;
		}

		void main() {

			gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );

		}`},qM={name:"SMAABlendShader",uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new be(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAANeighborhoodBlendingVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform sampler2D tColor;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
			// Fetch the blending weights for current pixel:
			vec4 a;
			a.xz = texture2D( blendTex, texcoord ).xz;
			a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
			a.w = texture2D( blendTex, offset[ 1 ].xy ).a;

			// Is there any blending weight with a value greater than 0.0?
			if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
				return texture2D( colorTex, texcoord, 0.0 );
			} else {
				// Up to 4 lines can be crossing a pixel (one through each edge). We
				// favor blending by choosing the line with the maximum weight for each
				// direction:
				vec2 offset;
				offset.x = a.a > a.b ? a.a : -a.b; // left vs. right
				offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs

				// Then we go in the direction that has the maximum weight:
				if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical
					offset.y = 0.0;
				} else {
					offset.x = 0.0;
				}

				// Fetch the opposite color and lerp by hand:
				vec4 C = texture2D( colorTex, texcoord, 0.0 );
				texcoord += sign( offset ) * resolution;
				vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
				float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );

				// WebGL port note: Added gamma correction
				C.xyz = pow(C.xyz, vec3(2.2));
				Cop.xyz = pow(Cop.xyz, vec3(2.2));
				vec4 mixed = mix(C, Cop, s);
				mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));

				return mixed;
			}
		}

		void main() {

			gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );

		}`};class dee extends yu{constructor(e,t){super(),this.edgesRT=new vi(e,t,{depthBuffer:!1,type:Zi}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new vi(e,t,{depthBuffer:!1,type:Zi}),this.weightsRT.texture.name="SMAAPass.weights";const n=this,r=new Image;r.src=this.getAreaTexture(),r.onload=function(){n.areaTexture.needsUpdate=!0},this.areaTexture=new Cn,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.minFilter=gn,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){n.searchTexture.needsUpdate=!0},this.searchTexture=new Cn,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=wn,this.searchTexture.minFilter=wn,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=Is.clone(jy.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Ft({defines:Object.assign({},jy.defines),uniforms:this.uniformsEdges,vertexShader:jy.vertexShader,fragmentShader:jy.fragmentShader}),this.uniformsWeights=Is.clone(Xy.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Ft({defines:Object.assign({},Xy.defines),uniforms:this.uniformsWeights,vertexShader:Xy.vertexShader,fragmentShader:Xy.fragmentShader}),this.uniformsBlend=Is.clone(qM.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Ft({uniforms:this.uniformsBlend,vertexShader:qM.vertexShader,fragmentShader:qM.fragmentShader}),this.fsQuad=new Kp(null)}render(e,t,n){this.uniformsEdges.tDiffuse.value=n.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=n.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}dispose(){this.edgesRT.dispose(),this.weightsRT.dispose(),this.areaTexture.dispose(),this.searchTexture.dispose(),this.materialEdges.dispose(),this.materialWeights.dispose(),this.materialBlend.dispose(),this.fsQuad.dispose()}}const pee={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ge(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Tp extends yu{constructor(e,t,n,r){super(),this.strength=t!==void 0?t:1,this.radius=n,this.threshold=r,this.resolution=e!==void 0?new be(e.x,e.y):new be(256,256),this.clearColor=new Ge(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new vi(s,o,{type:Zi}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const f=new vi(s,o,{type:Zi});f.texture.name="UnrealBloomPass.h"+h,f.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(f);const p=new vi(s,o,{type:Zi});p.texture.name="UnrealBloomPass.v"+h,p.texture.generateMipmaps=!1,this.renderTargetsVertical.push(p),s=Math.round(s/2),o=Math.round(o/2)}const a=pee;this.highPassUniforms=Is.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Ft({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[h])),this.separableBlurMaterials[h].uniforms.invSize.value=new be(1/s,1/o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const c=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=c,this.bloomTintColors=[new N(1,1,1),new N(1,1,1),new N(1,1,1),new N(1,1,1),new N(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const u=_5;this.copyUniforms=Is.clone(u.uniforms),this.blendMaterial=new Ft({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:ea,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ge,this.oldClearAlpha=1,this.basic=new Yt,this.fsQuad=new Kp(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.invSize.value=new be(1/n,1/r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=Tp.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=Tp.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return new Ft({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new be(.5,.5)},direction:{value:new be(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Ft({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Tp.BlurDirectionX=new be(1,0);Tp.BlurDirectionY=new be(0,1);const mee={name:"GammaCorrectionShader",uniforms:{tDiffuse:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 tex = texture2D( tDiffuse, vUv );

			gl_FragColor = sRGBTransferOETF( tex );

		}`},gee={name:"RGBShiftShader",uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float amount;
		uniform float angle;

		varying vec2 vUv;

		void main() {

			vec2 offset = amount * vec2( cos(angle), sin(angle));
			vec4 cr = texture2D(tDiffuse, vUv + offset);
			vec4 cga = texture2D(tDiffuse, vUv);
			vec4 cb = texture2D(tDiffuse, vUv - offset);
			gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);

		}`};var vee=`uniform float     uTime;
uniform float     uDeltaTime;
uniform float     uStrengthFactor;
uniform float     uFlowStrength;
uniform float     uFlowFrequency;
uniform sampler2D uBasePositionTexture;

vec4 _permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}

float _permute(float x) {
    return floor(mod(((x * 34.0) + 1.0) * x, 289.0));
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

float _taylorInvSqrt(float r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

vec4 _grad4(float j, vec4 ip) {
    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);
    vec4 p,s;

    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;
    p.w   = 1.5 - dot(abs(p.xyz), ones.xyz);
    s     = vec4(lessThan(p, vec4(0.0)));
    p.xyz = p.xyz + (s.xyz * 2.0 - 1.0) * s.www;

    return p;
}

float calcSimplexNoise4d(vec4 v){
    const vec2  C = vec2( 0.138196601125010504,  
    0.309016994374947451); 
    
    vec4 i  = floor(v + dot(v, C.yyyy) );
    vec4 x0 = v -   i + dot(i, C.xxxx);

    

    
    vec4 i0;

    vec3 isX = step( x0.yzw, x0.xxx );
    vec3 isYZ = step( x0.zww, x0.yyz );
    
    i0.x = isX.x + isX.y + isX.z;
    i0.yzw = 1.0 - isX;

    
    i0.y += isYZ.x + isYZ.y;
    i0.zw += 1.0 - isYZ.xy;

    i0.z += isYZ.z;
    i0.w += 1.0 - isYZ.z;

    
    vec4 i3 = clamp( i0, 0.0, 1.0 );
    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );
    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );

    
    vec4 x1 = x0 - i1 + 1.0 * C.xxxx;
    vec4 x2 = x0 - i2 + 2.0 * C.xxxx;
    vec4 x3 = x0 - i3 + 3.0 * C.xxxx;
    vec4 x4 = x0 - 1.0 + 4.0 * C.xxxx;

    
    i = mod(i, 289.0);
    float j0 = _permute( _permute( _permute( _permute(i.w) + i.z) + i.y) + i.x);
    vec4 j1 = _permute( _permute( _permute( _permute (
                                             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))
                                         + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))
                                + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))
                       + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));
    
    
    

    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;

    vec4 p0 = _grad4(j0,   ip);
    vec4 p1 = _grad4(j1.x, ip);
    vec4 p2 = _grad4(j1.y, ip);
    vec4 p3 = _grad4(j1.z, ip);
    vec4 p4 = _grad4(j1.w, ip);

    
    vec4 norm = _taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    p4 *= _taylorInvSqrt(dot(p4,p4));

    
    vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);
    vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);
    m0 = m0 * m0;
    m1 = m1 * m1;
    return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))
    + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;
}

void main() {
    float time         = uTime * 0.2;
    vec2  uv           = gl_FragCoord.xy / resolution.xy;
    vec4  particle     = texture(uParticle, uv);
    vec4  basePosition = texture(uBasePositionTexture, uv);

    if (particle.a >= 1.0) {
        particle = basePosition;
    }
    else {
        float strength = calcSimplexNoise4d(
            vec4(particle.xyz * 0.2, time + 1.0)
        );
        strength = smoothstep(
            (uStrengthFactor - 0.5) * 2.0 * -1.0,
            1.0,
            strength
        );
        vec3 flowField = vec3(
            calcSimplexNoise4d(
                vec4((particle.xyz * uFlowFrequency + 0.0), time)
            ),
            calcSimplexNoise4d(
                vec4((particle.xyz * uFlowFrequency + 1.0), time)
            ),
            calcSimplexNoise4d(
                vec4((particle.xyz * uFlowFrequency + 2.0), time)
            )
        );
        flowField     = normalize(flowField);
        particle.xyz += flowField * uFlowStrength * uDeltaTime * strength;

        particle.a += 0.3 * uDeltaTime;
    }

    gl_FragColor  = particle;
}`,Np,w5,S5;class yee{constructor(e,t){st(this,Np);oe(this,"particles");oe(this,"renderer");oe(this,"baseTexture");oe(this,"particleVariable");this.particles=e;const n=Math.ceil(Math.sqrt(e.count));W(this,Np,w5).call(this,n,n,t)}getRendererTexture(){return this.renderer.getCurrentRenderTarget(this.particleVariable).texture}addDebugPlaneToScene(e){const t=new Ae(new Ot(3,3),new Yt({map:this.getRendererTexture()}));t.position.x=3,e.add(t)}}Np=new WeakSet,w5=function(e,t,n){this.renderer=new see(e,t,n),W(this,Np,S5).call(this),this.particleVariable=this.renderer.addVariable("uParticle",vee,this.baseTexture),this.renderer.setVariableDependencies(this.particleVariable,[this.particleVariable]),this.renderer.init()},S5=function(){this.baseTexture=this.renderer.createTexture();for(let e=0;e<this.particles.count;e++){const t=e*3,n=e*4;this.baseTexture.image.data[n+0]=this.particles.array[t+0],this.baseTexture.image.data[n+1]=this.particles.array[t+1],this.baseTexture.image.data[n+2]=this.particles.array[t+2],this.baseTexture.image.data[n+3]=Math.random()}};var xee=`uniform vec2      uResolution;
uniform float     uSize;
uniform sampler2D uPositionTexture;

attribute vec2 aUv;
attribute vec3 aColor;
attribute float aSize;

varying vec3 vColor;

void main() {
    vec4 particle = texture(uPositionTexture, aUv);

    vec4 modelPosition      = modelMatrix      * vec4(particle.xyz, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    float sizeIn  = smoothstep(0.0, 0.1, particle.a);
    float sizeOut = 1.0 - smoothstep(0.7, 1.0, particle.a);
    float size    = min(sizeIn, sizeOut);

    gl_Position   = projectionPosition;
    gl_PointSize  = size * aSize * uSize * uResolution.y;
    gl_PointSize *= (-1.0 / viewPosition.z);

    vColor = aColor;
}`,_ee=`varying vec3 vColor;

void main() {
    float distanceToCenter = length(gl_PointCoord - vec2(0.5));
    if (distanceToCenter > 0.5) {
        discard;
    }

    gl_FragColor = vec4(vColor, 1.0);
    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`;const wee="/three.js-journey/assets/model-1AEEyafl.glb";var up,$n,M5,b5,T5,E5,A5,C5,P5,R5,E2,A2,wU;let See=(wU=class extends Dt{constructor(){super(...arguments);st(this,$n);oe(this,"model");oe(this,"mesh");oe(this,"timer");oe(this,"gpuComputation",null);oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);oe(this,"rendererParams",{clearColor:"#29191f"});st(this,up)}get number(){return"41"}get title(){return"GPGPU Flow Field Particles"}get link(){return"https://threejs-journey.com/lessons/gpgpu-flow-field-particles-shaders"}update(t){this.timer.update(t),this.control.update(),this.gpuComputation&&(this.gpuComputation.particleVariable.material.uniforms.uTime.value=this.timer.getElapsed(),this.gpuComputation.particleVariable.material.uniforms.uDeltaTime.value=this.timer.getDelta(),this.gpuComputation.renderer.compute(),this.mesh.material.uniforms.uPositionTexture.value=this.gpuComputation.getRendererTexture())}init(){super.init(),this.timer=new qp,W(this,$n,M5).call(this),W(this,$n,C5).call(this),W(this,$n,P5).call(this)}dispose(){this.canvas.removeEventListener("resize",gt(this,up)),this.timer.dispose(),super.dispose()}},up=new WeakMap,$n=new WeakSet,M5=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load(wee,r=>{this.model=r.scene.children[0],W(this,$n,T5).call(this),W(this,$n,E5).call(this),W(this,$n,b5).call(this),W(this,$n,R5).call(this)})},b5=function(){this.guiControl.addColor(this.rendererParams,"clearColor").onChange(t=>{this.renderer.setClearColor(t)}),this.guiControl.add(this.mesh.material.uniforms.uSize,"value").min(0).max(1).step(.001).name("uSize"),this.guiControl.add(this.gpuComputation.particleVariable.material.uniforms.uStrengthFactor,"value").min(0).max(1).step(.01).name("uStrength"),this.guiControl.add(this.gpuComputation.particleVariable.material.uniforms.uFlowStrength,"value").min(0).max(10).step(.001).name("uFlowStrength"),this.guiControl.add(this.gpuComputation.particleVariable.material.uniforms.uFlowFrequency,"value").min(0).max(1).step(.001).name("uFlowFrequency")},T5=function(){this.gpuComputation=new yee(this.model.geometry.attributes.position,this.renderer),this.gpuComputation.particleVariable.material.uniforms.uTime=new We(0),this.gpuComputation.particleVariable.material.uniforms.uDeltaTime=new We(0),this.gpuComputation.particleVariable.material.uniforms.uStrengthFactor=new We(.5),this.gpuComputation.particleVariable.material.uniforms.uFlowStrength=new We(2),this.gpuComputation.particleVariable.material.uniforms.uFlowFrequency=new We(.5),this.gpuComputation.particleVariable.material.uniforms.uBasePositionTexture=new We(this.gpuComputation.baseTexture)},E5=function(){const t=new yt;t.setDrawRange(0,this.gpuComputation.particles.count),this.mesh=new ca(t,new Ft({vertexShader:xee,fragmentShader:_ee,uniforms:{uSize:new We(.07),uResolution:new We(new be(W(this,$n,E2).call(this),W(this,$n,A2).call(this))),uPositionTexture:new We(this.gpuComputation.getRendererTexture())}})),W(this,$n,A5).call(this),this.scene.add(this.mesh)},A5=function(){const t=new Float32Array(this.gpuComputation.particles.count*2),n=new Float32Array(this.gpuComputation.particles.count*1),r=this.gpuComputation.getRendererTexture();for(let s=0;s<r.image.height;s++)for(let o=0;o<r.image.width;o++){const a=s*r.image.width+o,l=a*2,c=(o+.5)/r.image.width,u=(s+.5)/r.image.height;t[l+0]=c,t[l+1]=u,n[a]=Math.random()}this.mesh.geometry.setAttribute("aUv",new wt(t,2)),this.mesh.geometry.setAttribute("aColor",this.model.geometry.attributes.color),this.mesh.geometry.setAttribute("aSize",new wt(n,1))},C5=function(){this.camera.fov=35,this.camera.position.set(4.5,4,11),this.camera.updateProjectionMatrix()},P5=function(){this.renderer.setClearColor(this.rendererParams.clearColor)},R5=function(){Ln(this,up,()=>{this.mesh.material.uniforms.uResolution.value.set(W(this,$n,E2).call(this),W(this,$n,A2).call(this))}),this.canvas.addEventListener("resize",gt(this,up))},E2=function(){return this.canvas.width*this.renderer.getPixelRatio()},A2=function(){return this.canvas.height*this.renderer.getPixelRatio()},wU);var Mee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Yy(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var L5={exports:{}};(function(i,e){(function(t){i.exports=t()})(function(){return function t(n,r,s){function o(c,u){if(!r[c]){if(!n[c]){var h=typeof Yy=="function"&&Yy;if(!u&&h)return h(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}u=r[c]={exports:{}},n[c][0].call(u.exports,function(f){var p=n[c][1][f];return o(p||f)},u,u.exports,t,n,r,s)}return r[c].exports}for(var a=typeof Yy=="function"&&Yy,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){var v=t("crypto");function x(E,A){A=_(E,A);var T;return(T=A.algorithm!=="passthrough"?v.createHash(A.algorithm):new C).write===void 0&&(T.write=T.update,T.end=T.update),S(A,T).dispatch(E),T.update||T.end(""),T.digest?T.digest(A.encoding==="buffer"?void 0:A.encoding):(E=T.read(),A.encoding!=="buffer"?E.toString(A.encoding):E)}(r=n.exports=x).sha1=function(E){return x(E)},r.keys=function(E){return x(E,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(E){return x(E,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(E){return x(E,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var y=v.getHashes?v.getHashes().slice():["sha1","md5"],g=(y.push("passthrough"),["buffer","hex","binary","base64"]);function _(E,A){var T={};if(T.algorithm=(A=A||{}).algorithm||"sha1",T.encoding=A.encoding||"hex",T.excludeValues=!!A.excludeValues,T.algorithm=T.algorithm.toLowerCase(),T.encoding=T.encoding.toLowerCase(),T.ignoreUnknown=A.ignoreUnknown===!0,T.respectType=A.respectType!==!1,T.respectFunctionNames=A.respectFunctionNames!==!1,T.respectFunctionProperties=A.respectFunctionProperties!==!1,T.unorderedArrays=A.unorderedArrays===!0,T.unorderedSets=A.unorderedSets!==!1,T.unorderedObjects=A.unorderedObjects!==!1,T.replacer=A.replacer||void 0,T.excludeKeys=A.excludeKeys||void 0,E===void 0)throw new Error("Object argument required.");for(var L=0;L<y.length;++L)y[L].toLowerCase()===T.algorithm.toLowerCase()&&(T.algorithm=y[L]);if(y.indexOf(T.algorithm)===-1)throw new Error('Algorithm "'+T.algorithm+'"  not supported. supported values: '+y.join(", "));if(g.indexOf(T.encoding)===-1&&T.algorithm!=="passthrough")throw new Error('Encoding "'+T.encoding+'"  not supported. supported values: '+g.join(", "));return T}function w(E){if(typeof E=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(E))!=null}function S(E,A,T){T=T||[];function L(M){return A.update?A.update(M,"utf8"):A.write(M,"utf8")}return{dispatch:function(M){return this["_"+((M=E.replacer?E.replacer(M):M)===null?"null":typeof M)](M)},_object:function(M){var R,D=Object.prototype.toString.call(M),F=/\[object (.*)\]/i.exec(D);if(F=(F=F?F[1]:"unknown:["+D+"]").toLowerCase(),0<=(D=T.indexOf(M)))return this.dispatch("[CIRCULAR:"+D+"]");if(T.push(M),a!==void 0&&a.isBuffer&&a.isBuffer(M))return L("buffer:"),L(M);if(F==="object"||F==="function"||F==="asyncfunction")return D=Object.keys(M),E.unorderedObjects&&(D=D.sort()),E.respectType===!1||w(M)||D.splice(0,0,"prototype","__proto__","constructor"),E.excludeKeys&&(D=D.filter(function(z){return!E.excludeKeys(z)})),L("object:"+D.length+":"),R=this,D.forEach(function(z){R.dispatch(z),L(":"),E.excludeValues||R.dispatch(M[z]),L(",")});if(!this["_"+F]){if(E.ignoreUnknown)return L("["+F+"]");throw new Error('Unknown object type "'+F+'"')}this["_"+F](M)},_array:function(M,z){z=z!==void 0?z:E.unorderedArrays!==!1;var D=this;if(L("array:"+M.length+":"),!z||M.length<=1)return M.forEach(function(q){return D.dispatch(q)});var F=[],z=M.map(function(q){var H=new C,$=T.slice();return S(E,H,$).dispatch(q),F=F.concat($.slice(T.length)),H.read().toString()});return T=T.concat(F),z.sort(),this._array(z,!1)},_date:function(M){return L("date:"+M.toJSON())},_symbol:function(M){return L("symbol:"+M.toString())},_error:function(M){return L("error:"+M.toString())},_boolean:function(M){return L("bool:"+M.toString())},_string:function(M){L("string:"+M.length+":"),L(M.toString())},_function:function(M){L("fn:"),w(M)?this.dispatch("[native]"):this.dispatch(M.toString()),E.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(M.name)),E.respectFunctionProperties&&this._object(M)},_number:function(M){return L("number:"+M.toString())},_xml:function(M){return L("xml:"+M.toString())},_null:function(){return L("Null")},_undefined:function(){return L("Undefined")},_regexp:function(M){return L("regex:"+M.toString())},_uint8array:function(M){return L("uint8array:"),this.dispatch(Array.prototype.slice.call(M))},_uint8clampedarray:function(M){return L("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(M))},_int8array:function(M){return L("int8array:"),this.dispatch(Array.prototype.slice.call(M))},_uint16array:function(M){return L("uint16array:"),this.dispatch(Array.prototype.slice.call(M))},_int16array:function(M){return L("int16array:"),this.dispatch(Array.prototype.slice.call(M))},_uint32array:function(M){return L("uint32array:"),this.dispatch(Array.prototype.slice.call(M))},_int32array:function(M){return L("int32array:"),this.dispatch(Array.prototype.slice.call(M))},_float32array:function(M){return L("float32array:"),this.dispatch(Array.prototype.slice.call(M))},_float64array:function(M){return L("float64array:"),this.dispatch(Array.prototype.slice.call(M))},_arraybuffer:function(M){return L("arraybuffer:"),this.dispatch(new Uint8Array(M))},_url:function(M){return L("url:"+M.toString())},_map:function(M){return L("map:"),M=Array.from(M),this._array(M,E.unorderedSets!==!1)},_set:function(M){return L("set:"),M=Array.from(M),this._array(M,E.unorderedSets!==!1)},_file:function(M){return L("file:"),this.dispatch([M.name,M.size,M.type,M.lastModfied])},_blob:function(){if(E.ignoreUnknown)return L("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return L("domwindow")},_bigint:function(M){return L("bigint:"+M.toString())},_process:function(){return L("process")},_timer:function(){return L("timer")},_pipe:function(){return L("pipe")},_tcp:function(){return L("tcp")},_udp:function(){return L("udp")},_tty:function(){return L("tty")},_statwatcher:function(){return L("statwatcher")},_securecontext:function(){return L("securecontext")},_connection:function(){return L("connection")},_zlib:function(){return L("zlib")},_context:function(){return L("context")},_nodescript:function(){return L("nodescript")},_httpparser:function(){return L("httpparser")},_dataview:function(){return L("dataview")},_signal:function(){return L("signal")},_fsevent:function(){return L("fsevent")},_tlswrap:function(){return L("tlswrap")}}}function C(){return{buf:"",write:function(E){this.buf+=E},end:function(E){this.buf+=E},read:function(){return this.buf}}}r.writeToStream=function(E,A,T){return T===void 0&&(T=A,A={}),S(A=_(E,A),T).dispatch(E)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){(function(v){var x=typeof Uint8Array<"u"?Uint8Array:Array,y=43,g=47,_=48,w=97,S=65,C=45,E=95;function A(T){return T=T.charCodeAt(0),T===y||T===C?62:T===g||T===E?63:T<_?-1:T<_+10?T-_+26+26:T<S+26?T-S:T<w+26?T-w+26:void 0}v.toByteArray=function(T){var L,M;if(0<T.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=T.length,R=T.charAt(R-2)==="="?2:T.charAt(R-1)==="="?1:0,D=new x(3*T.length/4-R),F=0<R?T.length-4:T.length,z=0;function q(H){D[z++]=H}for(L=0;L<F;L+=4,0)q((16711680&(M=A(T.charAt(L))<<18|A(T.charAt(L+1))<<12|A(T.charAt(L+2))<<6|A(T.charAt(L+3))))>>16),q((65280&M)>>8),q(255&M);return R==2?q(255&(M=A(T.charAt(L))<<2|A(T.charAt(L+1))>>4)):R==1&&(q((M=A(T.charAt(L))<<10|A(T.charAt(L+1))<<4|A(T.charAt(L+2))>>2)>>8&255),q(255&M)),D},v.fromByteArray=function(T){var L,M,R,D,F=T.length%3,z="";function q(H){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(H)}for(L=0,R=T.length-F;L<R;L+=3)M=(T[L]<<16)+(T[L+1]<<8)+T[L+2],z+=q((D=M)>>18&63)+q(D>>12&63)+q(D>>6&63)+q(63&D);switch(F){case 1:z=(z+=q((M=T[T.length-1])>>2))+q(M<<4&63)+"==";break;case 2:z=(z=(z+=q((M=(T[T.length-2]<<8)+T[T.length-1])>>10))+q(M>>4&63))+q(M<<2&63)+"="}return z}})(r===void 0?this.base64js={}:r)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,n,r){(function(s,o,y,l,c,u,h,f,p){var v=t("base64-js"),x=t("ieee754");function y(G,Q,J){if(!(this instanceof y))return new y(G,Q,J);var ne,Y,de,ve,Se=typeof G;if(Q==="base64"&&Se=="string")for(G=(ve=G).trim?ve.trim():ve.replace(/^\s+|\s+$/g,"");G.length%4!=0;)G+="=";if(Se=="number")ne=U(G);else if(Se=="string")ne=y.byteLength(G,Q);else{if(Se!="object")throw new Error("First argument needs to be a number, array or string.");ne=U(G.length)}if(y._useTypedArrays?Y=y._augment(new Uint8Array(ne)):((Y=this).length=ne,Y._isBuffer=!0),y._useTypedArrays&&typeof G.byteLength=="number")Y._set(G);else if(X(ve=G)||y.isBuffer(ve)||ve&&typeof ve=="object"&&typeof ve.length=="number")for(de=0;de<ne;de++)y.isBuffer(G)?Y[de]=G.readUInt8(de):Y[de]=G[de];else if(Se=="string")Y.write(G,0,Q);else if(Se=="number"&&!y._useTypedArrays&&!J)for(de=0;de<ne;de++)Y[de]=0;return Y}function g(G,Q,J,ne){return y._charsWritten=ie(function(Y){for(var de=[],ve=0;ve<Y.length;ve++)de.push(255&Y.charCodeAt(ve));return de}(Q),G,J,ne)}function _(G,Q,J,ne){return y._charsWritten=ie(function(Y){for(var de,ve,Se=[],Te=0;Te<Y.length;Te++)ve=Y.charCodeAt(Te),de=ve>>8,ve=ve%256,Se.push(ve),Se.push(de);return Se}(Q),G,J,ne)}function w(G,Q,J){var ne="";J=Math.min(G.length,J);for(var Y=Q;Y<J;Y++)ne+=String.fromCharCode(G[Y]);return ne}function S(G,Q,J,de){de||(le(typeof J=="boolean","missing or invalid endian"),le(Q!=null,"missing offset"),le(Q+1<G.length,"Trying to read beyond buffer length"));var Y,de=G.length;if(!(de<=Q))return J?(Y=G[Q],Q+1<de&&(Y|=G[Q+1]<<8)):(Y=G[Q]<<8,Q+1<de&&(Y|=G[Q+1])),Y}function C(G,Q,J,de){de||(le(typeof J=="boolean","missing or invalid endian"),le(Q!=null,"missing offset"),le(Q+3<G.length,"Trying to read beyond buffer length"));var Y,de=G.length;if(!(de<=Q))return J?(Q+2<de&&(Y=G[Q+2]<<16),Q+1<de&&(Y|=G[Q+1]<<8),Y|=G[Q],Q+3<de&&(Y+=G[Q+3]<<24>>>0)):(Q+1<de&&(Y=G[Q+1]<<16),Q+2<de&&(Y|=G[Q+2]<<8),Q+3<de&&(Y|=G[Q+3]),Y+=G[Q]<<24>>>0),Y}function E(G,Q,J,ne){if(ne||(le(typeof J=="boolean","missing or invalid endian"),le(Q!=null,"missing offset"),le(Q+1<G.length,"Trying to read beyond buffer length")),!(G.length<=Q))return ne=S(G,Q,J,!0),32768&ne?-1*(65535-ne+1):ne}function A(G,Q,J,ne){if(ne||(le(typeof J=="boolean","missing or invalid endian"),le(Q!=null,"missing offset"),le(Q+3<G.length,"Trying to read beyond buffer length")),!(G.length<=Q))return ne=C(G,Q,J,!0),2147483648&ne?-1*(4294967295-ne+1):ne}function T(G,Q,J,ne){return ne||(le(typeof J=="boolean","missing or invalid endian"),le(Q+3<G.length,"Trying to read beyond buffer length")),x.read(G,Q,J,23,4)}function L(G,Q,J,ne){return ne||(le(typeof J=="boolean","missing or invalid endian"),le(Q+7<G.length,"Trying to read beyond buffer length")),x.read(G,Q,J,52,8)}function M(G,Q,J,ne,Y){if(Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+1<G.length,"trying to write beyond buffer length"),te(Q,65535)),Y=G.length,!(Y<=J))for(var de=0,ve=Math.min(Y-J,2);de<ve;de++)G[J+de]=(Q&255<<8*(ne?de:1-de))>>>8*(ne?de:1-de)}function R(G,Q,J,ne,Y){if(Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+3<G.length,"trying to write beyond buffer length"),te(Q,4294967295)),Y=G.length,!(Y<=J))for(var de=0,ve=Math.min(Y-J,4);de<ve;de++)G[J+de]=Q>>>8*(ne?de:3-de)&255}function D(G,Q,J,ne,Y){Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+1<G.length,"Trying to write beyond buffer length"),fe(Q,32767,-32768)),G.length<=J||M(G,0<=Q?Q:65535+Q+1,J,ne,Y)}function F(G,Q,J,ne,Y){Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+3<G.length,"Trying to write beyond buffer length"),fe(Q,2147483647,-2147483648)),G.length<=J||R(G,0<=Q?Q:4294967295+Q+1,J,ne,Y)}function z(G,Q,J,ne,Y){Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+3<G.length,"Trying to write beyond buffer length"),he(Q,34028234663852886e22,-34028234663852886e22)),G.length<=J||x.write(G,Q,J,ne,23,4)}function q(G,Q,J,ne,Y){Y||(le(Q!=null,"missing value"),le(typeof ne=="boolean","missing or invalid endian"),le(J!=null,"missing offset"),le(J+7<G.length,"Trying to write beyond buffer length"),he(Q,17976931348623157e292,-17976931348623157e292)),G.length<=J||x.write(G,Q,J,ne,52,8)}r.Buffer=y,r.SlowBuffer=y,r.INSPECT_MAX_BYTES=50,y.poolSize=8192,y._useTypedArrays=function(){try{var G=new ArrayBuffer(0),Q=new Uint8Array(G);return Q.foo=function(){return 42},Q.foo()===42&&typeof Q.subarray=="function"}catch{return!1}}(),y.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.isBuffer=function(G){return!(G==null||!G._isBuffer)},y.byteLength=function(G,Q){var J;switch(G+="",Q||"utf8"){case"hex":J=G.length/2;break;case"utf8":case"utf-8":J=B(G).length;break;case"ascii":case"binary":case"raw":J=G.length;break;case"base64":J=Z(G).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":J=2*G.length;break;default:throw new Error("Unknown encoding")}return J},y.concat=function(G,Q){if(le(X(G),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),G.length===0)return new y(0);if(G.length===1)return G[0];if(typeof Q!="number")for(Y=Q=0;Y<G.length;Y++)Q+=G[Y].length;for(var J=new y(Q),ne=0,Y=0;Y<G.length;Y++){var de=G[Y];de.copy(J,ne),ne+=de.length}return J},y.prototype.write=function(G,Q,J,ne){isFinite(Q)?isFinite(J)||(ne=J,J=void 0):(Te=ne,ne=Q,Q=J,J=Te),Q=Number(Q)||0;var Y,de,ve,Se,Te=this.length-Q;switch((!J||Te<(J=Number(J)))&&(J=Te),ne=String(ne||"utf8").toLowerCase()){case"hex":Y=function(Ee,Re,K,k){K=Number(K)||0;var ue=Ee.length-K;(!k||ue<(k=Number(k)))&&(k=ue),le((ue=Re.length)%2==0,"Invalid hex string"),ue/2<k&&(k=ue/2);for(var me=0;me<k;me++){var Me=parseInt(Re.substr(2*me,2),16);le(!isNaN(Me),"Invalid hex string"),Ee[K+me]=Me}return y._charsWritten=2*me,me}(this,G,Q,J);break;case"utf8":case"utf-8":de=this,ve=Q,Se=J,Y=y._charsWritten=ie(B(G),de,ve,Se);break;case"ascii":case"binary":Y=g(this,G,Q,J);break;case"base64":de=this,ve=Q,Se=J,Y=y._charsWritten=ie(Z(G),de,ve,Se);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":Y=_(this,G,Q,J);break;default:throw new Error("Unknown encoding")}return Y},y.prototype.toString=function(G,Q,J){var ne,Y,de,ve,Se=this;if(G=String(G||"utf8").toLowerCase(),Q=Number(Q)||0,(J=J!==void 0?Number(J):Se.length)===Q)return"";switch(G){case"hex":ne=function(Te,Ee,Re){var K=Te.length;(!Ee||Ee<0)&&(Ee=0),(!Re||Re<0||K<Re)&&(Re=K);for(var k="",ue=Ee;ue<Re;ue++)k+=j(Te[ue]);return k}(Se,Q,J);break;case"utf8":case"utf-8":ne=function(Te,Ee,Re){var K="",k="";Re=Math.min(Te.length,Re);for(var ue=Ee;ue<Re;ue++)Te[ue]<=127?(K+=V(k)+String.fromCharCode(Te[ue]),k=""):k+="%"+Te[ue].toString(16);return K+V(k)}(Se,Q,J);break;case"ascii":case"binary":ne=w(Se,Q,J);break;case"base64":Y=Se,ve=J,ne=(de=Q)===0&&ve===Y.length?v.fromByteArray(Y):v.fromByteArray(Y.slice(de,ve));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ne=function(Te,Ee,Re){for(var K=Te.slice(Ee,Re),k="",ue=0;ue<K.length;ue+=2)k+=String.fromCharCode(K[ue]+256*K[ue+1]);return k}(Se,Q,J);break;default:throw new Error("Unknown encoding")}return ne},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},y.prototype.copy=function(G,Q,J,ne){if(Q=Q||0,(ne=ne||ne===0?ne:this.length)!==(J=J||0)&&G.length!==0&&this.length!==0){le(J<=ne,"sourceEnd < sourceStart"),le(0<=Q&&Q<G.length,"targetStart out of bounds"),le(0<=J&&J<this.length,"sourceStart out of bounds"),le(0<=ne&&ne<=this.length,"sourceEnd out of bounds"),ne>this.length&&(ne=this.length);var Y=(ne=G.length-Q<ne-J?G.length-Q+J:ne)-J;if(Y<100||!y._useTypedArrays)for(var de=0;de<Y;de++)G[de+Q]=this[de+J];else G._set(this.subarray(J,J+Y),Q)}},y.prototype.slice=function(G,Q){var J=this.length;if(G=$(G,J,0),Q=$(Q,J,J),y._useTypedArrays)return y._augment(this.subarray(G,Q));for(var ne=Q-G,Y=new y(ne,void 0,!0),de=0;de<ne;de++)Y[de]=this[de+G];return Y},y.prototype.get=function(G){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(G)},y.prototype.set=function(G,Q){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(G,Q)},y.prototype.readUInt8=function(G,Q){if(Q||(le(G!=null,"missing offset"),le(G<this.length,"Trying to read beyond buffer length")),!(G>=this.length))return this[G]},y.prototype.readUInt16LE=function(G,Q){return S(this,G,!0,Q)},y.prototype.readUInt16BE=function(G,Q){return S(this,G,!1,Q)},y.prototype.readUInt32LE=function(G,Q){return C(this,G,!0,Q)},y.prototype.readUInt32BE=function(G,Q){return C(this,G,!1,Q)},y.prototype.readInt8=function(G,Q){if(Q||(le(G!=null,"missing offset"),le(G<this.length,"Trying to read beyond buffer length")),!(G>=this.length))return 128&this[G]?-1*(255-this[G]+1):this[G]},y.prototype.readInt16LE=function(G,Q){return E(this,G,!0,Q)},y.prototype.readInt16BE=function(G,Q){return E(this,G,!1,Q)},y.prototype.readInt32LE=function(G,Q){return A(this,G,!0,Q)},y.prototype.readInt32BE=function(G,Q){return A(this,G,!1,Q)},y.prototype.readFloatLE=function(G,Q){return T(this,G,!0,Q)},y.prototype.readFloatBE=function(G,Q){return T(this,G,!1,Q)},y.prototype.readDoubleLE=function(G,Q){return L(this,G,!0,Q)},y.prototype.readDoubleBE=function(G,Q){return L(this,G,!1,Q)},y.prototype.writeUInt8=function(G,Q,J){J||(le(G!=null,"missing value"),le(Q!=null,"missing offset"),le(Q<this.length,"trying to write beyond buffer length"),te(G,255)),Q>=this.length||(this[Q]=G)},y.prototype.writeUInt16LE=function(G,Q,J){M(this,G,Q,!0,J)},y.prototype.writeUInt16BE=function(G,Q,J){M(this,G,Q,!1,J)},y.prototype.writeUInt32LE=function(G,Q,J){R(this,G,Q,!0,J)},y.prototype.writeUInt32BE=function(G,Q,J){R(this,G,Q,!1,J)},y.prototype.writeInt8=function(G,Q,J){J||(le(G!=null,"missing value"),le(Q!=null,"missing offset"),le(Q<this.length,"Trying to write beyond buffer length"),fe(G,127,-128)),Q>=this.length||(0<=G?this.writeUInt8(G,Q,J):this.writeUInt8(255+G+1,Q,J))},y.prototype.writeInt16LE=function(G,Q,J){D(this,G,Q,!0,J)},y.prototype.writeInt16BE=function(G,Q,J){D(this,G,Q,!1,J)},y.prototype.writeInt32LE=function(G,Q,J){F(this,G,Q,!0,J)},y.prototype.writeInt32BE=function(G,Q,J){F(this,G,Q,!1,J)},y.prototype.writeFloatLE=function(G,Q,J){z(this,G,Q,!0,J)},y.prototype.writeFloatBE=function(G,Q,J){z(this,G,Q,!1,J)},y.prototype.writeDoubleLE=function(G,Q,J){q(this,G,Q,!0,J)},y.prototype.writeDoubleBE=function(G,Q,J){q(this,G,Q,!1,J)},y.prototype.fill=function(G,Q,J){if(Q=Q||0,J=J||this.length,le(typeof(G=typeof(G=G||0)=="string"?G.charCodeAt(0):G)=="number"&&!isNaN(G),"value is not a number"),le(Q<=J,"end < start"),J!==Q&&this.length!==0){le(0<=Q&&Q<this.length,"start out of bounds"),le(0<=J&&J<=this.length,"end out of bounds");for(var ne=Q;ne<J;ne++)this[ne]=G}},y.prototype.inspect=function(){for(var G=[],Q=this.length,J=0;J<Q;J++)if(G[J]=j(this[J]),J===r.INSPECT_MAX_BYTES){G[J+1]="...";break}return"<Buffer "+G.join(" ")+">"},y.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(y._useTypedArrays)return new y(this).buffer;for(var G=new Uint8Array(this.length),Q=0,J=G.length;Q<J;Q+=1)G[Q]=this[Q];return G.buffer};var H=y.prototype;function $(G,Q,J){return typeof G!="number"?J:Q<=(G=~~G)?Q:0<=G||0<=(G+=Q)?G:0}function U(G){return(G=~~Math.ceil(+G))<0?0:G}function X(G){return(Array.isArray||function(Q){return Object.prototype.toString.call(Q)==="[object Array]"})(G)}function j(G){return G<16?"0"+G.toString(16):G.toString(16)}function B(G){for(var Q=[],J=0;J<G.length;J++){var ne=G.charCodeAt(J);if(ne<=127)Q.push(G.charCodeAt(J));else for(var Y=J,de=(55296<=ne&&ne<=57343&&J++,encodeURIComponent(G.slice(Y,J+1)).substr(1).split("%")),ve=0;ve<de.length;ve++)Q.push(parseInt(de[ve],16))}return Q}function Z(G){return v.toByteArray(G)}function ie(G,Q,J,ne){for(var Y=0;Y<ne&&!(Y+J>=Q.length||Y>=G.length);Y++)Q[Y+J]=G[Y];return Y}function V(G){try{return decodeURIComponent(G)}catch{return"�"}}function te(G,Q){le(typeof G=="number","cannot write a non-number as a number"),le(0<=G,"specified a negative value for writing an unsigned value"),le(G<=Q,"value is larger than maximum value for type"),le(Math.floor(G)===G,"value has a fractional component")}function fe(G,Q,J){le(typeof G=="number","cannot write a non-number as a number"),le(G<=Q,"value larger than maximum allowed value"),le(J<=G,"value smaller than minimum allowed value"),le(Math.floor(G)===G,"value has a fractional component")}function he(G,Q,J){le(typeof G=="number","cannot write a non-number as a number"),le(G<=Q,"value larger than maximum allowed value"),le(J<=G,"value smaller than minimum allowed value")}function le(G,Q){if(!G)throw new Error(Q||"Failed assertion")}y._augment=function(G){return G._isBuffer=!0,G._get=G.get,G._set=G.set,G.get=H.get,G.set=H.set,G.write=H.write,G.toString=H.toString,G.toLocaleString=H.toString,G.toJSON=H.toJSON,G.copy=H.copy,G.slice=H.slice,G.readUInt8=H.readUInt8,G.readUInt16LE=H.readUInt16LE,G.readUInt16BE=H.readUInt16BE,G.readUInt32LE=H.readUInt32LE,G.readUInt32BE=H.readUInt32BE,G.readInt8=H.readInt8,G.readInt16LE=H.readInt16LE,G.readInt16BE=H.readInt16BE,G.readInt32LE=H.readInt32LE,G.readInt32BE=H.readInt32BE,G.readFloatLE=H.readFloatLE,G.readFloatBE=H.readFloatBE,G.readDoubleLE=H.readDoubleLE,G.readDoubleBE=H.readDoubleBE,G.writeUInt8=H.writeUInt8,G.writeUInt16LE=H.writeUInt16LE,G.writeUInt16BE=H.writeUInt16BE,G.writeUInt32LE=H.writeUInt32LE,G.writeUInt32BE=H.writeUInt32BE,G.writeInt8=H.writeInt8,G.writeInt16LE=H.writeInt16LE,G.writeInt16BE=H.writeInt16BE,G.writeInt32LE=H.writeInt32LE,G.writeInt32BE=H.writeInt32BE,G.writeFloatLE=H.writeFloatLE,G.writeFloatBE=H.writeFloatBE,G.writeDoubleLE=H.writeDoubleLE,G.writeDoubleBE=H.writeDoubleBE,G.fill=H.fill,G.inspect=H.inspect,G.toArrayBuffer=H.toArrayBuffer,G}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,n,r){(function(s,o,v,l,c,u,h,f,p){var v=t("buffer").Buffer,x=4,y=new v(x);y.fill(0),n.exports={hash:function(g,_,w,S){for(var C=_(function(M,R){M.length%x!=0&&(D=M.length+(x-M.length%x),M=v.concat([M,y],D));for(var D,F=[],z=R?M.readInt32BE:M.readInt32LE,q=0;q<M.length;q+=x)F.push(z.call(M,q));return F}(g=v.isBuffer(g)?g:new v(g),S),8*g.length),_=S,E=new v(w),A=_?E.writeInt32BE:E.writeInt32LE,T=0;T<C.length;T++)A.call(E,C[T],4*T,!0);return E}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,n,r){(function(s,o,v,l,c,u,h,f,p){var v=t("buffer").Buffer,x=t("./sha"),y=t("./sha256"),g=t("./rng"),_={sha1:x,sha256:y,md5:t("./md5")},w=64,S=new v(w);function C(M,R){var D=_[M=M||"sha1"],F=[];return D||E("algorithm:",M,"is not yet supported"),{update:function(z){return v.isBuffer(z)||(z=new v(z)),F.push(z),z.length,this},digest:function(z){var q=v.concat(F),q=R?function(H,$,U){v.isBuffer($)||($=new v($)),v.isBuffer(U)||(U=new v(U)),$.length>w?$=H($):$.length<w&&($=v.concat([$,S],w));for(var X=new v(w),j=new v(w),B=0;B<w;B++)X[B]=54^$[B],j[B]=92^$[B];return U=H(v.concat([X,U])),H(v.concat([j,U]))}(D,R,q):D(q);return F=null,z?q.toString(z):q}}}function E(){var M=[].slice.call(arguments).join(" ");throw new Error([M,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}S.fill(0),r.createHash=function(M){return C(M)},r.createHmac=C,r.randomBytes=function(M,R){if(!R||!R.call)return new v(g(M));try{R.call(this,void 0,new v(g(M)))}catch(D){R(D)}};var A,T=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],L=function(M){r[M]=function(){E("sorry,",M,"is not implemented yet")}};for(A in T)L(T[A])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){var v=t("./helpers");function x(E,A){E[A>>5]|=128<<A%32,E[14+(A+64>>>9<<4)]=A;for(var T=1732584193,L=-271733879,M=-1732584194,R=271733878,D=0;D<E.length;D+=16){var F=T,z=L,q=M,H=R,T=g(T,L,M,R,E[D+0],7,-680876936),R=g(R,T,L,M,E[D+1],12,-389564586),M=g(M,R,T,L,E[D+2],17,606105819),L=g(L,M,R,T,E[D+3],22,-1044525330);T=g(T,L,M,R,E[D+4],7,-176418897),R=g(R,T,L,M,E[D+5],12,1200080426),M=g(M,R,T,L,E[D+6],17,-1473231341),L=g(L,M,R,T,E[D+7],22,-45705983),T=g(T,L,M,R,E[D+8],7,1770035416),R=g(R,T,L,M,E[D+9],12,-1958414417),M=g(M,R,T,L,E[D+10],17,-42063),L=g(L,M,R,T,E[D+11],22,-1990404162),T=g(T,L,M,R,E[D+12],7,1804603682),R=g(R,T,L,M,E[D+13],12,-40341101),M=g(M,R,T,L,E[D+14],17,-1502002290),T=_(T,L=g(L,M,R,T,E[D+15],22,1236535329),M,R,E[D+1],5,-165796510),R=_(R,T,L,M,E[D+6],9,-1069501632),M=_(M,R,T,L,E[D+11],14,643717713),L=_(L,M,R,T,E[D+0],20,-373897302),T=_(T,L,M,R,E[D+5],5,-701558691),R=_(R,T,L,M,E[D+10],9,38016083),M=_(M,R,T,L,E[D+15],14,-660478335),L=_(L,M,R,T,E[D+4],20,-405537848),T=_(T,L,M,R,E[D+9],5,568446438),R=_(R,T,L,M,E[D+14],9,-1019803690),M=_(M,R,T,L,E[D+3],14,-187363961),L=_(L,M,R,T,E[D+8],20,1163531501),T=_(T,L,M,R,E[D+13],5,-1444681467),R=_(R,T,L,M,E[D+2],9,-51403784),M=_(M,R,T,L,E[D+7],14,1735328473),T=w(T,L=_(L,M,R,T,E[D+12],20,-1926607734),M,R,E[D+5],4,-378558),R=w(R,T,L,M,E[D+8],11,-2022574463),M=w(M,R,T,L,E[D+11],16,1839030562),L=w(L,M,R,T,E[D+14],23,-35309556),T=w(T,L,M,R,E[D+1],4,-1530992060),R=w(R,T,L,M,E[D+4],11,1272893353),M=w(M,R,T,L,E[D+7],16,-155497632),L=w(L,M,R,T,E[D+10],23,-1094730640),T=w(T,L,M,R,E[D+13],4,681279174),R=w(R,T,L,M,E[D+0],11,-358537222),M=w(M,R,T,L,E[D+3],16,-722521979),L=w(L,M,R,T,E[D+6],23,76029189),T=w(T,L,M,R,E[D+9],4,-640364487),R=w(R,T,L,M,E[D+12],11,-421815835),M=w(M,R,T,L,E[D+15],16,530742520),T=S(T,L=w(L,M,R,T,E[D+2],23,-995338651),M,R,E[D+0],6,-198630844),R=S(R,T,L,M,E[D+7],10,1126891415),M=S(M,R,T,L,E[D+14],15,-1416354905),L=S(L,M,R,T,E[D+5],21,-57434055),T=S(T,L,M,R,E[D+12],6,1700485571),R=S(R,T,L,M,E[D+3],10,-1894986606),M=S(M,R,T,L,E[D+10],15,-1051523),L=S(L,M,R,T,E[D+1],21,-2054922799),T=S(T,L,M,R,E[D+8],6,1873313359),R=S(R,T,L,M,E[D+15],10,-30611744),M=S(M,R,T,L,E[D+6],15,-1560198380),L=S(L,M,R,T,E[D+13],21,1309151649),T=S(T,L,M,R,E[D+4],6,-145523070),R=S(R,T,L,M,E[D+11],10,-1120210379),M=S(M,R,T,L,E[D+2],15,718787259),L=S(L,M,R,T,E[D+9],21,-343485551),T=C(T,F),L=C(L,z),M=C(M,q),R=C(R,H)}return Array(T,L,M,R)}function y(E,A,T,L,M,R){return C((A=C(C(A,E),C(L,R)))<<M|A>>>32-M,T)}function g(E,A,T,L,M,R,D){return y(A&T|~A&L,E,A,M,R,D)}function _(E,A,T,L,M,R,D){return y(A&L|T&~L,E,A,M,R,D)}function w(E,A,T,L,M,R,D){return y(A^T^L,E,A,M,R,D)}function S(E,A,T,L,M,R,D){return y(T^(A|~L),E,A,M,R,D)}function C(E,A){var T=(65535&E)+(65535&A);return(E>>16)+(A>>16)+(T>>16)<<16|65535&T}n.exports=function(E){return v.hash(E,x,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){n.exports=function(v){for(var x,y=new Array(v),g=0;g<v;g++)!(3&g)&&(x=4294967296*Math.random()),y[g]=x>>>((3&g)<<3)&255;return y}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){var v=t("./helpers");function x(_,w){_[w>>5]|=128<<24-w%32,_[15+(w+64>>9<<4)]=w;for(var S,C,E,A=Array(80),T=1732584193,L=-271733879,M=-1732584194,R=271733878,D=-1009589776,F=0;F<_.length;F+=16){for(var z=T,q=L,H=M,$=R,U=D,X=0;X<80;X++){A[X]=X<16?_[F+X]:g(A[X-3]^A[X-8]^A[X-14]^A[X-16],1);var j=y(y(g(T,5),(j=L,C=M,E=R,(S=X)<20?j&C|~j&E:!(S<40)&&S<60?j&C|j&E|C&E:j^C^E)),y(y(D,A[X]),(S=X)<20?1518500249:S<40?1859775393:S<60?-1894007588:-899497514)),D=R,R=M,M=g(L,30),L=T,T=j}T=y(T,z),L=y(L,q),M=y(M,H),R=y(R,$),D=y(D,U)}return Array(T,L,M,R,D)}function y(_,w){var S=(65535&_)+(65535&w);return(_>>16)+(w>>16)+(S>>16)<<16|65535&S}function g(_,w){return _<<w|_>>>32-w}n.exports=function(_){return v.hash(_,x,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){function v(w,S){var C=(65535&w)+(65535&S);return(w>>16)+(S>>16)+(C>>16)<<16|65535&C}function x(w,S){var C,E=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),A=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64);w[S>>5]|=128<<24-S%32,w[15+(S+64>>9<<4)]=S;for(var L,M,R=0;R<w.length;R+=16){for(var D=A[0],F=A[1],z=A[2],q=A[3],H=A[4],$=A[5],U=A[6],X=A[7],j=0;j<64;j++)T[j]=j<16?w[j+R]:v(v(v((M=T[j-2],g(M,17)^g(M,19)^_(M,10)),T[j-7]),(M=T[j-15],g(M,7)^g(M,18)^_(M,3))),T[j-16]),C=v(v(v(v(X,g(M=H,6)^g(M,11)^g(M,25)),H&$^~H&U),E[j]),T[j]),L=v(g(L=D,2)^g(L,13)^g(L,22),D&F^D&z^F&z),X=U,U=$,$=H,H=v(q,C),q=z,z=F,F=D,D=v(C,L);A[0]=v(D,A[0]),A[1]=v(F,A[1]),A[2]=v(z,A[2]),A[3]=v(q,A[3]),A[4]=v(H,A[4]),A[5]=v($,A[5]),A[6]=v(U,A[6]),A[7]=v(X,A[7])}return A}var y=t("./helpers"),g=function(w,S){return w>>>S|w<<32-S},_=function(w,S){return w>>>S};n.exports=function(w){return y.hash(w,x,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){r.read=function(v,x,y,g,R){var w,S,C=8*R-g-1,E=(1<<C)-1,A=E>>1,T=-7,L=y?R-1:0,M=y?-1:1,R=v[x+L];for(L+=M,w=R&(1<<-T)-1,R>>=-T,T+=C;0<T;w=256*w+v[x+L],L+=M,T-=8);for(S=w&(1<<-T)-1,w>>=-T,T+=g;0<T;S=256*S+v[x+L],L+=M,T-=8);if(w===0)w=1-A;else{if(w===E)return S?NaN:1/0*(R?-1:1);S+=Math.pow(2,g),w-=A}return(R?-1:1)*S*Math.pow(2,w-g)},r.write=function(v,x,y,g,_,D){var S,C,E=8*D-_-1,A=(1<<E)-1,T=A>>1,L=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=g?0:D-1,R=g?1:-1,D=x<0||x===0&&1/x<0?1:0;for(x=Math.abs(x),isNaN(x)||x===1/0?(C=isNaN(x)?1:0,S=A):(S=Math.floor(Math.log(x)/Math.LN2),x*(g=Math.pow(2,-S))<1&&(S--,g*=2),2<=(x+=1<=S+T?L/g:L*Math.pow(2,1-T))*g&&(S++,g/=2),A<=S+T?(C=0,S=A):1<=S+T?(C=(x*g-1)*Math.pow(2,_),S+=T):(C=x*Math.pow(2,T-1)*Math.pow(2,_),S=0));8<=_;v[y+M]=255&C,M+=R,C/=256,_-=8);for(S=S<<_|C,E+=_;0<E;v[y+M]=255&S,M+=R,S/=256,E-=8);v[y+M-R]|=128*D}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,n,r){(function(s,o,a,l,c,u,h,f,p){var v,x,y;function g(){}(s=n.exports={}).nextTick=(x=typeof window<"u"&&window.setImmediate,y=typeof window<"u"&&window.postMessage&&window.addEventListener,x?function(_){return window.setImmediate(_)}:y?(v=[],window.addEventListener("message",function(_){var w=_.source;w!==window&&w!==null||_.data!=="process-tick"||(_.stopPropagation(),0<v.length&&v.shift()())},!0),function(_){v.push(_),window.postMessage("process-tick","*")}):function(_){setTimeout(_,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.binding=function(_){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(_){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(L5);var bee=L5.exports;const Tee=hf(bee);var D5=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],Eee=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],I5=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],Aee=D5,Cee=Aee.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),C2=I5;C2=C2.slice().filter(function(i){return!/^(gl\_|texture)/.test(i)});var Pee=C2.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),Ree=Bee,Lee=D5,NL=Eee,Dee=I5,Iee=Cee,Uee=Pee,ma=999,OL=9999,KM=0,ZM=1,zL=2,BL=3,HL=4,Gm=5,Fee=6,kee=7,Nee=8,GL=9,Oee=10,VL=11,zee=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function Bee(i){var e=0,t=0,n=ma,r,s,o=[],a=[],l=1,c=0,u=0,h=!1,f=!1,p="",v;i=i||{};var x=Dee,y=Lee;i.version==="300 es"&&(x=Uee,y=Iee);for(var g={},_={},e=0;e<x.length;e++)g[x[e]]=!0;for(var e=0;e<y.length;e++)_[y[e]]=!0;return function($){return a=[],$!==null?S($):C()};function w($){$.length&&a.push({type:zee[n],data:$,position:u,line:l,column:c})}function S($){e=0,$.toString&&($=$.toString()),p+=$.replace(/\r\n/g,`
`),v=p.length;for(var U;r=p[e],e<v;){switch(U=e,n){case KM:e=M();break;case ZM:e=L();break;case zL:e=T();break;case BL:e=R();break;case HL:e=z();break;case VL:e=F();break;case Gm:e=q();break;case OL:e=H();break;case GL:e=A();break;case ma:e=E();break}if(U!==e)switch(p[U]){case`
`:c=0,++l;break;default:++c;break}}return t+=e,p=p.slice(e),a}function C($){return o.length&&w(o.join("")),n=Oee,w("(eof)"),a}function E(){return o=o.length?[]:o,s==="/"&&r==="*"?(u=t+e-1,n=KM,s=r,e+1):s==="/"&&r==="/"?(u=t+e-1,n=ZM,s=r,e+1):r==="#"?(n=zL,u=t+e,e):/\s/.test(r)?(n=GL,u=t+e,e):(h=/\d/.test(r),f=/[^\w_]/.test(r),u=t+e,n=h?HL:f?BL:OL,e)}function A(){return/[^\s]/g.test(r)?(w(o.join("")),n=ma,e):(o.push(r),s=r,e+1)}function T(){return(r==="\r"||r===`
`)&&s!=="\\"?(w(o.join("")),n=ma,e):(o.push(r),s=r,e+1)}function L(){return T()}function M(){return r==="/"&&s==="*"?(o.push(r),w(o.join("")),n=ma,e+1):(o.push(r),s=r,e+1)}function R(){if(s==="."&&/\d/.test(r))return n=Gm,e;if(s==="/"&&r==="*")return n=KM,e;if(s==="/"&&r==="/")return n=ZM,e;if(r==="."&&o.length){for(;D(o););return n=Gm,e}if(r===";"||r===")"||r==="("){if(o.length)for(;D(o););return w(r),n=ma,e+1}var $=o.length===2&&r!=="=";if(/[\w_\d\s]/.test(r)||$){for(;D(o););return n=ma,e}return o.push(r),s=r,e+1}function D($){var U=0,X,j;do{if(X=NL.indexOf($.slice(0,$.length+U).join("")),j=NL[X],X===-1){if(U--+$.length>0)continue;j=$.slice(0,1).join("")}return w(j),u+=j.length,o=o.slice(j.length),o.length}while(!0)}function F(){return/[^a-fA-F0-9]/.test(r)?(w(o.join("")),n=ma,e):(o.push(r),s=r,e+1)}function z(){return r==="."||/[eE]/.test(r)?(o.push(r),n=Gm,s=r,e+1):r==="x"&&o.length===1&&o[0]==="0"?(n=VL,o.push(r),s=r,e+1):/[^\d]/.test(r)?(w(o.join("")),n=ma,e):(o.push(r),s=r,e+1)}function q(){return r==="f"&&(o.push(r),s=r,e+=1),/[eE]/.test(r)||(r==="-"||r==="+")&&/[eE]/.test(s)?(o.push(r),s=r,e+1):/[^\d]/.test(r)?(w(o.join("")),n=ma,e):(o.push(r),s=r,e+1)}function H(){if(/[^\d\w_]/.test(r)){var $=o.join("");return _[$]?n=Nee:g[$]?n=kee:n=Fee,w(o.join("")),n=ma,e}return o.push(r),s=r,e+1}}var Hee=Ree,Gee=Vee;function Vee(i,e){var t=Hee(e),n=[];return n=n.concat(t(i)),n=n.concat(t(null)),n}const Wee=hf(Gee);var jee=Xee;function Xee(i){for(var e=[],t=0;t<i.length;t++)i[t].type!=="eof"&&e.push(i[t].data);return e.join("")}const WL=hf(jee);var Yee=qee;function qee(i){var e=null,t=null,n=0,r=0,s=0,o=0,a=0,l=[],c,u,h;for(c=0,u;c<i.length;c++)if(h=i[c],h.data==="{"){if(n&&n++||(u=p(c,bc(")"),bc()),u<0)||(o=u,u=p(u,bc("("),bc(")")),u<0)||(a=u,u=p(u,Vm),u<0)||i[u].type!=="ident"||(t=i[u].data,u=p(u,Vm),u<0))continue;n=1,r=c,e=i[u].data,s=u;var f=p(u,Vm);switch(i[f]&&i[f].data){case"lowp":case"highp":case"mediump":s=f}}else if(n&&h.data==="}"){if(--n)continue;l.push({name:t,type:e,body:[r+1,c],args:[a,o+1],outer:[s,c+1]})}for(c=0;c<i.length;c++)if(h=i[c],h.data===";"){if(u=p(c,bc(")"),bc()),u<0||(o=u,u=p(u,bc("("),bc(")")),u<0)||(a=u,u=p(u,Vm),u<0)||i[u].type!=="ident"||(t=i[u].data,u=p(u,Vm),u<0)||i[u].type==="operator"||i[u].data==="return")continue;e=i[u].data,l.push({name:t,type:e,body:!1,args:[a,o+1],outer:[u,c+1]})}return l.sort(function(v,x){return v.outer[0]-x.outer[0]});function p(v,x,y){for(var g=v-1;g>=0;g--){if(x(i[g]))return g;if(y&&y(i[g]))return-1}return-1}}function bc(i){return function(e){return e.type==="operator"&&(!i||e.data===i)}}function Vm(i){return i.type!=="whitespace"}const Kee=hf(Yee);function Zee(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function U5(i){var e=Zee(i,"string");return typeof e=="symbol"?e:String(e)}function Sn(i,e,t){return e=U5(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jL(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Kf(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?jL(Object(t),!0).forEach(function(n){Sn(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):jL(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Qee(i,e){if(i==null)return{};var t={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function Jee(i,e){if(i==null)return{};var t=Qee(i,e),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(t[n]=i[n])}return t}function $ee(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function ete(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,U5(n.key),n)}}function tte(i,e,t){return e&&ete(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function F5(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function P2(i,e){return P2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},P2(i,e)}function nte(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&P2(i,e)}function x_(i){return x_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x_(i)}function ite(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rte(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F5(i)}function ste(i){var e=ite();return function(){var n=x_(i),r;if(e){var s=x_(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return rte(this,r)}}var It={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Es,Zf,ote=(Es={},Sn(Es,"".concat(It.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(It.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),Sn(Es,"".concat(It.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(It.position,`;
  `)}),Sn(Es,"".concat(It.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(It.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),Sn(Es,"".concat(It.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(It.pointSize,`;
    `)}),Sn(Es,"".concat(It.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(It.diffuseColor,`;
  `)}),Sn(Es,"".concat(It.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(It.fragColor,`;
  `)}),Sn(Es,"".concat(It.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(It.emissive,`;
    `)}),Sn(Es,"".concat(It.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(It.roughness,`;
    `)}),Sn(Es,"".concat(It.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(It.metalness,`;
    `)}),Sn(Es,"".concat(It.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(It.ao,`;
    `)}),Sn(Es,"".concat(It.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(It.bump," - (dot(").concat(It.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),Sn(Es,"".concat(It.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(It.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(It.depthAlpha,`;
    `)}),Es),ate=(Zf={},Sn(Zf,"".concat(It.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(It.position,`, 1.0 );
  `)}),Sn(Zf,"".concat(It.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(It.position,`;
  `)}),Sn(Zf,"".concat(It.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(It.diffuseColor,`;
  `)}),Sn(Zf,"".concat(It.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(It.fragColor,`;
  `)}),Zf),lte=`

#ifdef IS_VERTEX
    // csm_Position & csm_PositionRaw
    #ifdef IS_UNKNOWN
        vec3 csm_Position = vec3(0.0);
        vec4 csm_PositionRaw = vec4(0.0);
        vec3 csm_Normal = vec3(0.0);
    #else
        vec3 csm_Position = position;
        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);
        vec3 csm_Normal = normal;
    #endif

    // csm_PointSize
    #ifdef IS_POINTSMATERIAL
        float csm_PointSize = size;
    #endif
#else
    // csm_DiffuseColor & csm_FragColor
    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL
        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);
        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
    #else
        #ifdef USE_MAP
            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);

            #ifdef DECODE_VIDEO_TEXTURE
            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)
            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);
            #endif

            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
        #else
            vec4 csm_DiffuseColor = vec4(diffuse, opacity);
            vec4 csm_FragColor = vec4(diffuse, opacity);
        #endif
    #endif

    // csm_Emissive, csm_Roughness, csm_Metalness
    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL
        vec3 csm_Emissive = emissive;
        float csm_Roughness = roughness;
        float csm_Metalness = metalness;
    #endif

    // csm_AO
    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL
        float csm_AO = 0.0;
    #endif

    // csm_Bump
    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL 
        vec3 csm_Bump = vec3(0.0);
    #endif

    float csm_DepthAlpha = 1.0;
#endif
`,cte=`
    varying mat4 csm_internal_vModelViewMatrix;
`,ute=`
    csm_internal_vModelViewMatrix = modelViewMatrix;
`,hte=`
    varying mat4 csm_internal_vModelViewMatrix;
`,fte=`
    
`,As,dte=(As={},Sn(As,"".concat(It.position),"*"),Sn(As,"".concat(It.positionRaw),"*"),Sn(As,"".concat(It.normal),"*"),Sn(As,"".concat(It.pointSize),["PointsMaterial"]),Sn(As,"".concat(It.diffuseColor),"*"),Sn(As,"".concat(It.fragColor),"*"),Sn(As,"".concat(It.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),Sn(As,"".concat(It.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Sn(As,"".concat(It.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Sn(As,"".concat(It.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Sn(As,"".concat(It.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Sn(As,"".concat(It.depthAlpha),"*"),As),pte=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"],mte=function(e,t,n){return e.split(t).join(n)},gte=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},vte=function(e,t){return new RegExp("\\b".concat(gte(t),"\\b")).test(e)};function yte(i){try{new i}catch(e){if(e.message.indexOf("is not a constructor")>=0)return!1}return!0}function xte(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Object.assign(i,e);var n=Object.getPrototypeOf(e);Object.entries(Object.getOwnPropertyDescriptors(n)).filter(function(r){var s=typeof r[1].get=="function",o=typeof r[1].set=="function",a=typeof r[1].value=="function",l=r[0]==="constructor";return(s||o||a)&&!l}).forEach(function(r){if(typeof i[r[0]]=="function"){t||console.warn("Function ".concat(r[0]," already exists on CSM, renaming to base_").concat(r[0]));var s="base_".concat(r[0]);i[s]=r[1].value.bind(i);return}Object.defineProperty(i,r[0],r[1])})}function _te(i){var e=i.toString().trim(),t=e.substring(e.indexOf("{")+1,e.lastIndexOf("}"));return t.trim().length===0}function XL(i){return i.replace(/\s/g,"")}function wte(i,e,t){var n=i.lastIndexOf(e);return n===-1?i:i.substring(0,n)+t+i.substring(n+e.length)}var Ep=function(i){nte(t,i);var e=ste(t);function t(n){var r,s=n.baseMaterial,o=n.fragmentShader,a=n.vertexShader,l=n.uniforms,c=n.patchMap,u=n.cacheKey,h=n.silent,f=Jee(n,pte);$ee(this,t);var p;if(yte(s)?p=new s(f):(p=s,Object.assign(p,f)),p.type==="RawShaderMaterial")throw new Error("CustomShaderMaterial does not support RawShaderMaterial");r=e.call(this),xte(F5(r),p,h),r.__csm={patchMap:c||{},fragmentShader:o||"",vertexShader:a||"",cacheKey:u,baseMaterial:s,instanceID:Ai.generateUUID(),type:p.type,isAlreadyExtended:!_te(p.onBeforeCompile),cacheHash:"",silent:h},r.uniforms=Kf(Kf({},r.uniforms||{}),l||{});{var v=r.__csm,x=v.fragmentShader,y=v.vertexShader,g=r.uniforms;r.__csm.cacheHash=r.getCacheHash(),r.generateMaterial(x,y,g)}return r}return tte(t,[{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.uniforms=r.uniforms||this.uniforms,Object.assign(this.__csm,r);var s=this.__csm,o=s.fragmentShader,a=s.vertexShader,l=this.uniforms,c=this.getCacheHash();this.__csm.cacheHash=c,this.generateMaterial(o,a,l)}},{key:"clone",value:function(){var r={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},s=new this.constructor(r);return Object.assign(this,s),s}},{key:"getCacheHash",value:function(){var r=this.__csm,s=r.fragmentShader,o=r.vertexShader,a=this.uniforms,l=Object.values(a).reduce(function(u,h){var f=h.value;return u+JSON.stringify(f)},""),c=XL(s)+XL(o)+l;return c.trim().length>0?Tee(c):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(r,s,o){var a=this,l=this.parseShader(r),c=this.parseShader(s);this.uniforms=o||{},this.customProgramCacheKey=function(){return a.__csm.cacheHash};var u=function(p){try{if(l){var v=a.patchShader(l,p.fragmentShader,!0);p.fragmentShader=a.getMaterialDefine()+v}if(c){var x=a.patchShader(c,p.vertexShader);p.vertexShader=`#define IS_VERTEX;
`+x,p.vertexShader=a.getMaterialDefine()+p.vertexShader}p.uniforms=Kf(Kf({},p.uniforms),a.uniforms),a.uniforms=p.uniforms}catch(y){console.error(y)}};if(this.__csm.isAlreadyExtended){var h=this.onBeforeCompile;this.onBeforeCompile=function(f,p){h(f,p),u(f)}}else this.onBeforeCompile=u;this.needsUpdate=!0}},{key:"patchShader",value:function(r,s,o){var a=this,l=s,c=Kf(Kf({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(c).forEach(function(f){Object.keys(c[f]).forEach(function(p){var v=dte[f],x=a.__csm.type;if(f==="*"||vte(r.main,f))if(!v||Array.isArray(v)&&v.includes(x)||v==="*")l=mte(l,p,c[f][p]);else throw new Error("CSM: ".concat(f," is not available in ").concat(x,". Shader cannot compile."))})}),l=l.replace("void main() {",`
        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED
          `.concat(o?hte:cte,`
          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1
        #endif

        `).concat(r.header,`
        
        void main() {
          #ifndef CSM_IS_DEFAULTS_DEFINED
            `).concat(lte,`
            #define CSM_IS_DEFAULTS_DEFINED 1
          #endif
          
          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED
            `).concat(o?fte:ute,`
            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1
          #endif

          // CSM_START
      `));var u=this.__csm.isAlreadyExtended,h=l.includes("// CSM_END");return u&&h?l=wte(l,"// CSM_END",`
          // CSM_END
          `.concat(r.main,`
          // CSM_END
        `)):l=l.replace("// CSM_START",`
        // CSM_START
        `.concat(r.main,`
        // CSM_END
          `)),l=r.defines+l,l}},{key:"parseShader",value:function(r){if(r){var s=r.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),o=Wee(s),a=Kee(o),l=a.map(function(h){return h.name}).indexOf("main"),c=WL(o.slice(0,l>=0?a[l].outer[0]:void 0)),u=l>=0?this.getShaderFromIndex(o,a[l].body):"";return{defines:"",header:c,main:u}}}},{key:"getMaterialDefine",value:function(){var r=this.__csm.type;return r?"#define IS_".concat(r.toUpperCase(),`;
`):`#define IS_UNKNOWN;
`}},{key:"getPatchMapForMaterial",value:function(){switch(this.__csm.type){case"ShaderMaterial":return ate;default:return ote}}},{key:"getShaderFromIndex",value:function(r,s){return WL(r.slice(s[0],s[1]))}}]),t}(Di),YL=`uniform float uTime;
uniform float uStrength;
uniform float uPositionFrequency;
uniform float uTimeFrequency;
uniform float uWarpStrength;
uniform float uWarpPositionFrequency;
uniform float uWarpTimeFrequency;

attribute vec4 tangent;

varying float vWobble;

vec4 _permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}

float _permute(float x) {
    return floor(mod(((x * 34.0) + 1.0) * x, 289.0));
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

float _taylorInvSqrt(float r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

vec4 _grad4(float j, vec4 ip) {
    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);
    vec4 p,s;

    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;
    p.w   = 1.5 - dot(abs(p.xyz), ones.xyz);
    s     = vec4(lessThan(p, vec4(0.0)));
    p.xyz = p.xyz + (s.xyz * 2.0 - 1.0) * s.www;

    return p;
}

float calcSimplexNoise4d(vec4 v){
    const vec2  C = vec2( 0.138196601125010504,  
    0.309016994374947451); 
    
    vec4 i  = floor(v + dot(v, C.yyyy) );
    vec4 x0 = v -   i + dot(i, C.xxxx);

    

    
    vec4 i0;

    vec3 isX = step( x0.yzw, x0.xxx );
    vec3 isYZ = step( x0.zww, x0.yyz );
    
    i0.x = isX.x + isX.y + isX.z;
    i0.yzw = 1.0 - isX;

    
    i0.y += isYZ.x + isYZ.y;
    i0.zw += 1.0 - isYZ.xy;

    i0.z += isYZ.z;
    i0.w += 1.0 - isYZ.z;

    
    vec4 i3 = clamp( i0, 0.0, 1.0 );
    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );
    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );

    
    vec4 x1 = x0 - i1 + 1.0 * C.xxxx;
    vec4 x2 = x0 - i2 + 2.0 * C.xxxx;
    vec4 x3 = x0 - i3 + 3.0 * C.xxxx;
    vec4 x4 = x0 - 1.0 + 4.0 * C.xxxx;

    
    i = mod(i, 289.0);
    float j0 = _permute( _permute( _permute( _permute(i.w) + i.z) + i.y) + i.x);
    vec4 j1 = _permute( _permute( _permute( _permute (
                                             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))
                                         + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))
                                + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))
                       + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));
    
    
    

    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;

    vec4 p0 = _grad4(j0,   ip);
    vec4 p1 = _grad4(j1.x, ip);
    vec4 p2 = _grad4(j1.y, ip);
    vec4 p3 = _grad4(j1.z, ip);
    vec4 p4 = _grad4(j1.w, ip);

    
    vec4 norm = _taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    p4 *= _taylorInvSqrt(dot(p4,p4));

    
    vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);
    vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);
    m0 = m0 * m0;
    m1 = m1 * m1;
    return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))
    + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;
}

float _calcWobble(
    vec3  position,
    float time,
    float strength,
    float positionFrequency,
    float timeFrequency,
    float warpStrength,
    float warpPositionFrequency,
    float warpTimeFrequency
) {
    vec3 warpedPosition  = position;
    warpedPosition      += calcSimplexNoise4d(
        vec4(
            position * warpPositionFrequency,
            time     * warpTimeFrequency
        )
    ) * warpStrength;

    return calcSimplexNoise4d(
        vec4(
            warpedPosition * positionFrequency,
            time           * timeFrequency
        )
    ) * strength;
}

void main() {
    vec3 bitangent = cross(normal, tangent.xyz);

    float  shift             = 0.01;
    vec3  tangentNeighbour   = csm_Position + shift * tangent.xyz;
    vec3  bitangentNeighbour = csm_Position + shift * bitangent;
    float positionWobble     = _calcWobble(
        csm_Position,
        uTime,
        uStrength,
        uPositionFrequency,
        uTimeFrequency,
        uWarpStrength,
        uWarpPositionFrequency,
        uWarpTimeFrequency
    );
    float tangentWobble = _calcWobble(
        tangentNeighbour,
        uTime,
        uStrength,
        uPositionFrequency,
        uTimeFrequency,
        uWarpStrength,
        uWarpPositionFrequency,
        uWarpTimeFrequency
    );
    float bitangentWobble = _calcWobble(
        bitangentNeighbour,
        uTime,
        uStrength,
        uPositionFrequency,
        uTimeFrequency,
        uWarpStrength,
        uWarpPositionFrequency,
        uWarpTimeFrequency
    );
    csm_Position            += normal * positionWobble;
    tangentNeighbour        += normal * tangentWobble;
    bitangentNeighbour      += normal * bitangentWobble;

    vec3 computedTangentNeighbourDir = normalize(
        tangentNeighbour - csm_Position
    );
    vec3 computedBitangentNeighbourDir = normalize(
        bitangentNeighbour - csm_Position
    );
    csm_Normal = cross(
        computedTangentNeighbourDir,
        computedBitangentNeighbourDir
    );

    vWobble = positionWobble / uStrength;
}`,Ste=`uniform vec3 uInnerColor;
uniform vec3 uOuterColor;

varying float vWobble;

void main() {
    float colorFactor    = smoothstep(-1.0, 1.0, vWobble);
    vec3  color          = mix(uInnerColor, uOuterColor, colorFactor);
    csm_DiffuseColor.rgb = color;
    csm_Roughness        = 1.0 - colorFactor;
}`,Zr,k5,N5,O5,z5,B5,H5,G5,SU;let Mte=(SU=class extends Dt{constructor(){super(...arguments);st(this,Zr);oe(this,"uniforms");oe(this,"wobbleParams",{innerColor:"#0000ff",outerColor:"#ff0000"});oe(this,"mesh",null);oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"42"}get title(){return"Wobbly Sphere"}get link(){return"https://threejs-journey.com/lessons/wobbly-sphere-shader"}update(t){const n=t*.001;this.mesh.material.uniforms.uTime.value=n,this.control.update()}init(){super.init(),W(this,Zr,N5).call(this),W(this,Zr,B5).call(this),W(this,Zr,z5).call(this),W(this,Zr,k5).call(this),W(this,Zr,H5).call(this),W(this,Zr,G5).call(this)}},Zr=new WeakSet,k5=function(){this.guiControl.add(this.mesh.material,"metalness").min(0).max(1).step(.001),this.guiControl.add(this.mesh.material,"roughness").min(0).max(1).step(.001),this.guiControl.add(this.mesh.material,"transmission").min(0).max(1).step(.001),this.guiControl.add(this.mesh.material,"ior").min(0).max(10).step(.001),this.guiControl.add(this.mesh.material,"thickness").min(0).max(10).step(.001),this.guiControl.addColor({color:this.mesh.material.color.getHexString()},"color").onChange(t=>this.mesh.material.color.set(t)),this.guiControl.add(this.mesh.material.uniforms.uStrength,"value").min(0).max(2).step(.001).name("uStrength"),this.guiControl.add(this.mesh.material.uniforms.uPositionFrequency,"value").min(0).max(2).step(.001).name("uPositionFrequency"),this.guiControl.add(this.mesh.material.uniforms.uTimeFrequency,"value").min(0).max(2).step(.001).name("uTimeFrequency"),this.guiControl.add(this.mesh.material.uniforms.uWarpStrength,"value").min(0).max(2).step(.001).name("uWarpStrength"),this.guiControl.add(this.mesh.material.uniforms.uWarpPositionFrequency,"value").min(0).max(2).step(.001).name("uWarpPositionFrequency"),this.guiControl.add(this.mesh.material.uniforms.uWarpTimeFrequency,"value").min(0).max(2).step(.001).name("uWarpTimeFrequency"),this.guiControl.addColor(this.wobbleParams,"innerColor").onChange(t=>{this.mesh.material.uniforms.uInnerColor.value.set(t)}),this.guiControl.addColor(this.wobbleParams,"outerColor").onChange(t=>{this.mesh.material.uniforms.uOuterColor.value.set(t)})},N5=function(){W(this,Zr,O5).call(this);const t=new iu(2.5,50),n=fJ(t);n.computeTangents();const r=new Ep({baseMaterial:pu,vertexShader:YL,silent:!0,depthPacking:sf,uniforms:this.uniforms});this.mesh=new Ae(n,new Ep({baseMaterial:gs,vertexShader:YL,fragmentShader:Ste,silent:!0,metalness:0,roughness:.5,color:16777215,transmission:0,ior:1.5,thickness:1.5,transparent:!0,wireframe:!1,uniforms:this.uniforms})),this.mesh.customDepthMaterial=r,this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.scene.add(this.mesh);const s=new Ae(new Ot(15,15,15),new hn({}));s.position.set(0,-5,5),s.rotation.y=Math.PI,s.receiveShadow=!0,s.visible=!1,this.scene.add(s)},O5=function(){this.uniforms={uTime:new We(0),uStrength:new We(.3),uTimeFrequency:new We(.4),uPositionFrequency:new We(.5),uWarpStrength:new We(1.7),uWarpTimeFrequency:new We(.12),uWarpPositionFrequency:new We(.38),uInnerColor:new We(new Ge(this.wobbleParams.innerColor)),uOuterColor:new We(new Ge(this.wobbleParams.outerColor))}},z5=function(){new Z0().load("/three.js-journey/media/images/environmentMaps/2k.hdr",n=>{n.mapping=Ca,this.scene.environment=n})},B5=function(){const t=new Fi(16777215,3);t.position.set(.25,2,-2.25),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.normalBias=.05,t.shadow.camera.far=15,this.scene.add(t)},H5=function(){this.camera.fov=35,this.camera.position.set(13,-3,-5),this.camera.updateProjectionMatrix()},G5=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.toneMapping=ta,this.renderer.toneMappingExposure=1},SU);var qL=`varying vec3 vPosition;

void main() {
    vPosition = csm_Position;
}`,KL=`uniform float uStartAngle;
uniform float uArcAngle;

varying vec3 vPosition;

void main() {
    float angle  = atan(vPosition.y, vPosition.x);
    angle       -= uStartAngle;
    angle        = mod(angle, PI2);

    if ((angle > 0.0) && (angle < uArcAngle)) {
        discard;
    }

    float csm_Slice;
}`;const bte="/three.js-journey/assets/gears-re--C28B.glb";var qs,V5,W5,j5,X5,Y5,q5,MU;let Tte=(MU=class extends Dt{constructor(){super(...arguments);st(this,qs);oe(this,"model",null);oe(this,"outerHullMesh",null);oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"43"}get title(){return"Sliced Model"}get link(){return"https://threejs-journey.com/lessons/sliced-model-shader"}update(t){const n=t*.001;this.model&&(this.model.rotation.y=.1*n),this.control.update()}init(){super.init(),W(this,qs,j5).call(this),W(this,qs,X5).call(this),W(this,qs,W5).call(this),W(this,qs,Y5).call(this),W(this,qs,q5).call(this)}},qs=new WeakSet,V5=function(){this.guiControl.add(this.outerHullMesh.material.uniforms.uStartAngle,"value").min(-Math.PI).max(Math.PI).step(.001).name("uStartAngle"),this.guiControl.add(this.outerHullMesh.material.uniforms.uArcAngle,"value").min(0).max(2*Math.PI).step(.001).name("uArcAngle")},W5=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n);const r={uStartAngle:new We(1.75),uArcAngle:new We(1.25)},s={csm_Slice:{"#include <colorspace_fragment>":`
          #include <colorspace_fragment>
          
          if (!gl_FrontFacing) {
            gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
          }
        `}},o=new hn({metalness:.5,roughness:.25,envMapIntensity:.5,color:"#858080"}),a=new Ep({baseMaterial:hn,patchMap:s,vertexShader:qL,fragmentShader:KL,uniforms:r,silent:!0,metalness:.5,roughness:.25,envMapIntensity:.5,color:"#858080",side:_n}),l=new Ep({baseMaterial:pu,patchMap:s,vertexShader:qL,fragmentShader:KL,uniforms:r,silent:!0,depthPacking:sf});t.load(bte,u=>{this.model=u.scene,this.model.traverse(h=>{h.isMesh&&(h.name==="outerHull"?(h.material=a,h.customDepthMaterial=l,this.outerHullMesh=h):h.material=o,h.receiveShadow=!0,h.castShadow=!0)}),this.scene.add(this.model),W(this,qs,V5).call(this)});const c=new Ae(new Ot(10,10,10),new hn({}));c.position.set(-4,-3,-4),c.lookAt(new N(0,0,0)),c.receiveShadow=!0,c.visible=!1,this.scene.add(c)},j5=function(){new Z0().load("/three.js-journey/media/images/environmentMaps/aerodynamics_workshop.hdr",n=>{n.mapping=Ca,this.scene.environment=n,this.scene.background=n,this.scene.backgroundBlurriness=.5})},X5=function(){const t=new Fi(16777215,5);t.position.set(6.25,3,4),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.camera.top=8,t.shadow.camera.bottom=-8,t.shadow.camera.left=-8,t.shadow.camera.right=8,t.shadow.camera.near=.1,t.shadow.camera.far=30,t.shadow.camera.normalBias=.05,this.scene.add(t)},Y5=function(){this.camera.position.set(-5,5,12),this.camera.fov=35,this.camera.updateProjectionMatrix()},q5=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.toneMapping=ta},MU);const K5=0,Ete=1,Ate=2,ZL=2,QM=1.25,QL=1,Fg=6*4+4+4,Pw=65535,Cte=Math.pow(2,-24),JM=Symbol("SKIP_GENERATION");function Pte(i){return i.index?i.index.count:i.attributes.position.count}function Zp(i){return Pte(i)/3}function Rte(i,e=ArrayBuffer){return i>65535?new Uint32Array(new e(4*i)):new Uint16Array(new e(2*i))}function Lte(i,e){if(!i.index){const t=i.attributes.position.count,n=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r=Rte(t,n);i.setIndex(new wt(r,1));for(let s=0;s<t;s++)r[s]=s}}function Z5(i,e){const t=Zp(i),n=e||i.drawRange,r=n.start/3,s=(n.start+n.count)/3,o=Math.max(0,r),a=Math.min(t,s)-o;return[{offset:Math.floor(o),count:Math.floor(a)}]}function Q5(i,e){if(!i.groups||!i.groups.length)return Z5(i,e);const t=[],n=new Set,r=e||i.drawRange,s=r.start/3,o=(r.start+r.count)/3;for(const l of i.groups){const c=l.start/3,u=(l.start+l.count)/3;n.add(Math.max(s,c)),n.add(Math.min(o,u))}const a=Array.from(n.values()).sort((l,c)=>l-c);for(let l=0;l<a.length-1;l++){const c=a[l],u=a[l+1];t.push({offset:Math.floor(c),count:Math.floor(u-c)})}return t}function Dte(i,e){const t=Zp(i),n=Q5(i,e).sort((o,a)=>o.offset-a.offset),r=n[n.length-1];r.count=Math.min(t-r.offset,r.count);let s=0;return n.forEach(({count:o})=>s+=o),t!==s}function $M(i,e,t,n,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,f=1/0,p=1/0,v=-1/0,x=-1/0,y=-1/0;for(let g=e*6,_=(e+t)*6;g<_;g+=6){const w=i[g+0],S=i[g+1],C=w-S,E=w+S;C<s&&(s=C),E>l&&(l=E),w<h&&(h=w),w>v&&(v=w);const A=i[g+2],T=i[g+3],L=A-T,M=A+T;L<o&&(o=L),M>c&&(c=M),A<f&&(f=A),A>x&&(x=A);const R=i[g+4],D=i[g+5],F=R-D,z=R+D;F<a&&(a=F),z>u&&(u=z),R<p&&(p=R),R>y&&(y=R)}n[0]=s,n[1]=o,n[2]=a,n[3]=l,n[4]=c,n[5]=u,r[0]=h,r[1]=f,r[2]=p,r[3]=v,r[4]=x,r[5]=y}function Ite(i,e=null,t=null,n=null){const r=i.attributes.position,s=i.index?i.index.array:null,o=Zp(i),a=r.normalized;let l;e===null?(l=new Float32Array(o*6),t=0,n=o):(l=e,t=t||0,n=n||o);const c=r.array,u=r.offset||0;let h=3;r.isInterleavedBufferAttribute&&(h=r.data.stride);const f=["getX","getY","getZ"];for(let p=t;p<t+n;p++){const v=p*3,x=p*6;let y=v+0,g=v+1,_=v+2;s&&(y=s[y],g=s[g],_=s[_]),a||(y=y*h+u,g=g*h+u,_=_*h+u);for(let w=0;w<3;w++){let S,C,E;a?(S=r[f[w]](y),C=r[f[w]](g),E=r[f[w]](_)):(S=c[y+w],C=c[g+w],E=c[_+w]);let A=S;C<A&&(A=C),E<A&&(A=E);let T=S;C>T&&(T=C),E>T&&(T=E);const L=(T-A)/2,M=w*2;l[x+M+0]=A+L,l[x+M+1]=L+(Math.abs(A)+L)*Cte}}return l}function di(i,e,t){return t.min.x=e[i],t.min.y=e[i+1],t.min.z=e[i+2],t.max.x=e[i+3],t.max.y=e[i+4],t.max.z=e[i+5],t}function JL(i){let e=-1,t=-1/0;for(let n=0;n<3;n++){const r=i[n+3]-i[n];r>t&&(t=r,e=n)}return e}function $L(i,e){e.set(i)}function eD(i,e,t){let n,r;for(let s=0;s<3;s++){const o=s+3;n=i[s],r=e[s],t[s]=n<r?n:r,n=i[o],r=e[o],t[o]=n>r?n:r}}function qy(i,e,t){for(let n=0;n<3;n++){const r=e[i+2*n],s=e[i+2*n+1],o=r-s,a=r+s;o<t[n]&&(t[n]=o),a>t[n+3]&&(t[n+3]=a)}}function Wm(i){const e=i[3]-i[0],t=i[4]-i[1],n=i[5]-i[2];return 2*(e*t+t*n+n*e)}const Dl=32,Ute=(i,e)=>i.candidate-e.candidate,Tc=new Array(Dl).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Ky=new Float32Array(6);function Fte(i,e,t,n,r,s){let o=-1,a=0;if(s===K5)o=JL(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===Ete)o=JL(i),o!==-1&&(a=kte(t,n,r,o));else if(s===Ate){const l=Wm(i);let c=QM*r;const u=n*6,h=(n+r)*6;for(let f=0;f<3;f++){const p=e[f],y=(e[f+3]-p)/Dl;if(r<Dl/4){const g=[...Tc];g.length=r;let _=0;for(let S=u;S<h;S+=6,_++){const C=g[_];C.candidate=t[S+2*f],C.count=0;const{bounds:E,leftCacheBounds:A,rightCacheBounds:T}=C;for(let L=0;L<3;L++)T[L]=1/0,T[L+3]=-1/0,A[L]=1/0,A[L+3]=-1/0,E[L]=1/0,E[L+3]=-1/0;qy(S,t,E)}g.sort(Ute);let w=r;for(let S=0;S<w;S++){const C=g[S];for(;S+1<w&&g[S+1].candidate===C.candidate;)g.splice(S+1,1),w--}for(let S=u;S<h;S+=6){const C=t[S+2*f];for(let E=0;E<w;E++){const A=g[E];C>=A.candidate?qy(S,t,A.rightCacheBounds):(qy(S,t,A.leftCacheBounds),A.count++)}}for(let S=0;S<w;S++){const C=g[S],E=C.count,A=r-C.count,T=C.leftCacheBounds,L=C.rightCacheBounds;let M=0;E!==0&&(M=Wm(T)/l);let R=0;A!==0&&(R=Wm(L)/l);const D=QL+QM*(M*E+R*A);D<c&&(o=f,c=D,a=C.candidate)}}else{for(let w=0;w<Dl;w++){const S=Tc[w];S.count=0,S.candidate=p+y+w*y;const C=S.bounds;for(let E=0;E<3;E++)C[E]=1/0,C[E+3]=-1/0}for(let w=u;w<h;w+=6){let E=~~((t[w+2*f]-p)/y);E>=Dl&&(E=Dl-1);const A=Tc[E];A.count++,qy(w,t,A.bounds)}const g=Tc[Dl-1];$L(g.bounds,g.rightCacheBounds);for(let w=Dl-2;w>=0;w--){const S=Tc[w],C=Tc[w+1];eD(S.bounds,C.rightCacheBounds,S.rightCacheBounds)}let _=0;for(let w=0;w<Dl-1;w++){const S=Tc[w],C=S.count,E=S.bounds,T=Tc[w+1].rightCacheBounds;C!==0&&(_===0?$L(E,Ky):eD(E,Ky,Ky)),_+=C;let L=0,M=0;_!==0&&(L=Wm(Ky)/l);const R=r-_;R!==0&&(M=Wm(T)/l);const D=QL+QM*(L*_+M*R);D<c&&(o=f,c=D,a=S.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function kte(i,e,t,n){let r=0;for(let s=e,o=e+t;s<o;s++)r+=i[s*6+n*2];return r/t}class eb{constructor(){this.boundingData=new Float32Array(6)}}function Nte(i,e,t,n,r,s){let o=n,a=n+r-1;const l=s.pos,c=s.axis*2;for(;;){for(;o<=a&&t[o*6+c]<l;)o++;for(;o<=a&&t[a*6+c]>=l;)a--;if(o<a){for(let u=0;u<3;u++){let h=e[o*3+u];e[o*3+u]=e[a*3+u],e[a*3+u]=h}for(let u=0;u<6;u++){let h=t[o*6+u];t[o*6+u]=t[a*6+u],t[a*6+u]=h}o++,a--}else return o}}function Ote(i,e,t,n,r,s){let o=n,a=n+r-1;const l=s.pos,c=s.axis*2;for(;;){for(;o<=a&&t[o*6+c]<l;)o++;for(;o<=a&&t[a*6+c]>=l;)a--;if(o<a){let u=i[o];i[o]=i[a],i[a]=u;for(let h=0;h<6;h++){let f=t[o*6+h];t[o*6+h]=t[a*6+h],t[a*6+h]=f}o++,a--}else return o}}function Rs(i,e){return e[i+15]===65535}function mo(i,e){return e[i+6]}function Yo(i,e){return e[i+14]}function qo(i){return i+8}function Ko(i,e){return e[i+6]}function J5(i,e){return e[i+7]}let $5,yg,s1,e6;const zte=Math.pow(2,32);function R2(i){return"count"in i?1:1+R2(i.left)+R2(i.right)}function Bte(i,e,t){return $5=new Float32Array(t),yg=new Uint32Array(t),s1=new Uint16Array(t),e6=new Uint8Array(t),L2(i,e)}function L2(i,e){const t=i/4,n=i/2,r="count"in e,s=e.boundingData;for(let o=0;o<6;o++)$5[t+o]=s[o];if(r)if(e.buffer){const o=e.buffer;e6.set(new Uint8Array(o),i);for(let a=i,l=i+o.byteLength;a<l;a+=Fg){const c=a/2;Rs(c,s1)||(yg[a/4+6]+=t)}return i+o.byteLength}else{const o=e.offset,a=e.count;return yg[t+6]=o,s1[n+14]=a,s1[n+15]=Pw,i+Fg}else{const o=e.left,a=e.right,l=e.splitAxis;let c;if(c=L2(i+Fg,o),c/4>zte)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return yg[t+6]=c/4,c=L2(c,a),yg[t+7]=l,c}}function Hte(i,e){const t=(i.index?i.index.count:i.attributes.position.count)/3,n=t>2**16,r=n?4:2,s=e?new SharedArrayBuffer(t*r):new ArrayBuffer(t*r),o=n?new Uint32Array(s):new Uint16Array(s);for(let a=0,l=o.length;a<l;a++)o[a]=a;return o}function Gte(i,e,t,n,r){const{maxDepth:s,verbose:o,maxLeafTris:a,strategy:l,onProgress:c,indirect:u}=r,h=i._indirectBuffer,f=i.geometry,p=f.index?f.index.array:null,v=u?Ote:Nte,x=Zp(f),y=new Float32Array(6);let g=!1;const _=new eb;return $M(e,t,n,_.boundingData,y),S(_,t,n,y),_;function w(C){c&&c(C/x)}function S(C,E,A,T=null,L=0){if(!g&&L>=s&&(g=!0,o&&(console.warn(`MeshBVH: Max depth of ${s} reached when generating BVH. Consider increasing maxDepth.`),console.warn(f))),A<=a||L>=s)return w(E+A),C.offset=E,C.count=A,C;const M=Fte(C.boundingData,T,e,E,A,l);if(M.axis===-1)return w(E+A),C.offset=E,C.count=A,C;const R=v(h,p,e,E,A,M);if(R===E||R===E+A)w(E+A),C.offset=E,C.count=A;else{C.splitAxis=M.axis;const D=new eb,F=E,z=R-E;C.left=D,$M(e,F,z,D.boundingData,y),S(D,F,z,y,L+1);const q=new eb,H=R,$=A-z;C.right=q,$M(e,H,$,q.boundingData,y),S(q,H,$,y,L+1)}return C}}function Vte(i,e){const t=i.geometry;e.indirect&&(i._indirectBuffer=Hte(t,e.useSharedArrayBuffer),Dte(t,e.range)&&!e.verbose&&console.warn('MeshBVH: Provided geometry contains groups or a range that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),i._indirectBuffer||Lte(t,e);const n=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r=Ite(t),s=e.indirect?Z5(t,e.range):Q5(t,e.range);i._roots=s.map(o=>{const a=Gte(i,r,o.offset,o.count,e),l=R2(a),c=new n(Fg*l);return Bte(0,a,c),c})}class Ql{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,r=-1/0;for(let s=0,o=e.length;s<o;s++){const l=e[s][t];n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}setFromPoints(e,t){let n=1/0,r=-1/0;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=e.dot(a);n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}Ql.prototype.setFromBox=function(){const i=new N;return function(t,n){const r=n.min,s=n.max;let o=1/0,a=-1/0;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){i.x=r.x*l+s.x*(1-l),i.y=r.y*c+s.y*(1-c),i.z=r.z*u+s.z*(1-u);const h=t.dot(i);o=Math.min(h,o),a=Math.max(h,a)}this.min=o,this.max=a}}();const Wte=function(){const i=new N,e=new N,t=new N;return function(r,s,o){const a=r.start,l=i,c=s.start,u=e;t.subVectors(a,c),i.subVectors(r.end,r.start),e.subVectors(s.end,s.start);const h=t.dot(u),f=u.dot(l),p=u.dot(u),v=t.dot(l),y=l.dot(l)*p-f*f;let g,_;y!==0?g=(h*f-v*p)/y:g=0,_=(h+g*f)/p,o.x=g,o.y=_}}(),$A=function(){const i=new be,e=new N,t=new N;return function(r,s,o,a){Wte(r,s,i);let l=i.x,c=i.y;if(l>=0&&l<=1&&c>=0&&c<=1){r.at(l,o),s.at(c,a);return}else if(l>=0&&l<=1){c<0?s.at(0,a):s.at(1,a),r.closestPointToPoint(a,!0,o);return}else if(c>=0&&c<=1){l<0?r.at(0,o):r.at(1,o),s.closestPointToPoint(o,!0,a);return}else{let u;l<0?u=r.start:u=r.end;let h;c<0?h=s.start:h=s.end;const f=e,p=t;if(r.closestPointToPoint(h,!0,e),s.closestPointToPoint(u,!0,t),f.distanceToSquared(h)<=p.distanceToSquared(u)){o.copy(f),a.copy(h);return}else{o.copy(u),a.copy(p);return}}}}(),jte=function(){const i=new N,e=new N,t=new Vr,n=new Us;return function(s,o){const{radius:a,center:l}=s,{a:c,b:u,c:h}=o;if(n.start=c,n.end=u,n.closestPointToPoint(l,!0,i).distanceTo(l)<=a||(n.start=c,n.end=h,n.closestPointToPoint(l,!0,i).distanceTo(l)<=a)||(n.start=u,n.end=h,n.closestPointToPoint(l,!0,i).distanceTo(l)<=a))return!0;const x=o.getPlane(t);if(Math.abs(x.distanceToPoint(l))<=a){const g=x.projectPoint(l,e);if(o.containsPoint(g))return!0}return!1}}(),Xte=1e-15;function tb(i){return Math.abs(i)<Xte}class ia extends An{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new N),this.satBounds=new Array(4).fill().map(()=>new Ql),this.points=[this.a,this.b,this.c],this.sphere=new Li,this.plane=new Vr,this.needsUpdate=!0}intersectsSphere(e){return jte(e,this)}update(){const e=this.a,t=this.b,n=this.c,r=this.points,s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,r);const c=s[1],u=o[1];c.subVectors(e,t),u.setFromPoints(c,r);const h=s[2],f=o[2];h.subVectors(t,n),f.setFromPoints(h,r);const p=s[3],v=o[3];p.subVectors(n,e),v.setFromPoints(p,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}}ia.prototype.closestPointToSegment=function(){const i=new N,e=new N,t=new Us;return function(r,s=null,o=null){const{start:a,end:l}=r,c=this.points;let u,h=1/0;for(let f=0;f<3;f++){const p=(f+1)%3;t.start.copy(c[f]),t.end.copy(c[p]),$A(t,r,i,e),u=i.distanceToSquared(e),u<h&&(h=u,s&&s.copy(i),o&&o.copy(e))}return this.closestPointToPoint(a,i),u=a.distanceToSquared(i),u<h&&(h=u,s&&s.copy(i),o&&o.copy(a)),this.closestPointToPoint(l,i),u=l.distanceToSquared(i),u<h&&(h=u,s&&s.copy(i),o&&o.copy(l)),Math.sqrt(h)}}();ia.prototype.intersectsTriangle=function(){const i=new ia,e=new Array(3),t=new Array(3),n=new Ql,r=new Ql,s=new N,o=new N,a=new N,l=new N,c=new N,u=new Us,h=new Us,f=new Us,p=new N;function v(x,y,g){const _=x.points;let w=0,S=-1;for(let C=0;C<3;C++){const{start:E,end:A}=u;E.copy(_[C]),A.copy(_[(C+1)%3]),u.delta(o);const T=tb(y.distanceToPoint(E));if(tb(y.normal.dot(o))&&T){g.copy(u),w=2;break}const L=y.intersectLine(u,p);if(!L&&T&&p.copy(E),(L||T)&&!tb(p.distanceTo(A))){if(w<=1)(w===1?g.start:g.end).copy(p),T&&(S=w);else if(w>=2){(S===1?g.start:g.end).copy(p),w=2;break}if(w++,w===2&&S===-1)break}}return w}return function(y,g=null,_=!1){this.needsUpdate&&this.update(),y.isExtendedTriangle?y.needsUpdate&&y.update():(i.copy(y),i.update(),y=i);const w=this.plane,S=y.plane;if(Math.abs(w.normal.dot(S.normal))>1-1e-10){const C=this.satBounds,E=this.satAxes;t[0]=y.a,t[1]=y.b,t[2]=y.c;for(let L=0;L<4;L++){const M=C[L],R=E[L];if(n.setFromPoints(R,t),M.isSeparated(n))return!1}const A=y.satBounds,T=y.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let L=0;L<4;L++){const M=A[L],R=T[L];if(n.setFromPoints(R,e),M.isSeparated(n))return!1}for(let L=0;L<4;L++){const M=E[L];for(let R=0;R<4;R++){const D=T[R];if(s.crossVectors(M,D),n.setFromPoints(s,e),r.setFromPoints(s,t),n.isSeparated(r))return!1}}return g&&(_||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),g.start.set(0,0,0),g.end.set(0,0,0)),!0}else{const C=v(this,S,h);if(C===1&&y.containsPoint(h.end))return g&&(g.start.copy(h.end),g.end.copy(h.end)),!0;if(C!==2)return!1;const E=v(y,w,f);if(E===1&&this.containsPoint(f.end))return g&&(g.start.copy(f.end),g.end.copy(f.end)),!0;if(E!==2)return!1;if(h.delta(a),f.delta(l),a.dot(l)<0){let F=f.start;f.start=f.end,f.end=F}const A=h.start.dot(a),T=h.end.dot(a),L=f.start.dot(a),M=f.end.dot(a),R=T<L,D=A<M;return A!==M&&L!==T&&R===D?!1:(g&&(c.subVectors(h.start,f.start),c.dot(a)>0?g.start.copy(h.start):g.start.copy(f.start),c.subVectors(h.end,f.end),c.dot(a)<0?g.end.copy(h.end):g.end.copy(f.end)),!0)}}}();ia.prototype.distanceToPoint=function(){const i=new N;return function(t){return this.closestPointToPoint(t,i),t.distanceTo(i)}}();ia.prototype.distanceToTriangle=function(){const i=new N,e=new N,t=["a","b","c"],n=new Us,r=new Us;return function(o,a=null,l=null){const c=a||l?n:null;if(this.intersectsTriangle(o,c))return(a||l)&&(a&&c.getCenter(a),l&&c.getCenter(l)),0;let u=1/0;for(let h=0;h<3;h++){let f;const p=t[h],v=o[p];this.closestPointToPoint(v,i),f=v.distanceToSquared(i),f<u&&(u=f,a&&a.copy(i),l&&l.copy(v));const x=this[p];o.closestPointToPoint(x,i),f=x.distanceToSquared(i),f<u&&(u=f,a&&a.copy(x),l&&l.copy(i))}for(let h=0;h<3;h++){const f=t[h],p=t[(h+1)%3];n.set(this[f],this[p]);for(let v=0;v<3;v++){const x=t[v],y=t[(v+1)%3];r.set(o[x],o[y]),$A(n,r,i,e);const g=i.distanceToSquared(e);g<u&&(u=g,a&&a.copy(i),l&&l.copy(e))}}return Math.sqrt(u)}}();class vs{constructor(e,t,n){this.isOrientedBox=!0,this.min=new N,this.max=new N,this.matrix=new Ze,this.invMatrix=new Ze,this.points=new Array(8).fill().map(()=>new N),this.satAxes=new Array(3).fill().map(()=>new N),this.satBounds=new Array(3).fill().map(()=>new Ql),this.alignedSatBounds=new Array(3).fill().map(()=>new Ql),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}vs.prototype.update=function(){return function(){const e=this.matrix,t=this.min,n=this.max,r=this.points;for(let c=0;c<=1;c++)for(let u=0;u<=1;u++)for(let h=0;h<=1;h++){const f=1*c|2*u|4*h,p=r[f];p.x=c?n.x:t.x,p.y=u?n.y:t.y,p.z=h?n.z:t.z,p.applyMatrix4(e)}const s=this.satBounds,o=this.satAxes,a=r[0];for(let c=0;c<3;c++){const u=o[c],h=s[c],f=1<<c,p=r[f];u.subVectors(a,p),h.setFromPoints(u,r)}const l=this.alignedSatBounds;l[0].setFromPointsField(r,"x"),l[1].setFromPointsField(r,"y"),l[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();vs.prototype.intersectsBox=function(){const i=new Ql;return function(t){this.needsUpdate&&this.update();const n=t.min,r=t.max,s=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(i.min=n.x,i.max=r.x,a[0].isSeparated(i)||(i.min=n.y,i.max=r.y,a[1].isSeparated(i))||(i.min=n.z,i.max=r.z,a[2].isSeparated(i)))return!1;for(let l=0;l<3;l++){const c=o[l],u=s[l];if(i.setFromBox(c,t),u.isSeparated(i))return!1}return!0}}();vs.prototype.intersectsTriangle=function(){const i=new ia,e=new Array(3),t=new Ql,n=new Ql,r=new N;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(i.copy(o),i.update(),o=i);const a=this.satBounds,l=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let f=0;f<3;f++){const p=a[f],v=l[f];if(t.setFromPoints(v,e),p.isSeparated(t))return!1}const c=o.satBounds,u=o.satAxes,h=this.points;for(let f=0;f<3;f++){const p=c[f],v=u[f];if(t.setFromPoints(v,h),p.isSeparated(t))return!1}for(let f=0;f<3;f++){const p=l[f];for(let v=0;v<4;v++){const x=u[v];if(r.crossVectors(p,x),t.setFromPoints(r,e),n.setFromPoints(r,h),t.isSeparated(n))return!1}}return!0}}();vs.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();vs.prototype.distanceToPoint=function(){const i=new N;return function(t){return this.closestPointToPoint(t,i),t.distanceTo(i)}}();vs.prototype.distanceToBox=function(){const i=["x","y","z"],e=new Array(12).fill().map(()=>new Us),t=new Array(12).fill().map(()=>new Us),n=new N,r=new N;return function(o,a=0,l=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(l||c)&&(o.getCenter(r),this.closestPointToPoint(r,n),o.closestPointToPoint(n,r),l&&l.copy(n),c&&c.copy(r)),0;const u=a*a,h=o.min,f=o.max,p=this.points;let v=1/0;for(let y=0;y<8;y++){const g=p[y];r.copy(g).clamp(h,f);const _=g.distanceToSquared(r);if(_<v&&(v=_,l&&l.copy(g),c&&c.copy(r),_<u))return Math.sqrt(_)}let x=0;for(let y=0;y<3;y++)for(let g=0;g<=1;g++)for(let _=0;_<=1;_++){const w=(y+1)%3,S=(y+2)%3,C=g<<w|_<<S,E=1<<y|g<<w|_<<S,A=p[C],T=p[E];e[x].set(A,T);const M=i[y],R=i[w],D=i[S],F=t[x],z=F.start,q=F.end;z[M]=h[M],z[R]=g?h[R]:f[R],z[D]=_?h[D]:f[R],q[M]=f[M],q[R]=g?h[R]:f[R],q[D]=_?h[D]:f[R],x++}for(let y=0;y<=1;y++)for(let g=0;g<=1;g++)for(let _=0;_<=1;_++){r.x=y?f.x:h.x,r.y=g?f.y:h.y,r.z=_?f.z:h.z,this.closestPointToPoint(r,n);const w=r.distanceToSquared(n);if(w<v&&(v=w,l&&l.copy(n),c&&c.copy(r),w<u))return Math.sqrt(w)}for(let y=0;y<12;y++){const g=e[y];for(let _=0;_<12;_++){const w=t[_];$A(g,w,n,r);const S=n.distanceToSquared(r);if(S<v&&(v=S,l&&l.copy(n),c&&c.copy(r),S<u))return Math.sqrt(S)}}return Math.sqrt(v)}}();class eC{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class Yte extends eC{constructor(){super(()=>new ia)}}const Zo=new Yte;class qte{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let t=null;this.setBuffer=n=>{t&&e.push(t),t=n,this.float32Array=new Float32Array(n),this.uint16Array=new Uint16Array(n),this.uint32Array=new Uint32Array(n)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,e.length!==0&&this.setBuffer(e.pop())}}}const Xn=new qte;let zc,Sd;const Qf=[],Zy=new eC(()=>new vn);function Kte(i,e,t,n,r,s){zc=Zy.getPrimitive(),Sd=Zy.getPrimitive(),Qf.push(zc,Sd),Xn.setBuffer(i._roots[e]);const o=D2(0,i.geometry,t,n,r,s);Xn.clearBuffer(),Zy.releasePrimitive(zc),Zy.releasePrimitive(Sd),Qf.pop(),Qf.pop();const a=Qf.length;return a>0&&(Sd=Qf[a-1],zc=Qf[a-2]),o}function D2(i,e,t,n,r=null,s=0,o=0){const{float32Array:a,uint16Array:l,uint32Array:c}=Xn;let u=i*2;if(Rs(u,l)){const f=mo(i,c),p=Yo(u,l);return di(i,a,zc),n(f,p,!1,o,s+i,zc)}else{let M=function(D){const{uint16Array:F,uint32Array:z}=Xn;let q=D*2;for(;!Rs(q,F);)D=qo(D),q=D*2;return mo(D,z)},R=function(D){const{uint16Array:F,uint32Array:z}=Xn;let q=D*2;for(;!Rs(q,F);)D=Ko(D,z),q=D*2;return mo(D,z)+Yo(q,F)};const f=qo(i),p=Ko(i,c);let v=f,x=p,y,g,_,w;if(r&&(_=zc,w=Sd,di(v,a,_),di(x,a,w),y=r(_),g=r(w),g<y)){v=p,x=f;const D=y;y=g,g=D,_=w}_||(_=zc,di(v,a,_));const S=Rs(v*2,l),C=t(_,S,y,o+1,s+v);let E;if(C===ZL){const D=M(v),z=R(v)-D;E=n(D,z,!0,o+1,s+v,_)}else E=C&&D2(v,e,t,n,r,s,o+1);if(E)return!0;w=Sd,di(x,a,w);const A=Rs(x*2,l),T=t(w,A,g,o+1,s+x);let L;if(T===ZL){const D=M(x),z=R(x)-D;L=n(D,z,!0,o+1,s+x,w)}else L=T&&D2(x,e,t,n,r,s,o+1);return!!L}}const jm=new N,nb=new N;function Zte(i,e,t={},n=0,r=1/0){const s=n*n,o=r*r;let a=1/0,l=null;if(i.shapecast({boundsTraverseOrder:u=>(jm.copy(e).clamp(u.min,u.max),jm.distanceToSquared(e)),intersectsBounds:(u,h,f)=>f<a&&f<o,intersectsTriangle:(u,h)=>{u.closestPointToPoint(e,jm);const f=e.distanceToSquared(jm);return f<a&&(nb.copy(jm),a=f,l=h),f<s}}),a===1/0)return null;const c=Math.sqrt(a);return t.point?t.point.copy(nb):t.point=nb.clone(),t.distance=c,t.faceIndex=l,t}const Qte=parseInt(rf)>=169,eh=new N,th=new N,nh=new N,Qy=new be,Jy=new be,$y=new be,tD=new N,nD=new N,iD=new N,Xm=new N;function Jte(i,e,t,n,r,s,o,a){let l;if(s===Vi?l=i.intersectTriangle(n,t,e,!0,r):l=i.intersectTriangle(e,t,n,s!==_n,r),l===null)return null;const c=i.origin.distanceTo(r);return c<o||c>a?null:{distance:c,point:r.clone()}}function $te(i,e,t,n,r,s,o,a,l,c,u){eh.fromBufferAttribute(e,s),th.fromBufferAttribute(e,o),nh.fromBufferAttribute(e,a);const h=Jte(i,eh,th,nh,Xm,l,c,u);if(h){const f=new N;An.getBarycoord(Xm,eh,th,nh,f),n&&(Qy.fromBufferAttribute(n,s),Jy.fromBufferAttribute(n,o),$y.fromBufferAttribute(n,a),h.uv=An.getInterpolation(Xm,eh,th,nh,Qy,Jy,$y,new be)),r&&(Qy.fromBufferAttribute(r,s),Jy.fromBufferAttribute(r,o),$y.fromBufferAttribute(r,a),h.uv1=An.getInterpolation(Xm,eh,th,nh,Qy,Jy,$y,new be)),t&&(tD.fromBufferAttribute(t,s),nD.fromBufferAttribute(t,o),iD.fromBufferAttribute(t,a),h.normal=An.getInterpolation(Xm,eh,th,nh,tD,nD,iD,new N),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const p={a:s,b:o,c:a,normal:new N,materialIndex:0};An.getNormal(eh,th,nh,p.normal),h.face=p,h.faceIndex=s,Qte&&(h.barycoord=f)}return h}function Rw(i,e,t,n,r,s,o){const a=n*3;let l=a+0,c=a+1,u=a+2;const h=i.index;i.index&&(l=h.getX(l),c=h.getX(c),u=h.getX(u));const{position:f,normal:p,uv:v,uv1:x}=i.attributes,y=$te(t,f,p,v,x,l,c,u,e,s,o);return y?(y.faceIndex=n,r&&r.push(y),y):null}function Gi(i,e,t,n){const r=i.a,s=i.b,o=i.c;let a=e,l=e+1,c=e+2;t&&(a=t.getX(a),l=t.getX(l),c=t.getX(c)),r.x=n.getX(a),r.y=n.getY(a),r.z=n.getZ(a),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function ene(i,e,t,n,r,s,o,a){const{geometry:l,_indirectBuffer:c}=i;for(let u=n,h=n+r;u<h;u++)Rw(l,e,t,u,s,o,a)}function tne(i,e,t,n,r,s,o){const{geometry:a,_indirectBuffer:l}=i;let c=1/0,u=null;for(let h=n,f=n+r;h<f;h++){let p;p=Rw(a,e,t,h,null,s,o),p&&p.distance<c&&(u=p,c=p.distance)}return u}function nne(i,e,t,n,r,s,o){const{geometry:a}=t,{index:l}=a,c=a.attributes.position;for(let u=i,h=e+i;u<h;u++){let f;if(f=u,Gi(o,f*3,l,c),o.needsUpdate=!0,n(o,f,r,s))return!0}return!1}function ine(i,e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=i.geometry,n=t.index?t.index.array:null,r=t.attributes.position;let s,o,a,l,c=0;const u=i._roots;for(let f=0,p=u.length;f<p;f++)s=u[f],o=new Uint32Array(s),a=new Uint16Array(s),l=new Float32Array(s),h(0,c),c+=s.byteLength;function h(f,p,v=!1){const x=f*2;if(a[x+15]===Pw){const g=o[f+6],_=a[x+14];let w=1/0,S=1/0,C=1/0,E=-1/0,A=-1/0,T=-1/0;for(let L=3*g,M=3*(g+_);L<M;L++){let R=n[L];const D=r.getX(R),F=r.getY(R),z=r.getZ(R);D<w&&(w=D),D>E&&(E=D),F<S&&(S=F),F>A&&(A=F),z<C&&(C=z),z>T&&(T=z)}return l[f+0]!==w||l[f+1]!==S||l[f+2]!==C||l[f+3]!==E||l[f+4]!==A||l[f+5]!==T?(l[f+0]=w,l[f+1]=S,l[f+2]=C,l[f+3]=E,l[f+4]=A,l[f+5]=T,!0):!1}else{const g=f+8,_=o[f+6],w=g+p,S=_+p;let C=v,E=!1,A=!1;e?C||(E=e.has(w),A=e.has(S),C=!E&&!A):(E=!0,A=!0);const T=C||E,L=C||A;let M=!1;T&&(M=h(g,p,C));let R=!1;L&&(R=h(_,p,C));const D=M||R;if(D)for(let F=0;F<3;F++){const z=g+F,q=_+F,H=l[z],$=l[z+3],U=l[q],X=l[q+3];l[f+F]=H<U?H:U,l[f+F+3]=$>X?$:X}return D}}}function ou(i,e,t,n,r){let s,o,a,l,c,u;const h=1/t.direction.x,f=1/t.direction.y,p=1/t.direction.z,v=t.origin.x,x=t.origin.y,y=t.origin.z;let g=e[i],_=e[i+3],w=e[i+1],S=e[i+3+1],C=e[i+2],E=e[i+3+2];return h>=0?(s=(g-v)*h,o=(_-v)*h):(s=(_-v)*h,o=(g-v)*h),f>=0?(a=(w-x)*f,l=(S-x)*f):(a=(S-x)*f,l=(w-x)*f),s>l||a>o||((a>s||isNaN(s))&&(s=a),(l<o||isNaN(o))&&(o=l),p>=0?(c=(C-y)*p,u=(E-y)*p):(c=(E-y)*p,u=(C-y)*p),s>u||c>o)?!1:((c>s||s!==s)&&(s=c),(u<o||o!==o)&&(o=u),s<=r&&o>=n)}function rne(i,e,t,n,r,s,o,a){const{geometry:l,_indirectBuffer:c}=i;for(let u=n,h=n+r;u<h;u++){let f=c?c[u]:u;Rw(l,e,t,f,s,o,a)}}function sne(i,e,t,n,r,s,o){const{geometry:a,_indirectBuffer:l}=i;let c=1/0,u=null;for(let h=n,f=n+r;h<f;h++){let p;p=Rw(a,e,t,l?l[h]:h,null,s,o),p&&p.distance<c&&(u=p,c=p.distance)}return u}function one(i,e,t,n,r,s,o){const{geometry:a}=t,{index:l}=a,c=a.attributes.position;for(let u=i,h=e+i;u<h;u++){let f;if(f=t.resolveTriangleIndex(u),Gi(o,f*3,l,c),o.needsUpdate=!0,n(o,f,r,s))return!0}return!1}function ane(i,e,t,n,r,s,o){Xn.setBuffer(i._roots[e]),I2(0,i,t,n,r,s,o),Xn.clearBuffer()}function I2(i,e,t,n,r,s,o){const{float32Array:a,uint16Array:l,uint32Array:c}=Xn,u=i*2;if(Rs(u,l)){const f=mo(i,c),p=Yo(u,l);ene(e,t,n,f,p,r,s,o)}else{const f=qo(i);ou(f,a,n,s,o)&&I2(f,e,t,n,r,s,o);const p=Ko(i,c);ou(p,a,n,s,o)&&I2(p,e,t,n,r,s,o)}}const lne=["x","y","z"];function cne(i,e,t,n,r,s){Xn.setBuffer(i._roots[e]);const o=U2(0,i,t,n,r,s);return Xn.clearBuffer(),o}function U2(i,e,t,n,r,s){const{float32Array:o,uint16Array:a,uint32Array:l}=Xn;let c=i*2;if(Rs(c,a)){const h=mo(i,l),f=Yo(c,a);return tne(e,t,n,h,f,r,s)}else{const h=J5(i,l),f=lne[h],v=n.direction[f]>=0;let x,y;v?(x=qo(i),y=Ko(i,l)):(x=Ko(i,l),y=qo(i));const _=ou(x,o,n,r,s)?U2(x,e,t,n,r,s):null;if(_){const C=_.point[f];if(v?C<=o[y+h]:C>=o[y+h+3])return _}const S=ou(y,o,n,r,s)?U2(y,e,t,n,r,s):null;return _&&S?_.distance<=S.distance?_:S:_||S||null}}const ex=new vn,Jf=new ia,$f=new ia,Ym=new Ze,rD=new vs,tx=new vs;function une(i,e,t,n){Xn.setBuffer(i._roots[e]);const r=F2(0,i,t,n);return Xn.clearBuffer(),r}function F2(i,e,t,n,r=null){const{float32Array:s,uint16Array:o,uint32Array:a}=Xn;let l=i*2;if(r===null&&(t.boundingBox||t.computeBoundingBox(),rD.set(t.boundingBox.min,t.boundingBox.max,n),r=rD),Rs(l,o)){const u=e.geometry,h=u.index,f=u.attributes.position,p=t.index,v=t.attributes.position,x=mo(i,a),y=Yo(l,o);if(Ym.copy(n).invert(),t.boundsTree)return di(i,s,tx),tx.matrix.copy(Ym),tx.needsUpdate=!0,t.boundsTree.shapecast({intersectsBounds:_=>tx.intersectsBox(_),intersectsTriangle:_=>{_.a.applyMatrix4(n),_.b.applyMatrix4(n),_.c.applyMatrix4(n),_.needsUpdate=!0;for(let w=x*3,S=(y+x)*3;w<S;w+=3)if(Gi($f,w,h,f),$f.needsUpdate=!0,_.intersectsTriangle($f))return!0;return!1}});for(let g=x*3,_=(y+x)*3;g<_;g+=3){Gi(Jf,g,h,f),Jf.a.applyMatrix4(Ym),Jf.b.applyMatrix4(Ym),Jf.c.applyMatrix4(Ym),Jf.needsUpdate=!0;for(let w=0,S=p.count;w<S;w+=3)if(Gi($f,w,p,v),$f.needsUpdate=!0,Jf.intersectsTriangle($f))return!0}}else{const u=i+8,h=a[i+6];return di(u,s,ex),!!(r.intersectsBox(ex)&&F2(u,e,t,n,r)||(di(h,s,ex),r.intersectsBox(ex)&&F2(h,e,t,n,r)))}}const nx=new Ze,ib=new vs,qm=new vs,hne=new N,fne=new N,dne=new N,pne=new N;function mne(i,e,t,n={},r={},s=0,o=1/0){e.boundingBox||e.computeBoundingBox(),ib.set(e.boundingBox.min,e.boundingBox.max,t),ib.needsUpdate=!0;const a=i.geometry,l=a.attributes.position,c=a.index,u=e.attributes.position,h=e.index,f=Zo.getPrimitive(),p=Zo.getPrimitive();let v=hne,x=fne,y=null,g=null;r&&(y=dne,g=pne);let _=1/0,w=null,S=null;return nx.copy(t).invert(),qm.matrix.copy(nx),i.shapecast({boundsTraverseOrder:C=>ib.distanceToBox(C),intersectsBounds:(C,E,A)=>A<_&&A<o?(E&&(qm.min.copy(C.min),qm.max.copy(C.max),qm.needsUpdate=!0),!0):!1,intersectsRange:(C,E)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:T=>qm.distanceToBox(T),intersectsBounds:(T,L,M)=>M<_&&M<o,intersectsRange:(T,L)=>{for(let M=T,R=T+L;M<R;M++){Gi(p,3*M,h,u),p.a.applyMatrix4(t),p.b.applyMatrix4(t),p.c.applyMatrix4(t),p.needsUpdate=!0;for(let D=C,F=C+E;D<F;D++){Gi(f,3*D,c,l),f.needsUpdate=!0;const z=f.distanceToTriangle(p,v,y);if(z<_&&(x.copy(v),g&&g.copy(y),_=z,w=D,S=M),z<s)return!0}}}});{const A=Zp(e);for(let T=0,L=A;T<L;T++){Gi(p,3*T,h,u),p.a.applyMatrix4(t),p.b.applyMatrix4(t),p.c.applyMatrix4(t),p.needsUpdate=!0;for(let M=C,R=C+E;M<R;M++){Gi(f,3*M,c,l),f.needsUpdate=!0;const D=f.distanceToTriangle(p,v,y);if(D<_&&(x.copy(v),g&&g.copy(y),_=D,w=M,S=T),D<s)return!0}}}}}),Zo.releasePrimitive(f),Zo.releasePrimitive(p),_===1/0?null:(n.point?n.point.copy(x):n.point=x.clone(),n.distance=_,n.faceIndex=w,r&&(r.point?r.point.copy(g):r.point=g.clone(),r.point.applyMatrix4(nx),x.applyMatrix4(nx),r.distance=x.sub(r.point).length(),r.faceIndex=S),n)}function gne(i,e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=i.geometry,n=t.index?t.index.array:null,r=t.attributes.position;let s,o,a,l,c=0;const u=i._roots;for(let f=0,p=u.length;f<p;f++)s=u[f],o=new Uint32Array(s),a=new Uint16Array(s),l=new Float32Array(s),h(0,c),c+=s.byteLength;function h(f,p,v=!1){const x=f*2;if(a[x+15]===Pw){const g=o[f+6],_=a[x+14];let w=1/0,S=1/0,C=1/0,E=-1/0,A=-1/0,T=-1/0;for(let L=g,M=g+_;L<M;L++){const R=3*i.resolveTriangleIndex(L);for(let D=0;D<3;D++){let F=R+D;F=n?n[F]:F;const z=r.getX(F),q=r.getY(F),H=r.getZ(F);z<w&&(w=z),z>E&&(E=z),q<S&&(S=q),q>A&&(A=q),H<C&&(C=H),H>T&&(T=H)}}return l[f+0]!==w||l[f+1]!==S||l[f+2]!==C||l[f+3]!==E||l[f+4]!==A||l[f+5]!==T?(l[f+0]=w,l[f+1]=S,l[f+2]=C,l[f+3]=E,l[f+4]=A,l[f+5]=T,!0):!1}else{const g=f+8,_=o[f+6],w=g+p,S=_+p;let C=v,E=!1,A=!1;e?C||(E=e.has(w),A=e.has(S),C=!E&&!A):(E=!0,A=!0);const T=C||E,L=C||A;let M=!1;T&&(M=h(g,p,C));let R=!1;L&&(R=h(_,p,C));const D=M||R;if(D)for(let F=0;F<3;F++){const z=g+F,q=_+F,H=l[z],$=l[z+3],U=l[q],X=l[q+3];l[f+F]=H<U?H:U,l[f+F+3]=$>X?$:X}return D}}}function vne(i,e,t,n,r,s,o){Xn.setBuffer(i._roots[e]),k2(0,i,t,n,r,s,o),Xn.clearBuffer()}function k2(i,e,t,n,r,s,o){const{float32Array:a,uint16Array:l,uint32Array:c}=Xn,u=i*2;if(Rs(u,l)){const f=mo(i,c),p=Yo(u,l);rne(e,t,n,f,p,r,s,o)}else{const f=qo(i);ou(f,a,n,s,o)&&k2(f,e,t,n,r,s,o);const p=Ko(i,c);ou(p,a,n,s,o)&&k2(p,e,t,n,r,s,o)}}const yne=["x","y","z"];function xne(i,e,t,n,r,s){Xn.setBuffer(i._roots[e]);const o=N2(0,i,t,n,r,s);return Xn.clearBuffer(),o}function N2(i,e,t,n,r,s){const{float32Array:o,uint16Array:a,uint32Array:l}=Xn;let c=i*2;if(Rs(c,a)){const h=mo(i,l),f=Yo(c,a);return sne(e,t,n,h,f,r,s)}else{const h=J5(i,l),f=yne[h],v=n.direction[f]>=0;let x,y;v?(x=qo(i),y=Ko(i,l)):(x=Ko(i,l),y=qo(i));const _=ou(x,o,n,r,s)?N2(x,e,t,n,r,s):null;if(_){const C=_.point[f];if(v?C<=o[y+h]:C>=o[y+h+3])return _}const S=ou(y,o,n,r,s)?N2(y,e,t,n,r,s):null;return _&&S?_.distance<=S.distance?_:S:_||S||null}}const ix=new vn,ed=new ia,td=new ia,Km=new Ze,sD=new vs,rx=new vs;function _ne(i,e,t,n){Xn.setBuffer(i._roots[e]);const r=O2(0,i,t,n);return Xn.clearBuffer(),r}function O2(i,e,t,n,r=null){const{float32Array:s,uint16Array:o,uint32Array:a}=Xn;let l=i*2;if(r===null&&(t.boundingBox||t.computeBoundingBox(),sD.set(t.boundingBox.min,t.boundingBox.max,n),r=sD),Rs(l,o)){const u=e.geometry,h=u.index,f=u.attributes.position,p=t.index,v=t.attributes.position,x=mo(i,a),y=Yo(l,o);if(Km.copy(n).invert(),t.boundsTree)return di(i,s,rx),rx.matrix.copy(Km),rx.needsUpdate=!0,t.boundsTree.shapecast({intersectsBounds:_=>rx.intersectsBox(_),intersectsTriangle:_=>{_.a.applyMatrix4(n),_.b.applyMatrix4(n),_.c.applyMatrix4(n),_.needsUpdate=!0;for(let w=x,S=y+x;w<S;w++)if(Gi(td,3*e.resolveTriangleIndex(w),h,f),td.needsUpdate=!0,_.intersectsTriangle(td))return!0;return!1}});for(let g=x,_=y+x;g<_;g++){const w=e.resolveTriangleIndex(g);Gi(ed,3*w,h,f),ed.a.applyMatrix4(Km),ed.b.applyMatrix4(Km),ed.c.applyMatrix4(Km),ed.needsUpdate=!0;for(let S=0,C=p.count;S<C;S+=3)if(Gi(td,S,p,v),td.needsUpdate=!0,ed.intersectsTriangle(td))return!0}}else{const u=i+8,h=a[i+6];return di(u,s,ix),!!(r.intersectsBox(ix)&&O2(u,e,t,n,r)||(di(h,s,ix),r.intersectsBox(ix)&&O2(h,e,t,n,r)))}}const sx=new Ze,rb=new vs,Zm=new vs,wne=new N,Sne=new N,Mne=new N,bne=new N;function Tne(i,e,t,n={},r={},s=0,o=1/0){e.boundingBox||e.computeBoundingBox(),rb.set(e.boundingBox.min,e.boundingBox.max,t),rb.needsUpdate=!0;const a=i.geometry,l=a.attributes.position,c=a.index,u=e.attributes.position,h=e.index,f=Zo.getPrimitive(),p=Zo.getPrimitive();let v=wne,x=Sne,y=null,g=null;r&&(y=Mne,g=bne);let _=1/0,w=null,S=null;return sx.copy(t).invert(),Zm.matrix.copy(sx),i.shapecast({boundsTraverseOrder:C=>rb.distanceToBox(C),intersectsBounds:(C,E,A)=>A<_&&A<o?(E&&(Zm.min.copy(C.min),Zm.max.copy(C.max),Zm.needsUpdate=!0),!0):!1,intersectsRange:(C,E)=>{if(e.boundsTree){const A=e.boundsTree;return A.shapecast({boundsTraverseOrder:T=>Zm.distanceToBox(T),intersectsBounds:(T,L,M)=>M<_&&M<o,intersectsRange:(T,L)=>{for(let M=T,R=T+L;M<R;M++){const D=A.resolveTriangleIndex(M);Gi(p,3*D,h,u),p.a.applyMatrix4(t),p.b.applyMatrix4(t),p.c.applyMatrix4(t),p.needsUpdate=!0;for(let F=C,z=C+E;F<z;F++){const q=i.resolveTriangleIndex(F);Gi(f,3*q,c,l),f.needsUpdate=!0;const H=f.distanceToTriangle(p,v,y);if(H<_&&(x.copy(v),g&&g.copy(y),_=H,w=F,S=M),H<s)return!0}}}})}else{const A=Zp(e);for(let T=0,L=A;T<L;T++){Gi(p,3*T,h,u),p.a.applyMatrix4(t),p.b.applyMatrix4(t),p.c.applyMatrix4(t),p.needsUpdate=!0;for(let M=C,R=C+E;M<R;M++){const D=i.resolveTriangleIndex(M);Gi(f,3*D,c,l),f.needsUpdate=!0;const F=f.distanceToTriangle(p,v,y);if(F<_&&(x.copy(v),g&&g.copy(y),_=F,w=M,S=T),F<s)return!0}}}}}),Zo.releasePrimitive(f),Zo.releasePrimitive(p),_===1/0?null:(n.point?n.point.copy(x):n.point=x.clone(),n.distance=_,n.faceIndex=w,r&&(r.point?r.point.copy(g):r.point=g.clone(),r.point.applyMatrix4(sx),x.applyMatrix4(sx),r.distance=x.sub(r.point).length(),r.faceIndex=S),n)}function Ene(){return typeof SharedArrayBuffer<"u"}const kg=new Xn.constructor,__=new Xn.constructor,Pc=new eC(()=>new vn),nd=new vn,id=new vn,sb=new vn,ob=new vn;let ab=!1;function Ane(i,e,t,n){if(ab)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");ab=!0;const r=i._roots,s=e._roots;let o,a=0,l=0;const c=new Ze().copy(t).invert();for(let u=0,h=r.length;u<h;u++){kg.setBuffer(r[u]),l=0;const f=Pc.getPrimitive();di(0,kg.float32Array,f),f.applyMatrix4(c);for(let p=0,v=s.length;p<v&&(__.setBuffer(s[p]),o=va(0,0,t,c,n,a,l,0,0,f),__.clearBuffer(),l+=s[p].length,!o);p++);if(Pc.releasePrimitive(f),kg.clearBuffer(),a+=r[u].length,o)break}return ab=!1,o}function va(i,e,t,n,r,s=0,o=0,a=0,l=0,c=null,u=!1){let h,f;u?(h=__,f=kg):(h=kg,f=__);const p=h.float32Array,v=h.uint32Array,x=h.uint16Array,y=f.float32Array,g=f.uint32Array,_=f.uint16Array,w=i*2,S=e*2,C=Rs(w,x),E=Rs(S,_);let A=!1;if(E&&C)u?A=r(mo(e,g),Yo(e*2,_),mo(i,v),Yo(i*2,x),l,o+e,a,s+i):A=r(mo(i,v),Yo(i*2,x),mo(e,g),Yo(e*2,_),a,s+i,l,o+e);else if(E){const T=Pc.getPrimitive();di(e,y,T),T.applyMatrix4(t);const L=qo(i),M=Ko(i,v);di(L,p,nd),di(M,p,id);const R=T.intersectsBox(nd),D=T.intersectsBox(id);A=R&&va(e,L,n,t,r,o,s,l,a+1,T,!u)||D&&va(e,M,n,t,r,o,s,l,a+1,T,!u),Pc.releasePrimitive(T)}else{const T=qo(e),L=Ko(e,g);di(T,y,sb),di(L,y,ob);const M=c.intersectsBox(sb),R=c.intersectsBox(ob);if(M&&R)A=va(i,T,t,n,r,s,o,a,l+1,c,u)||va(i,L,t,n,r,s,o,a,l+1,c,u);else if(M)if(C)A=va(i,T,t,n,r,s,o,a,l+1,c,u);else{const D=Pc.getPrimitive();D.copy(sb).applyMatrix4(t);const F=qo(i),z=Ko(i,v);di(F,p,nd),di(z,p,id);const q=D.intersectsBox(nd),H=D.intersectsBox(id);A=q&&va(T,F,n,t,r,o,s,l,a+1,D,!u)||H&&va(T,z,n,t,r,o,s,l,a+1,D,!u),Pc.releasePrimitive(D)}else if(R)if(C)A=va(i,L,t,n,r,s,o,a,l+1,c,u);else{const D=Pc.getPrimitive();D.copy(ob).applyMatrix4(t);const F=qo(i),z=Ko(i,v);di(F,p,nd),di(z,p,id);const q=D.intersectsBox(nd),H=D.intersectsBox(id);A=q&&va(L,F,n,t,r,o,s,l,a+1,D,!u)||H&&va(L,z,n,t,r,o,s,l,a+1,D,!u),Pc.releasePrimitive(D)}}return A}const ox=new vs,oD=new vn,Cne={strategy:K5,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};class tC{static serialize(e,t={}){t={cloneBuffers:!0,...t};const n=e.geometry,r=e._roots,s=e._indirectBuffer,o=n.getIndex();let a;return t.cloneBuffers?a={roots:r.map(l=>l.slice()),index:o?o.array.slice():null,indirectBuffer:s?s.slice():null}:a={roots:r,index:o?o.array:null,indirectBuffer:s},a}static deserialize(e,t,n={}){n={setIndex:!0,indirect:!!e.indirectBuffer,...n};const{index:r,roots:s,indirectBuffer:o}=e,a=new tC(t,{...n,[JM]:!0});if(a._roots=s,a._indirectBuffer=o||null,n.setIndex){const l=t.getIndex();if(l===null){const c=new wt(e.index,1,!1);t.setIndex(c)}else l.array!==r&&(l.array.set(r),l.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({...Cne,[JM]:!1},t),t.useSharedArrayBuffer&&!Ene())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[JM]||(Vte(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new vn))),this.resolveTriangleIndex=t.indirect?n=>this._indirectBuffer[n]:n=>n}refit(e=null){return(this.indirect?gne:ine)(this,e)}traverse(e,t=0){const n=this._roots[t],r=new Uint32Array(n),s=new Uint16Array(n);o(0);function o(a,l=0){const c=a*2,u=s[c+15]===Pw;if(u){const h=r[a+6],f=s[c+14];e(l,u,new Float32Array(n,a*4,6),h,f)}else{const h=a+Fg/4,f=r[a+6],p=r[a+7];e(l,u,new Float32Array(n,a*4,6),p)||(o(h,l+1),o(f,l+1))}}}raycast(e,t=wo,n=0,r=1/0){const s=this._roots,o=this.geometry,a=[],l=t.isMaterial,c=Array.isArray(t),u=o.groups,h=l?t.side:t,f=this.indirect?vne:ane;for(let p=0,v=s.length;p<v;p++){const x=c?t[u[p].materialIndex].side:h,y=a.length;if(f(this,p,x,e,a,n,r),c){const g=u[p].materialIndex;for(let _=y,w=a.length;_<w;_++)a[_].face.materialIndex=g}}return a}raycastFirst(e,t=wo,n=0,r=1/0){const s=this._roots,o=this.geometry,a=t.isMaterial,l=Array.isArray(t);let c=null;const u=o.groups,h=a?t.side:t,f=this.indirect?xne:cne;for(let p=0,v=s.length;p<v;p++){const x=l?t[u[p].materialIndex].side:h,y=f(this,p,x,e,n,r);y!=null&&(c==null||y.distance<c.distance)&&(c=y,l&&(y.face.materialIndex=u[p].materialIndex))}return c}intersectsGeometry(e,t){let n=!1;const r=this._roots,s=this.indirect?_ne:une;for(let o=0,a=r.length;o<a&&(n=s(this,o,e,t),!n);o++);return n}shapecast(e){const t=Zo.getPrimitive(),n=this.indirect?one:nne;let{boundsTraverseOrder:r,intersectsBounds:s,intersectsRange:o,intersectsTriangle:a}=e;if(o&&a){const h=o;o=(f,p,v,x,y)=>h(f,p,v,x,y)?!0:n(f,p,this,a,v,x,t)}else o||(a?o=(h,f,p,v)=>n(h,f,this,a,p,v,t):o=(h,f,p)=>p);let l=!1,c=0;const u=this._roots;for(let h=0,f=u.length;h<f;h++){const p=u[h];if(l=Kte(this,h,s,o,r,c),l)break;c+=p.byteLength}return Zo.releasePrimitive(t),l}bvhcast(e,t,n){let{intersectsRanges:r,intersectsTriangles:s}=n;const o=Zo.getPrimitive(),a=this.geometry.index,l=this.geometry.attributes.position,c=this.indirect?v=>{const x=this.resolveTriangleIndex(v);Gi(o,x*3,a,l)}:v=>{Gi(o,v*3,a,l)},u=Zo.getPrimitive(),h=e.geometry.index,f=e.geometry.attributes.position,p=e.indirect?v=>{const x=e.resolveTriangleIndex(v);Gi(u,x*3,h,f)}:v=>{Gi(u,v*3,h,f)};if(s){const v=(x,y,g,_,w,S,C,E)=>{for(let A=g,T=g+_;A<T;A++){p(A),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let L=x,M=x+y;L<M;L++)if(c(L),o.needsUpdate=!0,s(o,u,L,A,w,S,C,E))return!0}return!1};if(r){const x=r;r=function(y,g,_,w,S,C,E,A){return x(y,g,_,w,S,C,E,A)?!0:v(y,g,_,w,S,C,E,A)}}else r=v}return Ane(this,e,t,r)}intersectsBox(e,t){return ox.set(e.min,e.max,t),ox.needsUpdate=!0,this.shapecast({intersectsBounds:n=>ox.intersectsBox(n),intersectsTriangle:n=>ox.intersectsTriangle(n)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,n={},r={},s=0,o=1/0){return(this.indirect?Tne:mne)(this,e,t,n,r,s,o)}closestPointToPoint(e,t={},n=0,r=1/0){return Zte(this,e,t,n,r)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(n=>{di(0,new Float32Array(n),oD),e.union(oD)}),e}}const t6=1e-6,Pne=t6*.5,n6=Math.pow(10,-Math.log10(t6)),Rne=Pne*n6;function el(i){return~~(i*n6+Rne)}function Lne(i){return`${el(i.x)},${el(i.y)}`}function aD(i){return`${el(i.x)},${el(i.y)},${el(i.z)}`}function Dne(i){return`${el(i.x)},${el(i.y)},${el(i.z)},${el(i.w)}`}function Ine(i,e,t){t.direction.subVectors(e,i).normalize();const n=i.dot(t.direction);return t.origin.copy(i).addScaledVector(t.direction,-n),t}function i6(){return typeof SharedArrayBuffer<"u"}function Une(i){if(i.buffer instanceof SharedArrayBuffer)return i;const e=i.constructor,t=i.buffer,n=new SharedArrayBuffer(t.byteLength),r=new Uint8Array(t);return new Uint8Array(n).set(r,0),new e(n)}function Fne(i,e=ArrayBuffer){return i>65535?new Uint32Array(new e(4*i)):new Uint16Array(new e(2*i))}function kne(i,e){if(!i.index){const t=i.attributes.position.count,n=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r=Fne(t,n);i.setIndex(new wt(r,1));for(let s=0;s<t;s++)r[s]=s}}function Nne(i){return i.index?i.index.count:i.attributes.position.count}function nC(i){return Nne(i)/3}const One=1e-8,zne=new N;function Bne(i){return~~(i/3)}function Hne(i){return i%3}function lD(i,e){return i.start-e.start}function cD(i,e){return zne.subVectors(e,i.origin).dot(i.direction)}function Gne(i,e,t,n=One){i.sort(lD),e.sort(lD);for(let a=0;a<i.length;a++){const l=i[a];for(let c=0;c<e.length;c++){const u=e[c];if(!(u.start>l.end)){if(l.end<u.start||u.end<l.start)continue;if(l.start<=u.start&&l.end>=u.end)s(u.end,l.end)||i.splice(a+1,0,{start:u.end,end:l.end,index:l.index}),l.end=u.start,u.start=0,u.end=0;else if(l.start>=u.start&&l.end<=u.end)s(l.end,u.end)||e.splice(c+1,0,{start:l.end,end:u.end,index:u.index}),u.end=l.start,l.start=0,l.end=0;else if(l.start<=u.start&&l.end<=u.end){const h=l.end;l.end=u.start,u.start=h}else if(l.start>=u.start&&l.end>=u.end){const h=u.end;u.end=l.start,l.start=h}else throw new Error}if(t.has(l.index)||t.set(l.index,[]),t.has(u.index)||t.set(u.index,[]),t.get(l.index).push(u.index),t.get(u.index).push(l.index),o(u)&&(e.splice(c,1),c--),o(l)){i.splice(a,1),a--;break}}}r(i),r(e);function r(a){for(let l=0;l<a.length;l++)o(a[l])&&(a.splice(l,1),l--)}function s(a,l){return Math.abs(l-a)<n}function o(a){return Math.abs(a.end-a.start)<n}}const uD=1e-5,hD=1e-4;class Vne{constructor(){this._rays=[]}addRay(e){this._rays.push(e)}findClosestRay(e){const t=this._rays,n=e.clone();n.direction.multiplyScalar(-1);let r=1/0,s=null;for(let l=0,c=t.length;l<c;l++){const u=t[l];if(o(u,e)&&o(u,n))continue;const h=a(u,e),f=a(u,n),p=Math.min(h,f);p<r&&(r=p,s=u)}return s;function o(l,c){const u=l.origin.distanceTo(c.origin)>uD;return l.direction.angleTo(c.direction)>hD||u}function a(l,c){const u=l.origin.distanceTo(c.origin),h=l.direction.angleTo(c.direction);return u/uD+h/hD}}}const lb=new N,cb=new N,ax=new la;function Wne(i,e,t){const n=i.attributes,r=i.index,s=n.position,o=new Map,a=new Map,l=Array.from(e),c=new Vne;for(let u=0,h=l.length;u<h;u++){const f=l[u],p=Bne(f),v=Hne(f);let x=3*p+v,y=3*p+(v+1)%3;r&&(x=r.getX(x),y=r.getX(y)),lb.fromBufferAttribute(s,x),cb.fromBufferAttribute(s,y),Ine(lb,cb,ax);let g,_=c.findClosestRay(ax);_===null&&(_=ax.clone(),c.addRay(_)),a.has(_)||a.set(_,{forward:[],reverse:[],ray:_}),g=a.get(_);let w=cD(_,lb),S=cD(_,cb);w>S&&([w,S]=[S,w]),ax.direction.dot(_.direction)<0?g.reverse.push({start:w,end:S,index:f}):g.forward.push({start:w,end:S,index:f})}return a.forEach(({forward:u,reverse:h},f)=>{Gne(u,h,o,t),u.length===0&&h.length===0&&a.delete(f)}),{disjointConnectivityMap:o,fragmentMap:a}}const jne=new be,ub=new N,Xne=new Pt,hb=["","",""];class Yne{constructor(e=null){this.data=null,this.disjointConnections=null,this.unmatchedDisjointEdges=null,this.unmatchedEdges=-1,this.matchedEdges=-1,this.useDrawRange=!0,this.useAllAttributes=!1,this.matchDisjointEdges=!1,this.degenerateEpsilon=1e-8,e&&this.updateFrom(e)}getSiblingTriangleIndex(e,t){const n=this.data[e*3+t];return n===-1?-1:~~(n/3)}getSiblingEdgeIndex(e,t){const n=this.data[e*3+t];return n===-1?-1:n%3}getDisjointSiblingTriangleIndices(e,t){const n=e*3+t,r=this.disjointConnections.get(n);return r?r.map(s=>~~(s/3)):[]}getDisjointSiblingEdgeIndices(e,t){const n=e*3+t,r=this.disjointConnections.get(n);return r?r.map(s=>s%3):[]}isFullyConnected(){return this.unmatchedEdges===0}updateFrom(e){const{useAllAttributes:t,useDrawRange:n,matchDisjointEdges:r,degenerateEpsilon:s}=this,o=t?w:_,a=new Map,{attributes:l}=e,c=t?Object.keys(l):null,u=e.index,h=l.position;let f=nC(e);const p=f;let v=0;n&&(v=e.drawRange.start,e.drawRange.count!==1/0&&(f=~~(e.drawRange.count/3)));let x=this.data;(!x||x.length<3*p)&&(x=new Int32Array(3*p)),x.fill(-1);let y=0,g=new Set;for(let S=v,C=f*3+v;S<C;S+=3){const E=S;for(let A=0;A<3;A++){let T=E+A;u&&(T=u.getX(T)),hb[A]=o(T)}for(let A=0;A<3;A++){const T=(A+1)%3,L=hb[A],M=hb[T],R=`${M}_${L}`;if(a.has(R)){const D=E+A,F=a.get(R);x[D]=F,x[F]=D,a.delete(R),y+=2,g.delete(F)}else{const D=`${L}_${M}`,F=E+A;a.set(D,F),g.add(F)}}}if(r){const{fragmentMap:S,disjointConnectivityMap:C}=Wne(e,g,s);g.clear(),S.forEach(({forward:E,reverse:A})=>{E.forEach(({index:T})=>g.add(T)),A.forEach(({index:T})=>g.add(T))}),this.unmatchedDisjointEdges=S,this.disjointConnections=C,y=f*3-g.size}this.matchedEdges=y,this.unmatchedEdges=g.size,this.data=x;function _(S){return ub.fromBufferAttribute(h,S),aD(ub)}function w(S){let C="";for(let E=0,A=c.length;E<A;E++){const T=l[c[E]];let L;switch(T.itemSize){case 1:L=el(T.getX(S));break;case 2:L=Lne(jne.fromBufferAttribute(T,S));break;case 3:L=aD(ub.fromBufferAttribute(T,S));break;case 4:L=Dne(Xne.fromBufferAttribute(T,S));break}C!==""&&(C+="|"),C+=L}return C}}}class w_ extends Ae{constructor(...e){super(...e),this.isBrush=!0,this._previousMatrix=new Ze,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:e,_previousMatrix:t}=this,n=e.elements,r=t.elements;for(let s=0;s<16;s++)if(n[s]!==r[s])return!0;return!1}prepareGeometry(){const e=this.geometry,t=e.attributes,n=i6();if(n)for(const r in t){const s=t[r];if(s.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");s.array=Une(s.array)}if(e.boundsTree||(kne(e,{useSharedArrayBuffer:n}),e.boundsTree=new tC(e,{maxLeafTris:3,indirect:!0,useSharedArrayBuffer:n})),e.halfEdges||(e.halfEdges=new Yne(e)),!e.groupIndices){const r=nC(e),s=new Uint16Array(r),o=e.groups;for(let a=0,l=o.length;a<l;a++){const{start:c,count:u}=o[a];for(let h=c/3,f=(c+u)/3;h<f;h++)s[h]=a}e.groupIndices=s}}disposeCacheData(){const{geometry:e}=this;e.halfEdges=null,e.boundsTree=null,e.groupIndices=null}}const qne=1e-14,fb=new N,fD=new N,dD=new N;function Ic(i,e=qne){fb.subVectors(i.b,i.a),fD.subVectors(i.c,i.a),dD.subVectors(i.b,i.c);const t=fb.angleTo(fD),n=fb.angleTo(dD),r=Math.PI-t-n;return Math.abs(t)<e||Math.abs(n)<e||Math.abs(r)<e||i.a.distanceToSquared(i.b)<e||i.a.distanceToSquared(i.c)<e||i.b.distanceToSquared(i.c)<e}const db=1e-10,Qm=1e-10,Kne=1e-10,Pl=new Us,Ei=new Us,Rl=new N,pb=new N,pD=new N,lx=new Vr,mb=new ia;class Zne{constructor(){this._pool=[],this._index=0}getTriangle(){return this._index>=this._pool.length&&this._pool.push(new An),this._pool[this._index++]}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class Qne{constructor(){this.trianglePool=new Zne,this.triangles=[],this.normal=new N,this.coplanarTriangleUsed=!1}initialize(e){this.reset();const{triangles:t,trianglePool:n,normal:r}=this;if(Array.isArray(e))for(let s=0,o=e.length;s<o;s++){const a=e[s];if(s===0)a.getNormal(r);else if(Math.abs(1-a.getNormal(Rl).dot(r))>db)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const l=n.getTriangle();l.copy(a),t.push(l)}else{e.getNormal(r);const s=n.getTriangle();s.copy(e),t.push(s)}}splitByTriangle(e){const{normal:t,triangles:n}=this;if(e.getNormal(pb).normalize(),Math.abs(1-Math.abs(pb.dot(t)))<Kne){this.coplanarTriangleUsed=!0;for(let s=0,o=n.length;s<o;s++){const a=n[s];a.coplanarCount=0}const r=[e.a,e.b,e.c];for(let s=0;s<3;s++){const o=(s+1)%3,a=r[s],l=r[o];Rl.subVectors(l,a).normalize(),pD.crossVectors(pb,Rl),lx.setFromNormalAndCoplanarPoint(pD,a),this.splitByPlane(lx,e)}}else e.getPlane(lx),this.splitByPlane(lx,e)}splitByPlane(e,t){const{triangles:n,trianglePool:r}=this;mb.copy(t),mb.needsUpdate=!0;for(let s=0,o=n.length;s<o;s++){const a=n[s];if(!mb.intersectsTriangle(a,Pl,!0))continue;const{a:l,b:c,c:u}=a;let h=0,f=-1,p=!1,v=[],x=[];const y=[l,c,u];for(let g=0;g<3;g++){const _=(g+1)%3;Pl.start.copy(y[g]),Pl.end.copy(y[_]);const w=e.distanceToPoint(Pl.start),S=e.distanceToPoint(Pl.end);if(Math.abs(w)<Qm&&Math.abs(S)<Qm){p=!0;break}if(w>0?v.push(g):x.push(g),Math.abs(w)<Qm)continue;let C=!!e.intersectLine(Pl,Rl);!C&&Math.abs(S)<Qm&&(Rl.copy(Pl.end),C=!0),C&&!(Rl.distanceTo(Pl.start)<db)&&(Rl.distanceTo(Pl.end)<db&&(f=g),h===0?Ei.start.copy(Rl):Ei.end.copy(Rl),h++)}if(!p&&h===2&&Ei.distance()>Qm)if(f!==-1){f=(f+1)%3;let g=0;g===f&&(g=(g+1)%3);let _=g+1;_===f&&(_=(_+1)%3);const w=r.getTriangle();w.a.copy(y[_]),w.b.copy(Ei.end),w.c.copy(Ei.start),Ic(w)||n.push(w),a.a.copy(y[g]),a.b.copy(Ei.start),a.c.copy(Ei.end),Ic(a)&&(n.splice(s,1),s--,o--)}else{const g=v.length>=2?x[0]:v[0];if(g===0){let E=Ei.start;Ei.start=Ei.end,Ei.end=E}const _=(g+1)%3,w=(g+2)%3,S=r.getTriangle(),C=r.getTriangle();y[_].distanceToSquared(Ei.start)<y[w].distanceToSquared(Ei.end)?(S.a.copy(y[_]),S.b.copy(Ei.start),S.c.copy(Ei.end),C.a.copy(y[_]),C.b.copy(y[w]),C.c.copy(Ei.start)):(S.a.copy(y[w]),S.b.copy(Ei.start),S.c.copy(Ei.end),C.a.copy(y[_]),C.b.copy(y[w]),C.c.copy(Ei.end)),a.a.copy(y[g]),a.b.copy(Ei.end),a.c.copy(Ei.start),Ic(S)||n.push(S),Ic(C)||n.push(C),Ic(a)&&(n.splice(s,1),s--,o--)}else h===3&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0,this.trianglePool.clear(),this.coplanarTriangleUsed=!1}}function Jne(i){return i=~~i,i+4-i%4}class mD{constructor(e,t=500){this.expansionFactor=1.5,this.type=e,this.length=0,this.array=null,this.setSize(t)}setType(e){if(this.length!==0)throw new Error("TypeBackedArray: Cannot change the type while there is used data in the buffer.");const t=this.array.buffer;this.array=new e(t),this.type=e}setSize(e){if(this.array&&e===this.array.length)return;const t=this.type,n=i6()?SharedArrayBuffer:ArrayBuffer,r=new t(new n(Jne(e*t.BYTES_PER_ELEMENT)));this.array&&r.set(this.array,0),this.array=r}expand(){const{array:e,expansionFactor:t}=this;this.setSize(e.length*t)}push(...e){let{array:t,length:n}=this;n+e.length>t.length&&(this.expand(),t=this.array);for(let r=0,s=e.length;r<s;r++)t[n+r]=e[r];this.length+=e.length}clear(){this.length=0}}class $ne{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(e){return this.groupAttributes[0][e].type}getItemSize(e){return this.groupAttributes[0][e].itemSize}getNormalized(e){return this.groupAttributes[0][e].normalized}getCount(e){if(this.groupCount<=e)return 0;const t=this.getGroupAttrArray("position",e);return t.length/t.itemSize}getTotalLength(e){const{groupCount:t,groupAttributes:n}=this;let r=0;for(let s=0;s<t;s++){const o=n[s];r+=o[e].length}return r}getGroupAttrSet(e=0){const{groupAttributes:t}=this;if(t[e])return this.groupCount=Math.max(this.groupCount,e+1),t[e];const n=t[0];for(this.groupCount=Math.max(this.groupCount,e+1);e>=t.length;){const r={};t.push(r);for(const s in n){const o=n[s],a=new mD(o.type);a.itemSize=o.itemSize,a.normalized=o.normalized,r[s]=a}}return t[e]}getGroupAttrArray(e,t=0){const{groupAttributes:n}=this;if(!n[0][e])throw new Error(`TypedAttributeData: Attribute with "${e}" has not been initialized`);return this.getGroupAttrSet(t)[e]}initializeArray(e,t,n,r){const{groupAttributes:s}=this,a=s[0][e];if(a){if(a.type!==t)for(let l=0,c=s.length;l<c;l++){const u=s[l][e];u.setType(t),u.itemSize=n,u.normalized=r}}else for(let l=0,c=s.length;l<c;l++){const u=new mD(t);u.itemSize=n,u.normalized=r,s[l][e]=u}}clear(){this.groupCount=0;const{groupAttributes:e}=this;e.forEach(t=>{for(const n in t)t[n].clear()})}delete(e){this.groupAttributes.forEach(t=>{delete t[e]})}reset(){this.groupAttributes=[],this.groupCount=0}}class gD{constructor(){this.intersectionSet={},this.ids=[]}add(e,t){const{intersectionSet:n,ids:r}=this;n[e]||(n[e]=[],r.push(e)),n[e].push(t)}}const eie=0,r6=1,tie=2,nie=3,iie=4,s6=5,o6=6,Ho=new la,vD=new Ze,ls=new An,Ll=new N,yD=new Pt,xD=new Pt,_D=new Pt,gb=new Pt,cx=new Pt,ux=new Pt,wD=new Us,vb=new N,yb=1e-8,rie=1e-15,gh=-1,vh=1,o1=-2,a1=2,Ng=0,ih=1,iC=2,sie=1e-14;let l1=null;function SD(i){l1=i}function a6(i,e){i.getMidpoint(Ho.origin),i.getNormal(Ho.direction);const t=e.raycastFirst(Ho,_n);return!!(t&&Ho.direction.dot(t.face.normal)>0)?gh:vh}function oie(i,e){function t(){return Math.random()-.5}i.getNormal(vb),Ho.direction.copy(vb),i.getMidpoint(Ho.origin);const n=3;let r=0,s=1/0;for(let o=0;o<n;o++){Ho.direction.x+=t()*yb,Ho.direction.y+=t()*yb,Ho.direction.z+=t()*yb,Ho.direction.multiplyScalar(-1);const a=e.raycastFirst(Ho,_n);if(!!(a&&Ho.direction.dot(a.face.normal)>0)&&r++,a!==null&&(s=Math.min(s,a.distance)),s<=rie)return a.face.normal.dot(vb)>0?a1:o1;if(r/n>.5||(o-r+1)/n>.5)break}return r/n>.5?gh:vh}function aie(i,e){const t=new gD,n=new gD;return vD.copy(i.matrixWorld).invert().multiply(e.matrixWorld),i.geometry.boundsTree.bvhcast(e.geometry.boundsTree,vD,{intersectsTriangles(r,s,o,a){if(!Ic(r)&&!Ic(s)){let l=r.intersectsTriangle(s,wD,!0);if(!l){const c=r.plane,u=s.plane,h=c.normal,f=u.normal;h.dot(f)===1&&Math.abs(c.constant-u.constant)<sie&&(l=!0)}if(l){let c=i.geometry.boundsTree.resolveTriangleIndex(o),u=e.geometry.boundsTree.resolveTriangleIndex(a);t.add(c,u),n.add(u,c),l1&&(l1.addEdge(wD),l1.addIntersectingTriangles(o,r,a,s))}}return!1}}),{aIntersections:t,bIntersections:n}}function lie(i,e,t,n,r,s,o=!1){const a=t.attributes,l=t.index,c=i*3,u=l.getX(c+0),h=l.getX(c+1),f=l.getX(c+2);for(const p in s){const v=a[p],x=s[p];if(!(p in a))throw new Error(`CSG Operations: Attribute ${p} not available on geometry.`);const y=v.itemSize;p==="position"?(ls.a.fromBufferAttribute(v,u).applyMatrix4(n),ls.b.fromBufferAttribute(v,h).applyMatrix4(n),ls.c.fromBufferAttribute(v,f).applyMatrix4(n),xb(ls.a,ls.b,ls.c,e,3,x,o)):p==="normal"?(ls.a.fromBufferAttribute(v,u).applyNormalMatrix(r),ls.b.fromBufferAttribute(v,h).applyNormalMatrix(r),ls.c.fromBufferAttribute(v,f).applyNormalMatrix(r),o&&(ls.a.multiplyScalar(-1),ls.b.multiplyScalar(-1),ls.c.multiplyScalar(-1)),xb(ls.a,ls.b,ls.c,e,3,x,o,!0)):(yD.fromBufferAttribute(v,u),xD.fromBufferAttribute(v,h),_D.fromBufferAttribute(v,f),xb(yD,xD,_D,e,y,x,o))}}function cie(i,e,t,n,r,s,o,a=!1){_b(i,n,r,s,o,a),_b(a?t:e,n,r,s,o,a),_b(a?e:t,n,r,s,o,a)}function l6(i,e,t=!1){switch(i){case eie:if(e===vh||e===a1&&!t)return ih;break;case r6:if(t){if(e===gh)return Ng}else if(e===vh||e===o1)return ih;break;case tie:if(t){if(e===vh||e===o1)return ih}else if(e===gh)return Ng;break;case iie:if(e===gh)return Ng;if(e===vh)return ih;break;case nie:if(e===gh||e===a1&&!t)return ih;break;case s6:if(!t&&(e===vh||e===o1))return ih;break;case o6:if(!t&&(e===gh||e===a1))return ih;break;default:throw new Error(`Unrecognized CSG operation enum "${i}".`)}return iC}function xb(i,e,t,n,r,s,o=!1,a=!1){const l=c=>{s.push(c.x),r>1&&s.push(c.y),r>2&&s.push(c.z),r>3&&s.push(c.w)};gb.set(0,0,0,0).addScaledVector(i,n.a.x).addScaledVector(e,n.a.y).addScaledVector(t,n.a.z),cx.set(0,0,0,0).addScaledVector(i,n.b.x).addScaledVector(e,n.b.y).addScaledVector(t,n.b.z),ux.set(0,0,0,0).addScaledVector(i,n.c.x).addScaledVector(e,n.c.y).addScaledVector(t,n.c.z),a&&(gb.normalize(),cx.normalize(),ux.normalize()),l(gb),o?(l(ux),l(cx)):(l(cx),l(ux))}function _b(i,e,t,n,r,s=!1){for(const o in r){const a=e[o],l=r[o];if(!(o in e))throw new Error(`CSG Operations: Attribute ${o} no available on geometry.`);const c=a.itemSize;o==="position"?(Ll.fromBufferAttribute(a,i).applyMatrix4(t),l.push(Ll.x,Ll.y,Ll.z)):o==="normal"?(Ll.fromBufferAttribute(a,i).applyNormalMatrix(n),s&&Ll.multiplyScalar(-1),l.push(Ll.x,Ll.y,Ll.z)):(l.push(a.getX(i)),c>1&&l.push(a.getY(i)),c>2&&l.push(a.getZ(i)),c>3&&l.push(a.getW(i)))}}class uie{constructor(e){this.triangle=new An().copy(e),this.intersects={}}addTriangle(e,t){this.intersects[e]=new An().copy(t)}getIntersectArray(){const e=[],{intersects:t}=this;for(const n in t)e.push(t[n]);return e}}class MD{constructor(){this.data={}}addTriangleIntersection(e,t,n,r){const{data:s}=this;s[e]||(s[e]=new uie(t)),s[e].addTriangle(n,r)}getTrianglesAsArray(e=null){const{data:t}=this,n=[];if(e!==null)e in t&&n.push(t[e].triangle);else for(const r in t)n.push(t[r].triangle);return n}getTriangleIndices(){return Object.keys(this.data).map(e=>parseInt(e))}getIntersectionIndices(e){const{data:t}=this;return t[e]?Object.keys(t[e].intersects).map(n=>parseInt(n)):[]}getIntersectionsAsArray(e=null,t=null){const{data:n}=this,r=new Set,s=[],o=a=>{if(n[a])if(t!==null)n[a].intersects[t]&&s.push(n[a].intersects[t]);else{const l=n[a].intersects;for(const c in l)r.has(c)||(r.add(c),s.push(l[c]))}};if(e!==null)o(e);else for(const a in n)o(a);return s}reset(){this.data={}}}class hie{constructor(){this.enabled=!1,this.triangleIntersectsA=new MD,this.triangleIntersectsB=new MD,this.intersectionEdges=[]}addIntersectingTriangles(e,t,n,r){const{triangleIntersectsA:s,triangleIntersectsB:o}=this;s.addTriangleIntersection(e,t,n,r),o.addTriangleIntersection(n,r,e,t)}addEdge(e){this.intersectionEdges.push(e.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}init(){this.enabled&&(this.reset(),SD(this))}complete(){this.enabled&&SD(null)}}const Bc=new Ze,S_=new Nt,rh=new An,hx=new An,Ec=new An,fx=new An,Ma=[],kh=[];function fie(i){for(const e of i)return e}function die(i,e,t,n,r,s={}){const{useGroups:o=!0}=s,{aIntersections:a,bIntersections:l}=aie(i,e),c=[];let u=null,h;return h=o?0:-1,bD(i,e,a,t,!1,n,r,h),TD(i,e,a,t,!1,r,h),t.findIndex(p=>p!==o6&&p!==s6)!==-1&&(h=o?i.geometry.groups.length||1:-1,bD(e,i,l,t,!0,n,r,h),TD(e,i,l,t,!0,r,h)),Ma.length=0,kh.length=0,{groups:c,materials:u}}function bD(i,e,t,n,r,s,o,a=0){const l=i.matrixWorld.determinant()<0;Bc.copy(e.matrixWorld).invert().multiply(i.matrixWorld),S_.getNormalMatrix(i.matrixWorld).multiplyScalar(l?-1:1);const c=i.geometry.groupIndices,u=i.geometry.index,h=i.geometry.attributes.position,f=e.geometry.boundsTree,p=e.geometry.index,v=e.geometry.attributes.position,x=t.ids,y=t.intersectionSet;for(let g=0,_=x.length;g<_;g++){const w=x[g],S=a===-1?0:c[w]+a,C=3*w,E=u.getX(C+0),A=u.getX(C+1),T=u.getX(C+2);rh.a.fromBufferAttribute(h,E).applyMatrix4(Bc),rh.b.fromBufferAttribute(h,A).applyMatrix4(Bc),rh.c.fromBufferAttribute(h,T).applyMatrix4(Bc),s.reset(),s.initialize(rh);const L=y[w];for(let R=0,D=L.length;R<D;R++){const F=3*L[R],z=p.getX(F+0),q=p.getX(F+1),H=p.getX(F+2);hx.a.fromBufferAttribute(v,z),hx.b.fromBufferAttribute(v,q),hx.c.fromBufferAttribute(v,H),s.splitByTriangle(hx)}const M=s.triangles;for(let R=0,D=M.length;R<D;R++){const F=M[R],z=s.coplanarTriangleUsed?oie(F,f):a6(F,f);Ma.length=0,kh.length=0;for(let q=0,H=n.length;q<H;q++){const $=l6(n[q],z,r);$!==iC&&(kh.push($),Ma.push(o[q].getGroupAttrSet(S)))}if(Ma.length!==0){rh.getBarycoord(F.a,fx.a),rh.getBarycoord(F.b,fx.b),rh.getBarycoord(F.c,fx.c);for(let q=0,H=Ma.length;q<H;q++){const $=Ma[q],X=kh[q]===Ng;lie(w,fx,i.geometry,i.matrixWorld,S_,$,l!==X)}}}}return x.length}function TD(i,e,t,n,r,s,o=0){const a=i.matrixWorld.determinant()<0;Bc.copy(e.matrixWorld).invert().multiply(i.matrixWorld),S_.getNormalMatrix(i.matrixWorld).multiplyScalar(a?-1:1);const l=e.geometry.boundsTree,c=i.geometry.groupIndices,u=i.geometry.index,h=i.geometry.attributes,f=h.position,p=[],v=i.geometry.halfEdges,x=new Set,y=nC(i.geometry);for(let g=0,_=y;g<_;g++)g in t.intersectionSet||x.add(g);for(;x.size>0;){const g=fie(x);x.delete(g),p.push(g);const _=3*g,w=u.getX(_+0),S=u.getX(_+1),C=u.getX(_+2);Ec.a.fromBufferAttribute(f,w).applyMatrix4(Bc),Ec.b.fromBufferAttribute(f,S).applyMatrix4(Bc),Ec.c.fromBufferAttribute(f,C).applyMatrix4(Bc);const E=a6(Ec,l);kh.length=0,Ma.length=0;for(let A=0,T=n.length;A<T;A++){const L=l6(n[A],E,r);L!==iC&&(kh.push(L),Ma.push(s[A]))}for(;p.length>0;){const A=p.pop();for(let T=0;T<3;T++){const L=v.getSiblingTriangleIndex(A,T);L!==-1&&x.has(L)&&(p.push(L),x.delete(L))}if(Ma.length!==0){const T=3*A,L=u.getX(T+0),M=u.getX(T+1),R=u.getX(T+2),D=o===-1?0:c[A]+o;if(Ec.a.fromBufferAttribute(f,L),Ec.b.fromBufferAttribute(f,M),Ec.c.fromBufferAttribute(f,R),!Ic(Ec))for(let F=0,z=Ma.length;F<z;F++){const q=kh[F],H=Ma[F].getGroupAttrSet(D),$=q===Ng;cie(L,M,R,h,i.matrixWorld,S_,H,$!==a)}}}}}function pie(i){for(let e=0;e<i.length-1;e++){const t=i[e],n=i[e+1];if(t.materialIndex===n.materialIndex){const r=t.start,s=n.start+n.count;n.start=r,n.count=s-r,i.splice(e,1),e--}}}function mie(i,e,t,n){t.clear();const r=i.attributes;for(let s=0,o=n.length;s<o;s++){const a=n[s],l=r[a];t.initializeArray(a,l.array.constructor,l.itemSize,l.normalized)}for(const s in t.attributes)n.includes(s)||t.delete(s);for(const s in e.attributes)n.includes(s)||(e.deleteAttribute(s),e.dispose())}function gie(i,e,t){let n=!1,r=-1;const s=i.attributes,o=e.groupAttributes[0];for(const l in o){const c=e.getTotalLength(l),u=e.getType(l),h=e.getItemSize(l),f=e.getNormalized(l);let p=s[l];(!p||p.array.length<c)&&(p=new wt(new u(c),h,f),i.setAttribute(l,p),n=!0);let v=0;for(let x=0,y=Math.min(t.length,e.groupCount);x<y;x++){const g=t[x].index,{array:_,type:w,length:S}=e.groupAttributes[g][l],C=new w(_.buffer,0,S);p.array.set(C,v),v+=C.length}p.needsUpdate=!0,r=c/p.itemSize}if(i.index){const l=i.index.array;if(l.length<r)i.index=null,n=!0;else for(let c=0,u=l.length;c<u;c++)l[c]=c}let a=0;i.clearGroups();for(let l=0,c=Math.min(t.length,e.groupCount);l<c;l++){const{index:u,materialIndex:h}=t[l],f=e.getCount(u);f!==0&&(i.addGroup(a,f,h),a+=f)}i.setDrawRange(0,r),i.boundsTree=null,n&&i.dispose()}function ED(i,e){let t=e;return Array.isArray(e)||(t=[],i.forEach(n=>{t[n.materialIndex]=e})),t}class vie{constructor(){this.triangleSplitter=new Qne,this.attributeData=[],this.attributes=["position","uv","normal"],this.useGroups=!0,this.consolidateGroups=!0,this.debug=new hie}getGroupRanges(e){return!this.useGroups||e.groups.length===0?[{start:0,count:1/0,materialIndex:0}]:e.groups.map(t=>({...t}))}evaluate(e,t,n,r=new w_){let s=!0;if(Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r],s=!1),r.length!==n.length)throw new Error("Evaluator: operations and target array passed as different sizes.");e.prepareGeometry(),t.prepareGeometry();const{triangleSplitter:o,attributeData:a,attributes:l,useGroups:c,consolidateGroups:u,debug:h}=this;for(;a.length<r.length;)a.push(new $ne);r.forEach((g,_)=>{mie(e.geometry,g.geometry,a[_],l)}),h.init(),die(e,t,n,o,a,{useGroups:c}),h.complete();const f=this.getGroupRanges(e.geometry),p=ED(f,e.material),v=this.getGroupRanges(t.geometry),x=ED(v,t.material);v.forEach(g=>g.materialIndex+=p.length);let y=[...f,...v].map((g,_)=>({...g,index:_}));if(c){const g=[...p,...x];u&&(y=y.map(w=>{const S=g[w.materialIndex];return w.materialIndex=g.indexOf(S),w}).sort((w,S)=>w.materialIndex-S.materialIndex));const _=[];for(let w=0,S=g.length;w<S;w++){let C=!1;for(let E=0,A=y.length;E<A;E++){const T=y[E];T.materialIndex===w&&(C=!0,T.materialIndex=_.length)}C&&_.push(g[w])}r.forEach(w=>{w.material=_})}else y=[{start:0,count:1/0,index:0,materialIndex:0}],r.forEach(g=>{g.material=p[0]});return r.forEach((g,_)=>{const w=g.geometry;gie(w,a[_],y),u&&pie(w.groups)}),s?r:r[0]}evaluateHierarchy(e,t=new w_){e.updateMatrixWorld(!0);const n=(s,o)=>{const a=s.children;for(let l=0,c=a.length;l<c;l++){const u=a[l];u.isOperationGroup?n(u,o):o(u)}},r=s=>{const o=s.children;let a=!1;for(let c=0,u=o.length;c<u;c++){const h=o[c];a=r(h)||a}const l=s.isDirty();if(l&&s.markUpdated(),a&&!s.isOperationGroup){let c;return n(s,u=>{c?c=this.evaluate(c,u,u.operation):c=this.evaluate(s,u,u.operation)}),s._cachedGeometry=c.geometry,s._cachedMaterials=c.material,!0}else return a||l};return r(e),t.geometry=e._cachedGeometry,t.material=e._cachedMaterials,t}reset(){this.triangleSplitter.reset()}}var AD=`uniform float uTime;
uniform float uPositionFrequency;
uniform float uStrength;
uniform float uWarpFrequency;
uniform float uWarpStrength;

varying vec3  vPosition;
varying float vUpDot;

vec3 _permute(vec3 x) {
    return mod(((x*44.0)+1.0)*x, 299.0);
}

float calcSimplexNoise2d(vec2 v) {
    const vec4 C = vec4(0.211324865405187, 0.366025403784439,
    -0.577350269189626, 0.024390243902439);
    vec2 i  = floor(v + dot(v, C.yy) );
    vec2 x0 = v -   i + dot(i, C.xx);
    vec2 i1;
    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
    vec4 x12 = x0.xyxy + C.xxzz;
    x12.xy -= i1;
    i = mod(i, 299.0);
    vec3 p = _permute(_permute( i.y + vec3(0.0, i1.y, 1.0 ))
                      + i.x + vec3(0.0, i1.x, 1.0 ));
    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy),
    dot(x12.zw,x12.zw)), 0.0);
    m = m*m ;
    m = m*m ;
    vec3 x = 2.0 * fract(p * C.www) - 1.0;
    vec3 h = abs(x) - 0.5;
    vec3 ox = floor(x + 0.5);
    vec3 a0 = x - ox;
    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
    vec3 g;
    g.x  = a0.x  * x0.x  + h.x  * x0.y;
    g.yz = a0.yz * x12.xz + h.yz * x12.yw;
    return 130.0 * dot(m, g);
}

float _calcElevation(
    vec2  position,
    float positionFreq,
    float strength,
    float warpFreq,
    float warpStrength
) {
    float elevation      = 0.0;
    vec2 warpedPosition  = position;
    warpedPosition      += calcSimplexNoise2d(
        position * positionFreq * warpFreq
    ) * warpStrength;

    elevation += calcSimplexNoise2d(warpedPosition * positionFreq)       / 2.0;
    elevation += calcSimplexNoise2d(warpedPosition * positionFreq * 2.0) / 4.0;
    elevation += calcSimplexNoise2d(warpedPosition * positionFreq * 4.0) / 8.0;

    float elevationSign = sign(elevation);
    elevation           = pow(abs(elevation), 2.0) * elevationSign;

    elevation *= strength;

    return elevation;
}

void main() {
    float displacement  = 0.2 * uTime;
    vec3 pos            = csm_Position;
    pos.xz             += displacement;
    float shift         = 0.01;
    vec3  positionA     = pos + vec3(1.0, 0.0, 0.0)  * shift;
    vec3  positionB     = pos + vec3(0.0, 0.0, -1.0) * shift;

    pos.y += _calcElevation(
        pos.xz,
        uPositionFrequency,
        uStrength,
        uWarpFrequency,
        uWarpStrength
    );
    positionA.y += _calcElevation(
        positionA.xz,
        uPositionFrequency,
        uStrength,
        uWarpFrequency,
        uWarpStrength
    );
    positionB.y += _calcElevation(
        positionB.xz,
        uPositionFrequency,
        uStrength,
        uWarpFrequency,
        uWarpStrength
    );
    csm_Position.y = pos.y;

    vec3 toA   = normalize(positionA - pos);
    vec3 toB   = normalize(positionB - pos);
    csm_Normal = cross(toA, toB);

    vPosition = pos;
    vUpDot    = dot(csm_Normal, vec3(0.0, 1.0, 0.0));
}`,yie=`uniform vec3 uDeepWaterColor;
uniform vec3 uSurfaceWaterColor;
uniform vec3 uSandColor;
uniform vec3 uGrassColor;
uniform vec3 uSnowColor;
uniform vec3 uRockColor;

varying vec3  vPosition;
varying float vUpDot;

vec3 _permute(vec3 x) {
    return mod(((x*44.0)+1.0)*x, 299.0);
}

float calcSimplexNoise2d(vec2 v) {
    const vec4 C = vec4(0.211324865405187, 0.366025403784439,
    -0.577350269189626, 0.024390243902439);
    vec2 i  = floor(v + dot(v, C.yy) );
    vec2 x0 = v -   i + dot(i, C.xx);
    vec2 i1;
    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
    vec4 x12 = x0.xyxy + C.xxzz;
    x12.xy -= i1;
    i = mod(i, 299.0);
    vec3 p = _permute(_permute( i.y + vec3(0.0, i1.y, 1.0 ))
                      + i.x + vec3(0.0, i1.x, 1.0 ));
    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy),
    dot(x12.zw,x12.zw)), 0.0);
    m = m*m ;
    m = m*m ;
    vec3 x = 2.0 * fract(p * C.www) - 1.0;
    vec3 h = abs(x) - 0.5;
    vec3 ox = floor(x + 0.5);
    vec3 a0 = x - ox;
    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
    vec3 g;
    g.x  = a0.x  * x0.x  + h.x  * x0.y;
    g.yz = a0.yz * x12.xz + h.yz * x12.yw;
    return 130.0 * dot(m, g);
}

void main() {
    vec3 color = vec3(1.0);

    float waterMixFactor = smoothstep(-1.0, -0.1, vPosition.y);
    color                = mix(
        uDeepWaterColor, uSurfaceWaterColor, waterMixFactor
    );

    float sandMixFactor = step(-0.1, vPosition.y);
    color               = mix(color, uSandColor, sandMixFactor);

    float grassMixFactor = step(-0.06, vPosition.y);
    color                = mix(color, uGrassColor, grassMixFactor);

    float rockMixFactor  = 1.0 - step(0.8, vUpDot);
    rockMixFactor       *= grassMixFactor;
    color                = mix(color, uRockColor, rockMixFactor);

    float snowThreshold   = 0.45;
    snowThreshold        += calcSimplexNoise2d(vPosition.xz * 15.0) * 0.1;
    float snowMixFactor   = step(snowThreshold, vPosition.y);
    color                 = mix(color, uSnowColor, snowMixFactor);

    csm_DiffuseColor = vec4(color, 1.0);
}`,Qr,c6,u6,h6,f6,d6,p6,m6,bU;let xie=(bU=class extends Dt{constructor(){super(...arguments);st(this,Qr);oe(this,"mesh");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0)}get number(){return"44"}get title(){return"Procedural Terrain"}get link(){return"https://threejs-journey.com/lessons/procedural-terrain-shader"}update(t){this.mesh.material.uniforms.uTime.value=t*.001,this.control.update()}init(){super.init(),W(this,Qr,f6).call(this),W(this,Qr,d6).call(this),W(this,Qr,u6).call(this),W(this,Qr,h6).call(this),W(this,Qr,c6).call(this),W(this,Qr,p6).call(this),W(this,Qr,m6).call(this)}},Qr=new WeakSet,c6=function(){this.guiControl.add(this.mesh.material.uniforms.uPositionFrequency,"value").min(0).max(1).step(.001).name("uPositionFrequency"),this.guiControl.add(this.mesh.material.uniforms.uStrength,"value").min(0).max(10).step(.001).name("uStrength"),this.guiControl.add(this.mesh.material.uniforms.uWarpFrequency,"value").min(0).max(10).step(.001).name("uWarpFrequency"),this.guiControl.add(this.mesh.material.uniforms.uWarpStrength,"value").min(0).max(1).step(.001).name("uWarpStrength"),this.guiControl.addColor({uDeepWaterColor:this.mesh.material.uniforms.uDeepWaterColor.value.getHexString()},"uDeepWaterColor").onChange(t=>{this.mesh.material.uniforms.uDeepWaterColor.value.set(t)}),this.guiControl.addColor({uSurfaceWaterColor:this.mesh.material.uniforms.uSurfaceWaterColor.value.getHexString()},"uSurfaceWaterColor").onChange(t=>{this.mesh.material.uniforms.uSurfaceWaterColor.value.set(t)}),this.guiControl.addColor({uSandColor:this.mesh.material.uniforms.uSandColor.value.getHexString()},"uSandColor").onChange(t=>{this.mesh.material.uniforms.uSandColor.value.set(t)}),this.guiControl.addColor({uGrassColor:this.mesh.material.uniforms.uGrassColor.value.getHexString()},"uGrassColor").onChange(t=>{this.mesh.material.uniforms.uGrassColor.value.set(t)}),this.guiControl.addColor({uSnowColor:this.mesh.material.uniforms.uSnowColor.value.getHexString()},"uSnowColor").onChange(t=>{this.mesh.material.uniforms.uSnowColor.value.set(t)}),this.guiControl.addColor({uRockColor:this.mesh.material.uniforms.uRockColor.value.getHexString()},"uRockColor").onChange(t=>{this.mesh.material.uniforms.uRockColor.value.set(t)})},u6=function(){const t=new vie,n=new w_(new un(11,2,11)),r=new w_(new un(10,2.1,10)),s=t.evaluate(n,r,r6);s.geometry.clearGroups(),s.material=new hn({color:"#ffffff",metalness:0,roughness:.3}),s.receiveShadow=!0,s.castShadow=!0,this.scene.add(s)},h6=function(){const t={uPositionFrequency:new We(.2),uStrength:new We(2),uWarpFrequency:new We(5),uWarpStrength:new We(.5),uTime:new We(0),uDeepWaterColor:new We(new Ge("#002b3d")),uSurfaceWaterColor:new We(new Ge("#66a8ff")),uSandColor:new We(new Ge("#ffe894")),uGrassColor:new We(new Ge("#85d534")),uSnowColor:new We(new Ge("#ffffff")),uRockColor:new We(new Ge("#bfbd8d"))},n=new Ot(10,10,500,500);n.rotateX(-Math.PI/2),n.deleteAttribute("normal"),n.deleteAttribute("uv");const r=new Ep({baseMaterial:hn,vertexShader:AD,fragmentShader:yie,uniforms:t,silent:!0,metalness:0,roughness:.5,color:"#85d534"}),s=new Ep({baseMaterial:pu,vertexShader:AD,uniforms:t,silent:!0,depthPacking:sf});this.mesh=new Ae(n,r),this.mesh.customDepthMaterial=s,this.mesh.receiveShadow=!0,this.mesh.castShadow=!0,this.scene.add(this.mesh);const o=new Ae(new Ot(10,10,1,1),new gs({transmission:1,roughness:.3}));o.rotation.x=-Math.PI/2,o.position.y=-.1,this.scene.add(o)},f6=function(){new Z0().load("/three.js-journey/media/images/environmentMaps/spruit_sunrise.hdr",n=>{n.mapping=Ca,this.scene.environment=n,this.scene.background=n,this.scene.backgroundBlurriness=.5})},d6=function(){const t=new Fi(16777215,2);t.position.set(6.25,3,4),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.camera.near=.1,t.shadow.camera.far=30,t.shadow.camera.top=8,t.shadow.camera.right=8,t.shadow.camera.bottom=-8,t.shadow.camera.left=-8,this.scene.add(t)},p6=function(){this.camera.fov=35,this.camera.position.set(-10,6,-2),this.camera.updateProjectionMatrix()},m6=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.toneMapping=ta},bU);const _ie="/three.js-journey/assets/interfaceNormalMap-COCmqaCQ.png";var F0,hp,Rr,g6,v6,y6,x6,z2,_6,w6,TU;let wie=(TU=class extends Dt{constructor(){super(...arguments);st(this,Rr);oe(this,"displacementPass");oe(this,"effectComposer");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);st(this,F0);st(this,hp)}get number(){return"45"}get title(){return"Post-processing"}get link(){return"https://threejs-journey.com/lessons/post-processing"}update(t){this.displacementPass.material.uniforms.uTime.value=t*.001,this.control.update()}animate(t){this.update(t),this.effectComposer.render(),Ln(this,F0,requestAnimationFrame(this.animate.bind(this)))}init(){super.init(),W(this,Rr,g6).call(this),W(this,Rr,v6).call(this),W(this,Rr,y6).call(this),W(this,Rr,x6).call(this),W(this,Rr,_6).call(this),W(this,Rr,w6).call(this)}close(){super.close(),cancelAnimationFrame(gt(this,F0))}dispose(){window.removeEventListener("resize",gt(this,hp)),super.dispose()}},F0=new WeakMap,hp=new WeakMap,Rr=new WeakSet,g6=function(){const n=new cf().load(["/three.js-journey/media/images/environmentMaps/3/px.jpg","/three.js-journey/media/images/environmentMaps/3/nx.jpg","/three.js-journey/media/images/environmentMaps/3/py.jpg","/three.js-journey/media/images/environmentMaps/3/ny.jpg","/three.js-journey/media/images/environmentMaps/3/pz.jpg","/three.js-journey/media/images/environmentMaps/3/nz.jpg"]);this.scene.background=n,this.scene.environment=n},v6=function(){const t=new Fi(16777215,3);t.position.set(.25,3,-2.25),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.normalBias=.05,t.shadow.camera.far=15,this.scene.add(t)},y6=function(){const t=new nr,n=new ir;n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/DamagedHelmet/glTF/DamagedHelmet.gltf",r=>{r.scene.scale.set(2,2,2),r.scene.rotation.y=Math.PI/2,this.scene.add(r.scene),r.scene.traverse(s=>{s instanceof Ae&&s.material instanceof hn&&(s.receiveShadow=!0,s.castShadow=!0,s.material.envMapIntensity=2.5,s.material.needsUpdate=!0)})})},x6=function(){const t=new _i,n=new vi(this.canvas.width*window.devicePixelRatio,this.canvas.height*window.devicePixelRatio,{samples:window.devicePixelRatio===1?2:0});this.effectComposer=new cee(this.renderer,n),W(this,Rr,z2).call(this),Ln(this,hp,W(this,Rr,z2).bind(this)),window.addEventListener("resize",gt(this,hp));const r=new fee(this.scene,this.camera);this.effectComposer.addPass(r);const s=new aee;s.enabled=!1,this.effectComposer.addPass(s);const o=new hee;o.enabled=!1,this.effectComposer.addPass(o);const a=new dd(gee);a.enabled=!1,this.effectComposer.addPass(a);const l=new Tp;l.strength=.3,l.radius=1,l.threshold=.6;const c=this.guiControl.addFolder("Bloom");c.add(l,"enabled"),c.add(l,"strength").min(0).max(2).step(.001),c.add(l,"radius").min(0).max(2).step(.001),c.add(l,"threshold").min(0).max(1).step(.001),this.effectComposer.addPass(l);const u=new dd({uniforms:{tDiffuse:new We(null),uTint:new We(null)},vertexShader:`
        varying vec2 vUv;
        
        void main() {
          vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
          vec4 viewPosition       = viewMatrix       * modelPosition;
          vec4 projectionPosition = projectionMatrix * viewPosition;
          gl_Position             = projectionPosition;
          
          vUv = uv;
        }
      `,fragmentShader:`
        uniform sampler2D tDiffuse;
        uniform vec3      uTint;
        
        varying vec2 vUv;
        
        void main() {
          vec4 color    = texture2D(tDiffuse, vUv);
          color.rgb    += uTint;
          gl_FragColor  = color;
        }
      `});u.material.uniforms.uTint.value=new N(0,0,0);const h=this.guiControl.addFolder("Tint");h.add(u,"enabled"),h.add(u.material.uniforms.uTint.value,"x").min(-1).max(1).step(.001).name("red"),h.add(u.material.uniforms.uTint.value,"y").min(-1).max(1).step(.001).name("green"),h.add(u.material.uniforms.uTint.value,"z").min(-1).max(1).step(.001).name("blue"),this.effectComposer.addPass(u),this.displacementPass=new dd({uniforms:{tDiffuse:new We(null),uTime:new We(null)},vertexShader:`
        varying vec2 vUv;
      
        void main() {
          vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
          vec4 viewPosition       = viewMatrix       * modelPosition;
          vec4 projectionPosition = projectionMatrix * viewPosition;
          gl_Position             = projectionPosition;
          
          vUv = uv;
        }
      `,fragmentShader:`
        uniform sampler2D tDiffuse;
        uniform float     uTime;
        
        varying vec2 vUv;
            
        void main() {
          vec2 displacedUv = vec2(
            vUv.x,
            vUv.y + sin(vUv.x * 10.0 + uTime) * 0.1
          );
          vec4 color   = texture2D(tDiffuse, displacedUv);
          gl_FragColor = color;
        }
      `}),this.displacementPass.enabled=!1,this.displacementPass.material.uniforms.uTime.value=0,this.guiControl.addFolder("Displacement").add(this.displacementPass,"enabled"),this.effectComposer.addPass(this.displacementPass);const p=new dd({uniforms:{tDiffuse:new We(null),uNormalTexture:new We(null)},vertexShader:`
        varying vec2 vUv;
      
        void main() {
          vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
          vec4 viewPosition       = viewMatrix       * modelPosition;
          vec4 projectionPosition = projectionMatrix * viewPosition;
          
          gl_Position = projectionPosition;
          
          vUv = uv;
        }
      `,fragmentShader:`
        uniform sampler2D tDiffuse;
        uniform sampler2D uNormalTexture;
        
        varying vec2 vUv;
        
        void main() {
          vec3  normalFactor     = texture2D(uNormalTexture, vUv).xyz * 2.0 - 1.0;
          vec2  processedUv      = vUv + normalFactor.xy * 0.1;
          vec4  color            = texture2D(tDiffuse, processedUv);
          vec3  lightDirection   = normalize(vec3(-1.0, 1.0, 0.0));
          vec3  normalDirection  = normalize(normalFactor);
          float lightFactor      = dot(lightDirection, normalDirection);
          lightFactor            = clamp(lightFactor, 0.0, 1.0);
          color.rgb             += lightFactor * 2.0;
          gl_FragColor           = color;
        }
      `});p.material.uniforms.uNormalTexture.value=t.load(_ie),this.guiControl.addFolder("Futuristic").add(p,"enabled"),this.effectComposer.addPass(p);const x=new dd(mee);if(this.effectComposer.addPass(x),window.devicePixelRatio===1&&!this.renderer.capabilities.isWebGL2){const y=new dee;this.effectComposer.addPass(y)}},z2=function(){this.effectComposer.setSize(this.canvas.width,this.canvas.height),this.effectComposer.setPixelRatio(this.renderer.getPixelRatio())},_6=function(){this.camera.fov=75,this.camera.position.set(4,1,-4),this.camera.updateProjectionMatrix()},w6=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=zp,this.renderer.toneMapping=Bp,this.renderer.toneMappingExposure=1.5},TU);var S6={exports:{}};(function(i,e){(function(t,n){i.exports=n()})(Mee,function(){var t=function(){function n(p){return o.appendChild(p.dom),p}function r(p){for(var v=0;v<o.children.length;v++)o.children[v].style.display=v===p?"block":"none";s=p}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(p){p.preventDefault(),r(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,c=0,u=n(new t.Panel("FPS","#0ff","#002")),h=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=n(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:n,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){c++;var p=(performance||Date).now();if(h.update(p-a,200),p>l+1e3&&(u.update(1e3*c/(p-l),100),l=p,c=0,f)){var v=performance.memory;f.update(v.usedJSHeapSize/1048576,v.jsHeapSizeLimit/1048576)}return p},update:function(){a=this.end()},domElement:o,setMode:r}};return t.Panel=function(n,r,s){var o=1/0,a=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,h=48*c,f=3*c,p=2*c,v=3*c,x=15*c,y=74*c,g=30*c,_=document.createElement("canvas");_.width=u,_.height=h,_.style.cssText="width:80px;height:48px";var w=_.getContext("2d");return w.font="bold "+9*c+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=s,w.fillRect(0,0,u,h),w.fillStyle=r,w.fillText(n,f,p),w.fillRect(v,x,y,g),w.fillStyle=s,w.globalAlpha=.9,w.fillRect(v,x,y,g),{dom:_,update:function(S,C){o=Math.min(o,S),a=Math.max(a,S),w.fillStyle=s,w.globalAlpha=1,w.fillRect(0,0,u,x),w.fillStyle=r,w.fillText(l(S)+" "+n+" ("+l(o)+"-"+l(a)+")",f,p),w.drawImage(_,v+c,x,y-c,g,v,x,y-c,g),w.fillRect(v+y-c,x,c,g),w.fillStyle=s,w.globalAlpha=.9,w.fillRect(v+y-c,x,c,l((1-S/C)*g))}}},t})})(S6);var Sie=S6.exports;const Mie=hf(Sie),bie="/three.js-journey/assets/displacementMap-V3b1Z6DO.png";var mr,M6,b6,T6,E6,A6,C6,P6,R6,EU;let Tie=(EU=class extends Dt{constructor(){super(...arguments);st(this,mr);oe(this,"torusKnot");oe(this,"sphere");oe(this,"box");oe(this,"stats");oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0)}get number(){return"46"}get title(){return"Performance tips"}get link(){return"https://threejs-journey.com/lessons/performance-tips"}update(t){this.stats.begin(),this.torusKnot.rotation.y=.1*t*.001,this.control.update(),this.stats.end()}init(){super.init(),W(this,mr,M6).call(this),W(this,mr,b6).call(this),W(this,mr,C6).call(this),W(this,mr,T6).call(this),W(this,mr,E6).call(this),W(this,mr,A6).call(this),W(this,mr,P6).call(this),W(this,mr,R6).call(this)}dispose(){document.body.removeChild(this.stats.dom),super.dispose()}},mr=new WeakSet,M6=function(){this.stats=new Mie,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)},b6=function(){const t=new Fi(16777215,3);t.position.set(.25,3,2.25),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.camera.far=10,t.shadow.normalBias=.05,t.shadow.camera.top=3,t.shadow.camera.bottom=-3,t.shadow.camera.left=-6,t.shadow.camera.right=6,this.scene.add(t)},T6=function(){const t=[],n=new u_;for(let o=0;o<25;o++){const a=new un;a.translate((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*20),a.rotateX((Math.random()-.5)*2*Math.PI),a.rotateY((Math.random()-.5)*2*Math.PI),t.push(a)}const r=hJ(t),s=new Ae(r,n);this.scene.add(s)},E6=function(){const t=new un,n=new u_,r=new fw(t,n,25);for(let s=0;s<25;s++){const o=new N((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*20),a=new Qt;a.setFromEuler(new ms((Math.random()-.5)*2*Math.PI,(Math.random()-.5)*2*Math.PI,0));const l=new Ze;l.makeRotationFromQuaternion(a),l.setPosition(o),r.setMatrixAt(s,l)}this.scene.add(r)},A6=function(){const n=new _i().load(bie),r=new Ae(new Ot(10,10,256,256),new Ft({precision:"lowp",defines:{uDisplacementStrength:1.5},uniforms:{uDisplacementTexture:new We(n)},vertexShader:`
          uniform sampler2D uDisplacementTexture;
  
          varying vec3 vColor;
  
          void main() {
              vec4 modelPosition = modelMatrix * vec4(position, 1.0);
  
              float elevation  = texture2D(uDisplacementTexture, uv).r;
              elevation        = max(elevation, 0.5);  
              modelPosition.y += elevation * uDisplacementStrength;
  
              gl_Position = projectionMatrix * viewMatrix * modelPosition;
  
              float colorFactor = max(elevation, 0.25);
              vec3 depthColor   = vec3(1.0, 0.1, 0.1);
              vec3 surfaceColor = vec3(0.1, 0.0, 0.5);
              vColor            = mix(depthColor, surfaceColor, elevation);
          }
        `,fragmentShader:`
          varying vec3 vColor;
  
          void main() {              
              gl_FragColor = vec4(vColor, 1.0);
          }
        `}));r.position.set(0,-1.99,0),r.rotation.x=-Math.PI/2,this.scene.add(r)},C6=function(){const t=new hn;this.box=new Ae(new un(2,2,2),t),this.box.position.set(-5,0,0),this.box.castShadow=!0,this.box.receiveShadow=!1,this.sphere=new Ae(new Lr(1,32,32),t),this.sphere.position.set(5,0,0),this.sphere.castShadow=!0,this.sphere.receiveShadow=!1,this.torusKnot=new Ae(new fl(1,.4,128,32),t),this.torusKnot.castShadow=!0,this.torusKnot.receiveShadow=!1;const n=new Ae(new Ot(10,10),t);n.position.set(0,-2,0),n.rotation.x=-Math.PI/2,n.castShadow=!1,n.receiveShadow=!0,this.scene.add(this.box,this.sphere,this.torusKnot,n)},P6=function(){this.camera.fov=75,this.camera.position.set(2,2,6),this.camera.updateProjectionMatrix()},R6=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.shadowMap.autoUpdate=!0,this.renderer.shadowMap.needsUpdate=!0},EU);var gr,L6,D6,I6,U6,F6,k6,N6,O6,AU;let Eie=(AU=class extends Dt{constructor(){super(...arguments);st(this,gr);oe(this,"loader");oe(this,"loadingManager");oe(this,"overlay");oe(this,"onLoadEffectDelay",500);oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0)}get number(){return"47"}get title(){return"Intro and loading progress"}get link(){return"https://threejs-journey.com/lessons/intro-and-loading-progress"}update(){this.control.update()}init(){super.init(),W(this,gr,L6).call(this),W(this,gr,D6).call(this),W(this,gr,U6).call(this),W(this,gr,I6).call(this),W(this,gr,F6).call(this),W(this,gr,k6).call(this),W(this,gr,N6).call(this),W(this,gr,O6).call(this)}dispose(){document.body.removeChild(this.loader),super.dispose()}},gr=new WeakSet,L6=function(){this.loader=document.createElement("div"),this.loader.style.height="2px",this.loader.style.width="100%",this.loader.style.position="absolute",this.loader.style.top="50%",this.loader.style.backgroundColor="#ffffff",this.loader.style.transformOrigin="top left",this.loader.style.transform="scaleX(0)",this.loader.style.transition=`transform ${this.onLoadEffectDelay}ms`,this.loader.style.willChange="transform",document.body.appendChild(this.loader)},D6=function(){this.loadingManager=new Xp(()=>{window.setTimeout(()=>{Zl.to(this.overlay.material.uniforms.uProgress,{value:1,duration:3}),this.loader.style.transformOrigin="top right",this.loader.style.transition="transform 1.5s ease-in-out",this.loader.style.transform="scaleX(0)"},this.onLoadEffectDelay)},(t,n,r)=>{const s=n/r;this.loader.style.transform=`scaleX(${s})`})},I6=function(){const t=new Fi(16777215,3);t.position.set(.25,3,-2.25),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.normalBias=.05,t.shadow.camera.far=15,this.scene.add(t)},U6=function(){const n=new cf(this.loadingManager).load(["/three.js-journey/media/images/environmentMaps/3/px.jpg","/three.js-journey/media/images/environmentMaps/3/nx.jpg","/three.js-journey/media/images/environmentMaps/3/py.jpg","/three.js-journey/media/images/environmentMaps/3/ny.jpg","/three.js-journey/media/images/environmentMaps/3/pz.jpg","/three.js-journey/media/images/environmentMaps/3/nz.jpg"]);n.colorSpace=Wt,this.scene.background=n,this.scene.environment=n},F6=function(){this.overlay=new Ae(new Ot(2,2,1,1),new Ft({transparent:!0,uniforms:{uProgress:new We(0)},vertexShader:`
          void main() {
            gl_Position = vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float uProgress;
          
          void main() {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0 - uProgress);
          }
        `})),this.scene.add(this.overlay)},k6=function(){const t=new nr(this.loadingManager),n=new ir(this.loadingManager);n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/FlightHelmet/glTF/FlightHelmet.gltf",r=>{r.scene.scale.set(10,10,10),r.scene.position.set(0,-4,0),r.scene.rotation.y=Math.PI*.5,r.scene.traverse(s=>{s instanceof Ae&&s.material instanceof hn&&(s.castShadow=!0,s.receiveShadow=!0,s.material.envMapIntensity=2.5,s.material.needsUpdate=!0)}),this.scene.add(r.scene)})},N6=function(){this.camera.fov=75,this.camera.position.set(4,1,-4),this.camera.updateProjectionMatrix()},O6=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.shadowMap.autoUpdate=!1,this.renderer.shadowMap.needsUpdate=!0,this.renderer.toneMapping=Bp,this.renderer.toneMappingExposure=3},AU);var Jn,z6,B6,H6,G6,V6,W6,j6,c1,X6,Y6,CU;let Aie=(CU=class extends Dt{constructor(){super(...arguments);st(this,Jn);oe(this,"points");oe(this,"loader");oe(this,"raycaster");oe(this,"loadingManager");oe(this,"overlay");oe(this,"isSceneReady",!1);oe(this,"loadDelay",500);oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0)}get number(){return"48"}get title(){return"Mixing HTML and WebGL"}get link(){return"https://threejs-journey.com/lessons/mixing-html-and-webgl"}update(){if(this.control.update(),this.isSceneReady)for(const t of this.points){const n=t.position.clone();n.project(this.camera);const r=n.x*this.canvas.width*.5,s=n.y*this.canvas.height*.5;t.element.style.transform=`translate(${r}px, ${-s}px)`,this.raycaster.setFromCamera(n,this.camera);const o=this.raycaster.intersectObjects(this.scene.children,!0);if(o.length){const a=o[0].distance;t.position.distanceTo(this.camera.position)<a?t.element.firstChild.style.transform="scale(1, 1)":t.element.firstChild.style.transform="scale(0, 0)"}else t.element.firstChild.style.transform="scale(1,1)"}}init(){super.init(),this.raycaster=new Yp,W(this,Jn,B6).call(this),W(this,Jn,z6).call(this),W(this,Jn,G6).call(this),W(this,Jn,H6).call(this),W(this,Jn,j6).call(this),W(this,Jn,W6).call(this),W(this,Jn,V6).call(this),W(this,Jn,X6).call(this),W(this,Jn,Y6).call(this)}close(){this.isSceneReady=!1,super.close()}dispose(){document.body.removeChild(this.loader);for(const t of this.points)document.body.removeChild(t.element);super.dispose()}},Jn=new WeakSet,z6=function(){this.points=[{position:new N(1.55,.3,-.6),element:W(this,Jn,c1).call(this,"1","Front and top screen with HUD aggregating terrain and battle information.")},{position:new N(.5,.8,-1.6),element:W(this,Jn,c1).call(this,"2","Ventilation with air purifier and detection of environment toxicity.")},{position:new N(1.6,-1.3,-.7),element:W(this,Jn,c1).call(this,"3","Cameras supporting night vision and heat vision with automatic adjustment.")}]},B6=function(){this.loader=document.createElement("div"),this.loader.style.position="absolute",this.loader.style.top="50%",this.loader.style.width="100%",this.loader.style.height="2px",this.loader.style.backgroundColor="#ffffff",this.loader.style.transformOrigin="top left",this.loader.style.transform="scaleX(0)",this.loader.style.transition=`transform ${this.loadDelay}ms`,this.loader.style.willChange="transform",document.body.appendChild(this.loader)},H6=function(){this.loadingManager=new Xp(()=>{window.setTimeout(()=>{Zl.to(this.overlay.material.uniforms.uProgress,{value:1,duration:3}),this.loader.style.transformOrigin="top right",this.loader.style.transition="transform 1.5s ease-in-out",this.loader.style.transform="scaleX(0)",this.isSceneReady=!0},this.loadDelay)},(t,n,r)=>{const s=n/r;this.loader.style.transform=`scaleX(${s})`})},G6=function(){this.overlay=new Ae(new Ot(2,2,1,1),new Ft({transparent:!0,uniforms:{uProgress:new We(0)},vertexShader:`
          void main() {
            gl_Position = vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float uProgress;
        
          void main() {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0 - uProgress);
          }
        `})),this.scene.add(this.overlay)},V6=function(){const t=new nr(this.loadingManager),n=new ir(this.loadingManager);n.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),t.setDRACOLoader(n),t.load("/three.js-journey/media/models/DamagedHelmet/glTF/DamagedHelmet.gltf",r=>{r.scene.scale.set(2.5,2.5,2.5),r.scene.rotation.y=Math.PI/2,r.scene.traverse(s=>{s instanceof Ae&&s instanceof hn&&(s.castShadow=!0,s.receiveShadow=!0,s.material.envMapIntensity=2.5,s.material.needsUpdate=!0)}),this.scene.add(r.scene)})},W6=function(){const t=new Fi(16777215,3);t.position.set(.25,3,-2.25),t.castShadow=!0,t.shadow.mapSize.set(1024,1024),t.shadow.normalBias=.05,t.shadow.camera.far=15,this.scene.add(t)},j6=function(){const n=new cf(this.loadingManager).load(["/three.js-journey/media/images/environmentMaps/3/px.jpg","/three.js-journey/media/images/environmentMaps/3/nx.jpg","/three.js-journey/media/images/environmentMaps/3/py.jpg","/three.js-journey/media/images/environmentMaps/3/ny.jpg","/three.js-journey/media/images/environmentMaps/3/pz.jpg","/three.js-journey/media/images/environmentMaps/3/nz.jpg"]);n.colorSpace=Wt,this.scene.background=n,this.scene.environment=n},c1=function(t,n){const r=document.createElement("div");r.style.position="absolute",r.style.top="50%",r.style.left="50%";const s=document.createElement("div");s.textContent=t,s.style.position="absolute",s.style.width="40px",s.style.height="40px",s.style.top="-20px",s.style.left="-20px",s.style.color="#ffffff",s.style.backgroundColor="#00000077",s.style.border="1px solid #ffffff77",s.style.borderRadius="50%",s.style.textAlign="center",s.style.lineHeight="40px",s.style.transform="scale(0,0)",s.style.transition="transform 0.3s",s.style.willChange="transform",s.style.cursor="help";const o=document.createElement("div");return o.textContent=n,o.style.position="absolute",o.style.width="200px",o.style.padding="20px",o.style.top="30px",o.style.left="-120px",o.style.color="#ffffff",o.style.backgroundColor="#00000077",o.style.border="1px solid #ffffff77",o.style.borderRadius="4px",o.style.textAlign="center",o.style.lineHeight="1.3em",o.style.opacity="0",o.style.transition="opacity 0.3s",o.style.willChange="opacity",o.style.pointerEvents="none",r.addEventListener("mouseenter",()=>{o.style.opacity="1"}),r.addEventListener("mouseleave",()=>{o.style.opacity="0"}),r.appendChild(s),r.appendChild(o),document.body.appendChild(r),r},X6=function(){this.camera.fov=75,this.camera.position.set(4,1,-4),this.camera.updateProjectionMatrix()},Y6=function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ji,this.renderer.shadowMap.autoUpdate=!0,this.renderer.shadowMap.needsUpdate=!0,this.renderer.toneMapping=Bp,this.renderer.toneMappingExposure=3},CU);var Op,q6,K6,PU;let Cie=(PU=class extends Dt{constructor(){super(...arguments);st(this,Op);oe(this,"model");oe(this,"hasGuiTweaks",!1);oe(this,"hasAnimation",!0)}get number(){return"51"}get title(){return"Importing and optimizing the scene"}get link(){return"https://threejs-journey.com/lessons/importing-and-optimizing-the-scene"}update(){this.control.update()}init(){super.init(),W(this,Op,q6).call(this),W(this,Op,K6).call(this)}},Op=new WeakSet,q6=function(){const t=new _i,n=new nr,r=new ir;r.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),n.setDRACOLoader(r);const s=t.load("/three.js-journey/media/images/textures/LessonPortal/color.jpg");s.flipY=!1,s.colorSpace=Wt;const o=new Yt({map:s}),a=new Yt({color:16777215}),l=new Yt({color:16777189});n.load("/three.js-journey/media/models/LessonPortal/portal.glb",c=>{this.model=c.scene,this.model.traverse(u=>{if(u.isMesh)switch(u.name){case"poleLightA":case"poleLightB":u.material=l;break;case"portalLight":u.material=a;break;default:u.material=o}}),this.scene.add(c.scene)})},K6=function(){this.camera.position.set(4,2,4),this.camera.fov=45,this.camera.updateProjectionMatrix()},PU);var Pie=`varying vec2 vUv;

void main() {
    vec4 modelPosition      = modelMatrix      * vec4(position, 1.0);
    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position = projectionPosition;

    vUv = uv;
}`,Rie=`uniform float uTime;
uniform vec3  uInnerColor;
uniform vec3  uOuterColor;

varying vec2 vUv;

vec4 _permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}

vec4 _taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 _fade(vec3 t) {
    return t * t * t * ( t * (t * 6.0 - 15.0) + 10.0);
}

float calcPerlinNoise3d(vec3 P) {
    vec3 Pi0 = floor(P); 
    vec3 Pi1 = Pi0 + vec3(1.0); 
    Pi0 = mod(Pi0, 289.0);
    Pi1 = mod(Pi1, 289.0);
    vec3 Pf0 = fract(P); 
    vec3 Pf1 = Pf0 - vec3(1.0); 
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;

    vec4 ixy = _permute(_permute(ix) + iy);
    vec4 ixy0 = _permute(ixy + iz0);
    vec4 ixy1 = _permute(ixy + iz1);

    vec4 gx0 = ixy0 / 7.0;
    vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);

    vec4 gx1 = ixy1 / 7.0;
    vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);

    vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
    vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
    vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
    vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
    vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
    vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
    vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
    vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

    vec4 norm0 = _taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = _taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;

    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);

    vec3 fade_xyz = _fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);

    return 2.2 * n_xyz;
}

void main() {
    vec2  processedUv  = vUv + calcPerlinNoise3d(vec3(vUv * 5.0, uTime * 0.1));
    float strength     = calcPerlinNoise3d(vec3(processedUv * 5.0, uTime * 0.2));
    float outerGlow    = distance(vUv, vec2(0.5)) * 5.0 - 1.4;
          strength    += outerGlow;
          strength    += step(-0.2, strength) * 0.8;
          strength     = clamp(strength, 0.0, 1.0);

    vec3 color = mix(uInnerColor, uOuterColor, strength);

    gl_FragColor = vec4(color, 1.0);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,Lie=`uniform float uTime;
uniform float uSize;
uniform vec2  uResolution;

attribute float aScale;

void main() {
    vec4 modelPosition  = modelMatrix * vec4(position, 1.0);
    modelPosition.y    += sin(uTime + modelPosition.x * 100.0) * 0.2 * aScale;

    vec4 viewPosition       = viewMatrix       * modelPosition;
    vec4 projectionPosition = projectionMatrix * viewPosition;

    gl_Position   = projectionPosition;
    gl_PointSize  = uSize * uResolution.y * aScale;
    gl_PointSize *= (-1.0 / viewPosition.z);
}`,Die=`void main() {
    float distanceToCenter = length(gl_PointCoord - vec2(0.5));
    float strength         = (0.05 / distanceToCenter) - 0.1;

    gl_FragColor = vec4(1.0, 1.0, 1.0, strength);

    #include <tonemapping_fragment>
    #include <colorspace_fragment>
}`,fp,xi,Z6,Q6,J6,$6,e8,t8,n8,B2,H2,RU;let Iie=(RU=class extends Dt{constructor(){super(...arguments);st(this,xi);oe(this,"portal");oe(this,"fireflies");oe(this,"model");oe(this,"hasGuiTweaks",!0);oe(this,"hasAnimation",!0);oe(this,"renderParams",{clearColor:"#201919",innerPortalColor:"#000000",outerPortalColor:"#ffffff"});st(this,fp)}get number(){return"52"}get title(){return"Adding details to the scene"}get link(){return"https://threejs-journey.com/lessons/adding-details-to-the-scene"}update(t){const n=t*.001;this.fireflies.material.uniforms.uTime.value=n,this.portal.uniforms.uTime.value=n,this.control.update()}init(){super.init(),W(this,xi,J6).call(this),W(this,xi,$6).call(this),W(this,xi,e8).call(this),W(this,xi,t8).call(this),W(this,xi,n8).call(this),W(this,xi,Q6).call(this),W(this,xi,Z6).call(this)}dispose(){this.canvas.removeEventListener("resize",gt(this,fp)),super.dispose()}},fp=new WeakMap,xi=new WeakSet,Z6=function(){this.guiControl.addColor(this.renderParams,"clearColor").onChange(t=>{this.renderer.setClearColor(t)}),this.guiControl.add(this.fireflies.material.uniforms.uSize,"value").min(.001).max(1).step(.001).name("fireflySize"),this.guiControl.addColor(this.renderParams,"innerPortalColor").onChange(t=>{this.portal.uniforms.uInnerColor.value.set(t)}),this.guiControl.addColor(this.renderParams,"outerPortalColor").onChange(t=>{this.portal.uniforms.uOuterColor.value.set(t)})},Q6=function(){Ln(this,fp,()=>{this.fireflies.material.uniforms.uResolution.value.set(W(this,xi,B2).call(this),W(this,xi,H2).call(this))}),this.canvas.addEventListener("resize",gt(this,fp))},J6=function(){this.portal=new Ft({vertexShader:Pie,fragmentShader:Rie,uniforms:{uTime:new We(0),uInnerColor:new We(new Ge(this.renderParams.innerPortalColor)),uOuterColor:new We(new Ge(this.renderParams.outerPortalColor))}})},$6=function(){const t=new yt,n=30,r=new Float32Array(n*3),s=new Float32Array(n*1);for(let a=0;a<n;a++){const l=a*3;r[l+0]=(Math.random()-.5)*4,r[l+1]=Math.random()*1.5,r[l+2]=(Math.random()-.5)*4,s[a]=Math.random()}t.setAttribute("position",new wt(r,3)),t.setAttribute("aScale",new wt(s,1));const o=new Ft({vertexShader:Lie,fragmentShader:Die,uniforms:{uTime:new We(0),uSize:new We(.1),uResolution:new We(new be(W(this,xi,B2).call(this),W(this,xi,H2).call(this)))},transparent:!0,blending:ea,depthWrite:!1});this.fireflies=new ca(t,o),this.scene.add(this.fireflies)},e8=function(){const t=new _i,n=new nr,r=new ir;r.setDecoderPath("/three.js-journey/js/utils/loader/draco/"),n.setDRACOLoader(r);const s=t.load("/three.js-journey/media/images/textures/LessonPortal/color.jpg");s.colorSpace=Wt,s.flipY=!1;const o=new Yt({map:s}),a=new Yt({color:16777189});n.load("/three.js-journey/media/models/LessonPortal/portal.glb",l=>{this.model=l.scene,this.model.traverse(c=>{if(c.isMesh)switch(c.name){case"poleLightA":case"poleLightB":c.material=a;break;case"portalLight":c.material=this.portal;break;default:c.material=o}}),this.scene.add(this.model)})},t8=function(){this.camera.position.set(4,2,4),this.camera.fov=45,this.camera.updateProjectionMatrix()},n8=function(){this.renderer.setClearColor(this.renderParams.clearColor)},B2=function(){return this.canvas.width*this.renderer.getPixelRatio()},H2=function(){return this.canvas.height*this.renderer.getPixelRatio()},RU);var i8={exports:{}},Lw={},r8={exports:{}},tn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0=Symbol.for("react.element"),Uie=Symbol.for("react.portal"),Fie=Symbol.for("react.fragment"),kie=Symbol.for("react.strict_mode"),Nie=Symbol.for("react.profiler"),Oie=Symbol.for("react.provider"),zie=Symbol.for("react.context"),Bie=Symbol.for("react.forward_ref"),Hie=Symbol.for("react.suspense"),Gie=Symbol.for("react.memo"),Vie=Symbol.for("react.lazy"),CD=Symbol.iterator;function Wie(i){return i===null||typeof i!="object"?null:(i=CD&&i[CD]||i["@@iterator"],typeof i=="function"?i:null)}var s8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o8=Object.assign,a8={};function Qp(i,e,t){this.props=i,this.context=e,this.refs=a8,this.updater=t||s8}Qp.prototype.isReactComponent={};Qp.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Qp.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function l8(){}l8.prototype=Qp.prototype;function rC(i,e,t){this.props=i,this.context=e,this.refs=a8,this.updater=t||s8}var sC=rC.prototype=new l8;sC.constructor=rC;o8(sC,Qp.prototype);sC.isPureReactComponent=!0;var PD=Array.isArray,c8=Object.prototype.hasOwnProperty,oC={current:null},u8={key:!0,ref:!0,__self:!0,__source:!0};function h8(i,e,t){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)c8.call(e,n)&&!u8.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(i&&i.defaultProps)for(n in a=i.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:J0,type:i,key:s,ref:o,props:r,_owner:oC.current}}function jie(i,e){return{$$typeof:J0,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function aC(i){return typeof i=="object"&&i!==null&&i.$$typeof===J0}function Xie(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var RD=/\/+/g;function wb(i,e){return typeof i=="object"&&i!==null&&i.key!=null?Xie(""+i.key):e.toString(36)}function u1(i,e,t,n,r){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var o=!1;if(i===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(i.$$typeof){case J0:case Uie:o=!0}}if(o)return o=i,r=r(o),i=n===""?"."+wb(o,0):n,PD(r)?(t="",i!=null&&(t=i.replace(RD,"$&/")+"/"),u1(r,e,t,"",function(c){return c})):r!=null&&(aC(r)&&(r=jie(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(RD,"$&/")+"/")+i)),e.push(r)),1;if(o=0,n=n===""?".":n+":",PD(i))for(var a=0;a<i.length;a++){s=i[a];var l=n+wb(s,a);o+=u1(s,e,t,l,r)}else if(l=Wie(i),typeof l=="function")for(i=l.call(i),a=0;!(s=i.next()).done;)s=s.value,l=n+wb(s,a++),o+=u1(s,e,t,l,r);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function dx(i,e,t){if(i==null)return i;var n=[],r=0;return u1(i,n,"","",function(s){return e.call(t,s,r++)}),n}function Yie(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var ys={current:null},h1={transition:null},qie={ReactCurrentDispatcher:ys,ReactCurrentBatchConfig:h1,ReactCurrentOwner:oC};function f8(){throw Error("act(...) is not supported in production builds of React.")}tn.Children={map:dx,forEach:function(i,e,t){dx(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return dx(i,function(){e++}),e},toArray:function(i){return dx(i,function(e){return e})||[]},only:function(i){if(!aC(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};tn.Component=Qp;tn.Fragment=Fie;tn.Profiler=Nie;tn.PureComponent=rC;tn.StrictMode=kie;tn.Suspense=Hie;tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qie;tn.act=f8;tn.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var n=o8({},i.props),r=i.key,s=i.ref,o=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=oC.current),e.key!==void 0&&(r=""+e.key),i.type&&i.type.defaultProps)var a=i.type.defaultProps;for(l in e)c8.call(e,l)&&!u8.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:J0,type:i.type,key:r,ref:s,props:n,_owner:o}};tn.createContext=function(i){return i={$$typeof:zie,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Oie,_context:i},i.Consumer=i};tn.createElement=h8;tn.createFactory=function(i){var e=h8.bind(null,i);return e.type=i,e};tn.createRef=function(){return{current:null}};tn.forwardRef=function(i){return{$$typeof:Bie,render:i}};tn.isValidElement=aC;tn.lazy=function(i){return{$$typeof:Vie,_payload:{_status:-1,_result:i},_init:Yie}};tn.memo=function(i,e){return{$$typeof:Gie,type:i,compare:e===void 0?null:e}};tn.startTransition=function(i){var e=h1.transition;h1.transition={};try{i()}finally{h1.transition=e}};tn.unstable_act=f8;tn.useCallback=function(i,e){return ys.current.useCallback(i,e)};tn.useContext=function(i){return ys.current.useContext(i)};tn.useDebugValue=function(){};tn.useDeferredValue=function(i){return ys.current.useDeferredValue(i)};tn.useEffect=function(i,e){return ys.current.useEffect(i,e)};tn.useId=function(){return ys.current.useId()};tn.useImperativeHandle=function(i,e,t){return ys.current.useImperativeHandle(i,e,t)};tn.useInsertionEffect=function(i,e){return ys.current.useInsertionEffect(i,e)};tn.useLayoutEffect=function(i,e){return ys.current.useLayoutEffect(i,e)};tn.useMemo=function(i,e){return ys.current.useMemo(i,e)};tn.useReducer=function(i,e,t){return ys.current.useReducer(i,e,t)};tn.useRef=function(i){return ys.current.useRef(i)};tn.useState=function(i){return ys.current.useState(i)};tn.useSyncExternalStore=function(i,e,t){return ys.current.useSyncExternalStore(i,e,t)};tn.useTransition=function(){return ys.current.useTransition()};tn.version="18.3.1";r8.exports=tn;var re=r8.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kie=re,Zie=Symbol.for("react.element"),Qie=Symbol.for("react.fragment"),Jie=Object.prototype.hasOwnProperty,$ie=Kie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ere={key:!0,ref:!0,__self:!0,__source:!0};function d8(i,e,t){var n,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Jie.call(e,n)&&!ere.hasOwnProperty(n)&&(r[n]=e[n]);if(i&&i.defaultProps)for(n in e=i.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:Zie,type:i,key:s,ref:o,props:r,_owner:$ie.current}}Lw.Fragment=Qie;Lw.jsx=d8;Lw.jsxs=d8;i8.exports=Lw;var ft=i8.exports,p8={exports:{}},To={},m8={exports:{}},g8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(U,X){var j=U.length;U.push(X);e:for(;0<j;){var B=j-1>>>1,Z=U[B];if(0<r(Z,X))U[B]=X,U[j]=Z,j=B;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],j=U.pop();if(j!==X){U[0]=j;e:for(var B=0,Z=U.length,ie=Z>>>1;B<ie;){var V=2*(B+1)-1,te=U[V],fe=V+1,he=U[fe];if(0>r(te,j))fe<Z&&0>r(he,te)?(U[B]=he,U[fe]=j,B=fe):(U[B]=te,U[V]=j,B=V);else if(fe<Z&&0>r(he,j))U[B]=he,U[fe]=j,B=fe;else break e}}return X}function r(U,X){var j=U.sortIndex-X.sortIndex;return j!==0?j:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function S(U){if(x=!1,w(U),!v)if(t(l)!==null)v=!0,H(C);else{var X=t(c);X!==null&&$(S,X.startTime-U)}}function C(U,X){v=!1,x&&(x=!1,g(T),T=-1),p=!0;var j=f;try{for(w(X),h=t(l);h!==null&&(!(h.expirationTime>X)||U&&!R());){var B=h.callback;if(typeof B=="function"){h.callback=null,f=h.priorityLevel;var Z=B(h.expirationTime<=X);X=i.unstable_now(),typeof Z=="function"?h.callback=Z:h===t(l)&&n(l),w(X)}else n(l);h=t(l)}if(h!==null)var ie=!0;else{var V=t(c);V!==null&&$(S,V.startTime-X),ie=!1}return ie}finally{h=null,f=j,p=!1}}var E=!1,A=null,T=-1,L=5,M=-1;function R(){return!(i.unstable_now()-M<L)}function D(){if(A!==null){var U=i.unstable_now();M=U;var X=!0;try{X=A(!0,U)}finally{X?F():(E=!1,A=null)}}else E=!1}var F;if(typeof _=="function")F=function(){_(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,q=z.port2;z.port1.onmessage=D,F=function(){q.postMessage(null)}}else F=function(){y(D,0)};function H(U){A=U,E||(E=!0,F())}function $(U,X){T=y(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){v||p||(v=!0,H(C))},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return f},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var j=f;f=X;try{return U()}finally{f=j}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=f;f=U;try{return X()}finally{f=j}},i.unstable_scheduleCallback=function(U,X,j){var B=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?B+j:B):j=B,U){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=j+Z,U={id:u++,callback:X,priorityLevel:U,startTime:j,expirationTime:Z,sortIndex:-1},j>B?(U.sortIndex=j,e(c,U),t(l)===null&&U===t(c)&&(x?(g(T),T=-1):x=!0,$(S,j-B))):(U.sortIndex=Z,e(l,U),v||p||(v=!0,H(C))),U},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(U){var X=f;return function(){var j=f;f=X;try{return U.apply(this,arguments)}finally{f=j}}}})(g8);m8.exports=g8;var tre=m8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v8=re,Mo=tre;function Ke(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y8=new Set,g0={};function ff(i,e){Ap(i,e),Ap(i+"Capture",e)}function Ap(i,e){for(g0[i]=e,i=0;i<e.length;i++)y8.add(e[i])}var Jl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),G2=Object.prototype.hasOwnProperty,nre=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LD={},DD={};function ire(i){return G2.call(DD,i)?!0:G2.call(LD,i)?!1:nre.test(i)?DD[i]=!0:(LD[i]=!0,!1)}function rre(i,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function sre(i,e,t,n){if(e===null||typeof e>"u"||rre(i,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xs(i,e,t,n,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Ar[i]=new xs(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Ar[e]=new xs(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Ar[i]=new xs(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Ar[i]=new xs(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Ar[i]=new xs(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Ar[i]=new xs(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Ar[i]=new xs(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Ar[i]=new xs(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Ar[i]=new xs(i,5,!1,i.toLowerCase(),null,!1,!1)});var lC=/[\-:]([a-z])/g;function cC(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(lC,cC);Ar[e]=new xs(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(lC,cC);Ar[e]=new xs(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(lC,cC);Ar[e]=new xs(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Ar[i]=new xs(i,1,!1,i.toLowerCase(),null,!1,!1)});Ar.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Ar[i]=new xs(i,1,!1,i.toLowerCase(),null,!0,!0)});function uC(i,e,t,n){var r=Ar.hasOwnProperty(e)?Ar[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sre(e,t,r,n)&&(t=null),n||r===null?ire(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):r.mustUseProperty?i[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,n=r.attributeNamespace,t===null?i.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,n?i.setAttributeNS(n,e,t):i.setAttribute(e,t))))}var ic=v8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,px=Symbol.for("react.element"),Md=Symbol.for("react.portal"),bd=Symbol.for("react.fragment"),hC=Symbol.for("react.strict_mode"),V2=Symbol.for("react.profiler"),x8=Symbol.for("react.provider"),_8=Symbol.for("react.context"),fC=Symbol.for("react.forward_ref"),W2=Symbol.for("react.suspense"),j2=Symbol.for("react.suspense_list"),dC=Symbol.for("react.memo"),Rc=Symbol.for("react.lazy"),w8=Symbol.for("react.offscreen"),ID=Symbol.iterator;function Jm(i){return i===null||typeof i!="object"?null:(i=ID&&i[ID]||i["@@iterator"],typeof i=="function"?i:null)}var ai=Object.assign,Sb;function xg(i){if(Sb===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Sb=e&&e[1]||""}return`
`+Sb+i}var Mb=!1;function bb(i,e){if(!i||Mb)return"";Mb=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(i,[],e)}else{try{e.call()}catch(c){n=c}i.call(e.prototype)}else{try{throw Error()}catch(c){n=c}i()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=o&&0<=a);break}}}finally{Mb=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?xg(i):""}function ore(i){switch(i.tag){case 5:return xg(i.type);case 16:return xg("Lazy");case 13:return xg("Suspense");case 19:return xg("SuspenseList");case 0:case 2:case 15:return i=bb(i.type,!1),i;case 11:return i=bb(i.type.render,!1),i;case 1:return i=bb(i.type,!0),i;default:return""}}function X2(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case bd:return"Fragment";case Md:return"Portal";case V2:return"Profiler";case hC:return"StrictMode";case W2:return"Suspense";case j2:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case _8:return(i.displayName||"Context")+".Consumer";case x8:return(i._context.displayName||"Context")+".Provider";case fC:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case dC:return e=i.displayName||null,e!==null?e:X2(i.type)||"Memo";case Rc:e=i._payload,i=i._init;try{return X2(i(e))}catch{}}return null}function are(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X2(e);case 8:return e===hC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function au(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function S8(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lre(i){var e=S8(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),n=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function mx(i){i._valueTracker||(i._valueTracker=lre(i))}function M8(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return i&&(n=S8(i)?i.checked?"true":"false":i.value),i=n,i!==t?(e.setValue(i),!0):!1}function M_(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Y2(i,e){var t=e.checked;return ai({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function UD(i,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=au(e.value!=null?e.value:t),i._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function b8(i,e){e=e.checked,e!=null&&uC(i,"checked",e,!1)}function q2(i,e){b8(i,e);var t=au(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(n==="submit"||n==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?K2(i,e.type,t):e.hasOwnProperty("defaultValue")&&K2(i,e.type,au(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function FD(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function K2(i,e,t){(e!=="number"||M_(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var _g=Array.isArray;function Gd(i,e,t,n){if(i=i.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<i.length;t++)r=e.hasOwnProperty("$"+i[t].value),i[t].selected!==r&&(i[t].selected=r),r&&n&&(i[t].defaultSelected=!0)}else{for(t=""+au(t),e=null,r=0;r<i.length;r++){if(i[r].value===t){i[r].selected=!0,n&&(i[r].defaultSelected=!0);return}e!==null||i[r].disabled||(e=i[r])}e!==null&&(e.selected=!0)}}function Z2(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return ai({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function kD(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Ke(92));if(_g(t)){if(1<t.length)throw Error(Ke(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:au(t)}}function T8(i,e){var t=au(e.value),n=au(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),n!=null&&(i.defaultValue=""+n)}function ND(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function E8(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Q2(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?E8(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var gx,A8=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return i(e,t,n,r)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(gx=gx||document.createElement("div"),gx.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gx.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function v0(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Og={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cre=["Webkit","ms","Moz","O"];Object.keys(Og).forEach(function(i){cre.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Og[e]=Og[i]})});function C8(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Og.hasOwnProperty(i)&&Og[i]?(""+e).trim():e+"px"}function P8(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,r=C8(t,e[t],n);t==="float"&&(t="cssFloat"),n?i.setProperty(t,r):i[t]=r}}var ure=ai({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function J2(i,e){if(e){if(ure[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ke(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ke(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ke(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ke(62))}}function $2(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eE=null;function pC(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var tE=null,Vd=null,Wd=null;function OD(i){if(i=tv(i)){if(typeof tE!="function")throw Error(Ke(280));var e=i.stateNode;e&&(e=kw(e),tE(i.stateNode,i.type,e))}}function R8(i){Vd?Wd?Wd.push(i):Wd=[i]:Vd=i}function L8(){if(Vd){var i=Vd,e=Wd;if(Wd=Vd=null,OD(i),e)for(i=0;i<e.length;i++)OD(e[i])}}function D8(i,e){return i(e)}function I8(){}var Tb=!1;function U8(i,e,t){if(Tb)return i(e,t);Tb=!0;try{return D8(i,e,t)}finally{Tb=!1,(Vd!==null||Wd!==null)&&(I8(),L8())}}function y0(i,e){var t=i.stateNode;if(t===null)return null;var n=kw(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(i=i.type,n=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!n;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(Ke(231,e,typeof t));return t}var nE=!1;if(Jl)try{var $m={};Object.defineProperty($m,"passive",{get:function(){nE=!0}}),window.addEventListener("test",$m,$m),window.removeEventListener("test",$m,$m)}catch{nE=!1}function hre(i,e,t,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var zg=!1,b_=null,T_=!1,iE=null,fre={onError:function(i){zg=!0,b_=i}};function dre(i,e,t,n,r,s,o,a,l){zg=!1,b_=null,hre.apply(fre,arguments)}function pre(i,e,t,n,r,s,o,a,l){if(dre.apply(this,arguments),zg){if(zg){var c=b_;zg=!1,b_=null}else throw Error(Ke(198));T_||(T_=!0,iE=c)}}function df(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function F8(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function zD(i){if(df(i)!==i)throw Error(Ke(188))}function mre(i){var e=i.alternate;if(!e){if(e=df(i),e===null)throw Error(Ke(188));return e!==i?null:i}for(var t=i,n=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){t=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return zD(r),i;if(s===n)return zD(r),e;s=s.sibling}throw Error(Ke(188))}if(t.return!==n.return)t=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,n=s;break}if(a===n){o=!0,n=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,n=r;break}if(a===n){o=!0,n=s,t=r;break}a=a.sibling}if(!o)throw Error(Ke(189))}}if(t.alternate!==n)throw Error(Ke(190))}if(t.tag!==3)throw Error(Ke(188));return t.stateNode.current===t?i:e}function k8(i){return i=mre(i),i!==null?N8(i):null}function N8(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=N8(i);if(e!==null)return e;i=i.sibling}return null}var O8=Mo.unstable_scheduleCallback,BD=Mo.unstable_cancelCallback,gre=Mo.unstable_shouldYield,vre=Mo.unstable_requestPaint,Pi=Mo.unstable_now,yre=Mo.unstable_getCurrentPriorityLevel,mC=Mo.unstable_ImmediatePriority,z8=Mo.unstable_UserBlockingPriority,E_=Mo.unstable_NormalPriority,xre=Mo.unstable_LowPriority,B8=Mo.unstable_IdlePriority,Dw=null,rl=null;function _re(i){if(rl&&typeof rl.onCommitFiberRoot=="function")try{rl.onCommitFiberRoot(Dw,i,void 0,(i.current.flags&128)===128)}catch{}}var Ea=Math.clz32?Math.clz32:Mre,wre=Math.log,Sre=Math.LN2;function Mre(i){return i>>>=0,i===0?32:31-(wre(i)/Sre|0)|0}var vx=64,yx=4194304;function wg(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function A_(i,e){var t=i.pendingLanes;if(t===0)return 0;var n=0,r=i.suspendedLanes,s=i.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?n=wg(a):(s&=o,s!==0&&(n=wg(s)))}else o=t&~r,o!==0?n=wg(o):s!==0&&(n=wg(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(n&4&&(n|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=n;0<e;)t=31-Ea(e),r=1<<t,n|=i[t],e&=~r;return n}function bre(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tre(i,e){for(var t=i.suspendedLanes,n=i.pingedLanes,r=i.expirationTimes,s=i.pendingLanes;0<s;){var o=31-Ea(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&n)&&(r[o]=bre(a,e)):l<=e&&(i.expiredLanes|=a),s&=~a}}function rE(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function H8(){var i=vx;return vx<<=1,!(vx&4194240)&&(vx=64),i}function Eb(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function $0(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Ea(e),i[e]=t}function Ere(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var n=i.eventTimes;for(i=i.expirationTimes;0<t;){var r=31-Ea(t),s=1<<r;e[r]=0,n[r]=-1,i[r]=-1,t&=~s}}function gC(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var n=31-Ea(t),r=1<<n;r&e|i[n]&e&&(i[n]|=e),t&=~r}}var Mn=0;function G8(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var V8,vC,W8,j8,X8,sE=!1,xx=[],Yc=null,qc=null,Kc=null,x0=new Map,_0=new Map,Uc=[],Are="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HD(i,e){switch(i){case"focusin":case"focusout":Yc=null;break;case"dragenter":case"dragleave":qc=null;break;case"mouseover":case"mouseout":Kc=null;break;case"pointerover":case"pointerout":x0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_0.delete(e.pointerId)}}function eg(i,e,t,n,r,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=tv(e),e!==null&&vC(e)),i):(i.eventSystemFlags|=n,e=i.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),i)}function Cre(i,e,t,n,r){switch(e){case"focusin":return Yc=eg(Yc,i,e,t,n,r),!0;case"dragenter":return qc=eg(qc,i,e,t,n,r),!0;case"mouseover":return Kc=eg(Kc,i,e,t,n,r),!0;case"pointerover":var s=r.pointerId;return x0.set(s,eg(x0.get(s)||null,i,e,t,n,r)),!0;case"gotpointercapture":return s=r.pointerId,_0.set(s,eg(_0.get(s)||null,i,e,t,n,r)),!0}return!1}function Y8(i){var e=bh(i.target);if(e!==null){var t=df(e);if(t!==null){if(e=t.tag,e===13){if(e=F8(t),e!==null){i.blockedOn=e,X8(i.priority,function(){W8(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function f1(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=oE(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var n=new t.constructor(t.type,t);eE=n,t.target.dispatchEvent(n),eE=null}else return e=tv(t),e!==null&&vC(e),i.blockedOn=t,!1;e.shift()}return!0}function GD(i,e,t){f1(i)&&t.delete(e)}function Pre(){sE=!1,Yc!==null&&f1(Yc)&&(Yc=null),qc!==null&&f1(qc)&&(qc=null),Kc!==null&&f1(Kc)&&(Kc=null),x0.forEach(GD),_0.forEach(GD)}function tg(i,e){i.blockedOn===e&&(i.blockedOn=null,sE||(sE=!0,Mo.unstable_scheduleCallback(Mo.unstable_NormalPriority,Pre)))}function w0(i){function e(r){return tg(r,i)}if(0<xx.length){tg(xx[0],i);for(var t=1;t<xx.length;t++){var n=xx[t];n.blockedOn===i&&(n.blockedOn=null)}}for(Yc!==null&&tg(Yc,i),qc!==null&&tg(qc,i),Kc!==null&&tg(Kc,i),x0.forEach(e),_0.forEach(e),t=0;t<Uc.length;t++)n=Uc[t],n.blockedOn===i&&(n.blockedOn=null);for(;0<Uc.length&&(t=Uc[0],t.blockedOn===null);)Y8(t),t.blockedOn===null&&Uc.shift()}var jd=ic.ReactCurrentBatchConfig,C_=!0;function Rre(i,e,t,n){var r=Mn,s=jd.transition;jd.transition=null;try{Mn=1,yC(i,e,t,n)}finally{Mn=r,jd.transition=s}}function Lre(i,e,t,n){var r=Mn,s=jd.transition;jd.transition=null;try{Mn=4,yC(i,e,t,n)}finally{Mn=r,jd.transition=s}}function yC(i,e,t,n){if(C_){var r=oE(i,e,t,n);if(r===null)kb(i,e,n,P_,t),HD(i,n);else if(Cre(r,i,e,t,n))n.stopPropagation();else if(HD(i,n),e&4&&-1<Are.indexOf(i)){for(;r!==null;){var s=tv(r);if(s!==null&&V8(s),s=oE(i,e,t,n),s===null&&kb(i,e,n,P_,t),s===r)break;r=s}r!==null&&n.stopPropagation()}else kb(i,e,n,null,t)}}var P_=null;function oE(i,e,t,n){if(P_=null,i=pC(n),i=bh(i),i!==null)if(e=df(i),e===null)i=null;else if(t=e.tag,t===13){if(i=F8(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return P_=i,null}function q8(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yre()){case mC:return 1;case z8:return 4;case E_:case xre:return 16;case B8:return 536870912;default:return 16}default:return 16}}var Hc=null,xC=null,d1=null;function K8(){if(d1)return d1;var i,e=xC,t=e.length,n,r="value"in Hc?Hc.value:Hc.textContent,s=r.length;for(i=0;i<t&&e[i]===r[i];i++);var o=t-i;for(n=1;n<=o&&e[t-n]===r[s-n];n++);return d1=r.slice(i,1<n?1-n:void 0)}function p1(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function _x(){return!0}function VD(){return!1}function Eo(i){function e(t,n,r,s,o){this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in i)i.hasOwnProperty(a)&&(t=i[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?_x:VD,this.isPropagationStopped=VD,this}return ai(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=_x)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=_x)},persist:function(){},isPersistent:_x}),e}var Jp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_C=Eo(Jp),ev=ai({},Jp,{view:0,detail:0}),Dre=Eo(ev),Ab,Cb,ng,Iw=ai({},ev,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wC,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ng&&(ng&&i.type==="mousemove"?(Ab=i.screenX-ng.screenX,Cb=i.screenY-ng.screenY):Cb=Ab=0,ng=i),Ab)},movementY:function(i){return"movementY"in i?i.movementY:Cb}}),WD=Eo(Iw),Ire=ai({},Iw,{dataTransfer:0}),Ure=Eo(Ire),Fre=ai({},ev,{relatedTarget:0}),Pb=Eo(Fre),kre=ai({},Jp,{animationName:0,elapsedTime:0,pseudoElement:0}),Nre=Eo(kre),Ore=ai({},Jp,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),zre=Eo(Ore),Bre=ai({},Jp,{data:0}),jD=Eo(Bre),Hre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gre={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vre={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wre(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Vre[i])?!!e[i]:!1}function wC(){return Wre}var jre=ai({},ev,{key:function(i){if(i.key){var e=Hre[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=p1(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Gre[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wC,charCode:function(i){return i.type==="keypress"?p1(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?p1(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Xre=Eo(jre),Yre=ai({},Iw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XD=Eo(Yre),qre=ai({},ev,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wC}),Kre=Eo(qre),Zre=ai({},Jp,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qre=Eo(Zre),Jre=ai({},Iw,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),$re=Eo(Jre),ese=[9,13,27,32],SC=Jl&&"CompositionEvent"in window,Bg=null;Jl&&"documentMode"in document&&(Bg=document.documentMode);var tse=Jl&&"TextEvent"in window&&!Bg,Z8=Jl&&(!SC||Bg&&8<Bg&&11>=Bg),YD=" ",qD=!1;function Q8(i,e){switch(i){case"keyup":return ese.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J8(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Td=!1;function nse(i,e){switch(i){case"compositionend":return J8(e);case"keypress":return e.which!==32?null:(qD=!0,YD);case"textInput":return i=e.data,i===YD&&qD?null:i;default:return null}}function ise(i,e){if(Td)return i==="compositionend"||!SC&&Q8(i,e)?(i=K8(),d1=xC=Hc=null,Td=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Z8&&e.locale!=="ko"?null:e.data;default:return null}}var rse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KD(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!rse[i.type]:e==="textarea"}function $8(i,e,t,n){R8(n),e=R_(e,"onChange"),0<e.length&&(t=new _C("onChange","change",null,t,n),i.push({event:t,listeners:e}))}var Hg=null,S0=null;function sse(i){uH(i,0)}function Uw(i){var e=Cd(i);if(M8(e))return i}function ose(i,e){if(i==="change")return e}var eH=!1;if(Jl){var Rb;if(Jl){var Lb="oninput"in document;if(!Lb){var ZD=document.createElement("div");ZD.setAttribute("oninput","return;"),Lb=typeof ZD.oninput=="function"}Rb=Lb}else Rb=!1;eH=Rb&&(!document.documentMode||9<document.documentMode)}function QD(){Hg&&(Hg.detachEvent("onpropertychange",tH),S0=Hg=null)}function tH(i){if(i.propertyName==="value"&&Uw(S0)){var e=[];$8(e,S0,i,pC(i)),U8(sse,e)}}function ase(i,e,t){i==="focusin"?(QD(),Hg=e,S0=t,Hg.attachEvent("onpropertychange",tH)):i==="focusout"&&QD()}function lse(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Uw(S0)}function cse(i,e){if(i==="click")return Uw(e)}function use(i,e){if(i==="input"||i==="change")return Uw(e)}function hse(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Ra=typeof Object.is=="function"?Object.is:hse;function M0(i,e){if(Ra(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var r=t[n];if(!G2.call(e,r)||!Ra(i[r],e[r]))return!1}return!0}function JD(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function $D(i,e){var t=JD(i);i=0;for(var n;t;){if(t.nodeType===3){if(n=i+t.textContent.length,i<=e&&n>=e)return{node:t,offset:e-i};i=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=JD(t)}}function nH(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?nH(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function iH(){for(var i=window,e=M_();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=M_(i.document)}return e}function MC(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function fse(i){var e=iH(),t=i.focusedElem,n=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&nH(t.ownerDocument.documentElement,t)){if(n!==null&&MC(t)){if(e=n.start,i=n.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var r=t.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!i.extend&&s>n&&(r=n,n=s,s=r),r=$D(t,s);var o=$D(t,n);r&&o&&(i.rangeCount!==1||i.anchorNode!==r.node||i.anchorOffset!==r.offset||i.focusNode!==o.node||i.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),i.removeAllRanges(),s>n?(i.addRange(e),i.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var dse=Jl&&"documentMode"in document&&11>=document.documentMode,Ed=null,aE=null,Gg=null,lE=!1;function eI(i,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;lE||Ed==null||Ed!==M_(n)||(n=Ed,"selectionStart"in n&&MC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Gg&&M0(Gg,n)||(Gg=n,n=R_(aE,"onSelect"),0<n.length&&(e=new _C("onSelect","select",null,e,t),i.push({event:e,listeners:n}),e.target=Ed)))}function wx(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var Ad={animationend:wx("Animation","AnimationEnd"),animationiteration:wx("Animation","AnimationIteration"),animationstart:wx("Animation","AnimationStart"),transitionend:wx("Transition","TransitionEnd")},Db={},rH={};Jl&&(rH=document.createElement("div").style,"AnimationEvent"in window||(delete Ad.animationend.animation,delete Ad.animationiteration.animation,delete Ad.animationstart.animation),"TransitionEvent"in window||delete Ad.transitionend.transition);function Fw(i){if(Db[i])return Db[i];if(!Ad[i])return i;var e=Ad[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in rH)return Db[i]=e[t];return i}var sH=Fw("animationend"),oH=Fw("animationiteration"),aH=Fw("animationstart"),lH=Fw("transitionend"),cH=new Map,tI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xu(i,e){cH.set(i,e),ff(e,[i])}for(var Ib=0;Ib<tI.length;Ib++){var Ub=tI[Ib],pse=Ub.toLowerCase(),mse=Ub[0].toUpperCase()+Ub.slice(1);xu(pse,"on"+mse)}xu(sH,"onAnimationEnd");xu(oH,"onAnimationIteration");xu(aH,"onAnimationStart");xu("dblclick","onDoubleClick");xu("focusin","onFocus");xu("focusout","onBlur");xu(lH,"onTransitionEnd");Ap("onMouseEnter",["mouseout","mouseover"]);Ap("onMouseLeave",["mouseout","mouseover"]);Ap("onPointerEnter",["pointerout","pointerover"]);Ap("onPointerLeave",["pointerout","pointerover"]);ff("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ff("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ff("onBeforeInput",["compositionend","keypress","textInput","paste"]);ff("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ff("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ff("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gse=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sg));function nI(i,e,t){var n=i.type||"unknown-event";i.currentTarget=t,pre(n,e,void 0,i),i.currentTarget=null}function uH(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var n=i[t],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;nI(r,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;nI(r,a,c),s=l}}}if(T_)throw i=iE,T_=!1,iE=null,i}function Gn(i,e){var t=e[dE];t===void 0&&(t=e[dE]=new Set);var n=i+"__bubble";t.has(n)||(hH(e,i,2,!1),t.add(n))}function Fb(i,e,t){var n=0;e&&(n|=4),hH(t,i,n,e)}var Sx="_reactListening"+Math.random().toString(36).slice(2);function b0(i){if(!i[Sx]){i[Sx]=!0,y8.forEach(function(t){t!=="selectionchange"&&(gse.has(t)||Fb(t,!1,i),Fb(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Sx]||(e[Sx]=!0,Fb("selectionchange",!1,e))}}function hH(i,e,t,n){switch(q8(e)){case 1:var r=Rre;break;case 4:r=Lre;break;default:r=yC}t=r.bind(null,e,t,i),r=void 0,!nE||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?i.addEventListener(e,t,{capture:!0,passive:r}):i.addEventListener(e,t,!0):r!==void 0?i.addEventListener(e,t,{passive:r}):i.addEventListener(e,t,!1)}function kb(i,e,t,n,r){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=bh(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}U8(function(){var c=s,u=pC(t),h=[];e:{var f=cH.get(i);if(f!==void 0){var p=_C,v=i;switch(i){case"keypress":if(p1(t)===0)break e;case"keydown":case"keyup":p=Xre;break;case"focusin":v="focus",p=Pb;break;case"focusout":v="blur",p=Pb;break;case"beforeblur":case"afterblur":p=Pb;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=WD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Ure;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Kre;break;case sH:case oH:case aH:p=Nre;break;case lH:p=Qre;break;case"scroll":p=Dre;break;case"wheel":p=$re;break;case"copy":case"cut":case"paste":p=zre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=XD}var x=(e&4)!==0,y=!x&&i==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var _=c,w;_!==null;){w=_;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,g!==null&&(S=y0(_,g),S!=null&&x.push(T0(_,S,w)))),y)break;_=_.return}0<x.length&&(f=new p(f,v,null,t,u),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=i==="mouseover"||i==="pointerover",p=i==="mouseout"||i==="pointerout",f&&t!==eE&&(v=t.relatedTarget||t.fromElement)&&(bh(v)||v[$l]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=t.relatedTarget||t.toElement,p=c,v=v?bh(v):null,v!==null&&(y=df(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(x=WD,S="onMouseLeave",g="onMouseEnter",_="mouse",(i==="pointerout"||i==="pointerover")&&(x=XD,S="onPointerLeave",g="onPointerEnter",_="pointer"),y=p==null?f:Cd(p),w=v==null?f:Cd(v),f=new x(S,_+"leave",p,t,u),f.target=y,f.relatedTarget=w,S=null,bh(u)===c&&(x=new x(g,_+"enter",v,t,u),x.target=w,x.relatedTarget=y,S=x),y=S,p&&v)t:{for(x=p,g=v,_=0,w=x;w;w=rd(w))_++;for(w=0,S=g;S;S=rd(S))w++;for(;0<_-w;)x=rd(x),_--;for(;0<w-_;)g=rd(g),w--;for(;_--;){if(x===g||g!==null&&x===g.alternate)break t;x=rd(x),g=rd(g)}x=null}else x=null;p!==null&&iI(h,f,p,x,!1),v!==null&&y!==null&&iI(h,y,v,x,!0)}}e:{if(f=c?Cd(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=ose;else if(KD(f))if(eH)C=use;else{C=lse;var E=ase}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=cse);if(C&&(C=C(i,c))){$8(h,C,t,u);break e}E&&E(i,f,c),i==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&K2(f,"number",f.value)}switch(E=c?Cd(c):window,i){case"focusin":(KD(E)||E.contentEditable==="true")&&(Ed=E,aE=c,Gg=null);break;case"focusout":Gg=aE=Ed=null;break;case"mousedown":lE=!0;break;case"contextmenu":case"mouseup":case"dragend":lE=!1,eI(h,t,u);break;case"selectionchange":if(dse)break;case"keydown":case"keyup":eI(h,t,u)}var A;if(SC)e:{switch(i){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Td?Q8(i,t)&&(T="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(Z8&&t.locale!=="ko"&&(Td||T!=="onCompositionStart"?T==="onCompositionEnd"&&Td&&(A=K8()):(Hc=u,xC="value"in Hc?Hc.value:Hc.textContent,Td=!0)),E=R_(c,T),0<E.length&&(T=new jD(T,i,null,t,u),h.push({event:T,listeners:E}),A?T.data=A:(A=J8(t),A!==null&&(T.data=A)))),(A=tse?nse(i,t):ise(i,t))&&(c=R_(c,"onBeforeInput"),0<c.length&&(u=new jD("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=A))}uH(h,e)})}function T0(i,e,t){return{instance:i,listener:e,currentTarget:t}}function R_(i,e){for(var t=e+"Capture",n=[];i!==null;){var r=i,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=y0(i,t),s!=null&&n.unshift(T0(i,s,r)),s=y0(i,e),s!=null&&n.push(T0(i,s,r))),i=i.return}return n}function rd(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function iI(i,e,t,n,r){for(var s=e._reactName,o=[];t!==null&&t!==n;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,r?(l=y0(t,s),l!=null&&o.unshift(T0(t,l,a))):r||(l=y0(t,s),l!=null&&o.push(T0(t,l,a)))),t=t.return}o.length!==0&&i.push({event:e,listeners:o})}var vse=/\r\n?/g,yse=/\u0000|\uFFFD/g;function rI(i){return(typeof i=="string"?i:""+i).replace(vse,`
`).replace(yse,"")}function Mx(i,e,t){if(e=rI(e),rI(i)!==e&&t)throw Error(Ke(425))}function L_(){}var cE=null,uE=null;function hE(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fE=typeof setTimeout=="function"?setTimeout:void 0,xse=typeof clearTimeout=="function"?clearTimeout:void 0,sI=typeof Promise=="function"?Promise:void 0,_se=typeof queueMicrotask=="function"?queueMicrotask:typeof sI<"u"?function(i){return sI.resolve(null).then(i).catch(wse)}:fE;function wse(i){setTimeout(function(){throw i})}function Nb(i,e){var t=e,n=0;do{var r=t.nextSibling;if(i.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(n===0){i.removeChild(r),w0(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=r}while(t);w0(e)}function Zc(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function oI(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var $p=Math.random().toString(36).slice(2),Za="__reactFiber$"+$p,E0="__reactProps$"+$p,$l="__reactContainer$"+$p,dE="__reactEvents$"+$p,Sse="__reactListeners$"+$p,Mse="__reactHandles$"+$p;function bh(i){var e=i[Za];if(e)return e;for(var t=i.parentNode;t;){if(e=t[$l]||t[Za]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=oI(i);i!==null;){if(t=i[Za])return t;i=oI(i)}return e}i=t,t=i.parentNode}return null}function tv(i){return i=i[Za]||i[$l],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Cd(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Ke(33))}function kw(i){return i[E0]||null}var pE=[],Pd=-1;function _u(i){return{current:i}}function Wn(i){0>Pd||(i.current=pE[Pd],pE[Pd]=null,Pd--)}function Hn(i,e){Pd++,pE[Pd]=i.current,i.current=e}var lu={},qr=_u(lu),zs=_u(!1),Jh=lu;function Cp(i,e){var t=i.type.contextTypes;if(!t)return lu;var n=i.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=r),r}function Bs(i){return i=i.childContextTypes,i!=null}function D_(){Wn(zs),Wn(qr)}function aI(i,e,t){if(qr.current!==lu)throw Error(Ke(168));Hn(qr,e),Hn(zs,t)}function fH(i,e,t){var n=i.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(Ke(108,are(i)||"Unknown",r));return ai({},t,n)}function I_(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||lu,Jh=qr.current,Hn(qr,i),Hn(zs,zs.current),!0}function lI(i,e,t){var n=i.stateNode;if(!n)throw Error(Ke(169));t?(i=fH(i,e,Jh),n.__reactInternalMemoizedMergedChildContext=i,Wn(zs),Wn(qr),Hn(qr,i)):Wn(zs),Hn(zs,t)}var Nl=null,Nw=!1,Ob=!1;function dH(i){Nl===null?Nl=[i]:Nl.push(i)}function bse(i){Nw=!0,dH(i)}function wu(){if(!Ob&&Nl!==null){Ob=!0;var i=0,e=Mn;try{var t=Nl;for(Mn=1;i<t.length;i++){var n=t[i];do n=n(!0);while(n!==null)}Nl=null,Nw=!1}catch(r){throw Nl!==null&&(Nl=Nl.slice(i+1)),O8(mC,wu),r}finally{Mn=e,Ob=!1}}return null}var Rd=[],Ld=0,U_=null,F_=0,Vo=[],Wo=0,$h=null,Vl=1,Wl="";function dh(i,e){Rd[Ld++]=F_,Rd[Ld++]=U_,U_=i,F_=e}function pH(i,e,t){Vo[Wo++]=Vl,Vo[Wo++]=Wl,Vo[Wo++]=$h,$h=i;var n=Vl;i=Wl;var r=32-Ea(n)-1;n&=~(1<<r),t+=1;var s=32-Ea(e)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Vl=1<<32-Ea(e)+r|t<<r|n,Wl=s+i}else Vl=1<<s|t<<r|n,Wl=i}function bC(i){i.return!==null&&(dh(i,1),pH(i,1,0))}function TC(i){for(;i===U_;)U_=Rd[--Ld],Rd[Ld]=null,F_=Rd[--Ld],Rd[Ld]=null;for(;i===$h;)$h=Vo[--Wo],Vo[Wo]=null,Wl=Vo[--Wo],Vo[Wo]=null,Vl=Vo[--Wo],Vo[Wo]=null}var _o=null,go=null,Qn=!1,Sa=null;function mH(i,e){var t=Qo(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function cI(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,_o=i,go=Zc(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,_o=i,go=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=$h!==null?{id:Vl,overflow:Wl}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Qo(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,_o=i,go=null,!0):!1;default:return!1}}function mE(i){return(i.mode&1)!==0&&(i.flags&128)===0}function gE(i){if(Qn){var e=go;if(e){var t=e;if(!cI(i,e)){if(mE(i))throw Error(Ke(418));e=Zc(t.nextSibling);var n=_o;e&&cI(i,e)?mH(n,t):(i.flags=i.flags&-4097|2,Qn=!1,_o=i)}}else{if(mE(i))throw Error(Ke(418));i.flags=i.flags&-4097|2,Qn=!1,_o=i}}}function uI(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;_o=i}function bx(i){if(i!==_o)return!1;if(!Qn)return uI(i),Qn=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!hE(i.type,i.memoizedProps)),e&&(e=go)){if(mE(i))throw gH(),Error(Ke(418));for(;e;)mH(i,e),e=Zc(e.nextSibling)}if(uI(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ke(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){go=Zc(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}go=null}}else go=_o?Zc(i.stateNode.nextSibling):null;return!0}function gH(){for(var i=go;i;)i=Zc(i.nextSibling)}function Pp(){go=_o=null,Qn=!1}function EC(i){Sa===null?Sa=[i]:Sa.push(i)}var Tse=ic.ReactCurrentBatchConfig;function xa(i,e){if(i&&i.defaultProps){e=ai({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var k_=_u(null),N_=null,Dd=null,AC=null;function CC(){AC=Dd=N_=null}function PC(i){var e=k_.current;Wn(k_),i._currentValue=e}function vE(i,e,t){for(;i!==null;){var n=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),i===t)break;i=i.return}}function Xd(i,e){N_=i,AC=Dd=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Ds=!0),i.firstContext=null)}function ra(i){var e=i._currentValue;if(AC!==i)if(i={context:i,memoizedValue:e,next:null},Dd===null){if(N_===null)throw Error(Ke(308));Dd=i,N_.dependencies={lanes:0,firstContext:i}}else Dd=Dd.next=i;return e}var Th=null;function RC(i){Th===null?Th=[i]:Th.push(i)}function vH(i,e,t,n){var r=e.interleaved;return r===null?(t.next=t,RC(e)):(t.next=r.next,r.next=t),e.interleaved=t,ec(i,n)}function ec(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var Lc=!1;function LC(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yH(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function jl(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function Qc(i,e,t){var n=i.updateQueue;if(n===null)return null;if(n=n.shared,fn&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,ec(i,t)}return r=n.interleaved,r===null?(e.next=e,RC(n)):(e.next=r.next,r.next=e),n.interleaved=e,ec(i,t)}function m1(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,gC(i,t)}}function hI(i,e){var t=i.updateQueue,n=i.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function O_(i,e,t,n){var r=i.updateQueue;Lc=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=i.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=i,x=a;switch(f=e,p=t,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(p,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,f=typeof v=="function"?v.call(p,h,f):v,f==null)break e;h=ai({},h,f);break e;case 2:Lc=!0}}a.callback!==null&&a.lane!==0&&(i.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);tf|=o,i.lanes=o,i.memoizedState=h}}function fI(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var n=i[e],r=n.callback;if(r!==null){if(n.callback=null,n=t,typeof r!="function")throw Error(Ke(191,r));r.call(n)}}}var xH=new v8.Component().refs;function yE(i,e,t,n){e=i.memoizedState,t=t(n,e),t=t==null?e:ai({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var Ow={isMounted:function(i){return(i=i._reactInternals)?df(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var n=ps(),r=$c(i),s=jl(n,r);s.payload=e,t!=null&&(s.callback=t),e=Qc(i,s,r),e!==null&&(Aa(e,i,r,n),m1(e,i,r))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var n=ps(),r=$c(i),s=jl(n,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Qc(i,s,r),e!==null&&(Aa(e,i,r,n),m1(e,i,r))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=ps(),n=$c(i),r=jl(t,n);r.tag=2,e!=null&&(r.callback=e),e=Qc(i,r,n),e!==null&&(Aa(e,i,n,t),m1(e,i,n))}};function dI(i,e,t,n,r,s,o){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!M0(t,n)||!M0(r,s):!0}function _H(i,e,t){var n=!1,r=lu,s=e.contextType;return typeof s=="object"&&s!==null?s=ra(s):(r=Bs(e)?Jh:qr.current,n=e.contextTypes,s=(n=n!=null)?Cp(i,r):lu),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ow,i.stateNode=e,e._reactInternals=i,n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=r,i.__reactInternalMemoizedMaskedChildContext=s),e}function pI(i,e,t,n){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==i&&Ow.enqueueReplaceState(e,e.state,null)}function xE(i,e,t,n){var r=i.stateNode;r.props=t,r.state=i.memoizedState,r.refs=xH,LC(i);var s=e.contextType;typeof s=="object"&&s!==null?r.context=ra(s):(s=Bs(e)?Jh:qr.current,r.context=Cp(i,s)),r.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yE(i,e,s,t),r.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Ow.enqueueReplaceState(r,r.state,null),O_(i,t,r,n),r.state=i.memoizedState),typeof r.componentDidMount=="function"&&(i.flags|=4194308)}function ig(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Ke(309));var n=t.stateNode}if(!n)throw Error(Ke(147,i));var r=n,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===xH&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof i!="string")throw Error(Ke(284));if(!t._owner)throw Error(Ke(290,i))}return i}function Tx(i,e){throw i=Object.prototype.toString.call(e),Error(Ke(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function mI(i){var e=i._init;return e(i._payload)}function wH(i){function e(g,_){if(i){var w=g.deletions;w===null?(g.deletions=[_],g.flags|=16):w.push(_)}}function t(g,_){if(!i)return null;for(;_!==null;)e(g,_),_=_.sibling;return null}function n(g,_){for(g=new Map;_!==null;)_.key!==null?g.set(_.key,_):g.set(_.index,_),_=_.sibling;return g}function r(g,_){return g=eu(g,_),g.index=0,g.sibling=null,g}function s(g,_,w){return g.index=w,i?(w=g.alternate,w!==null?(w=w.index,w<_?(g.flags|=2,_):w):(g.flags|=2,_)):(g.flags|=1048576,_)}function o(g){return i&&g.alternate===null&&(g.flags|=2),g}function a(g,_,w,S){return _===null||_.tag!==6?(_=jb(w,g.mode,S),_.return=g,_):(_=r(_,w),_.return=g,_)}function l(g,_,w,S){var C=w.type;return C===bd?u(g,_,w.props.children,S,w.key):_!==null&&(_.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Rc&&mI(C)===_.type)?(S=r(_,w.props),S.ref=ig(g,_,w),S.return=g,S):(S=w1(w.type,w.key,w.props,null,g.mode,S),S.ref=ig(g,_,w),S.return=g,S)}function c(g,_,w,S){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=Xb(w,g.mode,S),_.return=g,_):(_=r(_,w.children||[]),_.return=g,_)}function u(g,_,w,S,C){return _===null||_.tag!==7?(_=Oh(w,g.mode,S,C),_.return=g,_):(_=r(_,w),_.return=g,_)}function h(g,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return _=jb(""+_,g.mode,w),_.return=g,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case px:return w=w1(_.type,_.key,_.props,null,g.mode,w),w.ref=ig(g,null,_),w.return=g,w;case Md:return _=Xb(_,g.mode,w),_.return=g,_;case Rc:var S=_._init;return h(g,S(_._payload),w)}if(_g(_)||Jm(_))return _=Oh(_,g.mode,w,null),_.return=g,_;Tx(g,_)}return null}function f(g,_,w,S){var C=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(g,_,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case px:return w.key===C?l(g,_,w,S):null;case Md:return w.key===C?c(g,_,w,S):null;case Rc:return C=w._init,f(g,_,C(w._payload),S)}if(_g(w)||Jm(w))return C!==null?null:u(g,_,w,S,null);Tx(g,w)}return null}function p(g,_,w,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(w)||null,a(_,g,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case px:return g=g.get(S.key===null?w:S.key)||null,l(_,g,S,C);case Md:return g=g.get(S.key===null?w:S.key)||null,c(_,g,S,C);case Rc:var E=S._init;return p(g,_,w,E(S._payload),C)}if(_g(S)||Jm(S))return g=g.get(w)||null,u(_,g,S,C,null);Tx(_,S)}return null}function v(g,_,w,S){for(var C=null,E=null,A=_,T=_=0,L=null;A!==null&&T<w.length;T++){A.index>T?(L=A,A=null):L=A.sibling;var M=f(g,A,w[T],S);if(M===null){A===null&&(A=L);break}i&&A&&M.alternate===null&&e(g,A),_=s(M,_,T),E===null?C=M:E.sibling=M,E=M,A=L}if(T===w.length)return t(g,A),Qn&&dh(g,T),C;if(A===null){for(;T<w.length;T++)A=h(g,w[T],S),A!==null&&(_=s(A,_,T),E===null?C=A:E.sibling=A,E=A);return Qn&&dh(g,T),C}for(A=n(g,A);T<w.length;T++)L=p(A,g,T,w[T],S),L!==null&&(i&&L.alternate!==null&&A.delete(L.key===null?T:L.key),_=s(L,_,T),E===null?C=L:E.sibling=L,E=L);return i&&A.forEach(function(R){return e(g,R)}),Qn&&dh(g,T),C}function x(g,_,w,S){var C=Jm(w);if(typeof C!="function")throw Error(Ke(150));if(w=C.call(w),w==null)throw Error(Ke(151));for(var E=C=null,A=_,T=_=0,L=null,M=w.next();A!==null&&!M.done;T++,M=w.next()){A.index>T?(L=A,A=null):L=A.sibling;var R=f(g,A,M.value,S);if(R===null){A===null&&(A=L);break}i&&A&&R.alternate===null&&e(g,A),_=s(R,_,T),E===null?C=R:E.sibling=R,E=R,A=L}if(M.done)return t(g,A),Qn&&dh(g,T),C;if(A===null){for(;!M.done;T++,M=w.next())M=h(g,M.value,S),M!==null&&(_=s(M,_,T),E===null?C=M:E.sibling=M,E=M);return Qn&&dh(g,T),C}for(A=n(g,A);!M.done;T++,M=w.next())M=p(A,g,T,M.value,S),M!==null&&(i&&M.alternate!==null&&A.delete(M.key===null?T:M.key),_=s(M,_,T),E===null?C=M:E.sibling=M,E=M);return i&&A.forEach(function(D){return e(g,D)}),Qn&&dh(g,T),C}function y(g,_,w,S){if(typeof w=="object"&&w!==null&&w.type===bd&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case px:e:{for(var C=w.key,E=_;E!==null;){if(E.key===C){if(C=w.type,C===bd){if(E.tag===7){t(g,E.sibling),_=r(E,w.props.children),_.return=g,g=_;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Rc&&mI(C)===E.type){t(g,E.sibling),_=r(E,w.props),_.ref=ig(g,E,w),_.return=g,g=_;break e}t(g,E);break}else e(g,E);E=E.sibling}w.type===bd?(_=Oh(w.props.children,g.mode,S,w.key),_.return=g,g=_):(S=w1(w.type,w.key,w.props,null,g.mode,S),S.ref=ig(g,_,w),S.return=g,g=S)}return o(g);case Md:e:{for(E=w.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){t(g,_.sibling),_=r(_,w.children||[]),_.return=g,g=_;break e}else{t(g,_);break}else e(g,_);_=_.sibling}_=Xb(w,g.mode,S),_.return=g,g=_}return o(g);case Rc:return E=w._init,y(g,_,E(w._payload),S)}if(_g(w))return v(g,_,w,S);if(Jm(w))return x(g,_,w,S);Tx(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,_!==null&&_.tag===6?(t(g,_.sibling),_=r(_,w),_.return=g,g=_):(t(g,_),_=jb(w,g.mode,S),_.return=g,g=_),o(g)):t(g,_)}return y}var Rp=wH(!0),SH=wH(!1),nv={},sl=_u(nv),A0=_u(nv),C0=_u(nv);function Eh(i){if(i===nv)throw Error(Ke(174));return i}function DC(i,e){switch(Hn(C0,e),Hn(A0,i),Hn(sl,nv),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Q2(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=Q2(e,i)}Wn(sl),Hn(sl,e)}function Lp(){Wn(sl),Wn(A0),Wn(C0)}function MH(i){Eh(C0.current);var e=Eh(sl.current),t=Q2(e,i.type);e!==t&&(Hn(A0,i),Hn(sl,t))}function IC(i){A0.current===i&&(Wn(sl),Wn(A0))}var ii=_u(0);function z_(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zb=[];function UC(){for(var i=0;i<zb.length;i++)zb[i]._workInProgressVersionPrimary=null;zb.length=0}var g1=ic.ReactCurrentDispatcher,Bb=ic.ReactCurrentBatchConfig,ef=0,oi=null,Ki=null,ur=null,B_=!1,Vg=!1,P0=0,Ese=0;function Hr(){throw Error(Ke(321))}function FC(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Ra(i[t],e[t]))return!1;return!0}function kC(i,e,t,n,r,s){if(ef=s,oi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,g1.current=i===null||i.memoizedState===null?Rse:Lse,i=t(n,r),Vg){s=0;do{if(Vg=!1,P0=0,25<=s)throw Error(Ke(301));s+=1,ur=Ki=null,e.updateQueue=null,g1.current=Dse,i=t(n,r)}while(Vg)}if(g1.current=H_,e=Ki!==null&&Ki.next!==null,ef=0,ur=Ki=oi=null,B_=!1,e)throw Error(Ke(300));return i}function NC(){var i=P0!==0;return P0=0,i}function Xa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?oi.memoizedState=ur=i:ur=ur.next=i,ur}function sa(){if(Ki===null){var i=oi.alternate;i=i!==null?i.memoizedState:null}else i=Ki.next;var e=ur===null?oi.memoizedState:ur.next;if(e!==null)ur=e,Ki=i;else{if(i===null)throw Error(Ke(310));Ki=i,i={memoizedState:Ki.memoizedState,baseState:Ki.baseState,baseQueue:Ki.baseQueue,queue:Ki.queue,next:null},ur===null?oi.memoizedState=ur=i:ur=ur.next=i}return ur}function R0(i,e){return typeof e=="function"?e(i):e}function Hb(i){var e=sa(),t=e.queue;if(t===null)throw Error(Ke(311));t.lastRenderedReducer=i;var n=Ki,r=n.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((ef&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:i(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,oi.lanes|=u,tf|=u}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,Ra(n,e.memoizedState)||(Ds=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,t.lastRenderedState=n}if(i=t.interleaved,i!==null){r=i;do s=r.lane,oi.lanes|=s,tf|=s,r=r.next;while(r!==i)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Gb(i){var e=sa(),t=e.queue;if(t===null)throw Error(Ke(311));t.lastRenderedReducer=i;var n=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=i(s,o.action),o=o.next;while(o!==r);Ra(s,e.memoizedState)||(Ds=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,n]}function bH(){}function TH(i,e){var t=oi,n=sa(),r=e(),s=!Ra(n.memoizedState,r);if(s&&(n.memoizedState=r,Ds=!0),n=n.queue,OC(CH.bind(null,t,n,i),[i]),n.getSnapshot!==e||s||ur!==null&&ur.memoizedState.tag&1){if(t.flags|=2048,L0(9,AH.bind(null,t,n,r,e),void 0,null),dr===null)throw Error(Ke(349));ef&30||EH(t,e,r)}return r}function EH(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=oi.updateQueue,e===null?(e={lastEffect:null,stores:null},oi.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function AH(i,e,t,n){e.value=t,e.getSnapshot=n,PH(e)&&RH(i)}function CH(i,e,t){return t(function(){PH(e)&&RH(i)})}function PH(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Ra(i,t)}catch{return!0}}function RH(i){var e=ec(i,1);e!==null&&Aa(e,i,1,-1)}function gI(i){var e=Xa();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:R0,lastRenderedState:i},e.queue=i,i=i.dispatch=Pse.bind(null,oi,i),[e.memoizedState,i]}function L0(i,e,t,n){return i={tag:i,create:e,destroy:t,deps:n,next:null},e=oi.updateQueue,e===null?(e={lastEffect:null,stores:null},oi.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(n=t.next,t.next=i,i.next=n,e.lastEffect=i)),i}function LH(){return sa().memoizedState}function v1(i,e,t,n){var r=Xa();oi.flags|=i,r.memoizedState=L0(1|e,t,void 0,n===void 0?null:n)}function zw(i,e,t,n){var r=sa();n=n===void 0?null:n;var s=void 0;if(Ki!==null){var o=Ki.memoizedState;if(s=o.destroy,n!==null&&FC(n,o.deps)){r.memoizedState=L0(e,t,s,n);return}}oi.flags|=i,r.memoizedState=L0(1|e,t,s,n)}function vI(i,e){return v1(8390656,8,i,e)}function OC(i,e){return zw(2048,8,i,e)}function DH(i,e){return zw(4,2,i,e)}function IH(i,e){return zw(4,4,i,e)}function UH(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function FH(i,e,t){return t=t!=null?t.concat([i]):null,zw(4,4,UH.bind(null,e,i),t)}function zC(){}function kH(i,e){var t=sa();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&FC(e,n[1])?n[0]:(t.memoizedState=[i,e],i)}function NH(i,e){var t=sa();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&FC(e,n[1])?n[0]:(i=i(),t.memoizedState=[i,e],i)}function OH(i,e,t){return ef&21?(Ra(t,e)||(t=H8(),oi.lanes|=t,tf|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Ds=!0),i.memoizedState=t)}function Ase(i,e){var t=Mn;Mn=t!==0&&4>t?t:4,i(!0);var n=Bb.transition;Bb.transition={};try{i(!1),e()}finally{Mn=t,Bb.transition=n}}function zH(){return sa().memoizedState}function Cse(i,e,t){var n=$c(i);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},BH(i))HH(e,t);else if(t=vH(i,e,t,n),t!==null){var r=ps();Aa(t,i,n,r),GH(t,e,n)}}function Pse(i,e,t){var n=$c(i),r={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(BH(i))HH(e,r);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Ra(a,o)){var l=e.interleaved;l===null?(r.next=r,RC(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=vH(i,e,r,n),t!==null&&(r=ps(),Aa(t,i,n,r),GH(t,e,n))}}function BH(i){var e=i.alternate;return i===oi||e!==null&&e===oi}function HH(i,e){Vg=B_=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function GH(i,e,t){if(t&4194240){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,gC(i,t)}}var H_={readContext:ra,useCallback:Hr,useContext:Hr,useEffect:Hr,useImperativeHandle:Hr,useInsertionEffect:Hr,useLayoutEffect:Hr,useMemo:Hr,useReducer:Hr,useRef:Hr,useState:Hr,useDebugValue:Hr,useDeferredValue:Hr,useTransition:Hr,useMutableSource:Hr,useSyncExternalStore:Hr,useId:Hr,unstable_isNewReconciler:!1},Rse={readContext:ra,useCallback:function(i,e){return Xa().memoizedState=[i,e===void 0?null:e],i},useContext:ra,useEffect:vI,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,v1(4194308,4,UH.bind(null,e,i),t)},useLayoutEffect:function(i,e){return v1(4194308,4,i,e)},useInsertionEffect:function(i,e){return v1(4,2,i,e)},useMemo:function(i,e){var t=Xa();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var n=Xa();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},n.queue=i,i=i.dispatch=Cse.bind(null,oi,i),[n.memoizedState,i]},useRef:function(i){var e=Xa();return i={current:i},e.memoizedState=i},useState:gI,useDebugValue:zC,useDeferredValue:function(i){return Xa().memoizedState=i},useTransition:function(){var i=gI(!1),e=i[0];return i=Ase.bind(null,i[1]),Xa().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var n=oi,r=Xa();if(Qn){if(t===void 0)throw Error(Ke(407));t=t()}else{if(t=e(),dr===null)throw Error(Ke(349));ef&30||EH(n,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,vI(CH.bind(null,n,s,i),[i]),n.flags|=2048,L0(9,AH.bind(null,n,s,t,e),void 0,null),t},useId:function(){var i=Xa(),e=dr.identifierPrefix;if(Qn){var t=Wl,n=Vl;t=(n&~(1<<32-Ea(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=P0++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Ese++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Lse={readContext:ra,useCallback:kH,useContext:ra,useEffect:OC,useImperativeHandle:FH,useInsertionEffect:DH,useLayoutEffect:IH,useMemo:NH,useReducer:Hb,useRef:LH,useState:function(){return Hb(R0)},useDebugValue:zC,useDeferredValue:function(i){var e=sa();return OH(e,Ki.memoizedState,i)},useTransition:function(){var i=Hb(R0)[0],e=sa().memoizedState;return[i,e]},useMutableSource:bH,useSyncExternalStore:TH,useId:zH,unstable_isNewReconciler:!1},Dse={readContext:ra,useCallback:kH,useContext:ra,useEffect:OC,useImperativeHandle:FH,useInsertionEffect:DH,useLayoutEffect:IH,useMemo:NH,useReducer:Gb,useRef:LH,useState:function(){return Gb(R0)},useDebugValue:zC,useDeferredValue:function(i){var e=sa();return Ki===null?e.memoizedState=i:OH(e,Ki.memoizedState,i)},useTransition:function(){var i=Gb(R0)[0],e=sa().memoizedState;return[i,e]},useMutableSource:bH,useSyncExternalStore:TH,useId:zH,unstable_isNewReconciler:!1};function Dp(i,e){try{var t="",n=e;do t+=ore(n),n=n.return;while(n);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:r,digest:null}}function Vb(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function _E(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Ise=typeof WeakMap=="function"?WeakMap:Map;function VH(i,e,t){t=jl(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){V_||(V_=!0,RE=n),_E(i,e)},t}function WH(i,e,t){t=jl(-1,t),t.tag=3;var n=i.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;t.payload=function(){return n(r)},t.callback=function(){_E(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){_E(i,e),typeof n!="function"&&(Jc===null?Jc=new Set([this]):Jc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function yI(i,e,t){var n=i.pingCache;if(n===null){n=i.pingCache=new Ise;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(t)||(r.add(t),i=Yse.bind(null,i,e,t),e.then(i,i))}function xI(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function _I(i,e,t,n,r){return i.mode&1?(i.flags|=65536,i.lanes=r,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=jl(-1,1),e.tag=2,Qc(t,e,1))),t.lanes|=1),i)}var Use=ic.ReactCurrentOwner,Ds=!1;function us(i,e,t,n){e.child=i===null?SH(e,null,t,n):Rp(e,i.child,t,n)}function wI(i,e,t,n,r){t=t.render;var s=e.ref;return Xd(e,r),n=kC(i,e,t,n,s,r),t=NC(),i!==null&&!Ds?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,tc(i,e,r)):(Qn&&t&&bC(e),e.flags|=1,us(i,e,n,r),e.child)}function SI(i,e,t,n,r){if(i===null){var s=t.type;return typeof s=="function"&&!YC(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,jH(i,e,s,n,r)):(i=w1(t.type,null,n,e,e.mode,r),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:M0,t(o,n)&&i.ref===e.ref)return tc(i,e,r)}return e.flags|=1,i=eu(s,n),i.ref=e.ref,i.return=e,e.child=i}function jH(i,e,t,n,r){if(i!==null){var s=i.memoizedProps;if(M0(s,n)&&i.ref===e.ref)if(Ds=!1,e.pendingProps=n=s,(i.lanes&r)!==0)i.flags&131072&&(Ds=!0);else return e.lanes=i.lanes,tc(i,e,r)}return wE(i,e,t,n,r)}function XH(i,e,t){var n=e.pendingProps,r=n.children,s=i!==null?i.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hn(Ud,so),so|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Hn(Ud,so),so|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,Hn(Ud,so),so|=n}else s!==null?(n=s.baseLanes|t,e.memoizedState=null):n=t,Hn(Ud,so),so|=n;return us(i,e,r,t),e.child}function YH(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function wE(i,e,t,n,r){var s=Bs(t)?Jh:qr.current;return s=Cp(e,s),Xd(e,r),t=kC(i,e,t,n,s,r),n=NC(),i!==null&&!Ds?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,tc(i,e,r)):(Qn&&n&&bC(e),e.flags|=1,us(i,e,t,r),e.child)}function MI(i,e,t,n,r){if(Bs(t)){var s=!0;I_(e)}else s=!1;if(Xd(e,r),e.stateNode===null)y1(i,e),_H(e,t,n),xE(e,t,n,r),n=!0;else if(i===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=ra(c):(c=Bs(t)?Jh:qr.current,c=Cp(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&pI(e,o,n,c),Lc=!1;var f=e.memoizedState;o.state=f,O_(e,n,o,r),l=e.memoizedState,a!==n||f!==l||zs.current||Lc?(typeof u=="function"&&(yE(e,t,u,n),l=e.memoizedState),(a=Lc||dI(e,t,a,n,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,yH(i,e),a=e.memoizedProps,c=e.type===e.elementType?a:xa(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=ra(l):(l=Bs(t)?Jh:qr.current,l=Cp(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&pI(e,o,n,l),Lc=!1,f=e.memoizedState,o.state=f,O_(e,n,o,r);var v=e.memoizedState;a!==h||f!==v||zs.current||Lc?(typeof p=="function"&&(yE(e,t,p,n),v=e.memoizedState),(c=Lc||dI(e,t,c,n,f,v,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),o.props=n,o.state=v,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(e.flags|=1024),n=!1)}return SE(i,e,t,n,s,r)}function SE(i,e,t,n,r,s){YH(i,e);var o=(e.flags&128)!==0;if(!n&&!o)return r&&lI(e,t,!1),tc(i,e,s);n=e.stateNode,Use.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,i!==null&&o?(e.child=Rp(e,i.child,null,s),e.child=Rp(e,null,a,s)):us(i,e,a,s),e.memoizedState=n.state,r&&lI(e,t,!0),e.child}function qH(i){var e=i.stateNode;e.pendingContext?aI(i,e.pendingContext,e.pendingContext!==e.context):e.context&&aI(i,e.context,!1),DC(i,e.containerInfo)}function bI(i,e,t,n,r){return Pp(),EC(r),e.flags|=256,us(i,e,t,n),e.child}var ME={dehydrated:null,treeContext:null,retryLane:0};function bE(i){return{baseLanes:i,cachePool:null,transitions:null}}function KH(i,e,t){var n=e.pendingProps,r=ii.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=i!==null&&i.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(r|=1),Hn(ii,r&1),i===null)return gE(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,i=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Gw(o,n,0,null),i=Oh(i,n,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=bE(t),e.memoizedState=ME,i):BC(e,o));if(r=i.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Fse(i,e,o,n,a,r,t);if(s){s=n.fallback,o=e.mode,r=i.child,a=r.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=eu(r,l),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=eu(a,s):(s=Oh(s,o,t,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=i.child.memoizedState,o=o===null?bE(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=i.childLanes&~t,e.memoizedState=ME,n}return s=i.child,i=s.sibling,n=eu(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=n,e.memoizedState=null,n}function BC(i,e){return e=Gw({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Ex(i,e,t,n){return n!==null&&EC(n),Rp(e,i.child,null,t),i=BC(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function Fse(i,e,t,n,r,s,o){if(t)return e.flags&256?(e.flags&=-257,n=Vb(Error(Ke(422))),Ex(i,e,o,n)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=Gw({mode:"visible",children:n.children},r,0,null),s=Oh(s,r,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Rp(e,i.child,null,o),e.child.memoizedState=bE(o),e.memoizedState=ME,s);if(!(e.mode&1))return Ex(i,e,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Ke(419)),n=Vb(s,n,void 0),Ex(i,e,o,n)}if(a=(o&i.childLanes)!==0,Ds||a){if(n=dr,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,ec(i,r),Aa(n,i,r,-1))}return XC(),n=Vb(Error(Ke(421))),Ex(i,e,o,n)}return r.data==="$?"?(e.flags|=128,e.child=i.child,e=qse.bind(null,i),r._reactRetry=e,null):(i=s.treeContext,go=Zc(r.nextSibling),_o=e,Qn=!0,Sa=null,i!==null&&(Vo[Wo++]=Vl,Vo[Wo++]=Wl,Vo[Wo++]=$h,Vl=i.id,Wl=i.overflow,$h=e),e=BC(e,n.children),e.flags|=4096,e)}function TI(i,e,t){i.lanes|=e;var n=i.alternate;n!==null&&(n.lanes|=e),vE(i.return,e,t)}function Wb(i,e,t,n,r){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=r)}function ZH(i,e,t){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(us(i,e,n.children,t),n=ii.current,n&2)n=n&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&TI(i,t,e);else if(i.tag===19)TI(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n&=1}if(Hn(ii,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)i=t.alternate,i!==null&&z_(i)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Wb(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(i=r.alternate,i!==null&&z_(i)===null){e.child=r;break}i=r.sibling,r.sibling=t,t=r,r=i}Wb(e,!0,t,null,s);break;case"together":Wb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function y1(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function tc(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),tf|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(Ke(153));if(e.child!==null){for(i=e.child,t=eu(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=eu(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function kse(i,e,t){switch(e.tag){case 3:qH(e),Pp();break;case 5:MH(e);break;case 1:Bs(e.type)&&I_(e);break;case 4:DC(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;Hn(k_,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Hn(ii,ii.current&1),e.flags|=128,null):t&e.child.childLanes?KH(i,e,t):(Hn(ii,ii.current&1),i=tc(i,e,t),i!==null?i.sibling:null);Hn(ii,ii.current&1);break;case 19:if(n=(t&e.childLanes)!==0,i.flags&128){if(n)return ZH(i,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Hn(ii,ii.current),n)break;return null;case 22:case 23:return e.lanes=0,XH(i,e,t)}return tc(i,e,t)}var QH,TE,JH,$H;QH=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};TE=function(){};JH=function(i,e,t,n){var r=i.memoizedProps;if(r!==n){i=e.stateNode,Eh(sl.current);var s=null;switch(t){case"input":r=Y2(i,r),n=Y2(i,n),s=[];break;case"select":r=ai({},r,{value:void 0}),n=ai({},n,{value:void 0}),s=[];break;case"textarea":r=Z2(i,r),n=Z2(i,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(i.onclick=L_)}J2(t,n);var o;t=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(g0.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(g0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Gn("scroll",i),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};$H=function(i,e,t,n){t!==n&&(e.flags|=4)};function rg(i,e){if(!Qn)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:n.sibling=null}}function Gr(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,n=0;if(e)for(var r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=i,r=r.sibling;else for(r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=i,r=r.sibling;return i.subtreeFlags|=n,i.childLanes=t,e}function Nse(i,e,t){var n=e.pendingProps;switch(TC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(e),null;case 1:return Bs(e.type)&&D_(),Gr(e),null;case 3:return n=e.stateNode,Lp(),Wn(zs),Wn(qr),UC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(i===null||i.child===null)&&(bx(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sa!==null&&(IE(Sa),Sa=null))),TE(i,e),Gr(e),null;case 5:IC(e);var r=Eh(C0.current);if(t=e.type,i!==null&&e.stateNode!=null)JH(i,e,t,n,r),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ke(166));return Gr(e),null}if(i=Eh(sl.current),bx(e)){n=e.stateNode,t=e.type;var s=e.memoizedProps;switch(n[Za]=e,n[E0]=s,i=(e.mode&1)!==0,t){case"dialog":Gn("cancel",n),Gn("close",n);break;case"iframe":case"object":case"embed":Gn("load",n);break;case"video":case"audio":for(r=0;r<Sg.length;r++)Gn(Sg[r],n);break;case"source":Gn("error",n);break;case"img":case"image":case"link":Gn("error",n),Gn("load",n);break;case"details":Gn("toggle",n);break;case"input":UD(n,s),Gn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Gn("invalid",n);break;case"textarea":kD(n,s),Gn("invalid",n)}J2(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Mx(n.textContent,a,i),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Mx(n.textContent,a,i),r=["children",""+a]):g0.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Gn("scroll",n)}switch(t){case"input":mx(n),FD(n,s,!0);break;case"textarea":mx(n),ND(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=L_)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=E8(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=o.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof n.is=="string"?i=o.createElement(t,{is:n.is}):(i=o.createElement(t),t==="select"&&(o=i,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):i=o.createElementNS(i,t),i[Za]=e,i[E0]=n,QH(i,e,!1,!1),e.stateNode=i;e:{switch(o=$2(t,n),t){case"dialog":Gn("cancel",i),Gn("close",i),r=n;break;case"iframe":case"object":case"embed":Gn("load",i),r=n;break;case"video":case"audio":for(r=0;r<Sg.length;r++)Gn(Sg[r],i);r=n;break;case"source":Gn("error",i),r=n;break;case"img":case"image":case"link":Gn("error",i),Gn("load",i),r=n;break;case"details":Gn("toggle",i),r=n;break;case"input":UD(i,n),r=Y2(i,n),Gn("invalid",i);break;case"option":r=n;break;case"select":i._wrapperState={wasMultiple:!!n.multiple},r=ai({},n,{value:void 0}),Gn("invalid",i);break;case"textarea":kD(i,n),r=Z2(i,n),Gn("invalid",i);break;default:r=n}J2(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?P8(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&A8(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&v0(i,l):typeof l=="number"&&v0(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(g0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Gn("scroll",i):l!=null&&uC(i,s,l,o))}switch(t){case"input":mx(i),FD(i,n,!1);break;case"textarea":mx(i),ND(i);break;case"option":n.value!=null&&i.setAttribute("value",""+au(n.value));break;case"select":i.multiple=!!n.multiple,s=n.value,s!=null?Gd(i,!!n.multiple,s,!1):n.defaultValue!=null&&Gd(i,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(i.onclick=L_)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gr(e),null;case 6:if(i&&e.stateNode!=null)$H(i,e,i.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ke(166));if(t=Eh(C0.current),Eh(sl.current),bx(e)){if(n=e.stateNode,t=e.memoizedProps,n[Za]=e,(s=n.nodeValue!==t)&&(i=_o,i!==null))switch(i.tag){case 3:Mx(n.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Mx(n.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Za]=e,e.stateNode=n}return Gr(e),null;case 13:if(Wn(ii),n=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Qn&&go!==null&&e.mode&1&&!(e.flags&128))gH(),Pp(),e.flags|=98560,s=!1;else if(s=bx(e),n!==null&&n.dehydrated!==null){if(i===null){if(!s)throw Error(Ke(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ke(317));s[Za]=e}else Pp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gr(e),s=!1}else Sa!==null&&(IE(Sa),Sa=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(i!==null&&i.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(i===null||ii.current&1?Qi===0&&(Qi=3):XC())),e.updateQueue!==null&&(e.flags|=4),Gr(e),null);case 4:return Lp(),TE(i,e),i===null&&b0(e.stateNode.containerInfo),Gr(e),null;case 10:return PC(e.type._context),Gr(e),null;case 17:return Bs(e.type)&&D_(),Gr(e),null;case 19:if(Wn(ii),s=e.memoizedState,s===null)return Gr(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)rg(s,!1);else{if(Qi!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(o=z_(i),o!==null){for(e.flags|=128,rg(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)s=t,i=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,i=o.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Hn(ii,ii.current&1|2),e.child}i=i.sibling}s.tail!==null&&Pi()>Ip&&(e.flags|=128,n=!0,rg(s,!1),e.lanes=4194304)}else{if(!n)if(i=z_(o),i!==null){if(e.flags|=128,n=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),rg(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Qn)return Gr(e),null}else 2*Pi()-s.renderingStartTime>Ip&&t!==1073741824&&(e.flags|=128,n=!0,rg(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Pi(),e.sibling=null,t=ii.current,Hn(ii,n?t&1|2:t&1),e):(Gr(e),null);case 22:case 23:return jC(),n=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?so&1073741824&&(Gr(e),e.subtreeFlags&6&&(e.flags|=8192)):Gr(e),null;case 24:return null;case 25:return null}throw Error(Ke(156,e.tag))}function Ose(i,e){switch(TC(e),e.tag){case 1:return Bs(e.type)&&D_(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Lp(),Wn(zs),Wn(qr),UC(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return IC(e),null;case 13:if(Wn(ii),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(Ke(340));Pp()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Wn(ii),null;case 4:return Lp(),null;case 10:return PC(e.type._context),null;case 22:case 23:return jC(),null;case 24:return null;default:return null}}var Ax=!1,Wr=!1,zse=typeof WeakSet=="function"?WeakSet:Set,pt=null;function Id(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){pi(i,e,n)}else t.current=null}function EE(i,e,t){try{t()}catch(n){pi(i,e,n)}}var EI=!1;function Bse(i,e){if(cE=C_,i=iH(),MC(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=i,f=null;t:for(;;){for(var p;h!==t||r!==0&&h.nodeType!==3||(a=o+r),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===i)break t;if(f===t&&++c===r&&(a=o),f===s&&++u===n&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(uE={focusedElem:i,selectionRange:t},C_=!1,pt=e;pt!==null;)if(e=pt,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,pt=i;else for(;pt!==null;){e=pt;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,g=e.stateNode,_=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:xa(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(S){pi(e,e.return,S)}if(i=e.sibling,i!==null){i.return=e.return,pt=i;break}pt=e.return}return v=EI,EI=!1,v}function Wg(i,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&i)===i){var s=r.destroy;r.destroy=void 0,s!==void 0&&EE(e,t,s)}r=r.next}while(r!==n)}}function Bw(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function AE(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function eG(i){var e=i.alternate;e!==null&&(i.alternate=null,eG(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Za],delete e[E0],delete e[dE],delete e[Sse],delete e[Mse])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function tG(i){return i.tag===5||i.tag===3||i.tag===4}function AI(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||tG(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function CE(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=L_));else if(n!==4&&(i=i.child,i!==null))for(CE(i,e,t),i=i.sibling;i!==null;)CE(i,e,t),i=i.sibling}function PE(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(n!==4&&(i=i.child,i!==null))for(PE(i,e,t),i=i.sibling;i!==null;)PE(i,e,t),i=i.sibling}var Mr=null,_a=!1;function Ac(i,e,t){for(t=t.child;t!==null;)nG(i,e,t),t=t.sibling}function nG(i,e,t){if(rl&&typeof rl.onCommitFiberUnmount=="function")try{rl.onCommitFiberUnmount(Dw,t)}catch{}switch(t.tag){case 5:Wr||Id(t,e);case 6:var n=Mr,r=_a;Mr=null,Ac(i,e,t),Mr=n,_a=r,Mr!==null&&(_a?(i=Mr,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Mr.removeChild(t.stateNode));break;case 18:Mr!==null&&(_a?(i=Mr,t=t.stateNode,i.nodeType===8?Nb(i.parentNode,t):i.nodeType===1&&Nb(i,t),w0(i)):Nb(Mr,t.stateNode));break;case 4:n=Mr,r=_a,Mr=t.stateNode.containerInfo,_a=!0,Ac(i,e,t),Mr=n,_a=r;break;case 0:case 11:case 14:case 15:if(!Wr&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&EE(t,e,o),r=r.next}while(r!==n)}Ac(i,e,t);break;case 1:if(!Wr&&(Id(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(a){pi(t,e,a)}Ac(i,e,t);break;case 21:Ac(i,e,t);break;case 22:t.mode&1?(Wr=(n=Wr)||t.memoizedState!==null,Ac(i,e,t),Wr=n):Ac(i,e,t);break;default:Ac(i,e,t)}}function CI(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new zse),e.forEach(function(n){var r=Kse.bind(null,i,n);t.has(n)||(t.add(n),n.then(r,r))})}}function ga(i,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];try{var s=i,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mr=a.stateNode,_a=!1;break e;case 3:Mr=a.stateNode.containerInfo,_a=!0;break e;case 4:Mr=a.stateNode.containerInfo,_a=!0;break e}a=a.return}if(Mr===null)throw Error(Ke(160));nG(s,o,r),Mr=null,_a=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){pi(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iG(e,i),e=e.sibling}function iG(i,e){var t=i.alternate,n=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ga(e,i),Ha(i),n&4){try{Wg(3,i,i.return),Bw(3,i)}catch(x){pi(i,i.return,x)}try{Wg(5,i,i.return)}catch(x){pi(i,i.return,x)}}break;case 1:ga(e,i),Ha(i),n&512&&t!==null&&Id(t,t.return);break;case 5:if(ga(e,i),Ha(i),n&512&&t!==null&&Id(t,t.return),i.flags&32){var r=i.stateNode;try{v0(r,"")}catch(x){pi(i,i.return,x)}}if(n&4&&(r=i.stateNode,r!=null)){var s=i.memoizedProps,o=t!==null?t.memoizedProps:s,a=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&b8(r,s),$2(a,o);var c=$2(a,s);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?P8(r,h):u==="dangerouslySetInnerHTML"?A8(r,h):u==="children"?v0(r,h):uC(r,u,h,c)}switch(a){case"input":q2(r,s);break;case"textarea":T8(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Gd(r,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?Gd(r,!!s.multiple,s.defaultValue,!0):Gd(r,!!s.multiple,s.multiple?[]:"",!1))}r[E0]=s}catch(x){pi(i,i.return,x)}}break;case 6:if(ga(e,i),Ha(i),n&4){if(i.stateNode===null)throw Error(Ke(162));r=i.stateNode,s=i.memoizedProps;try{r.nodeValue=s}catch(x){pi(i,i.return,x)}}break;case 3:if(ga(e,i),Ha(i),n&4&&t!==null&&t.memoizedState.isDehydrated)try{w0(e.containerInfo)}catch(x){pi(i,i.return,x)}break;case 4:ga(e,i),Ha(i);break;case 13:ga(e,i),Ha(i),r=i.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(VC=Pi())),n&4&&CI(i);break;case 22:if(u=t!==null&&t.memoizedState!==null,i.mode&1?(Wr=(c=Wr)||u,ga(e,i),Wr=c):ga(e,i),Ha(i),n&8192){if(c=i.memoizedState!==null,(i.stateNode.isHidden=c)&&!u&&i.mode&1)for(pt=i,u=i.child;u!==null;){for(h=pt=u;pt!==null;){switch(f=pt,p=f.child,f.tag){case 0:case 11:case 14:case 15:Wg(4,f,f.return);break;case 1:Id(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,t=f.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){pi(n,t,x)}}break;case 5:Id(f,f.return);break;case 22:if(f.memoizedState!==null){RI(h);continue}}p!==null?(p.return=f,pt=p):RI(h)}u=u.sibling}e:for(u=null,h=i;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=C8("display",o))}catch(x){pi(i,i.return,x)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){pi(i,i.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===i)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break e;for(;h.sibling===null;){if(h.return===null||h.return===i)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ga(e,i),Ha(i),n&4&&CI(i);break;case 21:break;default:ga(e,i),Ha(i)}}function Ha(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(tG(t)){var n=t;break e}t=t.return}throw Error(Ke(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(v0(r,""),n.flags&=-33);var s=AI(i);PE(i,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=AI(i);CE(i,a,o);break;default:throw Error(Ke(161))}}catch(l){pi(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function Hse(i,e,t){pt=i,rG(i)}function rG(i,e,t){for(var n=(i.mode&1)!==0;pt!==null;){var r=pt,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Ax;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Wr;a=Ax;var c=Wr;if(Ax=o,(Wr=l)&&!c)for(pt=r;pt!==null;)o=pt,l=o.child,o.tag===22&&o.memoizedState!==null?LI(r):l!==null?(l.return=o,pt=l):LI(r);for(;s!==null;)pt=s,rG(s),s=s.sibling;pt=r,Ax=a,Wr=c}PI(i)}else r.subtreeFlags&8772&&s!==null?(s.return=r,pt=s):PI(i)}}function PI(i){for(;pt!==null;){var e=pt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wr||Bw(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Wr)if(t===null)n.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:xa(e.type,t.memoizedProps);n.componentDidUpdate(r,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&fI(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}fI(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&w0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}Wr||e.flags&512&&AE(e)}catch(f){pi(e,e.return,f)}}if(e===i){pt=null;break}if(t=e.sibling,t!==null){t.return=e.return,pt=t;break}pt=e.return}}function RI(i){for(;pt!==null;){var e=pt;if(e===i){pt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,pt=t;break}pt=e.return}}function LI(i){for(;pt!==null;){var e=pt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Bw(4,e)}catch(l){pi(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){pi(e,r,l)}}var s=e.return;try{AE(e)}catch(l){pi(e,s,l)}break;case 5:var o=e.return;try{AE(e)}catch(l){pi(e,o,l)}}}catch(l){pi(e,e.return,l)}if(e===i){pt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pt=a;break}pt=e.return}}var Gse=Math.ceil,G_=ic.ReactCurrentDispatcher,HC=ic.ReactCurrentOwner,$o=ic.ReactCurrentBatchConfig,fn=0,dr=null,Bi=null,Er=0,so=0,Ud=_u(0),Qi=0,D0=null,tf=0,Hw=0,GC=0,jg=null,Ps=null,VC=0,Ip=1/0,Fl=null,V_=!1,RE=null,Jc=null,Cx=!1,Gc=null,W_=0,Xg=0,LE=null,x1=-1,_1=0;function ps(){return fn&6?Pi():x1!==-1?x1:x1=Pi()}function $c(i){return i.mode&1?fn&2&&Er!==0?Er&-Er:Tse.transition!==null?(_1===0&&(_1=H8()),_1):(i=Mn,i!==0||(i=window.event,i=i===void 0?16:q8(i.type)),i):1}function Aa(i,e,t,n){if(50<Xg)throw Xg=0,LE=null,Error(Ke(185));$0(i,t,n),(!(fn&2)||i!==dr)&&(i===dr&&(!(fn&2)&&(Hw|=t),Qi===4&&Fc(i,Er)),Hs(i,n),t===1&&fn===0&&!(e.mode&1)&&(Ip=Pi()+500,Nw&&wu()))}function Hs(i,e){var t=i.callbackNode;Tre(i,e);var n=A_(i,i===dr?Er:0);if(n===0)t!==null&&BD(t),i.callbackNode=null,i.callbackPriority=0;else if(e=n&-n,i.callbackPriority!==e){if(t!=null&&BD(t),e===1)i.tag===0?bse(DI.bind(null,i)):dH(DI.bind(null,i)),_se(function(){!(fn&6)&&wu()}),t=null;else{switch(G8(n)){case 1:t=mC;break;case 4:t=z8;break;case 16:t=E_;break;case 536870912:t=B8;break;default:t=E_}t=fG(t,sG.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function sG(i,e){if(x1=-1,_1=0,fn&6)throw Error(Ke(327));var t=i.callbackNode;if(Yd()&&i.callbackNode!==t)return null;var n=A_(i,i===dr?Er:0);if(n===0)return null;if(n&30||n&i.expiredLanes||e)e=j_(i,n);else{e=n;var r=fn;fn|=2;var s=aG();(dr!==i||Er!==e)&&(Fl=null,Ip=Pi()+500,Nh(i,e));do try{jse();break}catch(a){oG(i,a)}while(!0);CC(),G_.current=s,fn=r,Bi!==null?e=0:(dr=null,Er=0,e=Qi)}if(e!==0){if(e===2&&(r=rE(i),r!==0&&(n=r,e=DE(i,r))),e===1)throw t=D0,Nh(i,0),Fc(i,n),Hs(i,Pi()),t;if(e===6)Fc(i,n);else{if(r=i.current.alternate,!(n&30)&&!Vse(r)&&(e=j_(i,n),e===2&&(s=rE(i),s!==0&&(n=s,e=DE(i,s))),e===1))throw t=D0,Nh(i,0),Fc(i,n),Hs(i,Pi()),t;switch(i.finishedWork=r,i.finishedLanes=n,e){case 0:case 1:throw Error(Ke(345));case 2:ph(i,Ps,Fl);break;case 3:if(Fc(i,n),(n&130023424)===n&&(e=VC+500-Pi(),10<e)){if(A_(i,0)!==0)break;if(r=i.suspendedLanes,(r&n)!==n){ps(),i.pingedLanes|=i.suspendedLanes&r;break}i.timeoutHandle=fE(ph.bind(null,i,Ps,Fl),e);break}ph(i,Ps,Fl);break;case 4:if(Fc(i,n),(n&4194240)===n)break;for(e=i.eventTimes,r=-1;0<n;){var o=31-Ea(n);s=1<<o,o=e[o],o>r&&(r=o),n&=~s}if(n=r,n=Pi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Gse(n/1960))-n,10<n){i.timeoutHandle=fE(ph.bind(null,i,Ps,Fl),n);break}ph(i,Ps,Fl);break;case 5:ph(i,Ps,Fl);break;default:throw Error(Ke(329))}}}return Hs(i,Pi()),i.callbackNode===t?sG.bind(null,i):null}function DE(i,e){var t=jg;return i.current.memoizedState.isDehydrated&&(Nh(i,e).flags|=256),i=j_(i,e),i!==2&&(e=Ps,Ps=t,e!==null&&IE(e)),i}function IE(i){Ps===null?Ps=i:Ps.push.apply(Ps,i)}function Vse(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var r=t[n],s=r.getSnapshot;r=r.value;try{if(!Ra(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fc(i,e){for(e&=~GC,e&=~Hw,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Ea(e),n=1<<t;i[t]=-1,e&=~n}}function DI(i){if(fn&6)throw Error(Ke(327));Yd();var e=A_(i,0);if(!(e&1))return Hs(i,Pi()),null;var t=j_(i,e);if(i.tag!==0&&t===2){var n=rE(i);n!==0&&(e=n,t=DE(i,n))}if(t===1)throw t=D0,Nh(i,0),Fc(i,e),Hs(i,Pi()),t;if(t===6)throw Error(Ke(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,ph(i,Ps,Fl),Hs(i,Pi()),null}function WC(i,e){var t=fn;fn|=1;try{return i(e)}finally{fn=t,fn===0&&(Ip=Pi()+500,Nw&&wu())}}function nf(i){Gc!==null&&Gc.tag===0&&!(fn&6)&&Yd();var e=fn;fn|=1;var t=$o.transition,n=Mn;try{if($o.transition=null,Mn=1,i)return i()}finally{Mn=n,$o.transition=t,fn=e,!(fn&6)&&wu()}}function jC(){so=Ud.current,Wn(Ud)}function Nh(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,xse(t)),Bi!==null)for(t=Bi.return;t!==null;){var n=t;switch(TC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&D_();break;case 3:Lp(),Wn(zs),Wn(qr),UC();break;case 5:IC(n);break;case 4:Lp();break;case 13:Wn(ii);break;case 19:Wn(ii);break;case 10:PC(n.type._context);break;case 22:case 23:jC()}t=t.return}if(dr=i,Bi=i=eu(i.current,null),Er=so=e,Qi=0,D0=null,GC=Hw=tf=0,Ps=jg=null,Th!==null){for(e=0;e<Th.length;e++)if(t=Th[e],n=t.interleaved,n!==null){t.interleaved=null;var r=n.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}t.pending=n}Th=null}return i}function oG(i,e){do{var t=Bi;try{if(CC(),g1.current=H_,B_){for(var n=oi.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}B_=!1}if(ef=0,ur=Ki=oi=null,Vg=!1,P0=0,HC.current=null,t===null||t.return===null){Qi=1,D0=e,Bi=null;break}e:{var s=i,o=t.return,a=t,l=e;if(e=Er,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=xI(o);if(p!==null){p.flags&=-257,_I(p,o,a,s,e),p.mode&1&&yI(s,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var x=new Set;x.add(l),e.updateQueue=x}else v.add(l);break e}else{if(!(e&1)){yI(s,c,e),XC();break e}l=Error(Ke(426))}}else if(Qn&&a.mode&1){var y=xI(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),_I(y,o,a,s,e),EC(Dp(l,a));break e}}s=l=Dp(l,a),Qi!==4&&(Qi=2),jg===null?jg=[s]:jg.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=VH(s,l,e);hI(s,g);break e;case 1:a=l;var _=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Jc===null||!Jc.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=WH(s,a,e);hI(s,S);break e}}s=s.return}while(s!==null)}cG(t)}catch(C){e=C,Bi===t&&t!==null&&(Bi=t=t.return);continue}break}while(!0)}function aG(){var i=G_.current;return G_.current=H_,i===null?H_:i}function XC(){(Qi===0||Qi===3||Qi===2)&&(Qi=4),dr===null||!(tf&268435455)&&!(Hw&268435455)||Fc(dr,Er)}function j_(i,e){var t=fn;fn|=2;var n=aG();(dr!==i||Er!==e)&&(Fl=null,Nh(i,e));do try{Wse();break}catch(r){oG(i,r)}while(!0);if(CC(),fn=t,G_.current=n,Bi!==null)throw Error(Ke(261));return dr=null,Er=0,Qi}function Wse(){for(;Bi!==null;)lG(Bi)}function jse(){for(;Bi!==null&&!gre();)lG(Bi)}function lG(i){var e=hG(i.alternate,i,so);i.memoizedProps=i.pendingProps,e===null?cG(i):Bi=e,HC.current=null}function cG(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=Ose(t,e),t!==null){t.flags&=32767,Bi=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Qi=6,Bi=null;return}}else if(t=Nse(t,e,so),t!==null){Bi=t;return}if(e=e.sibling,e!==null){Bi=e;return}Bi=e=i}while(e!==null);Qi===0&&(Qi=5)}function ph(i,e,t){var n=Mn,r=$o.transition;try{$o.transition=null,Mn=1,Xse(i,e,t,n)}finally{$o.transition=r,Mn=n}return null}function Xse(i,e,t,n){do Yd();while(Gc!==null);if(fn&6)throw Error(Ke(327));t=i.finishedWork;var r=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(Ke(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(Ere(i,s),i===dr&&(Bi=dr=null,Er=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Cx||(Cx=!0,fG(E_,function(){return Yd(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=$o.transition,$o.transition=null;var o=Mn;Mn=1;var a=fn;fn|=4,HC.current=null,Bse(i,t),iG(t,i),fse(uE),C_=!!cE,uE=cE=null,i.current=t,Hse(t),vre(),fn=a,Mn=o,$o.transition=s}else i.current=t;if(Cx&&(Cx=!1,Gc=i,W_=r),s=i.pendingLanes,s===0&&(Jc=null),_re(t.stateNode),Hs(i,Pi()),e!==null)for(n=i.onRecoverableError,t=0;t<e.length;t++)r=e[t],n(r.value,{componentStack:r.stack,digest:r.digest});if(V_)throw V_=!1,i=RE,RE=null,i;return W_&1&&i.tag!==0&&Yd(),s=i.pendingLanes,s&1?i===LE?Xg++:(Xg=0,LE=i):Xg=0,wu(),null}function Yd(){if(Gc!==null){var i=G8(W_),e=$o.transition,t=Mn;try{if($o.transition=null,Mn=16>i?16:i,Gc===null)var n=!1;else{if(i=Gc,Gc=null,W_=0,fn&6)throw Error(Ke(331));var r=fn;for(fn|=4,pt=i.current;pt!==null;){var s=pt,o=s.child;if(pt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pt=c;pt!==null;){var u=pt;switch(u.tag){case 0:case 11:case 15:Wg(8,u,s)}var h=u.child;if(h!==null)h.return=u,pt=h;else for(;pt!==null;){u=pt;var f=u.sibling,p=u.return;if(eG(u),u===c){pt=null;break}if(f!==null){f.return=p,pt=f;break}pt=p}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}pt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pt=o;else e:for(;pt!==null;){if(s=pt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wg(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,pt=g;break e}pt=s.return}}var _=i.current;for(pt=_;pt!==null;){o=pt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,pt=w;else e:for(o=_;pt!==null;){if(a=pt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bw(9,a)}}catch(C){pi(a,a.return,C)}if(a===o){pt=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,pt=S;break e}pt=a.return}}if(fn=r,wu(),rl&&typeof rl.onPostCommitFiberRoot=="function")try{rl.onPostCommitFiberRoot(Dw,i)}catch{}n=!0}return n}finally{Mn=t,$o.transition=e}}return!1}function II(i,e,t){e=Dp(t,e),e=VH(i,e,1),i=Qc(i,e,1),e=ps(),i!==null&&($0(i,1,e),Hs(i,e))}function pi(i,e,t){if(i.tag===3)II(i,i,t);else for(;e!==null;){if(e.tag===3){II(e,i,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Jc===null||!Jc.has(n))){i=Dp(t,i),i=WH(e,i,1),e=Qc(e,i,1),i=ps(),e!==null&&($0(e,1,i),Hs(e,i));break}}e=e.return}}function Yse(i,e,t){var n=i.pingCache;n!==null&&n.delete(e),e=ps(),i.pingedLanes|=i.suspendedLanes&t,dr===i&&(Er&t)===t&&(Qi===4||Qi===3&&(Er&130023424)===Er&&500>Pi()-VC?Nh(i,0):GC|=t),Hs(i,e)}function uG(i,e){e===0&&(i.mode&1?(e=yx,yx<<=1,!(yx&130023424)&&(yx=4194304)):e=1);var t=ps();i=ec(i,e),i!==null&&($0(i,e,t),Hs(i,t))}function qse(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),uG(i,t)}function Kse(i,e){var t=0;switch(i.tag){case 13:var n=i.stateNode,r=i.memoizedState;r!==null&&(t=r.retryLane);break;case 19:n=i.stateNode;break;default:throw Error(Ke(314))}n!==null&&n.delete(e),uG(i,t)}var hG;hG=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||zs.current)Ds=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return Ds=!1,kse(i,e,t);Ds=!!(i.flags&131072)}else Ds=!1,Qn&&e.flags&1048576&&pH(e,F_,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;y1(i,e),i=e.pendingProps;var r=Cp(e,qr.current);Xd(e,t),r=kC(null,e,n,i,r,t);var s=NC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bs(n)?(s=!0,I_(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,LC(e),r.updater=Ow,e.stateNode=r,r._reactInternals=e,xE(e,n,i,t),e=SE(null,e,n,!0,s,t)):(e.tag=0,Qn&&s&&bC(e),us(null,e,r,t),e=e.child),e;case 16:n=e.elementType;e:{switch(y1(i,e),i=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=Qse(n),i=xa(n,i),r){case 0:e=wE(null,e,n,i,t);break e;case 1:e=MI(null,e,n,i,t);break e;case 11:e=wI(null,e,n,i,t);break e;case 14:e=SI(null,e,n,xa(n.type,i),t);break e}throw Error(Ke(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:xa(n,r),wE(i,e,n,r,t);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:xa(n,r),MI(i,e,n,r,t);case 3:e:{if(qH(e),i===null)throw Error(Ke(387));n=e.pendingProps,s=e.memoizedState,r=s.element,yH(i,e),O_(e,n,null,t);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Dp(Error(Ke(423)),e),e=bI(i,e,n,t,r);break e}else if(n!==r){r=Dp(Error(Ke(424)),e),e=bI(i,e,n,t,r);break e}else for(go=Zc(e.stateNode.containerInfo.firstChild),_o=e,Qn=!0,Sa=null,t=SH(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Pp(),n===r){e=tc(i,e,t);break e}us(i,e,n,t)}e=e.child}return e;case 5:return MH(e),i===null&&gE(e),n=e.type,r=e.pendingProps,s=i!==null?i.memoizedProps:null,o=r.children,hE(n,r)?o=null:s!==null&&hE(n,s)&&(e.flags|=32),YH(i,e),us(i,e,o,t),e.child;case 6:return i===null&&gE(e),null;case 13:return KH(i,e,t);case 4:return DC(e,e.stateNode.containerInfo),n=e.pendingProps,i===null?e.child=Rp(e,null,n,t):us(i,e,n,t),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:xa(n,r),wI(i,e,n,r,t);case 7:return us(i,e,e.pendingProps,t),e.child;case 8:return us(i,e,e.pendingProps.children,t),e.child;case 12:return us(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Hn(k_,n._currentValue),n._currentValue=o,s!==null)if(Ra(s.value,o)){if(s.children===r.children&&!zs.current){e=tc(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=jl(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),vE(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ke(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),vE(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}us(i,e,r.children,t),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,Xd(e,t),r=ra(r),n=n(r),e.flags|=1,us(i,e,n,t),e.child;case 14:return n=e.type,r=xa(n,e.pendingProps),r=xa(n.type,r),SI(i,e,n,r,t);case 15:return jH(i,e,e.type,e.pendingProps,t);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:xa(n,r),y1(i,e),e.tag=1,Bs(n)?(i=!0,I_(e)):i=!1,Xd(e,t),_H(e,n,r),xE(e,n,r,t),SE(null,e,n,!0,i,t);case 19:return ZH(i,e,t);case 22:return XH(i,e,t)}throw Error(Ke(156,e.tag))};function fG(i,e){return O8(i,e)}function Zse(i,e,t,n){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qo(i,e,t,n){return new Zse(i,e,t,n)}function YC(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Qse(i){if(typeof i=="function")return YC(i)?1:0;if(i!=null){if(i=i.$$typeof,i===fC)return 11;if(i===dC)return 14}return 2}function eu(i,e){var t=i.alternate;return t===null?(t=Qo(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function w1(i,e,t,n,r,s){var o=2;if(n=i,typeof i=="function")YC(i)&&(o=1);else if(typeof i=="string")o=5;else e:switch(i){case bd:return Oh(t.children,r,s,e);case hC:o=8,r|=8;break;case V2:return i=Qo(12,t,e,r|2),i.elementType=V2,i.lanes=s,i;case W2:return i=Qo(13,t,e,r),i.elementType=W2,i.lanes=s,i;case j2:return i=Qo(19,t,e,r),i.elementType=j2,i.lanes=s,i;case w8:return Gw(t,r,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case x8:o=10;break e;case _8:o=9;break e;case fC:o=11;break e;case dC:o=14;break e;case Rc:o=16,n=null;break e}throw Error(Ke(130,i==null?i:typeof i,""))}return e=Qo(o,t,e,r),e.elementType=i,e.type=n,e.lanes=s,e}function Oh(i,e,t,n){return i=Qo(7,i,n,e),i.lanes=t,i}function Gw(i,e,t,n){return i=Qo(22,i,n,e),i.elementType=w8,i.lanes=t,i.stateNode={isHidden:!1},i}function jb(i,e,t){return i=Qo(6,i,null,e),i.lanes=t,i}function Xb(i,e,t){return e=Qo(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function Jse(i,e,t,n,r){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eb(0),this.expirationTimes=Eb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eb(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function qC(i,e,t,n,r,s,o,a,l){return i=new Jse(i,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Qo(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},LC(s),i}function $se(i,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Md,key:n==null?null:""+n,children:i,containerInfo:e,implementation:t}}function dG(i){if(!i)return lu;i=i._reactInternals;e:{if(df(i)!==i||i.tag!==1)throw Error(Ke(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ke(171))}if(i.tag===1){var t=i.type;if(Bs(t))return fH(i,t,e)}return e}function pG(i,e,t,n,r,s,o,a,l){return i=qC(t,n,!0,i,r,s,o,a,l),i.context=dG(null),t=i.current,n=ps(),r=$c(t),s=jl(n,r),s.callback=e??null,Qc(t,s,r),i.current.lanes=r,$0(i,r,n),Hs(i,n),i}function Vw(i,e,t,n){var r=e.current,s=ps(),o=$c(r);return t=dG(t),e.context===null?e.context=t:e.pendingContext=t,e=jl(s,o),e.payload={element:i},n=n===void 0?null:n,n!==null&&(e.callback=n),i=Qc(r,e,o),i!==null&&(Aa(i,r,o,s),m1(i,r,o)),o}function X_(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function UI(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function KC(i,e){UI(i,e),(i=i.alternate)&&UI(i,e)}function eoe(){return null}var mG=typeof reportError=="function"?reportError:function(i){console.error(i)};function ZC(i){this._internalRoot=i}Ww.prototype.render=ZC.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(Ke(409));Vw(i,e,null,null)};Ww.prototype.unmount=ZC.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;nf(function(){Vw(null,i,null,null)}),e[$l]=null}};function Ww(i){this._internalRoot=i}Ww.prototype.unstable_scheduleHydration=function(i){if(i){var e=j8();i={blockedOn:null,target:i,priority:e};for(var t=0;t<Uc.length&&e!==0&&e<Uc[t].priority;t++);Uc.splice(t,0,i),t===0&&Y8(i)}};function QC(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function jw(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function FI(){}function toe(i,e,t,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var c=X_(o);s.call(c)}}var o=pG(e,n,i,0,null,!1,!1,"",FI);return i._reactRootContainer=o,i[$l]=o.current,b0(i.nodeType===8?i.parentNode:i),nf(),o}for(;r=i.lastChild;)i.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var c=X_(l);a.call(c)}}var l=qC(i,0,!1,null,null,!1,!1,"",FI);return i._reactRootContainer=l,i[$l]=l.current,b0(i.nodeType===8?i.parentNode:i),nf(function(){Vw(e,l,t,n)}),l}function Xw(i,e,t,n,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=X_(o);a.call(l)}}Vw(e,o,i,r)}else o=toe(t,e,i,r,n);return X_(o)}V8=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=wg(e.pendingLanes);t!==0&&(gC(e,t|1),Hs(e,Pi()),!(fn&6)&&(Ip=Pi()+500,wu()))}break;case 13:nf(function(){var n=ec(i,1);if(n!==null){var r=ps();Aa(n,i,1,r)}}),KC(i,1)}};vC=function(i){if(i.tag===13){var e=ec(i,134217728);if(e!==null){var t=ps();Aa(e,i,134217728,t)}KC(i,134217728)}};W8=function(i){if(i.tag===13){var e=$c(i),t=ec(i,e);if(t!==null){var n=ps();Aa(t,i,e,n)}KC(i,e)}};j8=function(){return Mn};X8=function(i,e){var t=Mn;try{return Mn=i,e()}finally{Mn=t}};tE=function(i,e,t){switch(e){case"input":if(q2(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==i&&n.form===i.form){var r=kw(n);if(!r)throw Error(Ke(90));M8(n),q2(n,r)}}}break;case"textarea":T8(i,t);break;case"select":e=t.value,e!=null&&Gd(i,!!t.multiple,e,!1)}};D8=WC;I8=nf;var noe={usingClientEntryPoint:!1,Events:[tv,Cd,kw,R8,L8,WC]},sg={findFiberByHostInstance:bh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ioe={bundleType:sg.bundleType,version:sg.version,rendererPackageName:sg.rendererPackageName,rendererConfig:sg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ic.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=k8(i),i===null?null:i.stateNode},findFiberByHostInstance:sg.findFiberByHostInstance||eoe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Px=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Px.isDisabled&&Px.supportsFiber)try{Dw=Px.inject(ioe),rl=Px}catch{}}To.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=noe;To.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!QC(e))throw Error(Ke(200));return $se(i,e,null,t)};To.createRoot=function(i,e){if(!QC(i))throw Error(Ke(299));var t=!1,n="",r=mG;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=qC(i,1,!1,null,null,t,!1,n,r),i[$l]=e.current,b0(i.nodeType===8?i.parentNode:i),new ZC(e)};To.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(Ke(188)):(i=Object.keys(i).join(","),Error(Ke(268,i)));return i=k8(e),i=i===null?null:i.stateNode,i};To.flushSync=function(i){return nf(i)};To.hydrate=function(i,e,t){if(!jw(e))throw Error(Ke(200));return Xw(null,i,e,!0,t)};To.hydrateRoot=function(i,e,t){if(!QC(i))throw Error(Ke(405));var n=t!=null&&t.hydratedSources||null,r=!1,s="",o=mG;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=pG(e,null,i,1,t??null,r,!1,s,o),i[$l]=e.current,b0(i),n)for(i=0;i<n.length;i++)t=n[i],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new Ww(e)};To.render=function(i,e,t){if(!jw(e))throw Error(Ke(200));return Xw(null,i,e,!1,t)};To.unmountComponentAtNode=function(i){if(!jw(i))throw Error(Ke(40));return i._reactRootContainer?(nf(function(){Xw(null,null,i,!1,function(){i._reactRootContainer=null,i[$l]=null})}),!0):!1};To.unstable_batchedUpdates=WC;To.unstable_renderSubtreeIntoContainer=function(i,e,t,n){if(!jw(t))throw Error(Ke(200));if(i==null||i._reactInternals===void 0)throw Error(Ke(38));return Xw(i,e,t,!1,n)};To.version="18.2.0-next-9e3b772b8-20220608";function gG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gG)}catch(i){console.error(i)}}gG(),p8.exports=To;var roe=p8.exports,iv,kI=roe;iv=kI.createRoot,kI.hydrateRoot;function soe({keyName:i,color:e,increment:t}){const[n,r]=re.useState(parseInt(window.localStorage.getItem(i)??0)),s=re.useRef(null);re.useEffect(()=>(s.current.style.textAlign="center",()=>{window.localStorage.removeItem(i)}),[]),re.useEffect(()=>{window.localStorage.setItem(i,n.toString())},[n]);const o=()=>{r(a=>a+1),t()};return ft.jsxs(ft.Fragment,{children:[ft.jsxs("div",{style:{margin:"2rem",color:e},children:["Clicks: ",n]}),ft.jsx("button",{ref:s,style:{padding:"1rem"},onClick:o,children:"Click me"})]})}function ooe(){const[i,e]=re.useState([]),t=()=>{fetch("https://jsonplaceholder.typicode.com/users").then(n=>n.json()).then(n=>e(n))};return re.useEffect(()=>{t()},[]),ft.jsxs("div",{style:{marginTop:"5rem"},children:[ft.jsx("h2",{style:{marginBottom:"1rem",textAlign:"center"},children:"People"}),ft.jsx("ul",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"90vw"},children:i.map((n,r)=>ft.jsx("li",{style:{listStyle:"none"},children:n.name},r))})]})}function aoe({counterCount:i,children:e}){const[t,n]=re.useState(!0),[r,s]=re.useState(0),o=()=>{n(c=>!c)},a=()=>{s(c=>c+1)},l=re.useMemo(()=>{const c=[];for(let u=0;u<i;u++)c.push(`hsl(${Math.random()*360}deg, 100%, 50%)`);return c},[i]);return ft.jsxs("div",{className:"app",children:[e,ft.jsxs("p",{style:{margin:"2rem",textTransform:"uppercase",fontWeight:"bold"},children:["Global clicks: ",r]}),ft.jsx("button",{style:{marginBottom:"2rem",padding:"1.5rem"},onClick:o,children:t?"Hide Clicker":"Show Clicker"}),t&&ft.jsx(ft.Fragment,{children:[...Array(i)].map((c,u)=>ft.jsx(soe,{keyName:`count${u}`,color:l[u],increment:a},u))}),ft.jsx(ooe,{})]})}let loe=class{init(e){iv(e).render(ft.jsx(aoe,{counterCount:2,children:ft.jsx("h1",{style:{textTransform:"uppercase"},children:"My First React App"})}))}},coe=class extends Tw{constructor(){super(...arguments);oe(this,"app");oe(this,"appElement")}get number(){return"54"}get title(){return"First React Application"}get link(){return"https://threejs-journey.com/lessons/first-react-application"}open(){this.appElement=document.createElement("div"),document.body.appendChild(this.appElement),this.app=new loe,this.app.init(this.appElement)}close(){document.body.removeChild(this.appElement)}};var vG={exports:{}},pf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */pf.ConcurrentRoot=1;pf.ContinuousEventPriority=4;pf.DefaultEventPriority=16;pf.DiscreteEventPriority=1;pf.IdleEventPriority=536870912;pf.LegacyRoot=0;vG.exports=pf;var Fd=vG.exports;function uoe(i){let e;const t=new Set,n=(c,u)=>{const h=typeof c=="function"?c(e):c;if(h!==e){const f=e;e=u?h:Object.assign({},e,h),t.forEach(p=>p(e,f))}},r=()=>e,s=(c,u=r,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let f=u(e);function p(){const v=u(e);if(!h(f,v)){const x=f;c(f=v,x)}}return t.add(p),()=>t.delete(p)},l={setState:n,getState:r,subscribe:(c,u,h)=>u||h?s(c,u,h):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=i(n,r,l),l}const hoe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),NI=hoe?re.useEffect:re.useLayoutEffect;function foe(i){const e=typeof i=="function"?uoe(i):i,t=(n=e.getState,r=Object.is)=>{const[,s]=re.useReducer(y=>y+1,0),o=e.getState(),a=re.useRef(o),l=re.useRef(n),c=re.useRef(r),u=re.useRef(!1),h=re.useRef();h.current===void 0&&(h.current=n(o));let f,p=!1;(a.current!==o||l.current!==n||c.current!==r||u.current)&&(f=n(o),p=!r(h.current,f)),NI(()=>{p&&(h.current=f),a.current=o,l.current=n,c.current=r,u.current=!1});const v=re.useRef(o);NI(()=>{const y=()=>{try{const _=e.getState(),w=l.current(_);c.current(h.current,w)||(a.current=_,h.current=w,s())}catch{u.current=!0,s()}},g=e.subscribe(y);return e.getState()!==v.current&&y(),g},[]);const x=p?f:h.current;return re.useDebugValue(x),x};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const r=n.length<=0;return{value:n.shift(),done:r}}}},t}var yG={exports:{}},Yb={exports:{}},qb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OI;function doe(){return OI||(OI=1,function(i){function e(U,X){var j=U.length;U.push(X);e:for(;0<j;){var B=j-1>>>1,Z=U[B];if(0<r(Z,X))U[B]=X,U[j]=Z,j=B;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],j=U.pop();if(j!==X){U[0]=j;e:for(var B=0,Z=U.length,ie=Z>>>1;B<ie;){var V=2*(B+1)-1,te=U[V],fe=V+1,he=U[fe];if(0>r(te,j))fe<Z&&0>r(he,te)?(U[B]=he,U[fe]=j,B=fe):(U[B]=te,U[V]=j,B=V);else if(fe<Z&&0>r(he,j))U[B]=he,U[fe]=j,B=fe;else break e}}return X}function r(U,X){var j=U.sortIndex-X.sortIndex;return j!==0?j:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function S(U){if(x=!1,w(U),!v)if(t(l)!==null)v=!0,H(C);else{var X=t(c);X!==null&&$(S,X.startTime-U)}}function C(U,X){v=!1,x&&(x=!1,g(T),T=-1),p=!0;var j=f;try{for(w(X),h=t(l);h!==null&&(!(h.expirationTime>X)||U&&!R());){var B=h.callback;if(typeof B=="function"){h.callback=null,f=h.priorityLevel;var Z=B(h.expirationTime<=X);X=i.unstable_now(),typeof Z=="function"?h.callback=Z:h===t(l)&&n(l),w(X)}else n(l);h=t(l)}if(h!==null)var ie=!0;else{var V=t(c);V!==null&&$(S,V.startTime-X),ie=!1}return ie}finally{h=null,f=j,p=!1}}var E=!1,A=null,T=-1,L=5,M=-1;function R(){return!(i.unstable_now()-M<L)}function D(){if(A!==null){var U=i.unstable_now();M=U;var X=!0;try{X=A(!0,U)}finally{X?F():(E=!1,A=null)}}else E=!1}var F;if(typeof _=="function")F=function(){_(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,q=z.port2;z.port1.onmessage=D,F=function(){q.postMessage(null)}}else F=function(){y(D,0)};function H(U){A=U,E||(E=!0,F())}function $(U,X){T=y(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){v||p||(v=!0,H(C))},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return f},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var j=f;f=X;try{return U()}finally{f=j}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=f;f=U;try{return X()}finally{f=j}},i.unstable_scheduleCallback=function(U,X,j){var B=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?B+j:B):j=B,U){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=j+Z,U={id:u++,callback:X,priorityLevel:U,startTime:j,expirationTime:Z,sortIndex:-1},j>B?(U.sortIndex=j,e(c,U),t(l)===null&&U===t(c)&&(x?(g(T),T=-1):x=!0,$(S,j-B))):(U.sortIndex=Z,e(l,U),v||p||(v=!0,H(C))),U},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(U){var X=f;return function(){var j=f;f=X;try{return U.apply(this,arguments)}finally{f=j}}}}(qb)),qb}var zI;function poe(){return zI||(zI=1,Yb.exports=doe()),Yb.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var moe=function(e){var t={},n=re,r=poe(),s=Object.assign;function o(d){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+d,b=1;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),v=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),C=Symbol.iterator;function E(d){return d===null||typeof d!="object"?null:(d=C&&d[C]||d["@@iterator"],typeof d=="function"?d:null)}function A(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case u:return"Fragment";case c:return"Portal";case f:return"Profiler";case h:return"StrictMode";case y:return"Suspense";case g:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case v:return(d.displayName||"Context")+".Consumer";case p:return(d._context.displayName||"Context")+".Provider";case x:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case _:return m=d.displayName||null,m!==null?m:A(d.type)||"Memo";case w:m=d._payload,d=d._init;try{return A(d(m))}catch{}}return null}function T(d){var m=d.type;switch(d.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=m.render,d=d.displayName||d.name||"",m.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(m);case 8:return m===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function L(d){var m=d,b=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,m.flags&4098&&(b=m.return),d=m.return;while(d)}return m.tag===3?b:null}function M(d){if(L(d)!==d)throw Error(o(188))}function R(d){var m=d.alternate;if(!m){if(m=L(d),m===null)throw Error(o(188));return m!==d?null:d}for(var b=d,P=m;;){var I=b.return;if(I===null)break;var O=I.alternate;if(O===null){if(P=I.return,P!==null){b=P;continue}break}if(I.child===O.child){for(O=I.child;O;){if(O===b)return M(I),d;if(O===P)return M(I),m;O=O.sibling}throw Error(o(188))}if(b.return!==P.return)b=I,P=O;else{for(var se=!1,ye=I.child;ye;){if(ye===b){se=!0,b=I,P=O;break}if(ye===P){se=!0,P=I,b=O;break}ye=ye.sibling}if(!se){for(ye=O.child;ye;){if(ye===b){se=!0,b=O,P=I;break}if(ye===P){se=!0,P=O,b=I;break}ye=ye.sibling}if(!se)throw Error(o(189))}}if(b.alternate!==P)throw Error(o(190))}if(b.tag!==3)throw Error(o(188));return b.stateNode.current===b?d:m}function D(d){return d=R(d),d!==null?F(d):null}function F(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var m=F(d);if(m!==null)return m;d=d.sibling}return null}function z(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){if(d.tag!==4){var m=z(d);if(m!==null)return m}d=d.sibling}return null}var q=Array.isArray,H=e.getPublicInstance,$=e.getRootHostContext,U=e.getChildHostContext,X=e.prepareForCommit,j=e.resetAfterCommit,B=e.createInstance,Z=e.appendInitialChild,ie=e.finalizeInitialChildren,V=e.prepareUpdate,te=e.shouldSetTextContent,fe=e.createTextInstance,he=e.scheduleTimeout,le=e.cancelTimeout,G=e.noTimeout,Q=e.isPrimaryRenderer,J=e.supportsMutation,ne=e.supportsPersistence,Y=e.supportsHydration,de=e.getInstanceFromNode,ve=e.preparePortalMount,Se=e.getCurrentEventPriority,Te=e.detachDeletedInstance,Ee=e.supportsMicrotasks,Re=e.scheduleMicrotask,K=e.supportsTestSelectors,k=e.findFiberRoot,ue=e.getBoundingRect,me=e.getTextContent,Me=e.isHiddenSubtree,ge=e.matchAccessibilityRole,Ye=e.setFocusIfFocusable,Ie=e.setupIntersectionObserver,ze=e.appendChild,Je=e.appendChildToContainer,Fe=e.commitTextUpdate,Xe=e.commitMount,ct=e.commitUpdate,tt=e.insertBefore,Ve=e.insertInContainerBefore,qe=e.removeChild,ce=e.removeChildFromContainer,ke=e.resetTextContent,ae=e.hideInstance,Be=e.hideTextInstance,pe=e.unhideInstance,De=e.unhideTextInstance,$e=e.clearContainer,je=e.cloneInstance,rt=e.createContainerChildSet,bt=e.appendChildToContainerChildSet,Ct=e.finalizeContainerChildren,nt=e.replaceContainerChildren,Lt=e.cloneHiddenInstance,ln=e.cloneHiddenTextInstance,Fn=e.canHydrateInstance,qn=e.canHydrateTextInstance,wi=e.canHydrateSuspenseInstance,Jr=e.isSuspenseInstancePending,Ir=e.isSuspenseInstanceFallback,Ks=e.registerSuspenseInstanceRetry,rr=e.getNextHydratableSibling,_s=e.getFirstHydratableChild,ci=e.getFirstHydratableChildWithinContainer,Ao=e.getFirstHydratableChildWithinSuspenseInstance,Su=e.hydrateInstance,Mu=e.hydrateTextInstance,nm=e.hydrateSuspenseInstance,mf=e.getNextHydratableInstanceAfterSuspenseInstance,ee=e.commitHydratedContainer,xe=e.commitHydratedSuspenseInstance,Pe=e.clearSuspenseBoundary,Le=e.clearSuspenseBoundaryFromContainer,_e=e.shouldDeleteUnhydratedTailInstances,Qe=e.didNotMatchHydratedContainerTextInstance,ot=e.didNotMatchHydratedTextInstance,He;function ht(d){if(He===void 0)try{throw Error()}catch(b){var m=b.stack.trim().match(/\n( *(at )?)/);He=m&&m[1]||""}return`
`+He+d}var Tt=!1;function St(d,m){if(!d||Tt)return"";Tt=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(et){var P=et}Reflect.construct(d,[],m)}else{try{m.call()}catch(et){P=et}d.call(m.prototype)}else{try{throw Error()}catch(et){P=et}d()}}catch(et){if(et&&P&&typeof et.stack=="string"){for(var I=et.stack.split(`
`),O=P.stack.split(`
`),se=I.length-1,ye=O.length-1;1<=se&&0<=ye&&I[se]!==O[ye];)ye--;for(;1<=se&&0<=ye;se--,ye--)if(I[se]!==O[ye]){if(se!==1||ye!==1)do if(se--,ye--,0>ye||I[se]!==O[ye]){var Ne=`
`+I[se].replace(" at new "," at ");return d.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",d.displayName)),Ne}while(1<=se&&0<=ye);break}}}finally{Tt=!1,Error.prepareStackTrace=b}return(d=d?d.displayName||d.name:"")?ht(d):""}var vt=Object.prototype.hasOwnProperty,nn=[],rn=-1;function sn(d){return{current:d}}function kt(d){0>rn||(d.current=nn[rn],nn[rn]=null,rn--)}function xt(d,m){rn++,nn[rn]=d.current,d.current=m}var dt={},$t=sn(dt),Rt=sn(!1),ui=dt;function Xi(d,m){var b=d.type.contextTypes;if(!b)return dt;var P=d.stateNode;if(P&&P.__reactInternalMemoizedUnmaskedChildContext===m)return P.__reactInternalMemoizedMaskedChildContext;var I={},O;for(O in b)I[O]=m[O];return P&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=m,d.__reactInternalMemoizedMaskedChildContext=I),I}function dn(d){return d=d.childContextTypes,d!=null}function $r(){kt(Rt),kt($t)}function bn(d,m,b){if($t.current!==dt)throw Error(o(168));xt($t,m),xt(Rt,b)}function es(d,m,b){var P=d.stateNode;if(m=m.childContextTypes,typeof P.getChildContext!="function")return b;P=P.getChildContext();for(var I in P)if(!(I in m))throw Error(o(108,T(d)||"Unknown",I));return s({},b,P)}function Co(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||dt,ui=$t.current,xt($t,d),xt(Rt,Rt.current),!0}function kn(d,m,b){var P=d.stateNode;if(!P)throw Error(o(169));b?(d=es(d,m,ui),P.__reactInternalMemoizedMergedChildContext=d,kt(Rt),kt($t),xt($t,d)):kt(Rt),xt(Rt,b)}var yr=Math.clz32?Math.clz32:lv,rc=Math.log,Ua=Math.LN2;function lv(d){return d>>>=0,d===0?32:31-(rc(d)/Ua|0)|0}var dl=64,pl=4194304;function ml(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function bu(d,m){var b=d.pendingLanes;if(b===0)return 0;var P=0,I=d.suspendedLanes,O=d.pingedLanes,se=b&268435455;if(se!==0){var ye=se&~I;ye!==0?P=ml(ye):(O&=se,O!==0&&(P=ml(O)))}else se=b&~I,se!==0?P=ml(se):O!==0&&(P=ml(O));if(P===0)return 0;if(m!==0&&m!==P&&!(m&I)&&(I=P&-P,O=m&-m,I>=O||I===16&&(O&4194240)!==0))return m;if(P&4&&(P|=b&16),m=d.entangledLanes,m!==0)for(d=d.entanglements,m&=P;0<m;)b=31-yr(m),I=1<<b,P|=d[b],m&=~I;return P}function cv(d,m){switch(d){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function im(d,m){for(var b=d.suspendedLanes,P=d.pingedLanes,I=d.expirationTimes,O=d.pendingLanes;0<O;){var se=31-yr(O),ye=1<<se,Ne=I[se];Ne===-1?(!(ye&b)||ye&P)&&(I[se]=cv(ye,m)):Ne<=m&&(d.expiredLanes|=ye),O&=~ye}}function gl(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function gf(d){for(var m=[],b=0;31>b;b++)m.push(d);return m}function Fa(d,m,b){d.pendingLanes|=m,m!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,m=31-yr(m),d[m]=b}function sc(d,m){var b=d.pendingLanes&~m;d.pendingLanes=m,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=m,d.mutableReadLanes&=m,d.entangledLanes&=m,m=d.entanglements;var P=d.eventTimes;for(d=d.expirationTimes;0<b;){var I=31-yr(b),O=1<<I;m[I]=0,P[I]=-1,d[I]=-1,b&=~O}}function ka(d,m){var b=d.entangledLanes|=m;for(d=d.entanglements;b;){var P=31-yr(b),I=1<<P;I&m|d[P]&m&&(d[P]|=m),b&=~I}}var Jt=0;function rm(d){return d&=-d,1<d?4<d?d&268435455?16:536870912:4:1}var vl=r.unstable_scheduleCallback,vf=r.unstable_cancelCallback,sm=r.unstable_shouldYield,uv=r.unstable_requestPaint,ei=r.unstable_now,Tu=r.unstable_ImmediatePriority,hv=r.unstable_UserBlockingPriority,ts=r.unstable_NormalPriority,om=r.unstable_IdlePriority,Eu=null,Zs=null;function am(d){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(Eu,d,void 0,(d.current.flags&128)===128)}catch{}}function fv(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var Qs=typeof Object.is=="function"?Object.is:fv,ns=null,Na=!1,Po=!1;function lm(d){ns===null?ns=[d]:ns.push(d)}function cm(d){Na=!0,lm(d)}function ws(){if(!Po&&ns!==null){Po=!0;var d=0,m=Jt;try{var b=ns;for(Jt=1;d<b.length;d++){var P=b[d];do P=P(!0);while(P!==null)}ns=null,Na=!1}catch(I){throw ns!==null&&(ns=ns.slice(d+1)),vl(Tu,ws),I}finally{Jt=m,Po=!1}}return null}var Au=a.ReactCurrentBatchConfig;function Cu(d,m){if(Qs(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var b=Object.keys(d),P=Object.keys(m);if(b.length!==P.length)return!1;for(P=0;P<b.length;P++){var I=b[P];if(!vt.call(m,I)||!Qs(d[I],m[I]))return!1}return!0}function Pu(d){switch(d.tag){case 5:return ht(d.type);case 16:return ht("Lazy");case 13:return ht("Suspense");case 19:return ht("SuspenseList");case 0:case 2:case 15:return d=St(d.type,!1),d;case 11:return d=St(d.type.render,!1),d;case 1:return d=St(d.type,!0),d;default:return""}}function is(d,m){if(d&&d.defaultProps){m=s({},m),d=d.defaultProps;for(var b in d)m[b]===void 0&&(m[b]=d[b]);return m}return m}var sr=sn(null),yf=null,ua=null,oc=null;function xf(){oc=ua=yf=null}function dv(d,m,b){Q?(xt(sr,m._currentValue),m._currentValue=b):(xt(sr,m._currentValue2),m._currentValue2=b)}function or(d){var m=sr.current;kt(sr),Q?d._currentValue=m:d._currentValue2=m}function rs(d,m,b){for(;d!==null;){var P=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,P!==null&&(P.childLanes|=m)):P!==null&&(P.childLanes&m)!==m&&(P.childLanes|=m),d===b)break;d=d.return}}function Si(d,m){yf=d,oc=ua=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.lanes&m&&(to=!0),d.firstContext=null)}function Mi(d){var m=Q?d._currentValue:d._currentValue2;if(oc!==d)if(d={context:d,memoizedValue:m,next:null},ua===null){if(yf===null)throw Error(o(308));ua=d,yf.dependencies={lanes:0,firstContext:d}}else ua=ua.next=d;return m}var Js=null,ac=!1;function qw(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sP(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function yl(d,m){return{eventTime:d,lane:m,tag:0,payload:null,callback:null,next:null}}function lc(d,m){var b=d.updateQueue;b!==null&&(b=b.shared,ki!==null&&d.mode&1&&!(Zt&2)?(d=b.interleaved,d===null?(m.next=m,Js===null?Js=[b]:Js.push(b)):(m.next=d.next,d.next=m),b.interleaved=m):(d=b.pending,d===null?m.next=m:(m.next=d.next,d.next=m),b.pending=m))}function pv(d,m,b){if(m=m.updateQueue,m!==null&&(m=m.shared,(b&4194240)!==0)){var P=m.lanes;P&=d.pendingLanes,b|=P,m.lanes=b,ka(d,b)}}function oP(d,m){var b=d.updateQueue,P=d.alternate;if(P!==null&&(P=P.updateQueue,b===P)){var I=null,O=null;if(b=b.firstBaseUpdate,b!==null){do{var se={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};O===null?I=O=se:O=O.next=se,b=b.next}while(b!==null);O===null?I=O=m:O=O.next=m}else I=O=m;b={baseState:P.baseState,firstBaseUpdate:I,lastBaseUpdate:O,shared:P.shared,effects:P.effects},d.updateQueue=b;return}d=b.lastBaseUpdate,d===null?b.firstBaseUpdate=m:d.next=m,b.lastBaseUpdate=m}function mv(d,m,b,P){var I=d.updateQueue;ac=!1;var O=I.firstBaseUpdate,se=I.lastBaseUpdate,ye=I.shared.pending;if(ye!==null){I.shared.pending=null;var Ne=ye,et=Ne.next;Ne.next=null,se===null?O=et:se.next=et,se=Ne;var mt=d.alternate;mt!==null&&(mt=mt.updateQueue,ye=mt.lastBaseUpdate,ye!==se&&(ye===null?mt.firstBaseUpdate=et:ye.next=et,mt.lastBaseUpdate=Ne))}if(O!==null){var Bt=I.baseState;se=0,mt=et=Ne=null,ye=O;do{var Et=ye.lane,Rn=ye.eventTime;if((P&Et)===Et){mt!==null&&(mt=mt.next={eventTime:Rn,lane:0,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null});e:{var Mt=d,Nr=ye;switch(Et=m,Rn=b,Nr.tag){case 1:if(Mt=Nr.payload,typeof Mt=="function"){Bt=Mt.call(Rn,Bt,Et);break e}Bt=Mt;break e;case 3:Mt.flags=Mt.flags&-65537|128;case 0:if(Mt=Nr.payload,Et=typeof Mt=="function"?Mt.call(Rn,Bt,Et):Mt,Et==null)break e;Bt=s({},Bt,Et);break e;case 2:ac=!0}}ye.callback!==null&&ye.lane!==0&&(d.flags|=64,Et=I.effects,Et===null?I.effects=[ye]:Et.push(ye))}else Rn={eventTime:Rn,lane:Et,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},mt===null?(et=mt=Rn,Ne=Bt):mt=mt.next=Rn,se|=Et;if(ye=ye.next,ye===null){if(ye=I.shared.pending,ye===null)break;Et=ye,ye=Et.next,Et.next=null,I.lastBaseUpdate=Et,I.shared.pending=null}}while(!0);if(mt===null&&(Ne=Bt),I.baseState=Ne,I.firstBaseUpdate=et,I.lastBaseUpdate=mt,m=I.shared.interleaved,m!==null){I=m;do se|=I.lane,I=I.next;while(I!==m)}else O===null&&(I.shared.lanes=0);Cf|=se,d.lanes=se,d.memoizedState=Bt}}function aP(d,m,b){if(d=m.effects,m.effects=null,d!==null)for(m=0;m<d.length;m++){var P=d[m],I=P.callback;if(I!==null){if(P.callback=null,P=b,typeof I!="function")throw Error(o(191,I));I.call(P)}}}var lP=new n.Component().refs;function Kw(d,m,b,P){m=d.memoizedState,b=b(P,m),b=b==null?m:s({},m,b),d.memoizedState=b,d.lanes===0&&(d.updateQueue.baseState=b)}var gv={isMounted:function(d){return(d=d._reactInternals)?L(d)===d:!1},enqueueSetState:function(d,m,b){d=d._reactInternals;var P=os(),I=hc(d),O=yl(P,I);O.payload=m,b!=null&&(O.callback=b),lc(d,O),m=Uo(d,I,P),m!==null&&pv(m,d,I)},enqueueReplaceState:function(d,m,b){d=d._reactInternals;var P=os(),I=hc(d),O=yl(P,I);O.tag=1,O.payload=m,b!=null&&(O.callback=b),lc(d,O),m=Uo(d,I,P),m!==null&&pv(m,d,I)},enqueueForceUpdate:function(d,m){d=d._reactInternals;var b=os(),P=hc(d),I=yl(b,P);I.tag=2,m!=null&&(I.callback=m),lc(d,I),m=Uo(d,P,b),m!==null&&pv(m,d,P)}};function cP(d,m,b,P,I,O,se){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(P,O,se):m.prototype&&m.prototype.isPureReactComponent?!Cu(b,P)||!Cu(I,O):!0}function uP(d,m,b){var P=!1,I=dt,O=m.contextType;return typeof O=="object"&&O!==null?O=Mi(O):(I=dn(m)?ui:$t.current,P=m.contextTypes,O=(P=P!=null)?Xi(d,I):dt),m=new m(b,O),d.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=gv,d.stateNode=m,m._reactInternals=d,P&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=I,d.__reactInternalMemoizedMaskedChildContext=O),m}function hP(d,m,b,P){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(b,P),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(b,P),m.state!==d&&gv.enqueueReplaceState(m,m.state,null)}function Zw(d,m,b,P){var I=d.stateNode;I.props=b,I.state=d.memoizedState,I.refs=lP,qw(d);var O=m.contextType;typeof O=="object"&&O!==null?I.context=Mi(O):(O=dn(m)?ui:$t.current,I.context=Xi(d,O)),I.state=d.memoizedState,O=m.getDerivedStateFromProps,typeof O=="function"&&(Kw(d,m,O,b),I.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(m=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),m!==I.state&&gv.enqueueReplaceState(I,I.state,null),mv(d,b,I,P),I.state=d.memoizedState),typeof I.componentDidMount=="function"&&(d.flags|=4194308)}var _f=[],wf=0,vv=null,yv=0,Ro=[],Lo=0,Ru=null,xl=1,_l="";function Lu(d,m){_f[wf++]=yv,_f[wf++]=vv,vv=d,yv=m}function fP(d,m,b){Ro[Lo++]=xl,Ro[Lo++]=_l,Ro[Lo++]=Ru,Ru=d;var P=xl;d=_l;var I=32-yr(P)-1;P&=~(1<<I),b+=1;var O=32-yr(m)+I;if(30<O){var se=I-I%5;O=(P&(1<<se)-1).toString(32),P>>=se,I-=se,xl=1<<32-yr(m)+I|b<<I|P,_l=O+d}else xl=1<<O|b<<I|P,_l=d}function Qw(d){d.return!==null&&(Lu(d,1),fP(d,1,0))}function Jw(d){for(;d===vv;)vv=_f[--wf],_f[wf]=null,yv=_f[--wf],_f[wf]=null;for(;d===Ru;)Ru=Ro[--Lo],Ro[Lo]=null,_l=Ro[--Lo],Ro[Lo]=null,xl=Ro[--Lo],Ro[Lo]=null}var $s=null,eo=null,Kn=!1,um=!1,ha=null;function dP(d,m){var b=Fo(5,null,null,0);b.elementType="DELETED",b.stateNode=m,b.return=d,m=d.deletions,m===null?(d.deletions=[b],d.flags|=16):m.push(b)}function pP(d,m){switch(d.tag){case 5:return m=Fn(m,d.type,d.pendingProps),m!==null?(d.stateNode=m,$s=d,eo=_s(m),!0):!1;case 6:return m=qn(m,d.pendingProps),m!==null?(d.stateNode=m,$s=d,eo=null,!0):!1;case 13:if(m=wi(m),m!==null){var b=Ru!==null?{id:xl,overflow:_l}:null;return d.memoizedState={dehydrated:m,treeContext:b,retryLane:1073741824},b=Fo(18,null,null,0),b.stateNode=m,b.return=d,d.child=b,$s=d,eo=null,!0}return!1;default:return!1}}function $w(d){return(d.mode&1)!==0&&(d.flags&128)===0}function eS(d){if(Kn){var m=eo;if(m){var b=m;if(!pP(d,m)){if($w(d))throw Error(o(418));m=rr(b);var P=$s;m&&pP(d,m)?dP(P,b):(d.flags=d.flags&-4097|2,Kn=!1,$s=d)}}else{if($w(d))throw Error(o(418));d.flags=d.flags&-4097|2,Kn=!1,$s=d}}}function mP(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;$s=d}function hm(d){if(!Y||d!==$s)return!1;if(!Kn)return mP(d),Kn=!0,!1;if(d.tag!==3&&(d.tag!==5||_e(d.type)&&!te(d.type,d.memoizedProps))){var m=eo;if(m){if($w(d)){for(d=eo;d;)d=rr(d);throw Error(o(418))}for(;m;)dP(d,m),m=rr(m)}}if(mP(d),d.tag===13){if(!Y)throw Error(o(316));if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(o(317));eo=mf(d)}else eo=$s?rr(d.stateNode):null;return!0}function Sf(){Y&&(eo=$s=null,um=Kn=!1)}function tS(d){ha===null?ha=[d]:ha.push(d)}function fm(d,m,b){if(d=b.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(o(309));var P=b.stateNode}if(!P)throw Error(o(147,d));var I=P,O=""+d;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===O?m.ref:(m=function(se){var ye=I.refs;ye===lP&&(ye=I.refs={}),se===null?delete ye[O]:ye[O]=se},m._stringRef=O,m)}if(typeof d!="string")throw Error(o(284));if(!b._owner)throw Error(o(290,d))}return d}function xv(d,m){throw d=Object.prototype.toString.call(m),Error(o(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d))}function gP(d){var m=d._init;return m(d._payload)}function vP(d){function m(Ce,we){if(d){var Ue=Ce.deletions;Ue===null?(Ce.deletions=[we],Ce.flags|=16):Ue.push(we)}}function b(Ce,we){if(!d)return null;for(;we!==null;)m(Ce,we),we=we.sibling;return null}function P(Ce,we){for(Ce=new Map;we!==null;)we.key!==null?Ce.set(we.key,we):Ce.set(we.index,we),we=we.sibling;return Ce}function I(Ce,we){return Ce=dc(Ce,we),Ce.index=0,Ce.sibling=null,Ce}function O(Ce,we,Ue){return Ce.index=Ue,d?(Ue=Ce.alternate,Ue!==null?(Ue=Ue.index,Ue<we?(Ce.flags|=2,we):Ue):(Ce.flags|=2,we)):(Ce.flags|=1048576,we)}function se(Ce){return d&&Ce.alternate===null&&(Ce.flags|=2),Ce}function ye(Ce,we,Ue,ut){return we===null||we.tag!==6?(we=OS(Ue,Ce.mode,ut),we.return=Ce,we):(we=I(we,Ue),we.return=Ce,we)}function Ne(Ce,we,Ue,ut){var _t=Ue.type;return _t===u?mt(Ce,we,Ue.props.children,ut,Ue.key):we!==null&&(we.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===w&&gP(_t)===we.type)?(ut=I(we,Ue.props),ut.ref=fm(Ce,we,Ue),ut.return=Ce,ut):(ut=Zv(Ue.type,Ue.key,Ue.props,null,Ce.mode,ut),ut.ref=fm(Ce,we,Ue),ut.return=Ce,ut)}function et(Ce,we,Ue,ut){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ue.containerInfo||we.stateNode.implementation!==Ue.implementation?(we=zS(Ue,Ce.mode,ut),we.return=Ce,we):(we=I(we,Ue.children||[]),we.return=Ce,we)}function mt(Ce,we,Ue,ut,_t){return we===null||we.tag!==7?(we=Ou(Ue,Ce.mode,ut,_t),we.return=Ce,we):(we=I(we,Ue),we.return=Ce,we)}function Bt(Ce,we,Ue){if(typeof we=="string"&&we!==""||typeof we=="number")return we=OS(""+we,Ce.mode,Ue),we.return=Ce,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case l:return Ue=Zv(we.type,we.key,we.props,null,Ce.mode,Ue),Ue.ref=fm(Ce,null,we),Ue.return=Ce,Ue;case c:return we=zS(we,Ce.mode,Ue),we.return=Ce,we;case w:var ut=we._init;return Bt(Ce,ut(we._payload),Ue)}if(q(we)||E(we))return we=Ou(we,Ce.mode,Ue,null),we.return=Ce,we;xv(Ce,we)}return null}function Et(Ce,we,Ue,ut){var _t=we!==null?we.key:null;if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return _t!==null?null:ye(Ce,we,""+Ue,ut);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case l:return Ue.key===_t?Ne(Ce,we,Ue,ut):null;case c:return Ue.key===_t?et(Ce,we,Ue,ut):null;case w:return _t=Ue._init,Et(Ce,we,_t(Ue._payload),ut)}if(q(Ue)||E(Ue))return _t!==null?null:mt(Ce,we,Ue,ut,null);xv(Ce,Ue)}return null}function Rn(Ce,we,Ue,ut,_t){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return Ce=Ce.get(Ue)||null,ye(we,Ce,""+ut,_t);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case l:return Ce=Ce.get(ut.key===null?Ue:ut.key)||null,Ne(we,Ce,ut,_t);case c:return Ce=Ce.get(ut.key===null?Ue:ut.key)||null,et(we,Ce,ut,_t);case w:var qt=ut._init;return Rn(Ce,we,Ue,qt(ut._payload),_t)}if(q(ut)||E(ut))return Ce=Ce.get(Ue)||null,mt(we,Ce,ut,_t,null);xv(we,ut)}return null}function Mt(Ce,we,Ue,ut){for(var _t=null,qt=null,Ht=we,pn=we=0,lr=null;Ht!==null&&pn<Ue.length;pn++){Ht.index>pn?(lr=Ht,Ht=null):lr=Ht.sibling;var mn=Et(Ce,Ht,Ue[pn],ut);if(mn===null){Ht===null&&(Ht=lr);break}d&&Ht&&mn.alternate===null&&m(Ce,Ht),we=O(mn,we,pn),qt===null?_t=mn:qt.sibling=mn,qt=mn,Ht=lr}if(pn===Ue.length)return b(Ce,Ht),Kn&&Lu(Ce,pn),_t;if(Ht===null){for(;pn<Ue.length;pn++)Ht=Bt(Ce,Ue[pn],ut),Ht!==null&&(we=O(Ht,we,pn),qt===null?_t=Ht:qt.sibling=Ht,qt=Ht);return Kn&&Lu(Ce,pn),_t}for(Ht=P(Ce,Ht);pn<Ue.length;pn++)lr=Rn(Ht,Ce,pn,Ue[pn],ut),lr!==null&&(d&&lr.alternate!==null&&Ht.delete(lr.key===null?pn:lr.key),we=O(lr,we,pn),qt===null?_t=lr:qt.sibling=lr,qt=lr);return d&&Ht.forEach(function(pc){return m(Ce,pc)}),Kn&&Lu(Ce,pn),_t}function Nr(Ce,we,Ue,ut){var _t=E(Ue);if(typeof _t!="function")throw Error(o(150));if(Ue=_t.call(Ue),Ue==null)throw Error(o(151));for(var qt=_t=null,Ht=we,pn=we=0,lr=null,mn=Ue.next();Ht!==null&&!mn.done;pn++,mn=Ue.next()){Ht.index>pn?(lr=Ht,Ht=null):lr=Ht.sibling;var pc=Et(Ce,Ht,mn.value,ut);if(pc===null){Ht===null&&(Ht=lr);break}d&&Ht&&pc.alternate===null&&m(Ce,Ht),we=O(pc,we,pn),qt===null?_t=pc:qt.sibling=pc,qt=pc,Ht=lr}if(mn.done)return b(Ce,Ht),Kn&&Lu(Ce,pn),_t;if(Ht===null){for(;!mn.done;pn++,mn=Ue.next())mn=Bt(Ce,mn.value,ut),mn!==null&&(we=O(mn,we,pn),qt===null?_t=mn:qt.sibling=mn,qt=mn);return Kn&&Lu(Ce,pn),_t}for(Ht=P(Ce,Ht);!mn.done;pn++,mn=Ue.next())mn=Rn(Ht,Ce,pn,mn.value,ut),mn!==null&&(d&&mn.alternate!==null&&Ht.delete(mn.key===null?pn:mn.key),we=O(mn,we,pn),qt===null?_t=mn:qt.sibling=mn,qt=mn);return d&&Ht.forEach(function(RV){return m(Ce,RV)}),Kn&&Lu(Ce,pn),_t}function ko(Ce,we,Ue,ut){if(typeof Ue=="object"&&Ue!==null&&Ue.type===u&&Ue.key===null&&(Ue=Ue.props.children),typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case l:e:{for(var _t=Ue.key,qt=we;qt!==null;){if(qt.key===_t){if(_t=Ue.type,_t===u){if(qt.tag===7){b(Ce,qt.sibling),we=I(qt,Ue.props.children),we.return=Ce,Ce=we;break e}}else if(qt.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===w&&gP(_t)===qt.type){b(Ce,qt.sibling),we=I(qt,Ue.props),we.ref=fm(Ce,qt,Ue),we.return=Ce,Ce=we;break e}b(Ce,qt);break}else m(Ce,qt);qt=qt.sibling}Ue.type===u?(we=Ou(Ue.props.children,Ce.mode,ut,Ue.key),we.return=Ce,Ce=we):(ut=Zv(Ue.type,Ue.key,Ue.props,null,Ce.mode,ut),ut.ref=fm(Ce,we,Ue),ut.return=Ce,Ce=ut)}return se(Ce);case c:e:{for(qt=Ue.key;we!==null;){if(we.key===qt)if(we.tag===4&&we.stateNode.containerInfo===Ue.containerInfo&&we.stateNode.implementation===Ue.implementation){b(Ce,we.sibling),we=I(we,Ue.children||[]),we.return=Ce,Ce=we;break e}else{b(Ce,we);break}else m(Ce,we);we=we.sibling}we=zS(Ue,Ce.mode,ut),we.return=Ce,Ce=we}return se(Ce);case w:return qt=Ue._init,ko(Ce,we,qt(Ue._payload),ut)}if(q(Ue))return Mt(Ce,we,Ue,ut);if(E(Ue))return Nr(Ce,we,Ue,ut);xv(Ce,Ue)}return typeof Ue=="string"&&Ue!==""||typeof Ue=="number"?(Ue=""+Ue,we!==null&&we.tag===6?(b(Ce,we.sibling),we=I(we,Ue),we.return=Ce,Ce=we):(b(Ce,we),we=OS(Ue,Ce.mode,ut),we.return=Ce,Ce=we),se(Ce)):b(Ce,we)}return ko}var Mf=vP(!0),yP=vP(!1),dm={},Do=sn(dm),pm=sn(dm),bf=sn(dm);function Oa(d){if(d===dm)throw Error(o(174));return d}function nS(d,m){xt(bf,m),xt(pm,d),xt(Do,dm),d=$(m),kt(Do),xt(Do,d)}function Tf(){kt(Do),kt(pm),kt(bf)}function xP(d){var m=Oa(bf.current),b=Oa(Do.current);m=U(b,d.type,m),b!==m&&(xt(pm,d),xt(Do,m))}function iS(d){pm.current===d&&(kt(Do),kt(pm))}var ti=sn(0);function _v(d){for(var m=d;m!==null;){if(m.tag===13){var b=m.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||Jr(b)||Ir(b)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if(m.flags&128)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var rS=[];function sS(){for(var d=0;d<rS.length;d++){var m=rS[d];Q?m._workInProgressVersionPrimary=null:m._workInProgressVersionSecondary=null}rS.length=0}var wv=a.ReactCurrentDispatcher,Io=a.ReactCurrentBatchConfig,Ef=0,hi=null,Ur=null,ar=null,Sv=!1,mm=!1,gm=0,tV=0;function Fr(){throw Error(o(321))}function oS(d,m){if(m===null)return!1;for(var b=0;b<m.length&&b<d.length;b++)if(!Qs(d[b],m[b]))return!1;return!0}function aS(d,m,b,P,I,O){if(Ef=O,hi=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,wv.current=d===null||d.memoizedState===null?sV:oV,d=b(P,I),mm){O=0;do{if(mm=!1,gm=0,25<=O)throw Error(o(301));O+=1,ar=Ur=null,m.updateQueue=null,wv.current=aV,d=b(P,I)}while(mm)}if(wv.current=Av,m=Ur!==null&&Ur.next!==null,Ef=0,ar=Ur=hi=null,Sv=!1,m)throw Error(o(300));return d}function lS(){var d=gm!==0;return gm=0,d}function wl(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ar===null?hi.memoizedState=ar=d:ar=ar.next=d,ar}function za(){if(Ur===null){var d=hi.alternate;d=d!==null?d.memoizedState:null}else d=Ur.next;var m=ar===null?hi.memoizedState:ar.next;if(m!==null)ar=m,Ur=d;else{if(d===null)throw Error(o(310));Ur=d,d={memoizedState:Ur.memoizedState,baseState:Ur.baseState,baseQueue:Ur.baseQueue,queue:Ur.queue,next:null},ar===null?hi.memoizedState=ar=d:ar=ar.next=d}return ar}function Du(d,m){return typeof m=="function"?m(d):m}function Mv(d){var m=za(),b=m.queue;if(b===null)throw Error(o(311));b.lastRenderedReducer=d;var P=Ur,I=P.baseQueue,O=b.pending;if(O!==null){if(I!==null){var se=I.next;I.next=O.next,O.next=se}P.baseQueue=I=O,b.pending=null}if(I!==null){O=I.next,P=P.baseState;var ye=se=null,Ne=null,et=O;do{var mt=et.lane;if((Ef&mt)===mt)Ne!==null&&(Ne=Ne.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),P=et.hasEagerState?et.eagerState:d(P,et.action);else{var Bt={lane:mt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};Ne===null?(ye=Ne=Bt,se=P):Ne=Ne.next=Bt,hi.lanes|=mt,Cf|=mt}et=et.next}while(et!==null&&et!==O);Ne===null?se=P:Ne.next=ye,Qs(P,m.memoizedState)||(to=!0),m.memoizedState=P,m.baseState=se,m.baseQueue=Ne,b.lastRenderedState=P}if(d=b.interleaved,d!==null){I=d;do O=I.lane,hi.lanes|=O,Cf|=O,I=I.next;while(I!==d)}else I===null&&(b.lanes=0);return[m.memoizedState,b.dispatch]}function bv(d){var m=za(),b=m.queue;if(b===null)throw Error(o(311));b.lastRenderedReducer=d;var P=b.dispatch,I=b.pending,O=m.memoizedState;if(I!==null){b.pending=null;var se=I=I.next;do O=d(O,se.action),se=se.next;while(se!==I);Qs(O,m.memoizedState)||(to=!0),m.memoizedState=O,m.baseQueue===null&&(m.baseState=O),b.lastRenderedState=O}return[O,P]}function _P(){}function wP(d,m){var b=hi,P=za(),I=m(),O=!Qs(P.memoizedState,I);if(O&&(P.memoizedState=I,to=!0),P=P.queue,ym(bP.bind(null,b,P,d),[d]),P.getSnapshot!==m||O||ar!==null&&ar.memoizedState.tag&1){if(b.flags|=2048,vm(9,MP.bind(null,b,P,I,m),void 0,null),ki===null)throw Error(o(349));Ef&30||SP(b,m,I)}return I}function SP(d,m,b){d.flags|=16384,d={getSnapshot:m,value:b},m=hi.updateQueue,m===null?(m={lastEffect:null,stores:null},hi.updateQueue=m,m.stores=[d]):(b=m.stores,b===null?m.stores=[d]:b.push(d))}function MP(d,m,b,P){m.value=b,m.getSnapshot=P,TP(m)&&Uo(d,1,-1)}function bP(d,m,b){return b(function(){TP(m)&&Uo(d,1,-1)})}function TP(d){var m=d.getSnapshot;d=d.value;try{var b=m();return!Qs(d,b)}catch{return!0}}function cS(d){var m=wl();return typeof d=="function"&&(d=d()),m.memoizedState=m.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Du,lastRenderedState:d},m.queue=d,d=d.dispatch=rV.bind(null,hi,d),[m.memoizedState,d]}function vm(d,m,b,P){return d={tag:d,create:m,destroy:b,deps:P,next:null},m=hi.updateQueue,m===null?(m={lastEffect:null,stores:null},hi.updateQueue=m,m.lastEffect=d.next=d):(b=m.lastEffect,b===null?m.lastEffect=d.next=d:(P=b.next,b.next=d,d.next=P,m.lastEffect=d)),d}function EP(){return za().memoizedState}function Tv(d,m,b,P){var I=wl();hi.flags|=d,I.memoizedState=vm(1|m,b,void 0,P===void 0?null:P)}function Ev(d,m,b,P){var I=za();P=P===void 0?null:P;var O=void 0;if(Ur!==null){var se=Ur.memoizedState;if(O=se.destroy,P!==null&&oS(P,se.deps)){I.memoizedState=vm(m,b,O,P);return}}hi.flags|=d,I.memoizedState=vm(1|m,b,O,P)}function uS(d,m){return Tv(8390656,8,d,m)}function ym(d,m){return Ev(2048,8,d,m)}function AP(d,m){return Ev(4,2,d,m)}function CP(d,m){return Ev(4,4,d,m)}function PP(d,m){if(typeof m=="function")return d=d(),m(d),function(){m(null)};if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function RP(d,m,b){return b=b!=null?b.concat([d]):null,Ev(4,4,PP.bind(null,m,d),b)}function hS(){}function LP(d,m){var b=za();m=m===void 0?null:m;var P=b.memoizedState;return P!==null&&m!==null&&oS(m,P[1])?P[0]:(b.memoizedState=[d,m],d)}function DP(d,m){var b=za();m=m===void 0?null:m;var P=b.memoizedState;return P!==null&&m!==null&&oS(m,P[1])?P[0]:(d=d(),b.memoizedState=[d,m],d)}function nV(d,m){var b=Jt;Jt=b!==0&&4>b?b:4,d(!0);var P=Io.transition;Io.transition={};try{d(!1),m()}finally{Jt=b,Io.transition=P}}function IP(){return za().memoizedState}function iV(d,m,b){var P=hc(d);b={lane:P,action:b,hasEagerState:!1,eagerState:null,next:null},UP(d)?FP(m,b):(kP(d,m,b),b=os(),d=Uo(d,P,b),d!==null&&NP(d,m,P))}function rV(d,m,b){var P=hc(d),I={lane:P,action:b,hasEagerState:!1,eagerState:null,next:null};if(UP(d))FP(m,I);else{kP(d,m,I);var O=d.alternate;if(d.lanes===0&&(O===null||O.lanes===0)&&(O=m.lastRenderedReducer,O!==null))try{var se=m.lastRenderedState,ye=O(se,b);if(I.hasEagerState=!0,I.eagerState=ye,Qs(ye,se))return}catch{}finally{}b=os(),d=Uo(d,P,b),d!==null&&NP(d,m,P)}}function UP(d){var m=d.alternate;return d===hi||m!==null&&m===hi}function FP(d,m){mm=Sv=!0;var b=d.pending;b===null?m.next=m:(m.next=b.next,b.next=m),d.pending=m}function kP(d,m,b){ki!==null&&d.mode&1&&!(Zt&2)?(d=m.interleaved,d===null?(b.next=b,Js===null?Js=[m]:Js.push(m)):(b.next=d.next,d.next=b),m.interleaved=b):(d=m.pending,d===null?b.next=b:(b.next=d.next,d.next=b),m.pending=b)}function NP(d,m,b){if(b&4194240){var P=m.lanes;P&=d.pendingLanes,b|=P,m.lanes=b,ka(d,b)}}var Av={readContext:Mi,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useInsertionEffect:Fr,useLayoutEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useMutableSource:Fr,useSyncExternalStore:Fr,useId:Fr,unstable_isNewReconciler:!1},sV={readContext:Mi,useCallback:function(d,m){return wl().memoizedState=[d,m===void 0?null:m],d},useContext:Mi,useEffect:uS,useImperativeHandle:function(d,m,b){return b=b!=null?b.concat([d]):null,Tv(4194308,4,PP.bind(null,m,d),b)},useLayoutEffect:function(d,m){return Tv(4194308,4,d,m)},useInsertionEffect:function(d,m){return Tv(4,2,d,m)},useMemo:function(d,m){var b=wl();return m=m===void 0?null:m,d=d(),b.memoizedState=[d,m],d},useReducer:function(d,m,b){var P=wl();return m=b!==void 0?b(m):m,P.memoizedState=P.baseState=m,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:m},P.queue=d,d=d.dispatch=iV.bind(null,hi,d),[P.memoizedState,d]},useRef:function(d){var m=wl();return d={current:d},m.memoizedState=d},useState:cS,useDebugValue:hS,useDeferredValue:function(d){var m=cS(d),b=m[0],P=m[1];return uS(function(){var I=Io.transition;Io.transition={};try{P(d)}finally{Io.transition=I}},[d]),b},useTransition:function(){var d=cS(!1),m=d[0];return d=nV.bind(null,d[1]),wl().memoizedState=d,[m,d]},useMutableSource:function(){},useSyncExternalStore:function(d,m,b){var P=hi,I=wl();if(Kn){if(b===void 0)throw Error(o(407));b=b()}else{if(b=m(),ki===null)throw Error(o(349));Ef&30||SP(P,m,b)}I.memoizedState=b;var O={value:b,getSnapshot:m};return I.queue=O,uS(bP.bind(null,P,O,d),[d]),P.flags|=2048,vm(9,MP.bind(null,P,O,b,m),void 0,null),b},useId:function(){var d=wl(),m=ki.identifierPrefix;if(Kn){var b=_l,P=xl;b=(P&~(1<<32-yr(P)-1)).toString(32)+b,m=":"+m+"R"+b,b=gm++,0<b&&(m+="H"+b.toString(32)),m+=":"}else b=tV++,m=":"+m+"r"+b.toString(32)+":";return d.memoizedState=m},unstable_isNewReconciler:!1},oV={readContext:Mi,useCallback:LP,useContext:Mi,useEffect:ym,useImperativeHandle:RP,useInsertionEffect:AP,useLayoutEffect:CP,useMemo:DP,useReducer:Mv,useRef:EP,useState:function(){return Mv(Du)},useDebugValue:hS,useDeferredValue:function(d){var m=Mv(Du),b=m[0],P=m[1];return ym(function(){var I=Io.transition;Io.transition={};try{P(d)}finally{Io.transition=I}},[d]),b},useTransition:function(){var d=Mv(Du)[0],m=za().memoizedState;return[d,m]},useMutableSource:_P,useSyncExternalStore:wP,useId:IP,unstable_isNewReconciler:!1},aV={readContext:Mi,useCallback:LP,useContext:Mi,useEffect:ym,useImperativeHandle:RP,useInsertionEffect:AP,useLayoutEffect:CP,useMemo:DP,useReducer:bv,useRef:EP,useState:function(){return bv(Du)},useDebugValue:hS,useDeferredValue:function(d){var m=bv(Du),b=m[0],P=m[1];return ym(function(){var I=Io.transition;Io.transition={};try{P(d)}finally{Io.transition=I}},[d]),b},useTransition:function(){var d=bv(Du)[0],m=za().memoizedState;return[d,m]},useMutableSource:_P,useSyncExternalStore:wP,useId:IP,unstable_isNewReconciler:!1};function fS(d,m){try{var b="",P=m;do b+=Pu(P),P=P.return;while(P);var I=b}catch(O){I=`
Error generating stack: `+O.message+`
`+O.stack}return{value:d,source:m,stack:I}}function dS(d,m){try{console.error(m.value)}catch(b){setTimeout(function(){throw b})}}var lV=typeof WeakMap=="function"?WeakMap:Map;function OP(d,m,b){b=yl(-1,b),b.tag=3,b.payload={element:null};var P=m.value;return b.callback=function(){Vv||(Vv=!0,LS=P),dS(d,m)},b}function zP(d,m,b){b=yl(-1,b),b.tag=3;var P=d.type.getDerivedStateFromError;if(typeof P=="function"){var I=m.value;b.payload=function(){return P(I)},b.callback=function(){dS(d,m)}}var O=d.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(b.callback=function(){dS(d,m),typeof P!="function"&&(cc===null?cc=new Set([this]):cc.add(this));var se=m.stack;this.componentDidCatch(m.value,{componentStack:se!==null?se:""})}),b}function BP(d,m,b){var P=d.pingCache;if(P===null){P=d.pingCache=new lV;var I=new Set;P.set(m,I)}else I=P.get(m),I===void 0&&(I=new Set,P.set(m,I));I.has(b)||(I.add(b),d=SV.bind(null,d,m,b),m.then(d,d))}function HP(d){do{var m;if((m=d.tag===13)&&(m=d.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return d;d=d.return}while(d!==null);return null}function GP(d,m,b,P,I){return d.mode&1?(d.flags|=65536,d.lanes=I,d):(d===m?d.flags|=65536:(d.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(m=yl(-1,1),m.tag=2,lc(b,m))),b.lanes|=1),d)}function Ba(d){d.flags|=4}function VP(d,m){if(d!==null&&d.child===m.child)return!0;if(m.flags&16)return!1;for(d=m.child;d!==null;){if(d.flags&12854||d.subtreeFlags&12854)return!1;d=d.sibling}return!0}var xm,_m,Cv,Pv;if(J)xm=function(d,m){for(var b=m.child;b!==null;){if(b.tag===5||b.tag===6)Z(d,b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},_m=function(){},Cv=function(d,m,b,P,I){if(d=d.memoizedProps,d!==P){var O=m.stateNode,se=Oa(Do.current);b=V(O,b,d,P,I,se),(m.updateQueue=b)&&Ba(m)}},Pv=function(d,m,b,P){b!==P&&Ba(m)};else if(ne){xm=function(d,m,b,P){for(var I=m.child;I!==null;){if(I.tag===5){var O=I.stateNode;b&&P&&(O=Lt(O,I.type,I.memoizedProps,I)),Z(d,O)}else if(I.tag===6)O=I.stateNode,b&&P&&(O=ln(O,I.memoizedProps,I)),Z(d,O);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)O=I.child,O!==null&&(O.return=I),xm(d,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===m)break;for(;I.sibling===null;){if(I.return===null||I.return===m)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};var WP=function(d,m,b,P){for(var I=m.child;I!==null;){if(I.tag===5){var O=I.stateNode;b&&P&&(O=Lt(O,I.type,I.memoizedProps,I)),bt(d,O)}else if(I.tag===6)O=I.stateNode,b&&P&&(O=ln(O,I.memoizedProps,I)),bt(d,O);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)O=I.child,O!==null&&(O.return=I),WP(d,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===m)break;for(;I.sibling===null;){if(I.return===null||I.return===m)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};_m=function(d,m){var b=m.stateNode;if(!VP(d,m)){d=b.containerInfo;var P=rt(d);WP(P,m,!1,!1),b.pendingChildren=P,Ba(m),Ct(d,P)}},Cv=function(d,m,b,P,I){var O=d.stateNode,se=d.memoizedProps;if((d=VP(d,m))&&se===P)m.stateNode=O;else{var ye=m.stateNode,Ne=Oa(Do.current),et=null;se!==P&&(et=V(ye,b,se,P,I,Ne)),d&&et===null?m.stateNode=O:(O=je(O,et,b,se,P,m,d,ye),ie(O,b,P,I,Ne)&&Ba(m),m.stateNode=O,d?Ba(m):xm(O,m,!1,!1))}},Pv=function(d,m,b,P){b!==P?(d=Oa(bf.current),b=Oa(Do.current),m.stateNode=fe(P,d,b,m),Ba(m)):m.stateNode=d.stateNode}}else _m=function(){},Cv=function(){},Pv=function(){};function wm(d,m){if(!Kn)switch(d.tailMode){case"hidden":m=d.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?d.tail=null:b.sibling=null;break;case"collapsed":b=d.tail;for(var P=null;b!==null;)b.alternate!==null&&(P=b),b=b.sibling;P===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:P.sibling=null}}function kr(d){var m=d.alternate!==null&&d.alternate.child===d.child,b=0,P=0;if(m)for(var I=d.child;I!==null;)b|=I.lanes|I.childLanes,P|=I.subtreeFlags&14680064,P|=I.flags&14680064,I.return=d,I=I.sibling;else for(I=d.child;I!==null;)b|=I.lanes|I.childLanes,P|=I.subtreeFlags,P|=I.flags,I.return=d,I=I.sibling;return d.subtreeFlags|=P,d.childLanes=b,m}function cV(d,m,b){var P=m.pendingProps;switch(Jw(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kr(m),null;case 1:return dn(m.type)&&$r(),kr(m),null;case 3:return P=m.stateNode,Tf(),kt(Rt),kt($t),sS(),P.pendingContext&&(P.context=P.pendingContext,P.pendingContext=null),(d===null||d.child===null)&&(hm(m)?Ba(m):d===null||d.memoizedState.isDehydrated&&!(m.flags&256)||(m.flags|=1024,ha!==null&&(US(ha),ha=null))),_m(d,m),kr(m),null;case 5:iS(m),b=Oa(bf.current);var I=m.type;if(d!==null&&m.stateNode!=null)Cv(d,m,I,P,b),d.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!P){if(m.stateNode===null)throw Error(o(166));return kr(m),null}if(d=Oa(Do.current),hm(m)){if(!Y)throw Error(o(175));d=Su(m.stateNode,m.type,m.memoizedProps,b,d,m,!um),m.updateQueue=d,d!==null&&Ba(m)}else{var O=B(I,P,b,d,m);xm(O,m,!1,!1),m.stateNode=O,ie(O,I,P,b,d)&&Ba(m)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return kr(m),null;case 6:if(d&&m.stateNode!=null)Pv(d,m,d.memoizedProps,P);else{if(typeof P!="string"&&m.stateNode===null)throw Error(o(166));if(d=Oa(bf.current),b=Oa(Do.current),hm(m)){if(!Y)throw Error(o(176));if(d=m.stateNode,P=m.memoizedProps,(b=Mu(d,P,m,!um))&&(I=$s,I!==null))switch(O=(I.mode&1)!==0,I.tag){case 3:Qe(I.stateNode.containerInfo,d,P,O);break;case 5:ot(I.type,I.memoizedProps,I.stateNode,d,P,O)}b&&Ba(m)}else m.stateNode=fe(P,d,b,m)}return kr(m),null;case 13:if(kt(ti),P=m.memoizedState,Kn&&eo!==null&&m.mode&1&&!(m.flags&128)){for(d=eo;d;)d=rr(d);return Sf(),m.flags|=98560,m}if(P!==null&&P.dehydrated!==null){if(P=hm(m),d===null){if(!P)throw Error(o(318));if(!Y)throw Error(o(344));if(d=m.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(o(317));nm(d,m)}else Sf(),!(m.flags&128)&&(m.memoizedState=null),m.flags|=4;return kr(m),null}return ha!==null&&(US(ha),ha=null),m.flags&128?(m.lanes=b,m):(P=P!==null,b=!1,d===null?hm(m):b=d.memoizedState!==null,P&&!b&&(m.child.flags|=8192,m.mode&1&&(d===null||ti.current&1?Yi===0&&(Yi=3):kS())),m.updateQueue!==null&&(m.flags|=4),kr(m),null);case 4:return Tf(),_m(d,m),d===null&&ve(m.stateNode.containerInfo),kr(m),null;case 10:return or(m.type._context),kr(m),null;case 17:return dn(m.type)&&$r(),kr(m),null;case 19:if(kt(ti),I=m.memoizedState,I===null)return kr(m),null;if(P=(m.flags&128)!==0,O=I.rendering,O===null)if(P)wm(I,!1);else{if(Yi!==0||d!==null&&d.flags&128)for(d=m.child;d!==null;){if(O=_v(d),O!==null){for(m.flags|=128,wm(I,!1),d=O.updateQueue,d!==null&&(m.updateQueue=d,m.flags|=4),m.subtreeFlags=0,d=b,P=m.child;P!==null;)b=P,I=d,b.flags&=14680066,O=b.alternate,O===null?(b.childLanes=0,b.lanes=I,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=O.childLanes,b.lanes=O.lanes,b.child=O.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=O.memoizedProps,b.memoizedState=O.memoizedState,b.updateQueue=O.updateQueue,b.type=O.type,I=O.dependencies,b.dependencies=I===null?null:{lanes:I.lanes,firstContext:I.firstContext}),P=P.sibling;return xt(ti,ti.current&1|2),m.child}d=d.sibling}I.tail!==null&&ei()>RS&&(m.flags|=128,P=!0,wm(I,!1),m.lanes=4194304)}else{if(!P)if(d=_v(O),d!==null){if(m.flags|=128,P=!0,d=d.updateQueue,d!==null&&(m.updateQueue=d,m.flags|=4),wm(I,!0),I.tail===null&&I.tailMode==="hidden"&&!O.alternate&&!Kn)return kr(m),null}else 2*ei()-I.renderingStartTime>RS&&b!==1073741824&&(m.flags|=128,P=!0,wm(I,!1),m.lanes=4194304);I.isBackwards?(O.sibling=m.child,m.child=O):(d=I.last,d!==null?d.sibling=O:m.child=O,I.last=O)}return I.tail!==null?(m=I.tail,I.rendering=m,I.tail=m.sibling,I.renderingStartTime=ei(),m.sibling=null,d=ti.current,xt(ti,P?d&1|2:d&1),m):(kr(m),null);case 22:case 23:return FS(),P=m.memoizedState!==null,d!==null&&d.memoizedState!==null!==P&&(m.flags|=8192),P&&m.mode&1?no&1073741824&&(kr(m),J&&m.subtreeFlags&6&&(m.flags|=8192)):kr(m),null;case 24:return null;case 25:return null}throw Error(o(156,m.tag))}var uV=a.ReactCurrentOwner,to=!1;function ss(d,m,b,P){m.child=d===null?yP(m,null,b,P):Mf(m,d.child,b,P)}function jP(d,m,b,P,I){b=b.render;var O=m.ref;return Si(m,I),P=aS(d,m,b,P,O,I),b=lS(),d!==null&&!to?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~I,Sl(d,m,I)):(Kn&&b&&Qw(m),m.flags|=1,ss(d,m,P,I),m.child)}function XP(d,m,b,P,I){if(d===null){var O=b.type;return typeof O=="function"&&!NS(O)&&O.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(m.tag=15,m.type=O,YP(d,m,O,P,I)):(d=Zv(b.type,null,P,m,m.mode,I),d.ref=m.ref,d.return=m,m.child=d)}if(O=d.child,!(d.lanes&I)){var se=O.memoizedProps;if(b=b.compare,b=b!==null?b:Cu,b(se,P)&&d.ref===m.ref)return Sl(d,m,I)}return m.flags|=1,d=dc(O,P),d.ref=m.ref,d.return=m,m.child=d}function YP(d,m,b,P,I){if(d!==null&&Cu(d.memoizedProps,P)&&d.ref===m.ref)if(to=!1,(d.lanes&I)!==0)d.flags&131072&&(to=!0);else return m.lanes=d.lanes,Sl(d,m,I);return pS(d,m,b,P,I)}function qP(d,m,b){var P=m.pendingProps,I=P.children,O=d!==null?d.memoizedState:null;if(P.mode==="hidden")if(!(m.mode&1))m.memoizedState={baseLanes:0,cachePool:null},xt(Af,no),no|=b;else if(b&1073741824)m.memoizedState={baseLanes:0,cachePool:null},P=O!==null?O.baseLanes:b,xt(Af,no),no|=P;else return d=O!==null?O.baseLanes|b:b,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:d,cachePool:null},m.updateQueue=null,xt(Af,no),no|=d,null;else O!==null?(P=O.baseLanes|b,m.memoizedState=null):P=b,xt(Af,no),no|=P;return ss(d,m,I,b),m.child}function KP(d,m){var b=m.ref;(d===null&&b!==null||d!==null&&d.ref!==b)&&(m.flags|=512,m.flags|=2097152)}function pS(d,m,b,P,I){var O=dn(b)?ui:$t.current;return O=Xi(m,O),Si(m,I),b=aS(d,m,b,P,O,I),P=lS(),d!==null&&!to?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~I,Sl(d,m,I)):(Kn&&P&&Qw(m),m.flags|=1,ss(d,m,b,I),m.child)}function ZP(d,m,b,P,I){if(dn(b)){var O=!0;Co(m)}else O=!1;if(Si(m,I),m.stateNode===null)d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2),uP(m,b,P),Zw(m,b,P,I),P=!0;else if(d===null){var se=m.stateNode,ye=m.memoizedProps;se.props=ye;var Ne=se.context,et=b.contextType;typeof et=="object"&&et!==null?et=Mi(et):(et=dn(b)?ui:$t.current,et=Xi(m,et));var mt=b.getDerivedStateFromProps,Bt=typeof mt=="function"||typeof se.getSnapshotBeforeUpdate=="function";Bt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(ye!==P||Ne!==et)&&hP(m,se,P,et),ac=!1;var Et=m.memoizedState;se.state=Et,mv(m,P,se,I),Ne=m.memoizedState,ye!==P||Et!==Ne||Rt.current||ac?(typeof mt=="function"&&(Kw(m,b,mt,P),Ne=m.memoizedState),(ye=ac||cP(m,b,ye,P,Et,Ne,et))?(Bt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(m.flags|=4194308)):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=P,m.memoizedState=Ne),se.props=P,se.state=Ne,se.context=et,P=ye):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),P=!1)}else{se=m.stateNode,sP(d,m),ye=m.memoizedProps,et=m.type===m.elementType?ye:is(m.type,ye),se.props=et,Bt=m.pendingProps,Et=se.context,Ne=b.contextType,typeof Ne=="object"&&Ne!==null?Ne=Mi(Ne):(Ne=dn(b)?ui:$t.current,Ne=Xi(m,Ne));var Rn=b.getDerivedStateFromProps;(mt=typeof Rn=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(ye!==Bt||Et!==Ne)&&hP(m,se,P,Ne),ac=!1,Et=m.memoizedState,se.state=Et,mv(m,P,se,I);var Mt=m.memoizedState;ye!==Bt||Et!==Mt||Rt.current||ac?(typeof Rn=="function"&&(Kw(m,b,Rn,P),Mt=m.memoizedState),(et=ac||cP(m,b,et,P,Et,Mt,Ne)||!1)?(mt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(P,Mt,Ne),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(P,Mt,Ne)),typeof se.componentDidUpdate=="function"&&(m.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof se.componentDidUpdate!="function"||ye===d.memoizedProps&&Et===d.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Et===d.memoizedState||(m.flags|=1024),m.memoizedProps=P,m.memoizedState=Mt),se.props=P,se.state=Mt,se.context=Ne,P=et):(typeof se.componentDidUpdate!="function"||ye===d.memoizedProps&&Et===d.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Et===d.memoizedState||(m.flags|=1024),P=!1)}return mS(d,m,b,P,O,I)}function mS(d,m,b,P,I,O){KP(d,m);var se=(m.flags&128)!==0;if(!P&&!se)return I&&kn(m,b,!1),Sl(d,m,O);P=m.stateNode,uV.current=m;var ye=se&&typeof b.getDerivedStateFromError!="function"?null:P.render();return m.flags|=1,d!==null&&se?(m.child=Mf(m,d.child,null,O),m.child=Mf(m,null,ye,O)):ss(d,m,ye,O),m.memoizedState=P.state,I&&kn(m,b,!0),m.child}function QP(d){var m=d.stateNode;m.pendingContext?bn(d,m.pendingContext,m.pendingContext!==m.context):m.context&&bn(d,m.context,!1),nS(d,m.containerInfo)}function JP(d,m,b,P,I){return Sf(),tS(I),m.flags|=256,ss(d,m,b,P),m.child}var Rv={dehydrated:null,treeContext:null,retryLane:0};function Lv(d){return{baseLanes:d,cachePool:null}}function $P(d,m,b){var P=m.pendingProps,I=ti.current,O=!1,se=(m.flags&128)!==0,ye;if((ye=se)||(ye=d!==null&&d.memoizedState===null?!1:(I&2)!==0),ye?(O=!0,m.flags&=-129):(d===null||d.memoizedState!==null)&&(I|=1),xt(ti,I&1),d===null)return eS(m),d=m.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?(m.mode&1?Ir(d)?m.lanes=8:m.lanes=1073741824:m.lanes=1,null):(I=P.children,d=P.fallback,O?(P=m.mode,O=m.child,I={mode:"hidden",children:I},!(P&1)&&O!==null?(O.childLanes=0,O.pendingProps=I):O=Qv(I,P,0,null),d=Ou(d,P,b,null),O.return=m,d.return=m,O.sibling=d,m.child=O,m.child.memoizedState=Lv(b),m.memoizedState=Rv,d):gS(m,I));if(I=d.memoizedState,I!==null){if(ye=I.dehydrated,ye!==null){if(se)return m.flags&256?(m.flags&=-257,Dv(d,m,b,Error(o(422)))):m.memoizedState!==null?(m.child=d.child,m.flags|=128,null):(O=P.fallback,I=m.mode,P=Qv({mode:"visible",children:P.children},I,0,null),O=Ou(O,I,b,null),O.flags|=2,P.return=m,O.return=m,P.sibling=O,m.child=P,m.mode&1&&Mf(m,d.child,null,b),m.child.memoizedState=Lv(b),m.memoizedState=Rv,O);if(!(m.mode&1))m=Dv(d,m,b,null);else if(Ir(ye))m=Dv(d,m,b,Error(o(419)));else if(P=(b&d.childLanes)!==0,to||P){if(P=ki,P!==null){switch(b&-b){case 4:O=2;break;case 16:O=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:O=32;break;case 536870912:O=268435456;break;default:O=0}P=O&(P.suspendedLanes|b)?0:O,P!==0&&P!==I.retryLane&&(I.retryLane=P,Uo(d,P,-1))}kS(),m=Dv(d,m,b,Error(o(421)))}else Jr(ye)?(m.flags|=128,m.child=d.child,m=MV.bind(null,d),Ks(ye,m),m=null):(b=I.treeContext,Y&&(eo=Ao(ye),$s=m,Kn=!0,ha=null,um=!1,b!==null&&(Ro[Lo++]=xl,Ro[Lo++]=_l,Ro[Lo++]=Ru,xl=b.id,_l=b.overflow,Ru=m)),m=gS(m,m.pendingProps.children),m.flags|=4096);return m}return O?(P=t3(d,m,P.children,P.fallback,b),O=m.child,I=d.child.memoizedState,O.memoizedState=I===null?Lv(b):{baseLanes:I.baseLanes|b,cachePool:null},O.childLanes=d.childLanes&~b,m.memoizedState=Rv,P):(b=e3(d,m,P.children,b),m.memoizedState=null,b)}return O?(P=t3(d,m,P.children,P.fallback,b),O=m.child,I=d.child.memoizedState,O.memoizedState=I===null?Lv(b):{baseLanes:I.baseLanes|b,cachePool:null},O.childLanes=d.childLanes&~b,m.memoizedState=Rv,P):(b=e3(d,m,P.children,b),m.memoizedState=null,b)}function gS(d,m){return m=Qv({mode:"visible",children:m},d.mode,0,null),m.return=d,d.child=m}function e3(d,m,b,P){var I=d.child;return d=I.sibling,b=dc(I,{mode:"visible",children:b}),!(m.mode&1)&&(b.lanes=P),b.return=m,b.sibling=null,d!==null&&(P=m.deletions,P===null?(m.deletions=[d],m.flags|=16):P.push(d)),m.child=b}function t3(d,m,b,P,I){var O=m.mode;d=d.child;var se=d.sibling,ye={mode:"hidden",children:b};return!(O&1)&&m.child!==d?(b=m.child,b.childLanes=0,b.pendingProps=ye,m.deletions=null):(b=dc(d,ye),b.subtreeFlags=d.subtreeFlags&14680064),se!==null?P=dc(se,P):(P=Ou(P,O,I,null),P.flags|=2),P.return=m,b.return=m,b.sibling=P,m.child=b,P}function Dv(d,m,b,P){return P!==null&&tS(P),Mf(m,d.child,null,b),d=gS(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function n3(d,m,b){d.lanes|=m;var P=d.alternate;P!==null&&(P.lanes|=m),rs(d.return,m,b)}function vS(d,m,b,P,I){var O=d.memoizedState;O===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:P,tail:b,tailMode:I}:(O.isBackwards=m,O.rendering=null,O.renderingStartTime=0,O.last=P,O.tail=b,O.tailMode=I)}function i3(d,m,b){var P=m.pendingProps,I=P.revealOrder,O=P.tail;if(ss(d,m,P.children,b),P=ti.current,P&2)P=P&1|2,m.flags|=128;else{if(d!==null&&d.flags&128)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&n3(d,b,m);else if(d.tag===19)n3(d,b,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}P&=1}if(xt(ti,P),!(m.mode&1))m.memoizedState=null;else switch(I){case"forwards":for(b=m.child,I=null;b!==null;)d=b.alternate,d!==null&&_v(d)===null&&(I=b),b=b.sibling;b=I,b===null?(I=m.child,m.child=null):(I=b.sibling,b.sibling=null),vS(m,!1,I,b,O);break;case"backwards":for(b=null,I=m.child,m.child=null;I!==null;){if(d=I.alternate,d!==null&&_v(d)===null){m.child=I;break}d=I.sibling,I.sibling=b,b=I,I=d}vS(m,!0,b,null,O);break;case"together":vS(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function Sl(d,m,b){if(d!==null&&(m.dependencies=d.dependencies),Cf|=m.lanes,!(b&m.childLanes))return null;if(d!==null&&m.child!==d.child)throw Error(o(153));if(m.child!==null){for(d=m.child,b=dc(d,d.pendingProps),m.child=b,b.return=m;d.sibling!==null;)d=d.sibling,b=b.sibling=dc(d,d.pendingProps),b.return=m;b.sibling=null}return m.child}function hV(d,m,b){switch(m.tag){case 3:QP(m),Sf();break;case 5:xP(m);break;case 1:dn(m.type)&&Co(m);break;case 4:nS(m,m.stateNode.containerInfo);break;case 10:dv(m,m.type._context,m.memoizedProps.value);break;case 13:var P=m.memoizedState;if(P!==null)return P.dehydrated!==null?(xt(ti,ti.current&1),m.flags|=128,null):b&m.child.childLanes?$P(d,m,b):(xt(ti,ti.current&1),d=Sl(d,m,b),d!==null?d.sibling:null);xt(ti,ti.current&1);break;case 19:if(P=(b&m.childLanes)!==0,d.flags&128){if(P)return i3(d,m,b);m.flags|=128}var I=m.memoizedState;if(I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),xt(ti,ti.current),P)break;return null;case 22:case 23:return m.lanes=0,qP(d,m,b)}return Sl(d,m,b)}function fV(d,m){switch(Jw(m),m.tag){case 1:return dn(m.type)&&$r(),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return Tf(),kt(Rt),kt($t),sS(),d=m.flags,d&65536&&!(d&128)?(m.flags=d&-65537|128,m):null;case 5:return iS(m),null;case 13:if(kt(ti),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(o(340));Sf()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return kt(ti),null;case 4:return Tf(),null;case 10:return or(m.type._context),null;case 22:case 23:return FS(),null;case 24:return null;default:return null}}var Iv=!1,Iu=!1,dV=typeof WeakSet=="function"?WeakSet:Set,at=null;function Uv(d,m){var b=d.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(P){bs(d,m,P)}else b.current=null}function yS(d,m,b){try{b()}catch(P){bs(d,m,P)}}var r3=!1;function pV(d,m){for(X(d.containerInfo),at=m;at!==null;)if(d=at,m=d.child,(d.subtreeFlags&1028)!==0&&m!==null)m.return=d,at=m;else for(;at!==null;){d=at;try{var b=d.alternate;if(d.flags&1024)switch(d.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var P=b.memoizedProps,I=b.memoizedState,O=d.stateNode,se=O.getSnapshotBeforeUpdate(d.elementType===d.type?P:is(d.type,P),I);O.__reactInternalSnapshotBeforeUpdate=se}break;case 3:J&&$e(d.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ye){bs(d,d.return,ye)}if(m=d.sibling,m!==null){m.return=d.return,at=m;break}at=d.return}return b=r3,r3=!1,b}function Uu(d,m,b){var P=m.updateQueue;if(P=P!==null?P.lastEffect:null,P!==null){var I=P=P.next;do{if((I.tag&d)===d){var O=I.destroy;I.destroy=void 0,O!==void 0&&yS(m,b,O)}I=I.next}while(I!==P)}}function Sm(d,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&d)===d){var P=b.create;b.destroy=P()}b=b.next}while(b!==m)}}function xS(d){var m=d.ref;if(m!==null){var b=d.stateNode;switch(d.tag){case 5:d=H(b);break;default:d=b}typeof m=="function"?m(d):m.current=d}}function s3(d,m,b){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(Eu,m)}catch{}switch(m.tag){case 0:case 11:case 14:case 15:if(d=m.updateQueue,d!==null&&(d=d.lastEffect,d!==null)){var P=d=d.next;do{var I=P,O=I.destroy;I=I.tag,O!==void 0&&(I&2||I&4)&&yS(m,b,O),P=P.next}while(P!==d)}break;case 1:if(Uv(m,b),d=m.stateNode,typeof d.componentWillUnmount=="function")try{d.props=m.memoizedProps,d.state=m.memoizedState,d.componentWillUnmount()}catch(se){bs(m,b,se)}break;case 5:Uv(m,b);break;case 4:J?h3(d,m,b):ne&&ne&&(m=m.stateNode.containerInfo,b=rt(m),nt(m,b))}}function o3(d,m,b){for(var P=m;;)if(s3(d,P,b),P.child===null||J&&P.tag===4){if(P===m)break;for(;P.sibling===null;){if(P.return===null||P.return===m)return;P=P.return}P.sibling.return=P.return,P=P.sibling}else P.child.return=P,P=P.child}function a3(d){var m=d.alternate;m!==null&&(d.alternate=null,a3(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&Te(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function l3(d){return d.tag===5||d.tag===3||d.tag===4}function c3(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||l3(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function u3(d){if(J){e:{for(var m=d.return;m!==null;){if(l3(m))break e;m=m.return}throw Error(o(160))}var b=m;switch(b.tag){case 5:m=b.stateNode,b.flags&32&&(ke(m),b.flags&=-33),b=c3(d),wS(d,b,m);break;case 3:case 4:m=b.stateNode.containerInfo,b=c3(d),_S(d,b,m);break;default:throw Error(o(161))}}}function _S(d,m,b){var P=d.tag;if(P===5||P===6)d=d.stateNode,m?Ve(b,d,m):Je(b,d);else if(P!==4&&(d=d.child,d!==null))for(_S(d,m,b),d=d.sibling;d!==null;)_S(d,m,b),d=d.sibling}function wS(d,m,b){var P=d.tag;if(P===5||P===6)d=d.stateNode,m?tt(b,d,m):ze(b,d);else if(P!==4&&(d=d.child,d!==null))for(wS(d,m,b),d=d.sibling;d!==null;)wS(d,m,b),d=d.sibling}function h3(d,m,b){for(var P=m,I=!1,O,se;;){if(!I){I=P.return;e:for(;;){if(I===null)throw Error(o(160));switch(O=I.stateNode,I.tag){case 5:se=!1;break e;case 3:O=O.containerInfo,se=!0;break e;case 4:O=O.containerInfo,se=!0;break e}I=I.return}I=!0}if(P.tag===5||P.tag===6)o3(d,P,b),se?ce(O,P.stateNode):qe(O,P.stateNode);else if(P.tag===18)se?Le(O,P.stateNode):Pe(O,P.stateNode);else if(P.tag===4){if(P.child!==null){O=P.stateNode.containerInfo,se=!0,P.child.return=P,P=P.child;continue}}else if(s3(d,P,b),P.child!==null){P.child.return=P,P=P.child;continue}if(P===m)break;for(;P.sibling===null;){if(P.return===null||P.return===m)return;P=P.return,P.tag===4&&(I=!1)}P.sibling.return=P.return,P=P.sibling}}function SS(d,m){if(J){switch(m.tag){case 0:case 11:case 14:case 15:Uu(3,m,m.return),Sm(3,m),Uu(5,m,m.return);return;case 1:return;case 5:var b=m.stateNode;if(b!=null){var P=m.memoizedProps;d=d!==null?d.memoizedProps:P;var I=m.type,O=m.updateQueue;m.updateQueue=null,O!==null&&ct(b,O,I,d,P,m)}return;case 6:if(m.stateNode===null)throw Error(o(162));b=m.memoizedProps,Fe(m.stateNode,d!==null?d.memoizedProps:b,b);return;case 3:Y&&d!==null&&d.memoizedState.isDehydrated&&ee(m.stateNode.containerInfo);return;case 12:return;case 13:Fv(m);return;case 19:Fv(m);return;case 17:return}throw Error(o(163))}switch(m.tag){case 0:case 11:case 14:case 15:Uu(3,m,m.return),Sm(3,m),Uu(5,m,m.return);return;case 12:return;case 13:Fv(m);return;case 19:Fv(m);return;case 3:Y&&d!==null&&d.memoizedState.isDehydrated&&ee(m.stateNode.containerInfo);break;case 22:case 23:return}e:if(ne){switch(m.tag){case 1:case 5:case 6:break e;case 3:case 4:m=m.stateNode,nt(m.containerInfo,m.pendingChildren);break e}throw Error(o(163))}}function Fv(d){var m=d.updateQueue;if(m!==null){d.updateQueue=null;var b=d.stateNode;b===null&&(b=d.stateNode=new dV),m.forEach(function(P){var I=bV.bind(null,d,P);b.has(P)||(b.add(P),P.then(I,I))})}}function mV(d,m){for(at=m;at!==null;){m=at;var b=m.deletions;if(b!==null)for(var P=0;P<b.length;P++){var I=b[P];try{var O=d;J?h3(O,I,m):o3(O,I,m);var se=I.alternate;se!==null&&(se.return=null),I.return=null}catch(_t){bs(I,m,_t)}}if(b=m.child,m.subtreeFlags&12854&&b!==null)b.return=m,at=b;else for(;at!==null;){m=at;try{var ye=m.flags;if(ye&32&&J&&ke(m.stateNode),ye&512){var Ne=m.alternate;if(Ne!==null){var et=Ne.ref;et!==null&&(typeof et=="function"?et(null):et.current=null)}}if(ye&8192)switch(m.tag){case 13:if(m.memoizedState!==null){var mt=m.alternate;(mt===null||mt.memoizedState===null)&&(PS=ei())}break;case 22:var Bt=m.memoizedState!==null,Et=m.alternate,Rn=Et!==null&&Et.memoizedState!==null;if(b=m,J){e:if(P=b,I=Bt,O=null,J)for(var Mt=P;;){if(Mt.tag===5){if(O===null){O=Mt;var Nr=Mt.stateNode;I?ae(Nr):pe(Mt.stateNode,Mt.memoizedProps)}}else if(Mt.tag===6){if(O===null){var ko=Mt.stateNode;I?Be(ko):De(ko,Mt.memoizedProps)}}else if((Mt.tag!==22&&Mt.tag!==23||Mt.memoizedState===null||Mt===P)&&Mt.child!==null){Mt.child.return=Mt,Mt=Mt.child;continue}if(Mt===P)break;for(;Mt.sibling===null;){if(Mt.return===null||Mt.return===P)break e;O===Mt&&(O=null),Mt=Mt.return}O===Mt&&(O=null),Mt.sibling.return=Mt.return,Mt=Mt.sibling}}if(Bt&&!Rn&&b.mode&1){at=b;for(var Ce=b.child;Ce!==null;){for(b=at=Ce;at!==null;){P=at;var we=P.child;switch(P.tag){case 0:case 11:case 14:case 15:Uu(4,P,P.return);break;case 1:Uv(P,P.return);var Ue=P.stateNode;if(typeof Ue.componentWillUnmount=="function"){var ut=P.return;try{Ue.props=P.memoizedProps,Ue.state=P.memoizedState,Ue.componentWillUnmount()}catch(_t){bs(P,ut,_t)}}break;case 5:Uv(P,P.return);break;case 22:if(P.memoizedState!==null){p3(b);continue}}we!==null?(we.return=P,at=we):p3(b)}Ce=Ce.sibling}}}switch(ye&4102){case 2:u3(m),m.flags&=-3;break;case 6:u3(m),m.flags&=-3,SS(m.alternate,m);break;case 4096:m.flags&=-4097;break;case 4100:m.flags&=-4097,SS(m.alternate,m);break;case 4:SS(m.alternate,m)}}catch(_t){bs(m,m.return,_t)}if(b=m.sibling,b!==null){b.return=m.return,at=b;break}at=m.return}}}function gV(d,m,b){at=d,f3(d)}function f3(d,m,b){for(var P=(d.mode&1)!==0;at!==null;){var I=at,O=I.child;if(I.tag===22&&P){var se=I.memoizedState!==null||Iv;if(!se){var ye=I.alternate,Ne=ye!==null&&ye.memoizedState!==null||Iu;ye=Iv;var et=Iu;if(Iv=se,(Iu=Ne)&&!et)for(at=I;at!==null;)se=at,Ne=se.child,se.tag===22&&se.memoizedState!==null?m3(I):Ne!==null?(Ne.return=se,at=Ne):m3(I);for(;O!==null;)at=O,f3(O),O=O.sibling;at=I,Iv=ye,Iu=et}d3(d)}else I.subtreeFlags&8772&&O!==null?(O.return=I,at=O):d3(d)}}function d3(d){for(;at!==null;){var m=at;if(m.flags&8772){var b=m.alternate;try{if(m.flags&8772)switch(m.tag){case 0:case 11:case 15:Iu||Sm(5,m);break;case 1:var P=m.stateNode;if(m.flags&4&&!Iu)if(b===null)P.componentDidMount();else{var I=m.elementType===m.type?b.memoizedProps:is(m.type,b.memoizedProps);P.componentDidUpdate(I,b.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var O=m.updateQueue;O!==null&&aP(m,O,P);break;case 3:var se=m.updateQueue;if(se!==null){if(b=null,m.child!==null)switch(m.child.tag){case 5:b=H(m.child.stateNode);break;case 1:b=m.child.stateNode}aP(m,se,b)}break;case 5:var ye=m.stateNode;b===null&&m.flags&4&&Xe(ye,m.type,m.memoizedProps,m);break;case 6:break;case 4:break;case 12:break;case 13:if(Y&&m.memoizedState===null){var Ne=m.alternate;if(Ne!==null){var et=Ne.memoizedState;if(et!==null){var mt=et.dehydrated;mt!==null&&xe(mt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Iu||m.flags&512&&xS(m)}catch(Bt){bs(m,m.return,Bt)}}if(m===d){at=null;break}if(b=m.sibling,b!==null){b.return=m.return,at=b;break}at=m.return}}function p3(d){for(;at!==null;){var m=at;if(m===d){at=null;break}var b=m.sibling;if(b!==null){b.return=m.return,at=b;break}at=m.return}}function m3(d){for(;at!==null;){var m=at;try{switch(m.tag){case 0:case 11:case 15:var b=m.return;try{Sm(4,m)}catch(Ne){bs(m,b,Ne)}break;case 1:var P=m.stateNode;if(typeof P.componentDidMount=="function"){var I=m.return;try{P.componentDidMount()}catch(Ne){bs(m,I,Ne)}}var O=m.return;try{xS(m)}catch(Ne){bs(m,O,Ne)}break;case 5:var se=m.return;try{xS(m)}catch(Ne){bs(m,se,Ne)}}}catch(Ne){bs(m,m.return,Ne)}if(m===d){at=null;break}var ye=m.sibling;if(ye!==null){ye.return=m.return,at=ye;break}at=m.return}}var kv=0,Nv=1,Ov=2,zv=3,Bv=4;if(typeof Symbol=="function"&&Symbol.for){var Mm=Symbol.for;kv=Mm("selector.component"),Nv=Mm("selector.has_pseudo_class"),Ov=Mm("selector.role"),zv=Mm("selector.test_id"),Bv=Mm("selector.text")}function MS(d){var m=de(d);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(o(364));return m}if(d=k(d),d===null)throw Error(o(362));return d.stateNode.current}function bS(d,m){switch(m.$$typeof){case kv:if(d.type===m.value)return!0;break;case Nv:e:{m=m.value,d=[d,0];for(var b=0;b<d.length;){var P=d[b++],I=d[b++],O=m[I];if(P.tag!==5||!Me(P)){for(;O!=null&&bS(P,O);)I++,O=m[I];if(I===m.length){m=!0;break e}else for(P=P.child;P!==null;)d.push(P,I),P=P.sibling}}m=!1}return m;case Ov:if(d.tag===5&&ge(d.stateNode,m.value))return!0;break;case Bv:if((d.tag===5||d.tag===6)&&(d=me(d),d!==null&&0<=d.indexOf(m.value)))return!0;break;case zv:if(d.tag===5&&(d=d.memoizedProps["data-testname"],typeof d=="string"&&d.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function TS(d){switch(d.$$typeof){case kv:return"<"+(A(d.value)||"Unknown")+">";case Nv:return":has("+(TS(d)||"")+")";case Ov:return'[role="'+d.value+'"]';case Bv:return'"'+d.value+'"';case zv:return'[data-testname="'+d.value+'"]';default:throw Error(o(365))}}function g3(d,m){var b=[];d=[d,0];for(var P=0;P<d.length;){var I=d[P++],O=d[P++],se=m[O];if(I.tag!==5||!Me(I)){for(;se!=null&&bS(I,se);)O++,se=m[O];if(O===m.length)b.push(I);else for(I=I.child;I!==null;)d.push(I,O),I=I.sibling}}return b}function ES(d,m){if(!K)throw Error(o(363));d=MS(d),d=g3(d,m),m=[],d=Array.from(d);for(var b=0;b<d.length;){var P=d[b++];if(P.tag===5)Me(P)||m.push(P.stateNode);else for(P=P.child;P!==null;)d.push(P),P=P.sibling}return m}var vV=Math.ceil,Hv=a.ReactCurrentDispatcher,AS=a.ReactCurrentOwner,bi=a.ReactCurrentBatchConfig,Zt=0,ki=null,Ni=null,xr=0,no=0,Af=sn(0),Yi=0,bm=null,Cf=0,Gv=0,CS=0,Tm=null,Ss=null,PS=0,RS=1/0;function Pf(){RS=ei()+500}var Vv=!1,LS=null,cc=null,Wv=!1,uc=null,jv=0,Em=0,DS=null,Xv=-1,Yv=0;function os(){return Zt&6?ei():Xv!==-1?Xv:Xv=ei()}function hc(d){return d.mode&1?Zt&2&&xr!==0?xr&-xr:Au.transition!==null?(Yv===0&&(d=dl,dl<<=1,!(dl&4194240)&&(dl=64),Yv=d),Yv):(d=Jt,d!==0?d:Se()):1}function Uo(d,m,b){if(50<Em)throw Em=0,DS=null,Error(o(185));var P=qv(d,m);return P===null?null:(Fa(P,m,b),(!(Zt&2)||P!==ki)&&(P===ki&&(!(Zt&2)&&(Gv|=m),Yi===4&&fc(P,xr)),Ms(P,b),m===1&&Zt===0&&!(d.mode&1)&&(Pf(),Na&&ws())),P)}function qv(d,m){d.lanes|=m;var b=d.alternate;for(b!==null&&(b.lanes|=m),b=d,d=d.return;d!==null;)d.childLanes|=m,b=d.alternate,b!==null&&(b.childLanes|=m),b=d,d=d.return;return b.tag===3?b.stateNode:null}function Ms(d,m){var b=d.callbackNode;im(d,m);var P=bu(d,d===ki?xr:0);if(P===0)b!==null&&vf(b),d.callbackNode=null,d.callbackPriority=0;else if(m=P&-P,d.callbackPriority!==m){if(b!=null&&vf(b),m===1)d.tag===0?cm(y3.bind(null,d)):lm(y3.bind(null,d)),Ee?Re(function(){Zt===0&&ws()}):vl(Tu,ws),b=null;else{switch(rm(P)){case 1:b=Tu;break;case 4:b=hv;break;case 16:b=ts;break;case 536870912:b=om;break;default:b=ts}b=A3(b,v3.bind(null,d))}d.callbackPriority=m,d.callbackNode=b}}function v3(d,m){if(Xv=-1,Yv=0,Zt&6)throw Error(o(327));var b=d.callbackNode;if(Nu()&&d.callbackNode!==b)return null;var P=bu(d,d===ki?xr:0);if(P===0)return null;if(P&30||P&d.expiredLanes||m)m=Kv(d,P);else{m=P;var I=Zt;Zt|=2;var O=w3();(ki!==d||xr!==m)&&(Pf(),Fu(d,m));do try{_V();break}catch(ye){_3(d,ye)}while(!0);xf(),Hv.current=O,Zt=I,Ni!==null?m=0:(ki=null,xr=0,m=Yi)}if(m!==0){if(m===2&&(I=gl(d),I!==0&&(P=I,m=IS(d,I))),m===1)throw b=bm,Fu(d,0),fc(d,P),Ms(d,ei()),b;if(m===6)fc(d,P);else{if(I=d.current.alternate,!(P&30)&&!yV(I)&&(m=Kv(d,P),m===2&&(O=gl(d),O!==0&&(P=O,m=IS(d,O))),m===1))throw b=bm,Fu(d,0),fc(d,P),Ms(d,ei()),b;switch(d.finishedWork=I,d.finishedLanes=P,m){case 0:case 1:throw Error(o(345));case 2:ku(d,Ss);break;case 3:if(fc(d,P),(P&130023424)===P&&(m=PS+500-ei(),10<m)){if(bu(d,0)!==0)break;if(I=d.suspendedLanes,(I&P)!==P){os(),d.pingedLanes|=d.suspendedLanes&I;break}d.timeoutHandle=he(ku.bind(null,d,Ss),m);break}ku(d,Ss);break;case 4:if(fc(d,P),(P&4194240)===P)break;for(m=d.eventTimes,I=-1;0<P;){var se=31-yr(P);O=1<<se,se=m[se],se>I&&(I=se),P&=~O}if(P=I,P=ei()-P,P=(120>P?120:480>P?480:1080>P?1080:1920>P?1920:3e3>P?3e3:4320>P?4320:1960*vV(P/1960))-P,10<P){d.timeoutHandle=he(ku.bind(null,d,Ss),P);break}ku(d,Ss);break;case 5:ku(d,Ss);break;default:throw Error(o(329))}}}return Ms(d,ei()),d.callbackNode===b?v3.bind(null,d):null}function IS(d,m){var b=Tm;return d.current.memoizedState.isDehydrated&&(Fu(d,m).flags|=256),d=Kv(d,m),d!==2&&(m=Ss,Ss=b,m!==null&&US(m)),d}function US(d){Ss===null?Ss=d:Ss.push.apply(Ss,d)}function yV(d){for(var m=d;;){if(m.flags&16384){var b=m.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var P=0;P<b.length;P++){var I=b[P],O=I.getSnapshot;I=I.value;try{if(!Qs(O(),I))return!1}catch{return!1}}}if(b=m.child,m.subtreeFlags&16384&&b!==null)b.return=m,m=b;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function fc(d,m){for(m&=~CS,m&=~Gv,d.suspendedLanes|=m,d.pingedLanes&=~m,d=d.expirationTimes;0<m;){var b=31-yr(m),P=1<<b;d[b]=-1,m&=~P}}function y3(d){if(Zt&6)throw Error(o(327));Nu();var m=bu(d,0);if(!(m&1))return Ms(d,ei()),null;var b=Kv(d,m);if(d.tag!==0&&b===2){var P=gl(d);P!==0&&(m=P,b=IS(d,P))}if(b===1)throw b=bm,Fu(d,0),fc(d,m),Ms(d,ei()),b;if(b===6)throw Error(o(345));return d.finishedWork=d.current.alternate,d.finishedLanes=m,ku(d,Ss),Ms(d,ei()),null}function x3(d){uc!==null&&uc.tag===0&&!(Zt&6)&&Nu();var m=Zt;Zt|=1;var b=bi.transition,P=Jt;try{if(bi.transition=null,Jt=1,d)return d()}finally{Jt=P,bi.transition=b,Zt=m,!(Zt&6)&&ws()}}function FS(){no=Af.current,kt(Af)}function Fu(d,m){d.finishedWork=null,d.finishedLanes=0;var b=d.timeoutHandle;if(b!==G&&(d.timeoutHandle=G,le(b)),Ni!==null)for(b=Ni.return;b!==null;){var P=b;switch(Jw(P),P.tag){case 1:P=P.type.childContextTypes,P!=null&&$r();break;case 3:Tf(),kt(Rt),kt($t),sS();break;case 5:iS(P);break;case 4:Tf();break;case 13:kt(ti);break;case 19:kt(ti);break;case 10:or(P.type._context);break;case 22:case 23:FS()}b=b.return}if(ki=d,Ni=d=dc(d.current,null),xr=no=m,Yi=0,bm=null,CS=Gv=Cf=0,Ss=Tm=null,Js!==null){for(m=0;m<Js.length;m++)if(b=Js[m],P=b.interleaved,P!==null){b.interleaved=null;var I=P.next,O=b.pending;if(O!==null){var se=O.next;O.next=I,P.next=se}b.pending=P}Js=null}return d}function _3(d,m){do{var b=Ni;try{if(xf(),wv.current=Av,Sv){for(var P=hi.memoizedState;P!==null;){var I=P.queue;I!==null&&(I.pending=null),P=P.next}Sv=!1}if(Ef=0,ar=Ur=hi=null,mm=!1,gm=0,AS.current=null,b===null||b.return===null){Yi=1,bm=m,Ni=null;break}e:{var O=d,se=b.return,ye=b,Ne=m;if(m=xr,ye.flags|=32768,Ne!==null&&typeof Ne=="object"&&typeof Ne.then=="function"){var et=Ne,mt=ye,Bt=mt.tag;if(!(mt.mode&1)&&(Bt===0||Bt===11||Bt===15)){var Et=mt.alternate;Et?(mt.updateQueue=Et.updateQueue,mt.memoizedState=Et.memoizedState,mt.lanes=Et.lanes):(mt.updateQueue=null,mt.memoizedState=null)}var Rn=HP(se);if(Rn!==null){Rn.flags&=-257,GP(Rn,se,ye,O,m),Rn.mode&1&&BP(O,et,m),m=Rn,Ne=et;var Mt=m.updateQueue;if(Mt===null){var Nr=new Set;Nr.add(Ne),m.updateQueue=Nr}else Mt.add(Ne);break e}else{if(!(m&1)){BP(O,et,m),kS();break e}Ne=Error(o(426))}}else if(Kn&&ye.mode&1){var ko=HP(se);if(ko!==null){!(ko.flags&65536)&&(ko.flags|=256),GP(ko,se,ye,O,m),tS(Ne);break e}}O=Ne,Yi!==4&&(Yi=2),Tm===null?Tm=[O]:Tm.push(O),Ne=fS(Ne,ye),ye=se;do{switch(ye.tag){case 3:ye.flags|=65536,m&=-m,ye.lanes|=m;var Ce=OP(ye,Ne,m);oP(ye,Ce);break e;case 1:O=Ne;var we=ye.type,Ue=ye.stateNode;if(!(ye.flags&128)&&(typeof we.getDerivedStateFromError=="function"||Ue!==null&&typeof Ue.componentDidCatch=="function"&&(cc===null||!cc.has(Ue)))){ye.flags|=65536,m&=-m,ye.lanes|=m;var ut=zP(ye,O,m);oP(ye,ut);break e}}ye=ye.return}while(ye!==null)}M3(b)}catch(_t){m=_t,Ni===b&&b!==null&&(Ni=b=b.return);continue}break}while(!0)}function w3(){var d=Hv.current;return Hv.current=Av,d===null?Av:d}function kS(){(Yi===0||Yi===3||Yi===2)&&(Yi=4),ki===null||!(Cf&268435455)&&!(Gv&268435455)||fc(ki,xr)}function Kv(d,m){var b=Zt;Zt|=2;var P=w3();ki===d&&xr===m||Fu(d,m);do try{xV();break}catch(I){_3(d,I)}while(!0);if(xf(),Zt=b,Hv.current=P,Ni!==null)throw Error(o(261));return ki=null,xr=0,Yi}function xV(){for(;Ni!==null;)S3(Ni)}function _V(){for(;Ni!==null&&!sm();)S3(Ni)}function S3(d){var m=E3(d.alternate,d,no);d.memoizedProps=d.pendingProps,m===null?M3(d):Ni=m,AS.current=null}function M3(d){var m=d;do{var b=m.alternate;if(d=m.return,m.flags&32768){if(b=fV(b,m),b!==null){b.flags&=32767,Ni=b;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Yi=6,Ni=null;return}}else if(b=cV(b,m,no),b!==null){Ni=b;return}if(m=m.sibling,m!==null){Ni=m;return}Ni=m=d}while(m!==null);Yi===0&&(Yi=5)}function ku(d,m){var b=Jt,P=bi.transition;try{bi.transition=null,Jt=1,wV(d,m,b)}finally{bi.transition=P,Jt=b}return null}function wV(d,m,b){do Nu();while(uc!==null);if(Zt&6)throw Error(o(327));var P=d.finishedWork,I=d.finishedLanes;if(P===null)return null;if(d.finishedWork=null,d.finishedLanes=0,P===d.current)throw Error(o(177));d.callbackNode=null,d.callbackPriority=0;var O=P.lanes|P.childLanes;if(sc(d,O),d===ki&&(Ni=ki=null,xr=0),!(P.subtreeFlags&2064)&&!(P.flags&2064)||Wv||(Wv=!0,A3(ts,function(){return Nu(),null})),O=(P.flags&15990)!==0,P.subtreeFlags&15990||O){O=bi.transition,bi.transition=null;var se=Jt;Jt=1;var ye=Zt;Zt|=4,AS.current=null,pV(d,P),mV(d,P),j(d.containerInfo),d.current=P,gV(P),uv(),Zt=ye,Jt=se,bi.transition=O}else d.current=P;if(Wv&&(Wv=!1,uc=d,jv=I),O=d.pendingLanes,O===0&&(cc=null),am(P.stateNode),Ms(d,ei()),m!==null)for(b=d.onRecoverableError,P=0;P<m.length;P++)b(m[P]);if(Vv)throw Vv=!1,d=LS,LS=null,d;return jv&1&&d.tag!==0&&Nu(),O=d.pendingLanes,O&1?d===DS?Em++:(Em=0,DS=d):Em=0,ws(),null}function Nu(){if(uc!==null){var d=rm(jv),m=bi.transition,b=Jt;try{if(bi.transition=null,Jt=16>d?16:d,uc===null)var P=!1;else{if(d=uc,uc=null,jv=0,Zt&6)throw Error(o(331));var I=Zt;for(Zt|=4,at=d.current;at!==null;){var O=at,se=O.child;if(at.flags&16){var ye=O.deletions;if(ye!==null){for(var Ne=0;Ne<ye.length;Ne++){var et=ye[Ne];for(at=et;at!==null;){var mt=at;switch(mt.tag){case 0:case 11:case 15:Uu(8,mt,O)}var Bt=mt.child;if(Bt!==null)Bt.return=mt,at=Bt;else for(;at!==null;){mt=at;var Et=mt.sibling,Rn=mt.return;if(a3(mt),mt===et){at=null;break}if(Et!==null){Et.return=Rn,at=Et;break}at=Rn}}}var Mt=O.alternate;if(Mt!==null){var Nr=Mt.child;if(Nr!==null){Mt.child=null;do{var ko=Nr.sibling;Nr.sibling=null,Nr=ko}while(Nr!==null)}}at=O}}if(O.subtreeFlags&2064&&se!==null)se.return=O,at=se;else e:for(;at!==null;){if(O=at,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Uu(9,O,O.return)}var Ce=O.sibling;if(Ce!==null){Ce.return=O.return,at=Ce;break e}at=O.return}}var we=d.current;for(at=we;at!==null;){se=at;var Ue=se.child;if(se.subtreeFlags&2064&&Ue!==null)Ue.return=se,at=Ue;else e:for(se=we;at!==null;){if(ye=at,ye.flags&2048)try{switch(ye.tag){case 0:case 11:case 15:Sm(9,ye)}}catch(_t){bs(ye,ye.return,_t)}if(ye===se){at=null;break e}var ut=ye.sibling;if(ut!==null){ut.return=ye.return,at=ut;break e}at=ye.return}}if(Zt=I,ws(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(Eu,d)}catch{}P=!0}return P}finally{Jt=b,bi.transition=m}}return!1}function b3(d,m,b){m=fS(b,m),m=OP(d,m,1),lc(d,m),m=os(),d=qv(d,1),d!==null&&(Fa(d,1,m),Ms(d,m))}function bs(d,m,b){if(d.tag===3)b3(d,d,b);else for(;m!==null;){if(m.tag===3){b3(m,d,b);break}else if(m.tag===1){var P=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(cc===null||!cc.has(P))){d=fS(b,d),d=zP(m,d,1),lc(m,d),d=os(),m=qv(m,1),m!==null&&(Fa(m,1,d),Ms(m,d));break}}m=m.return}}function SV(d,m,b){var P=d.pingCache;P!==null&&P.delete(m),m=os(),d.pingedLanes|=d.suspendedLanes&b,ki===d&&(xr&b)===b&&(Yi===4||Yi===3&&(xr&130023424)===xr&&500>ei()-PS?Fu(d,0):CS|=b),Ms(d,m)}function T3(d,m){m===0&&(d.mode&1?(m=pl,pl<<=1,!(pl&130023424)&&(pl=4194304)):m=1);var b=os();d=qv(d,m),d!==null&&(Fa(d,m,b),Ms(d,b))}function MV(d){var m=d.memoizedState,b=0;m!==null&&(b=m.retryLane),T3(d,b)}function bV(d,m){var b=0;switch(d.tag){case 13:var P=d.stateNode,I=d.memoizedState;I!==null&&(b=I.retryLane);break;case 19:P=d.stateNode;break;default:throw Error(o(314))}P!==null&&P.delete(m),T3(d,b)}var E3;E3=function(d,m,b){if(d!==null)if(d.memoizedProps!==m.pendingProps||Rt.current)to=!0;else{if(!(d.lanes&b)&&!(m.flags&128))return to=!1,hV(d,m,b);to=!!(d.flags&131072)}else to=!1,Kn&&m.flags&1048576&&fP(m,yv,m.index);switch(m.lanes=0,m.tag){case 2:var P=m.type;d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2),d=m.pendingProps;var I=Xi(m,$t.current);Si(m,b),I=aS(null,m,P,d,I,b);var O=lS();return m.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,dn(P)?(O=!0,Co(m)):O=!1,m.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,qw(m),I.updater=gv,m.stateNode=I,I._reactInternals=m,Zw(m,P,d,b),m=mS(null,m,P,!0,O,b)):(m.tag=0,Kn&&O&&Qw(m),ss(null,m,I,b),m=m.child),m;case 16:P=m.elementType;e:{switch(d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2),d=m.pendingProps,I=P._init,P=I(P._payload),m.type=P,I=m.tag=EV(P),d=is(P,d),I){case 0:m=pS(null,m,P,d,b);break e;case 1:m=ZP(null,m,P,d,b);break e;case 11:m=jP(null,m,P,d,b);break e;case 14:m=XP(null,m,P,is(P.type,d),b);break e}throw Error(o(306,P,""))}return m;case 0:return P=m.type,I=m.pendingProps,I=m.elementType===P?I:is(P,I),pS(d,m,P,I,b);case 1:return P=m.type,I=m.pendingProps,I=m.elementType===P?I:is(P,I),ZP(d,m,P,I,b);case 3:e:{if(QP(m),d===null)throw Error(o(387));P=m.pendingProps,O=m.memoizedState,I=O.element,sP(d,m),mv(m,P,null,b);var se=m.memoizedState;if(P=se.element,Y&&O.isDehydrated)if(O={element:P,isDehydrated:!1,cache:se.cache,transitions:se.transitions},m.updateQueue.baseState=O,m.memoizedState=O,m.flags&256){I=Error(o(423)),m=JP(d,m,P,b,I);break e}else if(P!==I){I=Error(o(424)),m=JP(d,m,P,b,I);break e}else for(Y&&(eo=ci(m.stateNode.containerInfo),$s=m,Kn=!0,ha=null,um=!1),b=yP(m,null,P,b),m.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Sf(),P===I){m=Sl(d,m,b);break e}ss(d,m,P,b)}m=m.child}return m;case 5:return xP(m),d===null&&eS(m),P=m.type,I=m.pendingProps,O=d!==null?d.memoizedProps:null,se=I.children,te(P,I)?se=null:O!==null&&te(P,O)&&(m.flags|=32),KP(d,m),ss(d,m,se,b),m.child;case 6:return d===null&&eS(m),null;case 13:return $P(d,m,b);case 4:return nS(m,m.stateNode.containerInfo),P=m.pendingProps,d===null?m.child=Mf(m,null,P,b):ss(d,m,P,b),m.child;case 11:return P=m.type,I=m.pendingProps,I=m.elementType===P?I:is(P,I),jP(d,m,P,I,b);case 7:return ss(d,m,m.pendingProps,b),m.child;case 8:return ss(d,m,m.pendingProps.children,b),m.child;case 12:return ss(d,m,m.pendingProps.children,b),m.child;case 10:e:{if(P=m.type._context,I=m.pendingProps,O=m.memoizedProps,se=I.value,dv(m,P,se),O!==null)if(Qs(O.value,se)){if(O.children===I.children&&!Rt.current){m=Sl(d,m,b);break e}}else for(O=m.child,O!==null&&(O.return=m);O!==null;){var ye=O.dependencies;if(ye!==null){se=O.child;for(var Ne=ye.firstContext;Ne!==null;){if(Ne.context===P){if(O.tag===1){Ne=yl(-1,b&-b),Ne.tag=2;var et=O.updateQueue;if(et!==null){et=et.shared;var mt=et.pending;mt===null?Ne.next=Ne:(Ne.next=mt.next,mt.next=Ne),et.pending=Ne}}O.lanes|=b,Ne=O.alternate,Ne!==null&&(Ne.lanes|=b),rs(O.return,b,m),ye.lanes|=b;break}Ne=Ne.next}}else if(O.tag===10)se=O.type===m.type?null:O.child;else if(O.tag===18){if(se=O.return,se===null)throw Error(o(341));se.lanes|=b,ye=se.alternate,ye!==null&&(ye.lanes|=b),rs(se,b,m),se=O.sibling}else se=O.child;if(se!==null)se.return=O;else for(se=O;se!==null;){if(se===m){se=null;break}if(O=se.sibling,O!==null){O.return=se.return,se=O;break}se=se.return}O=se}ss(d,m,I.children,b),m=m.child}return m;case 9:return I=m.type,P=m.pendingProps.children,Si(m,b),I=Mi(I),P=P(I),m.flags|=1,ss(d,m,P,b),m.child;case 14:return P=m.type,I=is(P,m.pendingProps),I=is(P.type,I),XP(d,m,P,I,b);case 15:return YP(d,m,m.type,m.pendingProps,b);case 17:return P=m.type,I=m.pendingProps,I=m.elementType===P?I:is(P,I),d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2),m.tag=1,dn(P)?(d=!0,Co(m)):d=!1,Si(m,b),uP(m,P,I),Zw(m,P,I,b),mS(null,m,P,!0,d,b);case 19:return i3(d,m,b);case 22:return qP(d,m,b)}throw Error(o(156,m.tag))};function A3(d,m){return vl(d,m)}function TV(d,m,b,P){this.tag=d,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fo(d,m,b,P){return new TV(d,m,b,P)}function NS(d){return d=d.prototype,!(!d||!d.isReactComponent)}function EV(d){if(typeof d=="function")return NS(d)?1:0;if(d!=null){if(d=d.$$typeof,d===x)return 11;if(d===_)return 14}return 2}function dc(d,m){var b=d.alternate;return b===null?(b=Fo(d.tag,m,d.key,d.mode),b.elementType=d.elementType,b.type=d.type,b.stateNode=d.stateNode,b.alternate=d,d.alternate=b):(b.pendingProps=m,b.type=d.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=d.flags&14680064,b.childLanes=d.childLanes,b.lanes=d.lanes,b.child=d.child,b.memoizedProps=d.memoizedProps,b.memoizedState=d.memoizedState,b.updateQueue=d.updateQueue,m=d.dependencies,b.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},b.sibling=d.sibling,b.index=d.index,b.ref=d.ref,b}function Zv(d,m,b,P,I,O){var se=2;if(P=d,typeof d=="function")NS(d)&&(se=1);else if(typeof d=="string")se=5;else e:switch(d){case u:return Ou(b.children,I,O,m);case h:se=8,I|=8;break;case f:return d=Fo(12,b,m,I|2),d.elementType=f,d.lanes=O,d;case y:return d=Fo(13,b,m,I),d.elementType=y,d.lanes=O,d;case g:return d=Fo(19,b,m,I),d.elementType=g,d.lanes=O,d;case S:return Qv(b,I,O,m);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case p:se=10;break e;case v:se=9;break e;case x:se=11;break e;case _:se=14;break e;case w:se=16,P=null;break e}throw Error(o(130,d==null?d:typeof d,""))}return m=Fo(se,b,m,I),m.elementType=d,m.type=P,m.lanes=O,m}function Ou(d,m,b,P){return d=Fo(7,d,P,m),d.lanes=b,d}function Qv(d,m,b,P){return d=Fo(22,d,P,m),d.elementType=S,d.lanes=b,d.stateNode={},d}function OS(d,m,b){return d=Fo(6,d,null,m),d.lanes=b,d}function zS(d,m,b){return m=Fo(4,d.children!==null?d.children:[],d.key,m),m.lanes=b,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}function AV(d,m,b,P,I){this.tag=m,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=G,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gf(0),this.expirationTimes=gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gf(0),this.identifierPrefix=P,this.onRecoverableError=I,Y&&(this.mutableSourceEagerHydrationData=null)}function C3(d,m,b,P,I,O,se,ye,Ne){return d=new AV(d,m,b,ye,Ne),m===1?(m=1,O===!0&&(m|=8)):m=0,O=Fo(3,null,null,m),d.current=O,O.stateNode=d,O.memoizedState={element:P,isDehydrated:b,cache:null,transitions:null},qw(O),d}function P3(d){if(!d)return dt;d=d._reactInternals;e:{if(L(d)!==d||d.tag!==1)throw Error(o(170));var m=d;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(dn(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(o(171))}if(d.tag===1){var b=d.type;if(dn(b))return es(d,b,m)}return m}function R3(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(o(188)):(d=Object.keys(d).join(","),Error(o(268,d)));return d=D(m),d===null?null:d.stateNode}function L3(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var b=d.retryLane;d.retryLane=b!==0&&b<m?b:m}}function BS(d,m){L3(d,m),(d=d.alternate)&&L3(d,m)}function CV(d){return d=D(d),d===null?null:d.stateNode}function PV(){return null}return t.attemptContinuousHydration=function(d){if(d.tag===13){var m=os();Uo(d,134217728,m),BS(d,134217728)}},t.attemptHydrationAtCurrentPriority=function(d){if(d.tag===13){var m=os(),b=hc(d);Uo(d,b,m),BS(d,b)}},t.attemptSynchronousHydration=function(d){switch(d.tag){case 3:var m=d.stateNode;if(m.current.memoizedState.isDehydrated){var b=ml(m.pendingLanes);b!==0&&(ka(m,b|1),Ms(m,ei()),!(Zt&6)&&(Pf(),ws()))}break;case 13:var P=os();x3(function(){return Uo(d,1,P)}),BS(d,1)}},t.batchedUpdates=function(d,m){var b=Zt;Zt|=1;try{return d(m)}finally{Zt=b,Zt===0&&(Pf(),Na&&ws())}},t.createComponentSelector=function(d){return{$$typeof:kv,value:d}},t.createContainer=function(d,m,b,P,I,O,se){return C3(d,m,!1,null,b,P,I,O,se)},t.createHasPseudoClassSelector=function(d){return{$$typeof:Nv,value:d}},t.createHydrationContainer=function(d,m,b,P,I,O,se,ye,Ne){return d=C3(b,P,!0,d,I,O,se,ye,Ne),d.context=P3(null),b=d.current,P=os(),I=hc(b),O=yl(P,I),O.callback=m??null,lc(b,O),d.current.lanes=I,Fa(d,I,P),Ms(d,P),d},t.createPortal=function(d,m,b){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:P==null?null:""+P,children:d,containerInfo:m,implementation:b}},t.createRoleSelector=function(d){return{$$typeof:Ov,value:d}},t.createTestNameSelector=function(d){return{$$typeof:zv,value:d}},t.createTextSelector=function(d){return{$$typeof:Bv,value:d}},t.deferredUpdates=function(d){var m=Jt,b=bi.transition;try{return bi.transition=null,Jt=16,d()}finally{Jt=m,bi.transition=b}},t.discreteUpdates=function(d,m,b,P,I){var O=Jt,se=bi.transition;try{return bi.transition=null,Jt=1,d(m,b,P,I)}finally{Jt=O,bi.transition=se,Zt===0&&Pf()}},t.findAllNodes=ES,t.findBoundingRects=function(d,m){if(!K)throw Error(o(363));m=ES(d,m),d=[];for(var b=0;b<m.length;b++)d.push(ue(m[b]));for(m=d.length-1;0<m;m--){b=d[m];for(var P=b.x,I=P+b.width,O=b.y,se=O+b.height,ye=m-1;0<=ye;ye--)if(m!==ye){var Ne=d[ye],et=Ne.x,mt=et+Ne.width,Bt=Ne.y,Et=Bt+Ne.height;if(P>=et&&O>=Bt&&I<=mt&&se<=Et){d.splice(m,1);break}else if(P!==et||b.width!==Ne.width||Et<O||Bt>se){if(!(O!==Bt||b.height!==Ne.height||mt<P||et>I)){et>P&&(Ne.width+=et-P,Ne.x=P),mt<I&&(Ne.width=I-et),d.splice(m,1);break}}else{Bt>O&&(Ne.height+=Bt-O,Ne.y=O),Et<se&&(Ne.height=se-Bt),d.splice(m,1);break}}}return d},t.findHostInstance=R3,t.findHostInstanceWithNoPortals=function(d){return d=R(d),d=d!==null?z(d):null,d===null?null:d.stateNode},t.findHostInstanceWithWarning=function(d){return R3(d)},t.flushControlled=function(d){var m=Zt;Zt|=1;var b=bi.transition,P=Jt;try{bi.transition=null,Jt=1,d()}finally{Jt=P,bi.transition=b,Zt=m,Zt===0&&(Pf(),ws())}},t.flushPassiveEffects=Nu,t.flushSync=x3,t.focusWithin=function(d,m){if(!K)throw Error(o(363));for(d=MS(d),m=g3(d,m),m=Array.from(m),d=0;d<m.length;){var b=m[d++];if(!Me(b)){if(b.tag===5&&Ye(b.stateNode))return!0;for(b=b.child;b!==null;)m.push(b),b=b.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Jt},t.getFindAllNodesFailureDescription=function(d,m){if(!K)throw Error(o(363));var b=0,P=[];d=[MS(d),0];for(var I=0;I<d.length;){var O=d[I++],se=d[I++],ye=m[se];if((O.tag!==5||!Me(O))&&(bS(O,ye)&&(P.push(TS(ye)),se++,se>b&&(b=se)),se<m.length))for(O=O.child;O!==null;)d.push(O,se),O=O.sibling}if(b<m.length){for(d=[];b<m.length;b++)d.push(TS(m[b]));return`findAllNodes was able to match part of the selector:
  `+(P.join(" > ")+`

No matching component was found for:
  `)+d.join(" > ")}return null},t.getPublicRootInstance=function(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return H(d.child.stateNode);default:return d.child.stateNode}},t.injectIntoDevTools=function(d){if(d={bundleType:d.bundleType,version:d.version,rendererPackageName:d.rendererPackageName,rendererConfig:d.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:CV,findFiberByHostInstance:d.findFiberByHostInstance||PV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")d=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)d=!0;else{try{Eu=m.inject(d),Zs=m}catch{}d=!!m.checkDCE}}return d},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(d,m,b,P){if(!K)throw Error(o(363));d=ES(d,m);var I=Ie(d,b,P).disconnect;return{disconnect:function(){I()}}},t.registerMutableSourceForHydration=function(d,m){var b=m._getVersion;b=b(m._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[m,b]:d.mutableSourceEagerHydrationData.push(m,b)},t.runWithPriority=function(d,m){var b=Jt;try{return Jt=d,m()}finally{Jt=b}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(d,m,b,P){var I=m.current,O=os(),se=hc(I);return b=P3(b),m.context===null?m.context=b:m.pendingContext=b,m=yl(O,se),m.payload={element:d},P=P===void 0?null:P,P!==null&&(m.callback=P),lc(I,m),d=Uo(I,se,O),d!==null&&pv(d,I,se),se},t};yG.exports=moe;var goe=yG.exports;const voe=hf(goe);var xG={exports:{}},_G={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(U,X){var j=U.length;U.push(X);e:for(;0<j;){var B=j-1>>>1,Z=U[B];if(0<r(Z,X))U[B]=X,U[j]=Z,j=B;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],j=U.pop();if(j!==X){U[0]=j;e:for(var B=0,Z=U.length,ie=Z>>>1;B<ie;){var V=2*(B+1)-1,te=U[V],fe=V+1,he=U[fe];if(0>r(te,j))fe<Z&&0>r(he,te)?(U[B]=he,U[fe]=j,B=fe):(U[B]=te,U[V]=j,B=V);else if(fe<Z&&0>r(he,j))U[B]=he,U[fe]=j,B=fe;else break e}}return X}function r(U,X){var j=U.sortIndex-X.sortIndex;return j!==0?j:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function S(U){if(x=!1,w(U),!v)if(t(l)!==null)v=!0,H(C);else{var X=t(c);X!==null&&$(S,X.startTime-U)}}function C(U,X){v=!1,x&&(x=!1,g(T),T=-1),p=!0;var j=f;try{for(w(X),h=t(l);h!==null&&(!(h.expirationTime>X)||U&&!R());){var B=h.callback;if(typeof B=="function"){h.callback=null,f=h.priorityLevel;var Z=B(h.expirationTime<=X);X=i.unstable_now(),typeof Z=="function"?h.callback=Z:h===t(l)&&n(l),w(X)}else n(l);h=t(l)}if(h!==null)var ie=!0;else{var V=t(c);V!==null&&$(S,V.startTime-X),ie=!1}return ie}finally{h=null,f=j,p=!1}}var E=!1,A=null,T=-1,L=5,M=-1;function R(){return!(i.unstable_now()-M<L)}function D(){if(A!==null){var U=i.unstable_now();M=U;var X=!0;try{X=A(!0,U)}finally{X?F():(E=!1,A=null)}}else E=!1}var F;if(typeof _=="function")F=function(){_(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,q=z.port2;z.port1.onmessage=D,F=function(){q.postMessage(null)}}else F=function(){y(D,0)};function H(U){A=U,E||(E=!0,F())}function $(U,X){T=y(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){v||p||(v=!0,H(C))},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return f},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var j=f;f=X;try{return U()}finally{f=j}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=f;f=U;try{return X()}finally{f=j}},i.unstable_scheduleCallback=function(U,X,j){var B=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?B+j:B):j=B,U){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=j+Z,U={id:u++,callback:X,priorityLevel:U,startTime:j,expirationTime:Z,sortIndex:-1},j>B?(U.sortIndex=j,e(c,U),t(l)===null&&U===t(c)&&(x?(g(T),T=-1):x=!0,$(S,j-B))):(U.sortIndex=Z,e(l,U),v||p||(v=!0,H(C))),U},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(U){var X=f;return function(){var j=f;f=X;try{return U.apply(this,arguments)}finally{f=j}}}})(_G);xG.exports=_G;var BI=xG.exports;const yoe=i=>typeof i=="object"&&typeof i.then=="function",Rx=[];function xoe(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(i[r],e[r]))return!1;return!0}function _oe(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const s of Rx)if(xoe(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=Rx.indexOf(r);s!==-1&&Rx.splice(s,1)},promise:(yoe(i)?i:i(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(Rx.push(r),!t)throw r.promise}const woe=(i,e,t)=>_oe(i,e,!1,t),JC={},$C=i=>void Object.assign(JC,i);function Soe(i,e){function t(u,{args:h=[],attach:f,...p},v){let x=`${u[0].toUpperCase()}${u.slice(1)}`,y;if(u==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const g=p.object;y=pd(g,{type:u,root:v,attach:f,primitive:!0})}else{const g=JC[x];if(!g)throw new Error(`R3F: ${x} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(h))throw new Error("R3F: The args prop must be an array!");y=pd(new g(...h),{type:u,root:v,attach:f,memoizedProps:{args:h}})}return y.__r3f.attach===void 0&&(y instanceof yt?y.__r3f.attach="geometry":y instanceof Di&&(y.__r3f.attach="material")),x!=="inject"&&Qb(y,p),y}function n(u,h){let f=!1;if(h){var p,v;(p=h.__r3f)!=null&&p.attach?Zb(u,h,h.__r3f.attach):h.isObject3D&&u.isObject3D&&(u.add(h),f=!0),f||(v=u.__r3f)==null||v.objects.push(h),h.__r3f||pd(h,{}),h.__r3f.parent=u,FE(h),md(h)}}function r(u,h,f){let p=!1;if(h){var v,x;if((v=h.__r3f)!=null&&v.attach)Zb(u,h,h.__r3f.attach);else if(h.isObject3D&&u.isObject3D){h.parent=u,h.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:h});const y=u.children.filter(_=>_!==h),g=y.indexOf(f);u.children=[...y.slice(0,g),h,...y.slice(g)],p=!0}p||(x=u.__r3f)==null||x.objects.push(h),h.__r3f||pd(h,{}),h.__r3f.parent=u,FE(h),md(h)}}function s(u,h,f=!1){u&&[...u].forEach(p=>o(h,p,f))}function o(u,h,f){if(h){var p,v,x;if(h.__r3f&&(h.__r3f.parent=null),(p=u.__r3f)!=null&&p.objects&&(u.__r3f.objects=u.__r3f.objects.filter(S=>S!==h)),(v=h.__r3f)!=null&&v.attach)jI(u,h,h.__r3f.attach);else if(h.isObject3D&&u.isObject3D){var y;u.remove(h),(y=h.__r3f)!=null&&y.root&&Roe(S1(h),h)}const _=(x=h.__r3f)==null?void 0:x.primitive,w=!_&&(f===void 0?h.dispose!==null:f);if(!_){var g;s((g=h.__r3f)==null?void 0:g.objects,h,w),s(h.children,h,w)}if(delete h.__r3f,w&&h.dispose&&h.type!=="Scene"){const S=()=>{try{h.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?BI.unstable_scheduleCallback(BI.unstable_IdlePriority,S):S()}md(u)}}function a(u,h,f,p){var v;const x=(v=u.__r3f)==null?void 0:v.parent;if(!x)return;const y=t(h,f,u.__r3f.root);if(u.children){for(const g of u.children)g.__r3f&&n(y,g);u.children=u.children.filter(g=>!g.__r3f)}u.__r3f.objects.forEach(g=>n(y,g)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(x,u),y.parent&&(y.__r3f.autoRemovedBeforeAppend=!0),n(x,y),y.raycast&&y.__r3f.eventCount&&S1(y).getState().internal.interaction.push(y),[p,p.alternate].forEach(g=>{g!==null&&(g.stateNode=y,g.ref&&(typeof g.ref=="function"?g.ref(y):g.ref.current=y))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:voe({createInstance:t,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,h)=>{if(!h)return;const f=u.getState().scene;f.__r3f&&(f.__r3f.root=u,n(f,h))},removeChildFromContainer:(u,h)=>{h&&o(u.getState().scene,h)},insertInContainerBefore:(u,h,f)=>{if(!h||!f)return;const p=u.getState().scene;p.__r3f&&r(p,h,f)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var h;return!!((h=u==null?void 0:u.__r3f)!=null?h:{}).handlers},prepareUpdate(u,h,f,p){var v;if(((v=u==null?void 0:u.__r3f)!=null?v:{}).primitive&&p.object&&p.object!==u)return[!0];{const{args:y=[],children:g,..._}=p,{args:w=[],children:S,...C}=f;if(!Array.isArray(y))throw new Error("R3F: the args prop must be an array!");if(y.some((A,T)=>A!==w[T]))return[!0];const E=AG(u,_,C,!0);return E.changes.length?[!1,E]:null}},commitUpdate(u,[h,f],p,v,x,y){h?a(u,p,x,y):Qb(u,f)},commitMount(u,h,f,p){var v;const x=(v=u.__r3f)!=null?v:{};u.raycast&&x.handlers&&x.eventCount&&S1(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>pd(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var h;const{attach:f,parent:p}=(h=u.__r3f)!=null?h:{};f&&p&&jI(p,u,f),u.isObject3D&&(u.visible=!1),md(u)},unhideInstance(u,h){var f;const{attach:p,parent:v}=(f=u.__r3f)!=null?f:{};p&&v&&Zb(v,u,p),(u.isObject3D&&h.visible==null||h.visible)&&(u.visible=!0),md(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Fd.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Vn.fun(performance.now)?performance.now:Vn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Vn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Vn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Qb}}var HI,GI;const Kb=i=>"colorSpace"in i||"outputColorSpace"in i,wG=()=>{var i;return(i=JC.ColorManagement)!=null?i:null},SG=i=>i&&i.isOrthographicCamera,Moe=i=>i&&i.hasOwnProperty("current"),rv=typeof window<"u"&&((HI=window.document)!=null&&HI.createElement||((GI=window.navigator)==null?void 0:GI.product)==="ReactNative")?re.useLayoutEffect:re.useEffect;function MG(i){const e=re.useRef(i);return rv(()=>void(e.current=i),[i]),e}function boe({set:i}){return rv(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}class bG extends re.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}bG.getDerivedStateFromError=()=>({error:!0});const TG="__default",VI=new Map,Toe=i=>i&&!!i.memoized&&!!i.changes;function EG(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}const og=i=>{var e;return(e=i.__r3f)==null?void 0:e.root.getState()};function S1(i){let e=i.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Vn={obj:i=>i===Object(i)&&!Vn.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Vn.str(i)||Vn.num(i)||Vn.boo(i))return i===e;const s=Vn.obj(i);if(s&&n==="reference")return i===e;const o=Vn.arr(i);if(o&&t==="reference")return i===e;if((o||s)&&i===e)return!0;let a;for(a in i)if(!(a in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(a in r?e:i)if(!Vn.equ(i[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:i)if(i[a]!==e[a])return!1;if(Vn.und(a)){if(o&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function Eoe(i){i.dispose&&i.type!=="Scene"&&i.dispose();for(const e in i)e.dispose==null||e.dispose(),delete i[e]}function pd(i,e){const t=i;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},i}function UE(i,e){let t=i;if(e.includes("-")){const n=e.split("-"),r=n.pop();return t=n.reduce((s,o)=>s[o],i),{target:t,key:r}}else return{target:t,key:e}}const WI=/-\d+$/;function Zb(i,e,t){if(Vn.str(t)){if(WI.test(t)){const s=t.replace(WI,""),{target:o,key:a}=UE(i,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:r}=UE(i,t);e.__r3f.previousAttach=n[r],n[r]=e}else e.__r3f.previousAttach=t(i,e)}function jI(i,e,t){var n,r;if(Vn.str(t)){const{target:s,key:o}=UE(i,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(i,e);(r=e.__r3f)==null||delete r.previousAttach}function AG(i,{children:e,key:t,ref:n,...r},{children:s,key:o,ref:a,...l}={},c=!1){const u=i.__r3f,h=Object.entries(r),f=[];if(c){const v=Object.keys(l);for(let x=0;x<v.length;x++)r.hasOwnProperty(v[x])||h.unshift([v[x],TG+"remove"])}h.forEach(([v,x])=>{var y;if((y=i.__r3f)!=null&&y.primitive&&v==="object"||Vn.equ(x,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return f.push([v,x,!0,[]]);let g=[];v.includes("-")&&(g=v.split("-")),f.push([v,x,!1,g]);for(const _ in r){const w=r[_];_.startsWith(`${v}-`)&&f.push([_,w,!1,_.split("-")])}});const p={...r};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}const Aoe=typeof process<"u"&&!1;function Qb(i,e){var t;const n=i.__r3f,r=n==null?void 0:n.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=Toe(e)?e:AG(i,e),l=n==null?void 0:n.eventCount;i.__r3f&&(i.__r3f.memoizedProps=o);for(let u=0;u<a.length;u++){let[h,f,p,v]=a[u];if(Kb(i)){const _="srgb",w="srgb-linear";h==="encoding"?(h="colorSpace",f=f===3001?_:w):h==="outputEncoding"&&(h="outputColorSpace",f=f===3001?_:w)}let x=i,y=x[h];if(v.length&&(y=v.reduce((g,_)=>g[_],i),!(y&&y.set))){const[g,..._]=v.reverse();x=_.reverse().reduce((w,S)=>w[S],i),h=g}if(f===TG+"remove")if(x.constructor){let g=VI.get(x.constructor);g||(g=new x.constructor,VI.set(x.constructor,g)),f=g[h]}else f=0;if(p&&n)f?n.handlers[h]=f:delete n.handlers[h],n.eventCount=Object.keys(n.handlers).length;else if(y&&y.set&&(y.copy||y instanceof Rh)){if(Array.isArray(f))y.fromArray?y.fromArray(f):y.set(...f);else if(y.copy&&f&&f.constructor&&(Aoe?y.constructor.name===f.constructor.name:y.constructor===f.constructor))y.copy(f);else if(f!==void 0){const g=y instanceof Ge;!g&&y.setScalar?y.setScalar(f):y instanceof Rh&&f instanceof Rh?y.mask=f.mask:y.set(f),!wG()&&s&&!s.linear&&g&&y.convertSRGBToLinear()}}else if(x[h]=f,x[h]instanceof Cn&&x[h].format===fr&&x[h].type===Pa&&s){const g=x[h];Kb(g)&&Kb(s.gl)?g.colorSpace=s.gl.outputColorSpace:g.encoding=s.gl.outputEncoding}md(i)}if(n&&n.parent&&i.raycast&&l!==n.eventCount){const u=S1(i).getState().internal,h=u.interaction.indexOf(i);h>-1&&u.interaction.splice(h,1),n.eventCount&&u.interaction.push(i)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=i.__r3f)!=null&&t.parent&&FE(i),i}function md(i){var e,t;const n=(e=i.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function FE(i){i.onUpdate==null||i.onUpdate(i)}function Coe(i,e){i.manual||(SG(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function Lx(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function Poe(){var i;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Fd.DefaultEventPriority;switch((i=e.event)==null?void 0:i.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Fd.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Fd.ContinuousEventPriority;default:return Fd.DefaultEventPriority}}function CG(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function Roe(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{CG(t.capturedMap,e,n,r)})}function Loe(i){function e(l){const{internal:c}=i.getState(),u=l.offsetX-c.initialClick[0],h=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+h*h))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var h;return(h=c.__r3f)==null?void 0:h.handlers["onPointer"+u]}))}function n(l,c){const u=i.getState(),h=new Set,f=[],p=c?c(u.internal.interaction):u.internal.interaction;for(let g=0;g<p.length;g++){const _=og(p[g]);_&&(_.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function v(g){const _=og(g);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var w;_.events.compute==null||_.events.compute(l,_,(w=_.previousRoot)==null?void 0:w.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(g,!0):[]}let x=p.flatMap(v).sort((g,_)=>{const w=og(g.object),S=og(_.object);return!w||!S?g.distance-_.distance:S.events.priority-w.events.priority||g.distance-_.distance}).filter(g=>{const _=Lx(g);return h.has(_)?!1:(h.add(_),!0)});u.events.filter&&(x=u.events.filter(x,u));for(const g of x){let _=g.object;for(;_;){var y;(y=_.__r3f)!=null&&y.eventCount&&f.push({...g,eventObject:_}),_=_.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let g of u.internal.capturedMap.get(l.pointerId).values())h.has(Lx(g.intersection))||f.push(g.intersection);return f}function r(l,c,u,h){const f=i.getState();if(l.length){const p={stopped:!1};for(const v of l){const x=og(v.object)||f,{raycaster:y,pointer:g,camera:_,internal:w}=x,S=new N(g.x,g.y,0).unproject(_),C=M=>{var R,D;return(R=(D=w.capturedMap.get(M))==null?void 0:D.has(v.eventObject))!=null?R:!1},E=M=>{const R={intersection:v,target:c.target};w.capturedMap.has(M)?w.capturedMap.get(M).set(v.eventObject,R):w.capturedMap.set(M,new Map([[v.eventObject,R]])),c.target.setPointerCapture(M)},A=M=>{const R=w.capturedMap.get(M);R&&CG(w.capturedMap,v.eventObject,R,M)};let T={};for(let M in c){let R=c[M];typeof R!="function"&&(T[M]=R)}let L={...v,...T,pointer:g,intersections:l,stopped:p.stopped,delta:u,unprojectedPoint:S,ray:y.ray,camera:_,stopPropagation(){const M="pointerId"in c&&w.capturedMap.get(c.pointerId);if((!M||M.has(v.eventObject))&&(L.stopped=p.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(R=>R.eventObject===v.eventObject))){const R=l.slice(0,l.indexOf(v));s([...R,v])}},target:{hasPointerCapture:C,setPointerCapture:E,releasePointerCapture:A},currentTarget:{hasPointerCapture:C,setPointerCapture:E,releasePointerCapture:A},nativeEvent:c};if(h(L),p.stopped===!0)break}}return l}function s(l){const{internal:c}=i.getState();for(const u of c.hovered.values())if(!l.length||!l.find(h=>h.object===u.object&&h.index===u.index&&h.instanceId===u.instanceId)){const f=u.eventObject.__r3f,p=f==null?void 0:f.handlers;if(c.hovered.delete(Lx(u)),f!=null&&f.eventCount){const v={...u,intersections:l};p.onPointerOut==null||p.onPointerOut(v),p.onPointerLeave==null||p.onPointerLeave(v)}}}function o(l,c){for(let u=0;u<c.length;u++){const h=c[u].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=i.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:h,internal:f}=i.getState();f.lastEvent.current=u;const p=l==="onPointerMove",v=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=n(u,p?t:void 0),g=v?e(u):0;l==="onPointerDown"&&(f.initialClick=[u.offsetX,u.offsetY],f.initialHits=y.map(w=>w.eventObject)),v&&!y.length&&g<=2&&(o(u,f.interaction),h&&h(u)),p&&s(y);function _(w){const S=w.eventObject,C=S.__r3f,E=C==null?void 0:C.handlers;if(C!=null&&C.eventCount)if(p){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const A=Lx(w),T=f.hovered.get(A);T?T.stopped&&w.stopPropagation():(f.hovered.set(A,w),E.onPointerOver==null||E.onPointerOver(w),E.onPointerEnter==null||E.onPointerEnter(w))}E.onPointerMove==null||E.onPointerMove(w)}else{const A=E[l];A?(!v||f.initialHits.includes(S))&&(o(u,f.interaction.filter(T=>!f.initialHits.includes(T))),A(w)):v&&f.initialHits.includes(S)&&o(u,f.interaction.filter(T=>!f.initialHits.includes(T)))}}r(y,u,g,_)}}return{handlePointer:a}}const PG=i=>!!(i!=null&&i.render),RG=re.createContext(null),Doe=(i,e)=>{const t=foe((a,l)=>{const c=new N,u=new N,h=new N;function f(g=l().camera,_=u,w=l().size){const{width:S,height:C,top:E,left:A}=w,T=S/C;_ instanceof N?h.copy(_):h.set(..._);const L=g.getWorldPosition(c).distanceTo(h);if(SG(g))return{width:S/g.zoom,height:C/g.zoom,top:E,left:A,factor:1,distance:L,aspect:T};{const M=g.fov*Math.PI/180,R=2*Math.tan(M/2)*L,D=R*(S/C);return{width:D,height:R,top:E,left:A,factor:S/D,distance:L,aspect:T}}}let p;const v=g=>a(_=>({performance:{..._.performance,current:g}})),x=new be;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(g=1)=>i(l(),g),advance:(g,_)=>e(g,_,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new bw,pointer:x,mouse:x,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=l();p&&clearTimeout(p),g.performance.current!==g.performance.min&&v(g.performance.min),p=setTimeout(()=>v(l().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:f},setEvents:g=>a(_=>({..._,events:{..._.events,...g}})),setSize:(g,_,w,S,C)=>{const E=l().camera,A={width:g,height:_,top:S||0,left:C||0,updateStyle:w};a(T=>({size:A,viewport:{...T.viewport,...f(E,u,A)}}))},setDpr:g=>a(_=>{const w=EG(g);return{viewport:{..._.viewport,dpr:w,initialDpr:_.viewport.initialDpr||w}}}),setFrameloop:(g="always")=>{const _=l().clock;_.stop(),_.elapsedTime=0,g!=="never"&&(_.start(),_.elapsedTime=0),a(()=>({frameloop:g}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:re.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(g,_,w)=>{const S=l().internal;return S.priority=S.priority+(_>0?1:0),S.subscribers.push({ref:g,priority:_,store:w}),S.subscribers=S.subscribers.sort((C,E)=>C.priority-E.priority),()=>{const C=l().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(_>0?1:0),C.subscribers=C.subscribers.filter(E=>E.ref!==g))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:h}=t.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==s){var f;r=l,s=c.dpr,Coe(a,l),u.setPixelRatio(c.dpr);const p=(f=l.updateStyle)!=null?f:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,p)}a!==o&&(o=a,h(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>i(a)),t};let Dx,Ioe=new Set,Uoe=new Set,Foe=new Set;function Jb(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function ag(i,e){switch(i){case"before":return Jb(Ioe,e);case"after":return Jb(Uoe,e);case"tail":return Jb(Foe,e)}}let $b,eT;function tT(i,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),$b=e.internal.subscribers,Dx=0;Dx<$b.length;Dx++)eT=$b[Dx],eT.ref.current(eT.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function koe(i){let e=!1,t=!1,n,r,s;function o(c){r=requestAnimationFrame(o),e=!0,n=0,ag("before",c),t=!0;for(const h of i.values()){var u;s=h.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(n+=tT(c,s))}if(t=!1,ag("after",c),n===0)return ag("tail",c),e=!1,cancelAnimationFrame(r)}function a(c,u=1){var h;if(!c)return i.forEach(f=>a(f.store.getState(),u));(h=c.gl.xr)!=null&&h.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):t?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,h,f){if(u&&ag("before",c),h)tT(c,h,f);else for(const p of i.values())tT(c,p.store.getState());u&&ag("after",c)}return{loop:o,invalidate:a,advance:l}}function LG(){const i=re.useContext(RG);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function En(i=t=>t,e){return LG()(i,e)}function em(i,e=0){const t=LG(),n=t.getState().internal.subscribe,r=MG(i);return rv(()=>n(r,e,t),[e,n,t]),null}const Up=new Map,{invalidate:XI,advance:YI}=koe(Up),{reconciler:Y_,applyProps:sd}=Soe(Up,Poe),od={objects:"shallow",strict:!1},Noe=(i,e)=>{const t=typeof i=="function"?i(e):i;return PG(t)?t:new cA({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...i})};function Ooe(i,e){const t=typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement;if(e){const{width:n,height:r,top:s,left:o,updateStyle:a=t}=e;return{width:n,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:n,height:r,top:s,left:o}=i.parentElement.getBoundingClientRect();return{width:n,height:r,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function zoe(i){const e=Up.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||Doe(XI,YI),o=t||Y_.createContainer(s,Fd.ConcurrentRoot,null,!1,null,"",r,null);e||Up.set(i,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:h,size:f,scene:p,events:v,onCreated:x,shadows:y=!1,linear:g=!1,flat:_=!1,legacy:w=!1,orthographic:S=!1,frameloop:C="always",dpr:E=[1,2],performance:A,raycaster:T,camera:L,onPointerMissed:M}=u,R=s.getState(),D=R.gl;R.gl||R.set({gl:D=Noe(h,i)});let F=R.raycaster;F||R.set({raycaster:F=new Yp});const{params:z,...q}=T||{};if(Vn.equ(q,F,od)||sd(F,{...q}),Vn.equ(z,F.params,od)||sd(F,{params:{...F.params,...z}}),!R.camera||R.camera===c&&!Vn.equ(c,L,od)){c=L;const j=L instanceof Gp,B=j?L:S?new yo(0,0,0,0,.1,1e3):new Un(75,0,.1,1e3);j||(B.position.z=5,L&&(sd(B,L),("aspect"in L||"left"in L||"right"in L||"bottom"in L||"top"in L)&&(B.manual=!0,B.updateProjectionMatrix())),!R.camera&&!(L!=null&&L.rotation)&&B.lookAt(0,0,0)),R.set({camera:B}),F.camera=B}if(!R.scene){let j;p instanceof yp?j=p:(j=new yp,p&&sd(j,p)),R.set({scene:pd(j)})}if(!R.xr){var H;const j=(ie,V)=>{const te=s.getState();te.frameloop!=="never"&&YI(ie,!0,te,V)},B=()=>{const ie=s.getState();ie.gl.xr.enabled=ie.gl.xr.isPresenting,ie.gl.xr.setAnimationLoop(ie.gl.xr.isPresenting?j:null),ie.gl.xr.isPresenting||XI(ie)},Z={connect(){const ie=s.getState().gl;ie.xr.addEventListener("sessionstart",B),ie.xr.addEventListener("sessionend",B)},disconnect(){const ie=s.getState().gl;ie.xr.removeEventListener("sessionstart",B),ie.xr.removeEventListener("sessionend",B)}};typeof((H=D.xr)==null?void 0:H.addEventListener)=="function"&&Z.connect(),R.set({xr:Z})}if(D.shadowMap){const j=D.shadowMap.enabled,B=D.shadowMap.type;if(D.shadowMap.enabled=!!y,Vn.boo(y))D.shadowMap.type=Ji;else if(Vn.str(y)){var $;const Z={basic:kU,percentage:zp,soft:Ji,variance:ya};D.shadowMap.type=($=Z[y])!=null?$:Ji}else Vn.obj(y)&&Object.assign(D.shadowMap,y);(j!==D.shadowMap.enabled||B!==D.shadowMap.type)&&(D.shadowMap.needsUpdate=!0)}const U=wG();U&&("enabled"in U?U.enabled=!w:"legacyMode"in U&&(U.legacyMode=w)),l||sd(D,{outputEncoding:g?3e3:3001,toneMapping:_?Ta:ta}),R.legacy!==w&&R.set(()=>({legacy:w})),R.linear!==g&&R.set(()=>({linear:g})),R.flat!==_&&R.set(()=>({flat:_})),h&&!Vn.fun(h)&&!PG(h)&&!Vn.equ(h,D,od)&&sd(D,h),v&&!R.events.handlers&&R.set({events:v(s)});const X=Ooe(i,f);return Vn.equ(X,R.size,od)||R.setSize(X.width,X.height,X.updateStyle,X.top,X.left),E&&R.viewport.dpr!==EG(E)&&R.setDpr(E),R.frameloop!==C&&R.setFrameloop(C),R.onPointerMissed||R.set({onPointerMissed:M}),A&&!Vn.equ(A,R.performance,od)&&R.set(j=>({performance:{...j.performance,...A}})),a=x,l=!0,this},render(u){return l||this.configure(),Y_.updateContainer(ft.jsx(Boe,{store:s,children:u,onCreated:a,rootElement:i}),o,null,()=>{}),s},unmount(){DG(i)}}}function Boe({store:i,children:e,onCreated:t,rootElement:n}){return rv(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),ft.jsx(RG.Provider,{value:i,children:e})}function DG(i,e){const t=Up.get(i),n=t==null?void 0:t.fiber;if(n){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),Y_.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),Eoe(r),Up.delete(i)}catch{}},500)})}}Y_.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:re.version});function kE(i,e,t){var n,r,s,o,a;e==null&&(e=100);function l(){var u=Date.now()-o;u<e&&u>=0?n=setTimeout(l,e-u):(n=null,t||(a=i.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var u=t&&!n;return n||(n=setTimeout(l,e)),u&&(a=i.apply(s,r),s=r=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=i.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}kE.debounce=kE;var Hoe=kE;const qI=hf(Hoe);function Goe(i){let{debounce:e,scroll:t,polyfill:n,offsetSize:r}=i===void 0?{debounce:0,scroll:!1,offsetSize:!1}:i;const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=re.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=re.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,u=e?typeof e=="number"?e:e.resize:null,h=re.useRef(!1);re.useEffect(()=>(h.current=!0,()=>void(h.current=!1)));const[f,p,v]=re.useMemo(()=>{const _=()=>{if(!l.current.element)return;const{left:w,top:S,width:C,height:E,bottom:A,right:T,x:L,y:M}=l.current.element.getBoundingClientRect(),R={left:w,top:S,width:C,height:E,bottom:A,right:T,x:L,y:M};l.current.element instanceof HTMLElement&&r&&(R.height=l.current.element.offsetHeight,R.width=l.current.element.offsetWidth),Object.freeze(R),h.current&&!Xoe(l.current.lastBounds,R)&&a(l.current.lastBounds=R)};return[_,u?qI(_,u):_,c?qI(_,c):_]},[a,r,c,u]);function x(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",v,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function y(){l.current.element&&(l.current.resizeObserver=new s(v),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(_=>_.addEventListener("scroll",v,{capture:!0,passive:!0})))}const g=_=>{!_||_===l.current.element||(x(),l.current.element=_,l.current.scrollContainers=IG(_),y())};return Woe(v,!!t),Voe(p),re.useEffect(()=>{x(),y()},[t,v,p]),re.useEffect(()=>x,[]),[g,o,f]}function Voe(i){re.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function Woe(i,e){re.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function IG(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...IG(i.parentElement)]}const joe=["x","y","top","bottom","left","right","width","height"],Xoe=(i,e)=>joe.every(t=>i[t]===e[t]);var Yoe=Object.defineProperty,qoe=Object.defineProperties,Koe=Object.getOwnPropertyDescriptors,KI=Object.getOwnPropertySymbols,Zoe=Object.prototype.hasOwnProperty,Qoe=Object.prototype.propertyIsEnumerable,ZI=(i,e,t)=>e in i?Yoe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,QI=(i,e)=>{for(var t in e||(e={}))Zoe.call(e,t)&&ZI(i,t,e[t]);if(KI)for(var t of KI(e))Qoe.call(e,t)&&ZI(i,t,e[t]);return i},Joe=(i,e)=>qoe(i,Koe(e)),JI,$I;typeof window<"u"&&((JI=window.document)!=null&&JI.createElement||(($I=window.navigator)==null?void 0:$I.product)==="ReactNative")?re.useLayoutEffect:re.useEffect;function UG(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=i.child;for(;n;){const r=UG(n,e,t);if(r)return r;n=n.sibling}}function FG(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const e4=console.error;console.error=function(){const i=[...arguments].join("");if(i!=null&&i.startsWith("Warning:")&&i.includes("useContext")){console.error=e4;return}return e4.apply(this,arguments)};const eP=FG(re.createContext(null));class kG extends re.Component{render(){return re.createElement(eP.Provider,{value:this._reactInternals},this.props.children)}}function $oe(){const i=re.useContext(eP);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=re.useId();return re.useMemo(()=>{for(const n of[i,i==null?void 0:i.alternate]){if(!n)continue;const r=UG(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[i,e])}function eae(){const i=$oe(),[e]=re.useState(()=>new Map);e.clear();let t=i;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==eP&&!e.has(r)&&e.set(r,re.useContext(FG(r)))}t=t.return}return e}function tae(){const i=eae();return re.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>re.createElement(e,null,re.createElement(t.Provider,Joe(QI({},n),{value:i.get(t)}))),e=>re.createElement(kG,QI({},e))),[i])}const nT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function nae(i){const{handlePointer:e}=Loe(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(nT).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:s}=i.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,c]=nT[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=nT[s];n.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const iae=re.forwardRef(function({children:e,fallback:t,resize:n,style:r,gl:s,events:o=nae,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:h,legacy:f,orthographic:p,frameloop:v,dpr:x,performance:y,raycaster:g,camera:_,scene:w,onPointerMissed:S,onCreated:C,...E},A){re.useMemo(()=>$C(SK),[]);const T=tae(),[L,M]=Goe({scroll:!0,debounce:{scroll:50,resize:0},...n}),R=re.useRef(null),D=re.useRef(null);re.useImperativeHandle(A,()=>R.current);const F=MG(S),[z,q]=re.useState(!1),[H,$]=re.useState(!1);if(z)throw z;if(H)throw H;const U=re.useRef(null);rv(()=>{const j=R.current;M.width>0&&M.height>0&&j&&(U.current||(U.current=zoe(j)),U.current.configure({gl:s,events:o,shadows:c,linear:u,flat:h,legacy:f,orthographic:p,frameloop:v,dpr:x,performance:y,raycaster:g,camera:_,scene:w,size:M,onPointerMissed:(...B)=>F.current==null?void 0:F.current(...B),onCreated:B=>{B.events.connect==null||B.events.connect(a?Moe(a)?a.current:a:D.current),l&&B.setEvents({compute:(Z,ie)=>{const V=Z[l+"X"],te=Z[l+"Y"];ie.pointer.set(V/ie.size.width*2-1,-(te/ie.size.height)*2+1),ie.raycaster.setFromCamera(ie.pointer,ie.camera)}}),C==null||C(B)}}),U.current.render(ft.jsx(T,{children:ft.jsx(bG,{set:$,children:ft.jsx(re.Suspense,{fallback:ft.jsx(boe,{set:q}),children:e})})})))}),re.useEffect(()=>{const j=R.current;if(j)return()=>DG(j)},[]);const X=a?"none":"auto";return ft.jsx("div",{ref:D,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...r},...E,children:ft.jsx("div",{ref:L,style:{width:"100%",height:"100%"},children:ft.jsx("canvas",{ref:R,style:{display:"block"},children:t})})})}),NG=re.forwardRef(function(e,t){return ft.jsx(kG,{children:ft.jsx(iae,{...e,ref:t})})});function rae({vertexCount:i}){const e=re.useRef(null),t=re.useMemo(()=>{const n=new Float32Array(i*3);for(let r=0;r<n.length;r++)n[r]=(Math.random()-.5)*3;return n},[i]);return re.useEffect(()=>e.current.computeVertexNormals(),[t]),ft.jsxs("mesh",{children:[ft.jsx("bufferGeometry",{ref:e,children:ft.jsx("bufferAttribute",{attach:"attributes-position",count:i,itemSize:3,array:t})}),ft.jsx("meshStandardMaterial",{color:"red",side:_n})]})}$C({OrbitControls:UA});function sae(){const{camera:i}=En(),e=re.useRef(null);return em((t,n)=>{e.current.rotation.y+=n}),ft.jsxs(ft.Fragment,{children:[ft.jsx("orbitControls",{args:[i,document.querySelector("body")]}),ft.jsx("directionalLight",{position:[1,2,3],intensity:4.5}),ft.jsx("ambientLight",{intensity:1.5}),ft.jsxs("group",{children:[ft.jsxs("mesh",{"position-x":2,ref:e,children:[ft.jsx("boxGeometry",{args:[1.5,1.5,1.5]}),ft.jsx("meshStandardMaterial",{args:[{color:"mediumpurple"}]})]}),ft.jsxs("mesh",{"position-x":-2,children:[ft.jsx("sphereGeometry",{}),ft.jsx("meshStandardMaterial",{color:"orange"})]})]}),ft.jsxs("mesh",{"position-y":-1,"rotation-x":-Math.PI/2,scale:10,children:[ft.jsx("planeGeometry",{}),ft.jsx("meshStandardMaterial",{color:"greenyellow"})]}),ft.jsx(rae,{vertexCount:100})]})}let oae=class{constructor(e){iv(e).render(ft.jsx(NG,{flat:!1,orthographic:!1,dpr:[1,2],gl:{antialias:!0,toneMapping:ta,outputColorSpace:Wt},camera:{fov:75,near:.01,far:100,position:[3,2,6]},children:ft.jsx(sae,{})}))}},aae=class extends Tw{constructor(){super(...arguments);oe(this,"app");oe(this,"appElement")}get number(){return"55"}get title(){return"First R3F Application"}get link(){return"https://threejs-journey.com/lessons/first-r3f-application"}open(){this.appElement=document.createElement("div"),this.appElement.style.width="100vw",this.appElement.style.height="100vh",document.body.appendChild(this.appElement),this.app=new oae(this.appElement)}close(){document.body.removeChild(this.appElement)}};function al(){return al=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},al.apply(null,arguments)}const sv=new N,tP=new N,lae=new N,t4=new be;function cae(i,e,t){const n=sv.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-(n.y*s)+s]}function uae(i,e){const t=sv.setFromMatrixPosition(i.matrixWorld),n=tP.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection(lae);return r.angleTo(s)>Math.PI/2}function hae(i,e,t,n){const r=sv.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),t4.set(s.x,s.y),t.setFromCamera(t4,e);const o=t.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}function fae(i,e){if(e instanceof yo)return e.zoom;if(e instanceof Un){const t=sv.setFromMatrixPosition(i.matrixWorld),n=tP.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function dae(i,e,t){if(e instanceof Un||e instanceof yo){const n=sv.setFromMatrixPosition(i.matrixWorld),r=tP.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const NE=i=>Math.abs(i)<1e-10?0:i;function OG(i,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=NE(e[r]*i.elements[r])+(r!==15?",":")");return t+n}const pae=(i=>e=>OG(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),mae=(i=>(e,t)=>OG(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function gae(i){return i&&typeof i=="object"&&"current"in i}const ov=re.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:h,onOcclude:f,castShadow:p,receiveShadow:v,material:x,geometry:y,zIndexRange:g=[16777271,0],calculatePosition:_=cae,as:w="div",wrapperClass:S,pointerEvents:C="auto",...E},A)=>{const{gl:T,camera:L,scene:M,size:R,raycaster:D,events:F,viewport:z}=En(),[q]=re.useState(()=>document.createElement(w)),H=re.useRef(),$=re.useRef(null),U=re.useRef(0),X=re.useRef([0,0]),j=re.useRef(null),B=re.useRef(null),Z=(a==null?void 0:a.current)||F.connected||T.domElement.parentNode,ie=re.useRef(null),V=re.useRef(!1),te=re.useMemo(()=>h&&h!=="blending"||Array.isArray(h)&&h.length&&gae(h[0]),[h]);re.useLayoutEffect(()=>{const Q=T.domElement;h&&h==="blending"?(Q.style.zIndex=`${Math.floor(g[0]/2)}`,Q.style.position="absolute",Q.style.pointerEvents="none"):(Q.style.zIndex=null,Q.style.position=null,Q.style.pointerEvents=null)},[h]),re.useLayoutEffect(()=>{if($.current){const Q=H.current=iv(q);if(M.updateMatrixWorld(),u)q.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const J=_($.current,L,R);q.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${J[0]}px,${J[1]}px,0);transform-origin:0 0;`}return Z&&(r?Z.prepend(q):Z.appendChild(q)),()=>{Z&&Z.removeChild(q),Q.unmount()}}},[Z,u]),re.useLayoutEffect(()=>{S&&(q.className=S)},[S]);const fe=re.useMemo(()=>u?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...t},[t,s,o,R,u]),he=re.useMemo(()=>({position:"absolute",pointerEvents:C}),[C]);re.useLayoutEffect(()=>{if(V.current=!1,u){var Q;(Q=H.current)==null||Q.render(re.createElement("div",{ref:j,style:fe},re.createElement("div",{ref:B,style:he},re.createElement("div",{ref:A,className:n,style:t,children:i}))))}else{var J;(J=H.current)==null||J.render(re.createElement("div",{ref:A,style:fe,className:n,children:i}))}});const le=re.useRef(!0);em(Q=>{if($.current){L.updateMatrixWorld(),$.current.updateWorldMatrix(!0,!1);const J=u?X.current:_($.current,L,R);if(u||Math.abs(U.current-L.zoom)>e||Math.abs(X.current[0]-J[0])>e||Math.abs(X.current[1]-J[1])>e){const ne=uae($.current,L);let Y=!1;te&&(Array.isArray(h)?Y=h.map(Te=>Te.current):h!=="blending"&&(Y=[M]));const de=le.current;if(Y){const Te=hae($.current,L,D,Y);le.current=Te&&!ne}else le.current=!ne;de!==le.current&&(f?f(!le.current):q.style.display=le.current?"block":"none");const ve=Math.floor(g[0]/2),Se=h?te?[g[0],ve]:[ve-1,0]:g;if(q.style.zIndex=`${dae($.current,L,Se)}`,u){const[Te,Ee]=[R.width/2,R.height/2],Re=L.projectionMatrix.elements[5]*Ee,{isOrthographicCamera:K,top:k,left:ue,bottom:me,right:Me}=L,ge=pae(L.matrixWorldInverse),Ye=K?`scale(${Re})translate(${NE(-(Me+ue)/2)}px,${NE((k+me)/2)}px)`:`translateZ(${Re}px)`;let Ie=$.current.matrixWorld;c&&(Ie=L.matrixWorldInverse.clone().transpose().copyPosition(Ie).scale($.current.scale),Ie.elements[3]=Ie.elements[7]=Ie.elements[11]=0,Ie.elements[15]=1),q.style.width=R.width+"px",q.style.height=R.height+"px",q.style.perspective=K?"":`${Re}px`,j.current&&B.current&&(j.current.style.transform=`${Ye}${ge}translate(${Te}px,${Ee}px)`,B.current.style.transform=mae(Ie,1/((l||10)/400)))}else{const Te=l===void 0?1:fae($.current,L)*l;q.style.transform=`translate3d(${J[0]}px,${J[1]}px,0) scale(${Te})`}X.current=J,U.current=L.zoom}}if(!te&&ie.current&&!V.current)if(u){if(j.current){const J=j.current.children[0];if(J!=null&&J.clientWidth&&J!=null&&J.clientHeight){const{isOrthographicCamera:ne}=L;if(ne||y)E.scale&&(Array.isArray(E.scale)?E.scale instanceof N?ie.current.scale.copy(E.scale.clone().divideScalar(1)):ie.current.scale.set(1/E.scale[0],1/E.scale[1],1/E.scale[2]):ie.current.scale.setScalar(1/E.scale));else{const Y=(l||10)/400,de=J.clientWidth*Y,ve=J.clientHeight*Y;ie.current.scale.set(de,ve,1)}V.current=!0}}}else{const J=q.children[0];if(J!=null&&J.clientWidth&&J!=null&&J.clientHeight){const ne=1/z.factor,Y=J.clientWidth*ne,de=J.clientHeight*ne;ie.current.scale.set(Y,de,1),V.current=!0}ie.current.lookAt(Q.camera.position)}});const G=re.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return re.createElement("group",al({},E,{ref:$}),h&&!te&&re.createElement("mesh",{castShadow:p,receiveShadow:v,ref:ie},y||re.createElement("planeGeometry",null),x||re.createElement("shaderMaterial",{side:_n,vertexShader:G.vertexShader,fragmentShader:G.fragmentShader})))}),zG=parseInt(rf.replace(/\D+/g,"")),BG=zG>=125?"uv1":"uv2";var vae=Object.defineProperty,yae=(i,e,t)=>e in i?vae(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xae=(i,e,t)=>(yae(i,e+"",t),t);class _ae{constructor(){xae(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var wae=Object.defineProperty,Sae=(i,e,t)=>e in i?wae(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Oe=(i,e,t)=>(Sae(i,typeof e!="symbol"?e+"":e,t),t);let Mae=class extends Kt{constructor(e,t){super(),Oe(this,"isTransformControls",!0),Oe(this,"visible",!1),Oe(this,"domElement"),Oe(this,"raycaster",new Yp),Oe(this,"gizmo"),Oe(this,"plane"),Oe(this,"tempVector",new N),Oe(this,"tempVector2",new N),Oe(this,"tempQuaternion",new Qt),Oe(this,"unit",{X:new N(1,0,0),Y:new N(0,1,0),Z:new N(0,0,1)}),Oe(this,"pointStart",new N),Oe(this,"pointEnd",new N),Oe(this,"offset",new N),Oe(this,"rotationAxis",new N),Oe(this,"startNorm",new N),Oe(this,"endNorm",new N),Oe(this,"rotationAngle",0),Oe(this,"cameraPosition",new N),Oe(this,"cameraQuaternion",new Qt),Oe(this,"cameraScale",new N),Oe(this,"parentPosition",new N),Oe(this,"parentQuaternion",new Qt),Oe(this,"parentQuaternionInv",new Qt),Oe(this,"parentScale",new N),Oe(this,"worldPositionStart",new N),Oe(this,"worldQuaternionStart",new Qt),Oe(this,"worldScaleStart",new N),Oe(this,"worldPosition",new N),Oe(this,"worldQuaternion",new Qt),Oe(this,"worldQuaternionInv",new Qt),Oe(this,"worldScale",new N),Oe(this,"eye",new N),Oe(this,"positionStart",new N),Oe(this,"quaternionStart",new Qt),Oe(this,"scaleStart",new N),Oe(this,"camera"),Oe(this,"object"),Oe(this,"enabled",!0),Oe(this,"axis",null),Oe(this,"mode","translate"),Oe(this,"translationSnap",null),Oe(this,"rotationSnap",null),Oe(this,"scaleSnap",null),Oe(this,"space","world"),Oe(this,"size",1),Oe(this,"dragging",!1),Oe(this,"showX",!0),Oe(this,"showY",!0),Oe(this,"showZ",!0),Oe(this,"changeEvent",{type:"change"}),Oe(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),Oe(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),Oe(this,"objectChangeEvent",{type:"objectChange"}),Oe(this,"intersectObjectWithRay",(r,s,o)=>{const a=s.intersectObject(r,!0);for(let l=0;l<a.length;l++)if(a[l].object.visible||o)return a[l];return!1}),Oe(this,"attach",r=>(this.object=r,this.visible=!0,this)),Oe(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),Oe(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),Oe(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),Oe(this,"pointerHover",r=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera(r,this.camera);const s=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);s?this.axis=s.object.name:this.axis=null}),Oe(this,"pointerDown",r=>{if(!(this.object===void 0||this.dragging===!0||r.button!==0)&&this.axis!==null){this.raycaster.setFromCamera(r,this.camera);const s=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(s){let o=this.space;if(this.mode==="scale"?o="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(o="world"),o==="local"&&this.mode==="rotate"){const a=this.rotationSnap;this.axis==="X"&&a&&(this.object.rotation.x=Math.round(this.object.rotation.x/a)*a),this.axis==="Y"&&a&&(this.object.rotation.y=Math.round(this.object.rotation.y/a)*a),this.axis==="Z"&&a&&(this.object.rotation.z=Math.round(this.object.rotation.z/a)*a)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(s.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),Oe(this,"pointerMove",r=>{const s=this.axis,o=this.mode,a=this.object;let l=this.space;if(o==="scale"?l="local":(s==="E"||s==="XYZE"||s==="XYZ")&&(l="world"),a===void 0||s===null||this.dragging===!1||r.button!==-1)return;this.raycaster.setFromCamera(r,this.camera);const c=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(c){if(this.pointEnd.copy(c.point).sub(this.worldPositionStart),o==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),l==="local"&&s!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),s.indexOf("X")===-1&&(this.offset.x=0),s.indexOf("Y")===-1&&(this.offset.y=0),s.indexOf("Z")===-1&&(this.offset.z=0),l==="local"&&s!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),a.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(l==="local"&&(a.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),s.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),s.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),s.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.position.applyQuaternion(this.quaternionStart)),l==="world"&&(a.parent&&a.position.add(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld)),s.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),s.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),s.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.parent&&a.position.sub(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld))));else if(o==="scale"){if(s.search("XYZ")!==-1){let u=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(u*=-1),this.tempVector2.set(u,u,u)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),s.search("X")===-1&&(this.tempVector2.x=1),s.search("Y")===-1&&(this.tempVector2.y=1),s.search("Z")===-1&&(this.tempVector2.z=1);a.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(s.search("X")!==-1&&(this.object.scale.x=Math.round(a.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),s.search("Y")!==-1&&(a.scale.y=Math.round(a.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),s.search("Z")!==-1&&(a.scale.z=Math.round(a.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(o==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const u=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));s==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):s==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*u):(s==="X"||s==="Y"||s==="Z")&&(this.rotationAxis.copy(this.unit[s]),this.tempVector.copy(this.unit[s]),l==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*u),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),l==="local"&&s!=="E"&&s!=="XYZE"?(a.quaternion.copy(this.quaternionStart),a.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),a.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),a.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),Oe(this,"pointerUp",r=>{r.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),Oe(this,"getPointer",r=>{var s;if(this.domElement&&((s=this.domElement.ownerDocument)!=null&&s.pointerLockElement))return{x:0,y:0,button:r.button};{const o=r.changedTouches?r.changedTouches[0]:r,a=this.domElement.getBoundingClientRect();return{x:(o.clientX-a.left)/a.width*2-1,y:-(o.clientY-a.top)/a.height*2+1,button:r.button}}}),Oe(this,"onPointerHover",r=>{if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(r));break}}),Oe(this,"onPointerDown",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(r)),this.pointerDown(this.getPointer(r)))}),Oe(this,"onPointerMove",r=>{this.enabled&&this.pointerMove(this.getPointer(r))}),Oe(this,"onPointerUp",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(r)))}),Oe(this,"getMode",()=>this.mode),Oe(this,"setMode",r=>{this.mode=r}),Oe(this,"setTranslationSnap",r=>{this.translationSnap=r}),Oe(this,"setRotationSnap",r=>{this.rotationSnap=r}),Oe(this,"setScaleSnap",r=>{this.scaleSnap=r}),Oe(this,"setSize",r=>{this.size=r}),Oe(this,"setSpace",r=>{this.space=r}),Oe(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),Oe(this,"connect",r=>{r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=r,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),Oe(this,"dispose",()=>{var r,s,o,a,l,c;(r=this.domElement)==null||r.removeEventListener("pointerdown",this.onPointerDown),(s=this.domElement)==null||s.removeEventListener("pointermove",this.onPointerHover),(a=(o=this.domElement)==null?void 0:o.ownerDocument)==null||a.removeEventListener("pointermove",this.onPointerMove),(c=(l=this.domElement)==null?void 0:l.ownerDocument)==null||c.removeEventListener("pointerup",this.onPointerUp),this.traverse(u=>{const h=u;h.geometry&&h.geometry.dispose(),h.material&&h.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new bae,this.add(this.gizmo),this.plane=new Tae,this.add(this.plane);const n=(r,s)=>{let o=s;Object.defineProperty(this,r,{get:function(){return o!==void 0?o:s},set:function(a){o!==a&&(o=a,this.plane[r]=a,this.gizmo[r]=a,this.dispatchEvent({type:r+"-changed",value:a}),this.dispatchEvent(this.changeEvent))}}),this[r]=s,this.plane[r]=s,this.gizmo[r]=s};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),t!==void 0&&this.connect(t)}};class bae extends Kt{constructor(){super(),Oe(this,"isTransformControlsGizmo",!0),Oe(this,"type","TransformControlsGizmo"),Oe(this,"tempVector",new N(0,0,0)),Oe(this,"tempEuler",new ms),Oe(this,"alignVector",new N(0,1,0)),Oe(this,"zeroVector",new N(0,0,0)),Oe(this,"lookAtMatrix",new Ze),Oe(this,"tempQuaternion",new Qt),Oe(this,"tempQuaternion2",new Qt),Oe(this,"identityQuaternion",new Qt),Oe(this,"unitX",new N(1,0,0)),Oe(this,"unitY",new N(0,1,0)),Oe(this,"unitZ",new N(0,0,1)),Oe(this,"gizmo"),Oe(this,"picker"),Oe(this,"helper"),Oe(this,"rotationAxis",new N),Oe(this,"cameraPosition",new N),Oe(this,"worldPositionStart",new N),Oe(this,"worldQuaternionStart",new Qt),Oe(this,"worldPosition",new N),Oe(this,"worldQuaternion",new Qt),Oe(this,"eye",new N),Oe(this,"camera",null),Oe(this,"enabled",!0),Oe(this,"axis",null),Oe(this,"mode","translate"),Oe(this,"space","world"),Oe(this,"size",1),Oe(this,"dragging",!1),Oe(this,"showX",!0),Oe(this,"showY",!0),Oe(this,"showZ",!0),Oe(this,"updateMatrixWorld",()=>{let j=this.space;this.mode==="scale"&&(j="local");const B=j==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let Z=[];Z=Z.concat(this.picker[this.mode].children),Z=Z.concat(this.gizmo[this.mode].children),Z=Z.concat(this.helper[this.mode].children);for(let ie=0;ie<Z.length;ie++){const V=Z[ie];V.visible=!0,V.rotation.set(0,0,0),V.position.copy(this.worldPosition);let te;if(this.camera.isOrthographicCamera?te=(this.camera.top-this.camera.bottom)/this.camera.zoom:te=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),V.scale.set(1,1,1).multiplyScalar(te*this.size/7),V.tag==="helper"){V.visible=!1,V.name==="AXIS"?(V.position.copy(this.worldPositionStart),V.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),V.quaternion.copy(B).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(B).dot(this.eye))>.9&&(V.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),V.quaternion.copy(B).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(B).dot(this.eye))>.9&&(V.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),V.quaternion.copy(B).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(B).dot(this.eye))>.9&&(V.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),V.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),V.quaternion.multiply(this.tempQuaternion),V.visible=this.dragging),this.axis==="E"&&(V.visible=!1)):V.name==="START"?(V.position.copy(this.worldPositionStart),V.visible=this.dragging):V.name==="END"?(V.position.copy(this.worldPosition),V.visible=this.dragging):V.name==="DELTA"?(V.position.copy(this.worldPositionStart),V.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),V.scale.copy(this.tempVector),V.visible=this.dragging):(V.quaternion.copy(B),this.dragging?V.position.copy(this.worldPositionStart):V.position.copy(this.worldPosition),this.axis&&(V.visible=this.axis.search(V.name)!==-1));continue}V.quaternion.copy(B),this.mode==="translate"||this.mode==="scale"?((V.name==="X"||V.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(B).dot(this.eye))>.99&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),(V.name==="Y"||V.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(B).dot(this.eye))>.99&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),(V.name==="Z"||V.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(B).dot(this.eye))>.99&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),V.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(B).dot(this.eye))<.2&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),V.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(B).dot(this.eye))<.2&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),V.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(B).dot(this.eye))<.2&&(V.scale.set(1e-10,1e-10,1e-10),V.visible=!1),V.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(B).dot(this.eye)<0?V.tag==="fwd"?V.visible=!1:V.scale.x*=-1:V.tag==="bwd"&&(V.visible=!1)),V.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(B).dot(this.eye)<0?V.tag==="fwd"?V.visible=!1:V.scale.y*=-1:V.tag==="bwd"&&(V.visible=!1)),V.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(B).dot(this.eye)<0?V.tag==="fwd"?V.visible=!1:V.scale.z*=-1:V.tag==="bwd"&&(V.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(B),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(B).invert()),V.name.search("E")!==-1&&V.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),V.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),V.quaternion.copy(this.tempQuaternion)),V.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),V.quaternion.copy(this.tempQuaternion)),V.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),V.quaternion.copy(this.tempQuaternion))),V.visible=V.visible&&(V.name.indexOf("X")===-1||this.showX),V.visible=V.visible&&(V.name.indexOf("Y")===-1||this.showY),V.visible=V.visible&&(V.name.indexOf("Z")===-1||this.showZ),V.visible=V.visible&&(V.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),V.material.tempOpacity=V.material.tempOpacity||V.material.opacity,V.material.tempColor=V.material.tempColor||V.material.color.clone(),V.material.color.copy(V.material.tempColor),V.material.opacity=V.material.tempOpacity,this.enabled?this.axis&&(V.name===this.axis?(V.material.opacity=1,V.material.color.lerp(new Ge(1,1,1),.5)):this.axis.split("").some(function(fe){return V.name===fe})?(V.material.opacity=1,V.material.color.lerp(new Ge(1,1,1),.5)):(V.material.opacity*=.25,V.material.color.lerp(new Ge(1,1,1),.5))):(V.material.opacity*=.5,V.material.color.lerp(new Ge(1,1,1),.5))}super.updateMatrixWorld()});const e=new Yt({depthTest:!1,depthWrite:!1,transparent:!0,side:_n,fog:!1,toneMapped:!1}),t=new vr({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const r=e.clone();r.opacity=.33;const s=e.clone();s.color.set(16711680);const o=e.clone();o.color.set(65280);const a=e.clone();a.color.set(255);const l=e.clone();l.opacity=.25;const c=l.clone();c.color.set(16776960);const u=l.clone();u.color.set(65535);const h=l.clone();h.color.set(16711935),e.clone().color.set(16776960);const p=t.clone();p.color.set(16711680);const v=t.clone();v.color.set(65280);const x=t.clone();x.color.set(255);const y=t.clone();y.color.set(65535);const g=t.clone();g.color.set(16711935);const _=t.clone();_.color.set(16776960);const w=t.clone();w.color.set(7895160);const S=_.clone();S.opacity=.25;const C=new Tr(0,.05,.2,12,1,!1),E=new un(.125,.125,.125),A=new yt;A.setAttribute("position",new lt([0,0,0,1,0,0],3));const T=(j,B)=>{const Z=new yt,ie=[];for(let V=0;V<=64*B;++V)ie.push(0,Math.cos(V/32*Math.PI)*j,Math.sin(V/32*Math.PI)*j);return Z.setAttribute("position",new lt(ie,3)),Z},L=()=>{const j=new yt;return j.setAttribute("position",new lt([0,0,0,1,1,1],3)),j},M={X:[[new Ae(C,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Ae(C,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Xt(A,p)]],Y:[[new Ae(C,o),[0,1,0],null,null,"fwd"],[new Ae(C,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Xt(A,v),null,[0,0,Math.PI/2]]],Z:[[new Ae(C,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Ae(C,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Xt(A,x),null,[0,-Math.PI/2,0]]],XYZ:[[new Ae(new Go(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new Ae(new Ot(.295,.295),c.clone()),[.15,.15,0]],[new Xt(A,_),[.18,.3,0],null,[.125,1,1]],[new Xt(A,_),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Ae(new Ot(.295,.295),u.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Xt(A,y),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Xt(A,y),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Ae(new Ot(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Xt(A,g),[.18,0,.3],null,[.125,1,1]],[new Xt(A,g),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},R={X:[[new Ae(new Tr(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Ae(new Tr(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new Ae(new Tr(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Ae(new Go(.2,0),n)]],XY:[[new Ae(new Ot(.4,.4),n),[.2,.2,0]]],YZ:[[new Ae(new Ot(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Ae(new Ot(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},D={START:[[new Ae(new Go(.01,2),r),null,null,null,"helper"]],END:[[new Ae(new Go(.01,2),r),null,null,null,"helper"]],DELTA:[[new Xt(L(),r),null,null,null,"helper"]],X:[[new Xt(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Xt(A,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Xt(A,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},F={X:[[new Xt(T(1,.5),p)],[new Ae(new Go(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new Xt(T(1,.5),v),null,[0,0,-Math.PI/2]],[new Ae(new Go(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new Xt(T(1,.5),x),null,[0,Math.PI/2,0]],[new Ae(new Go(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new Xt(T(1.25,1),S),null,[0,Math.PI/2,0]],[new Ae(new Tr(.03,0,.15,4,1,!1),S),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Ae(new Tr(.03,0,.15,4,1,!1),S),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Ae(new Tr(.03,0,.15,4,1,!1),S),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Ae(new Tr(.03,0,.15,4,1,!1),S),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Xt(T(1,1),w),null,[0,Math.PI/2,0]]]},z={AXIS:[[new Xt(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},q={X:[[new Ae(new fo(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Ae(new fo(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Ae(new fo(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Ae(new fo(1.25,.1,2,24),n)]],XYZE:[[new Ae(new Lr(.7,10,8),n)]]},H={X:[[new Ae(E,s),[.8,0,0],[0,0,-Math.PI/2]],[new Xt(A,p),null,null,[.8,1,1]]],Y:[[new Ae(E,o),[0,.8,0]],[new Xt(A,v),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Ae(E,a),[0,0,.8],[Math.PI/2,0,0]],[new Xt(A,x),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Ae(E,c),[.85,.85,0],null,[2,2,.2]],[new Xt(A,_),[.855,.98,0],null,[.125,1,1]],[new Xt(A,_),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Ae(E,u),[0,.85,.85],null,[.2,2,2]],[new Xt(A,y),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Xt(A,y),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Ae(E,h),[.85,0,.85],null,[2,.2,2]],[new Xt(A,g),[.855,0,.98],null,[.125,1,1]],[new Xt(A,g),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Ae(new un(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new Ae(new un(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new Ae(new un(.125,.125,.125),l.clone()),[0,0,1.1]]]},$={X:[[new Ae(new Tr(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Ae(new Tr(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new Ae(new Tr(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Ae(E,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Ae(E,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Ae(E,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Ae(new un(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new Ae(new un(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new Ae(new un(.2,.2,.2),n),[0,0,1.1]]]},U={X:[[new Xt(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Xt(A,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Xt(A,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},X=j=>{const B=new Kt;for(let Z in j)for(let ie=j[Z].length;ie--;){const V=j[Z][ie][0].clone(),te=j[Z][ie][1],fe=j[Z][ie][2],he=j[Z][ie][3],le=j[Z][ie][4];V.name=Z,V.tag=le,te&&V.position.set(te[0],te[1],te[2]),fe&&V.rotation.set(fe[0],fe[1],fe[2]),he&&V.scale.set(he[0],he[1],he[2]),V.updateMatrix();const G=V.geometry.clone();G.applyMatrix4(V.matrix),V.geometry=G,V.renderOrder=1/0,V.position.set(0,0,0),V.rotation.set(0,0,0),V.scale.set(1,1,1),B.add(V)}return B};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=X(M)),this.add(this.gizmo.rotate=X(F)),this.add(this.gizmo.scale=X(H)),this.add(this.picker.translate=X(R)),this.add(this.picker.rotate=X(q)),this.add(this.picker.scale=X($)),this.add(this.helper.translate=X(D)),this.add(this.helper.rotate=X(z)),this.add(this.helper.scale=X(U)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class Tae extends Ae{constructor(){super(new Ot(1e5,1e5,2,2),new Yt({visible:!1,wireframe:!0,side:_n,transparent:!0,opacity:.1,toneMapped:!1})),Oe(this,"isTransformControlsPlane",!0),Oe(this,"type","TransformControlsPlane"),Oe(this,"unitX",new N(1,0,0)),Oe(this,"unitY",new N(0,1,0)),Oe(this,"unitZ",new N(0,0,1)),Oe(this,"tempVector",new N),Oe(this,"dirVector",new N),Oe(this,"alignVector",new N),Oe(this,"tempMatrix",new Ze),Oe(this,"identityQuaternion",new Qt),Oe(this,"cameraQuaternion",new Qt),Oe(this,"worldPosition",new N),Oe(this,"worldQuaternion",new Qt),Oe(this,"eye",new N),Oe(this,"axis",null),Oe(this,"mode","translate"),Oe(this,"space","world"),Oe(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),this.unitX.set(1,0,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}var Eae=Object.defineProperty,Aae=(i,e,t)=>e in i?Eae(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,At=(i,e,t)=>(Aae(i,typeof e!="symbol"?e+"":e,t),t);const Ix=new la,n4=new Vr,Cae=Math.cos(70*(Math.PI/180)),i4=(i,e)=>(i%e+e)%e;let Pae=class extends _ae{constructor(e,t){super(),At(this,"object"),At(this,"domElement"),At(this,"enabled",!0),At(this,"target",new N),At(this,"minDistance",0),At(this,"maxDistance",1/0),At(this,"minZoom",0),At(this,"maxZoom",1/0),At(this,"minPolarAngle",0),At(this,"maxPolarAngle",Math.PI),At(this,"minAzimuthAngle",-1/0),At(this,"maxAzimuthAngle",1/0),At(this,"enableDamping",!1),At(this,"dampingFactor",.05),At(this,"enableZoom",!0),At(this,"zoomSpeed",1),At(this,"enableRotate",!0),At(this,"rotateSpeed",1),At(this,"enablePan",!0),At(this,"panSpeed",1),At(this,"screenSpacePanning",!0),At(this,"keyPanSpeed",7),At(this,"zoomToCursor",!1),At(this,"autoRotate",!1),At(this,"autoRotateSpeed",2),At(this,"reverseOrbit",!1),At(this,"reverseHorizontalOrbit",!1),At(this,"reverseVerticalOrbit",!1),At(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),At(this,"mouseButtons",{LEFT:ao.ROTATE,MIDDLE:ao.DOLLY,RIGHT:ao.PAN}),At(this,"touches",{ONE:lo.ROTATE,TWO:lo.DOLLY_PAN}),At(this,"target0"),At(this,"position0"),At(this,"zoom0"),At(this,"_domElementKeyEvents",null),At(this,"getPolarAngle"),At(this,"getAzimuthalAngle"),At(this,"setPolarAngle"),At(this,"setAzimuthalAngle"),At(this,"getDistance"),At(this,"getZoomScale"),At(this,"listenToKeyEvents"),At(this,"stopListenToKeyEvents"),At(this,"saveState"),At(this,"reset"),At(this,"update"),At(this,"connect"),At(this,"dispose"),At(this,"dollyIn"),At(this,"dollyOut"),At(this,"getScale"),At(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=ce=>{let ke=i4(ce,2*Math.PI),ae=u.phi;ae<0&&(ae+=2*Math.PI),ke<0&&(ke+=2*Math.PI);let Be=Math.abs(ke-ae);2*Math.PI-Be<Be&&(ke<ae?ke+=2*Math.PI:ae+=2*Math.PI),h.phi=ke-ae,n.update()},this.setAzimuthalAngle=ce=>{let ke=i4(ce,2*Math.PI),ae=u.theta;ae<0&&(ae+=2*Math.PI),ke<0&&(ke+=2*Math.PI);let Be=Math.abs(ke-ae);2*Math.PI-Be<Be&&(ke<ae?ke+=2*Math.PI:ae+=2*Math.PI),h.theta=ke-ae,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ce=>{ce.addEventListener("keydown",ze),this._domElementKeyEvents=ce},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ze),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const ce=new N,ke=new N(0,1,0),ae=new Qt().setFromUnitVectors(e.up,ke),Be=ae.clone().invert(),pe=new N,De=new Qt,$e=2*Math.PI;return function(){const rt=n.object.position;ae.setFromUnitVectors(e.up,ke),Be.copy(ae).invert(),ce.copy(rt).sub(n.target),ce.applyQuaternion(ae),u.setFromVector3(ce),n.autoRotate&&l===a.NONE&&z(D()),n.enableDamping?(u.theta+=h.theta*n.dampingFactor,u.phi+=h.phi*n.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let bt=n.minAzimuthAngle,Ct=n.maxAzimuthAngle;isFinite(bt)&&isFinite(Ct)&&(bt<-Math.PI?bt+=$e:bt>Math.PI&&(bt-=$e),Ct<-Math.PI?Ct+=$e:Ct>Math.PI&&(Ct-=$e),bt<=Ct?u.theta=Math.max(bt,Math.min(Ct,u.theta)):u.theta=u.theta>(bt+Ct)/2?Math.max(bt,u.theta):Math.min(Ct,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(p,n.dampingFactor):n.target.add(p),n.zoomToCursor&&L||n.object.isOrthographicCamera?u.radius=ie(u.radius):u.radius=ie(u.radius*f),ce.setFromSpherical(u),ce.applyQuaternion(Be),rt.copy(n.target).add(ce),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,p.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),p.set(0,0,0));let nt=!1;if(n.zoomToCursor&&L){let Lt=null;if(n.object instanceof Un&&n.object.isPerspectiveCamera){const ln=ce.length();Lt=ie(ln*f);const Fn=ln-Lt;n.object.position.addScaledVector(A,Fn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ln=new N(T.x,T.y,0);ln.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix(),nt=!0;const Fn=new N(T.x,T.y,0);Fn.unproject(n.object),n.object.position.sub(Fn).add(ln),n.object.updateMatrixWorld(),Lt=ce.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Lt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Lt).add(n.object.position):(Ix.origin.copy(n.object.position),Ix.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Ix.direction))<Cae?e.lookAt(n.target):(n4.setFromNormalAndCoplanarPoint(n.object.up,n.target),Ix.intersectPlane(n4,n.target))))}else n.object instanceof yo&&n.object.isOrthographicCamera&&(nt=f!==1,nt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix()));return f=1,L=!1,nt||pe.distanceToSquared(n.object.position)>c||8*(1-De.dot(n.object.quaternion))>c?(n.dispatchEvent(r),pe.copy(n.object.position),De.copy(n.object.quaternion),nt=!1,!0):!1}})(),this.connect=ce=>{n.domElement=ce,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Xe),n.domElement.addEventListener("pointerdown",ue),n.domElement.addEventListener("pointercancel",Me),n.domElement.addEventListener("wheel",Ie)},this.dispose=()=>{var ce,ke,ae,Be,pe,De;n.domElement&&(n.domElement.style.touchAction="auto"),(ce=n.domElement)==null||ce.removeEventListener("contextmenu",Xe),(ke=n.domElement)==null||ke.removeEventListener("pointerdown",ue),(ae=n.domElement)==null||ae.removeEventListener("pointercancel",Me),(Be=n.domElement)==null||Be.removeEventListener("wheel",Ie),(pe=n.domElement)==null||pe.ownerDocument.removeEventListener("pointermove",me),(De=n.domElement)==null||De.ownerDocument.removeEventListener("pointerup",Me),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",ze)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new Kh,h=new Kh;let f=1;const p=new N,v=new be,x=new be,y=new be,g=new be,_=new be,w=new be,S=new be,C=new be,E=new be,A=new N,T=new be;let L=!1;const M=[],R={};function D(){return 2*Math.PI/60/60*n.autoRotateSpeed}function F(){return Math.pow(.95,n.zoomSpeed)}function z(ce){n.reverseOrbit||n.reverseHorizontalOrbit?h.theta+=ce:h.theta-=ce}function q(ce){n.reverseOrbit||n.reverseVerticalOrbit?h.phi+=ce:h.phi-=ce}const H=(()=>{const ce=new N;return function(ae,Be){ce.setFromMatrixColumn(Be,0),ce.multiplyScalar(-ae),p.add(ce)}})(),$=(()=>{const ce=new N;return function(ae,Be){n.screenSpacePanning===!0?ce.setFromMatrixColumn(Be,1):(ce.setFromMatrixColumn(Be,0),ce.crossVectors(n.object.up,ce)),ce.multiplyScalar(ae),p.add(ce)}})(),U=(()=>{const ce=new N;return function(ae,Be){const pe=n.domElement;if(pe&&n.object instanceof Un&&n.object.isPerspectiveCamera){const De=n.object.position;ce.copy(De).sub(n.target);let $e=ce.length();$e*=Math.tan(n.object.fov/2*Math.PI/180),H(2*ae*$e/pe.clientHeight,n.object.matrix),$(2*Be*$e/pe.clientHeight,n.object.matrix)}else pe&&n.object instanceof yo&&n.object.isOrthographicCamera?(H(ae*(n.object.right-n.object.left)/n.object.zoom/pe.clientWidth,n.object.matrix),$(Be*(n.object.top-n.object.bottom)/n.object.zoom/pe.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function X(ce){n.object instanceof Un&&n.object.isPerspectiveCamera||n.object instanceof yo&&n.object.isOrthographicCamera?f=ce:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function j(ce){X(f/ce)}function B(ce){X(f*ce)}function Z(ce){if(!n.zoomToCursor||!n.domElement)return;L=!0;const ke=n.domElement.getBoundingClientRect(),ae=ce.clientX-ke.left,Be=ce.clientY-ke.top,pe=ke.width,De=ke.height;T.x=ae/pe*2-1,T.y=-(Be/De)*2+1,A.set(T.x,T.y,1).unproject(n.object).sub(n.object.position).normalize()}function ie(ce){return Math.max(n.minDistance,Math.min(n.maxDistance,ce))}function V(ce){v.set(ce.clientX,ce.clientY)}function te(ce){Z(ce),S.set(ce.clientX,ce.clientY)}function fe(ce){g.set(ce.clientX,ce.clientY)}function he(ce){x.set(ce.clientX,ce.clientY),y.subVectors(x,v).multiplyScalar(n.rotateSpeed);const ke=n.domElement;ke&&(z(2*Math.PI*y.x/ke.clientHeight),q(2*Math.PI*y.y/ke.clientHeight)),v.copy(x),n.update()}function le(ce){C.set(ce.clientX,ce.clientY),E.subVectors(C,S),E.y>0?j(F()):E.y<0&&B(F()),S.copy(C),n.update()}function G(ce){_.set(ce.clientX,ce.clientY),w.subVectors(_,g).multiplyScalar(n.panSpeed),U(w.x,w.y),g.copy(_),n.update()}function Q(ce){Z(ce),ce.deltaY<0?B(F()):ce.deltaY>0&&j(F()),n.update()}function J(ce){let ke=!1;switch(ce.code){case n.keys.UP:U(0,n.keyPanSpeed),ke=!0;break;case n.keys.BOTTOM:U(0,-n.keyPanSpeed),ke=!0;break;case n.keys.LEFT:U(n.keyPanSpeed,0),ke=!0;break;case n.keys.RIGHT:U(-n.keyPanSpeed,0),ke=!0;break}ke&&(ce.preventDefault(),n.update())}function ne(){if(M.length==1)v.set(M[0].pageX,M[0].pageY);else{const ce=.5*(M[0].pageX+M[1].pageX),ke=.5*(M[0].pageY+M[1].pageY);v.set(ce,ke)}}function Y(){if(M.length==1)g.set(M[0].pageX,M[0].pageY);else{const ce=.5*(M[0].pageX+M[1].pageX),ke=.5*(M[0].pageY+M[1].pageY);g.set(ce,ke)}}function de(){const ce=M[0].pageX-M[1].pageX,ke=M[0].pageY-M[1].pageY,ae=Math.sqrt(ce*ce+ke*ke);S.set(0,ae)}function ve(){n.enableZoom&&de(),n.enablePan&&Y()}function Se(){n.enableZoom&&de(),n.enableRotate&&ne()}function Te(ce){if(M.length==1)x.set(ce.pageX,ce.pageY);else{const ae=qe(ce),Be=.5*(ce.pageX+ae.x),pe=.5*(ce.pageY+ae.y);x.set(Be,pe)}y.subVectors(x,v).multiplyScalar(n.rotateSpeed);const ke=n.domElement;ke&&(z(2*Math.PI*y.x/ke.clientHeight),q(2*Math.PI*y.y/ke.clientHeight)),v.copy(x)}function Ee(ce){if(M.length==1)_.set(ce.pageX,ce.pageY);else{const ke=qe(ce),ae=.5*(ce.pageX+ke.x),Be=.5*(ce.pageY+ke.y);_.set(ae,Be)}w.subVectors(_,g).multiplyScalar(n.panSpeed),U(w.x,w.y),g.copy(_)}function Re(ce){const ke=qe(ce),ae=ce.pageX-ke.x,Be=ce.pageY-ke.y,pe=Math.sqrt(ae*ae+Be*Be);C.set(0,pe),E.set(0,Math.pow(C.y/S.y,n.zoomSpeed)),j(E.y),S.copy(C)}function K(ce){n.enableZoom&&Re(ce),n.enablePan&&Ee(ce)}function k(ce){n.enableZoom&&Re(ce),n.enableRotate&&Te(ce)}function ue(ce){var ke,ae;n.enabled!==!1&&(M.length===0&&((ke=n.domElement)==null||ke.ownerDocument.addEventListener("pointermove",me),(ae=n.domElement)==null||ae.ownerDocument.addEventListener("pointerup",Me)),ct(ce),ce.pointerType==="touch"?Je(ce):ge(ce))}function me(ce){n.enabled!==!1&&(ce.pointerType==="touch"?Fe(ce):Ye(ce))}function Me(ce){var ke,ae,Be;tt(ce),M.length===0&&((ke=n.domElement)==null||ke.releasePointerCapture(ce.pointerId),(ae=n.domElement)==null||ae.ownerDocument.removeEventListener("pointermove",me),(Be=n.domElement)==null||Be.ownerDocument.removeEventListener("pointerup",Me)),n.dispatchEvent(o),l=a.NONE}function ge(ce){let ke;switch(ce.button){case 0:ke=n.mouseButtons.LEFT;break;case 1:ke=n.mouseButtons.MIDDLE;break;case 2:ke=n.mouseButtons.RIGHT;break;default:ke=-1}switch(ke){case ao.DOLLY:if(n.enableZoom===!1)return;te(ce),l=a.DOLLY;break;case ao.ROTATE:if(ce.ctrlKey||ce.metaKey||ce.shiftKey){if(n.enablePan===!1)return;fe(ce),l=a.PAN}else{if(n.enableRotate===!1)return;V(ce),l=a.ROTATE}break;case ao.PAN:if(ce.ctrlKey||ce.metaKey||ce.shiftKey){if(n.enableRotate===!1)return;V(ce),l=a.ROTATE}else{if(n.enablePan===!1)return;fe(ce),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function Ye(ce){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;he(ce);break;case a.DOLLY:if(n.enableZoom===!1)return;le(ce);break;case a.PAN:if(n.enablePan===!1)return;G(ce);break}}function Ie(ce){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ce.preventDefault(),n.dispatchEvent(s),Q(ce),n.dispatchEvent(o))}function ze(ce){n.enabled===!1||n.enablePan===!1||J(ce)}function Je(ce){switch(Ve(ce),M.length){case 1:switch(n.touches.ONE){case lo.ROTATE:if(n.enableRotate===!1)return;ne(),l=a.TOUCH_ROTATE;break;case lo.PAN:if(n.enablePan===!1)return;Y(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case lo.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ve(),l=a.TOUCH_DOLLY_PAN;break;case lo.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Se(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function Fe(ce){switch(Ve(ce),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;Te(ce),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;Ee(ce),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;K(ce),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;k(ce),n.update();break;default:l=a.NONE}}function Xe(ce){n.enabled!==!1&&ce.preventDefault()}function ct(ce){M.push(ce)}function tt(ce){delete R[ce.pointerId];for(let ke=0;ke<M.length;ke++)if(M[ke].pointerId==ce.pointerId){M.splice(ke,1);return}}function Ve(ce){let ke=R[ce.pointerId];ke===void 0&&(ke=new be,R[ce.pointerId]=ke),ke.set(ce.pageX,ce.pageY)}function qe(ce){const ke=ce.pointerId===M[0].pointerId?M[1]:M[0];return R[ke.pointerId]}this.dollyIn=(ce=F())=>{B(ce),n.update()},this.dollyOut=(ce=F())=>{j(ce),n.update()},this.getScale=()=>f,this.setScale=ce=>{X(ce),n.update()},this.getZoomScale=()=>F(),t!==void 0&&this.connect(t),this.update()}};const r4=new vn,Ux=new N;class nP extends Mw{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new lt(e,3)),this.setAttribute("uv",new lt(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new h_(t,6,1);return this.setAttribute("instanceStart",new Ls(n,3,0)),this.setAttribute("instanceEnd",new Ls(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const r=new h_(n,t*2,1);return this.setAttribute("instanceColorStart",new Ls(r,t,0)),this.setAttribute("instanceColorEnd",new Ls(r,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new xA(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vn);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),r4.setFromBufferAttribute(t),this.boundingBox.union(r4))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Li),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Ux.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Ux)),Ux.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(Ux));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class HG extends nP{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,r=new Float32Array(2*n);if(t===3)for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5];else for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5],r[2*s+6]=e[s+6],r[2*s+7]=e[s+7];return super.setColors(r,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class iP extends Ft{constructor(e){super({type:"LineMaterial",uniforms:Is.clone(Is.merge([it.common,it.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new be(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${zG>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const iT=new Pt,s4=new N,o4=new N,_r=new Pt,wr=new Pt,Ga=new Pt,rT=new N,sT=new Ze,br=new Us,a4=new N,Fx=new vn,kx=new Li,Va=new Pt;let Qa,zh;function l4(i,e,t){return Va.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),Va.multiplyScalar(1/Va.w),Va.x=zh/t.width,Va.y=zh/t.height,Va.applyMatrix4(i.projectionMatrixInverse),Va.multiplyScalar(1/Va.w),Math.abs(Math.max(Va.x,Va.y))}function Rae(i,e){const t=i.matrixWorld,n=i.geometry,r=n.attributes.instanceStart,s=n.attributes.instanceEnd,o=Math.min(n.instanceCount,r.count);for(let a=0,l=o;a<l;a++){br.start.fromBufferAttribute(r,a),br.end.fromBufferAttribute(s,a),br.applyMatrix4(t);const c=new N,u=new N;Qa.distanceSqToSegment(br.start,br.end,u,c),u.distanceTo(c)<zh*.5&&e.push({point:u,pointOnLine:c,distance:Qa.origin.distanceTo(u),object:i,face:null,faceIndex:a,uv:null,[BG]:null})}}function Lae(i,e,t){const n=e.projectionMatrix,s=i.material.resolution,o=i.matrixWorld,a=i.geometry,l=a.attributes.instanceStart,c=a.attributes.instanceEnd,u=Math.min(a.instanceCount,l.count),h=-e.near;Qa.at(1,Ga),Ga.w=1,Ga.applyMatrix4(e.matrixWorldInverse),Ga.applyMatrix4(n),Ga.multiplyScalar(1/Ga.w),Ga.x*=s.x/2,Ga.y*=s.y/2,Ga.z=0,rT.copy(Ga),sT.multiplyMatrices(e.matrixWorldInverse,o);for(let f=0,p=u;f<p;f++){if(_r.fromBufferAttribute(l,f),wr.fromBufferAttribute(c,f),_r.w=1,wr.w=1,_r.applyMatrix4(sT),wr.applyMatrix4(sT),_r.z>h&&wr.z>h)continue;if(_r.z>h){const w=_r.z-wr.z,S=(_r.z-h)/w;_r.lerp(wr,S)}else if(wr.z>h){const w=wr.z-_r.z,S=(wr.z-h)/w;wr.lerp(_r,S)}_r.applyMatrix4(n),wr.applyMatrix4(n),_r.multiplyScalar(1/_r.w),wr.multiplyScalar(1/wr.w),_r.x*=s.x/2,_r.y*=s.y/2,wr.x*=s.x/2,wr.y*=s.y/2,br.start.copy(_r),br.start.z=0,br.end.copy(wr),br.end.z=0;const x=br.closestPointToPointParameter(rT,!0);br.at(x,a4);const y=Ai.lerp(_r.z,wr.z,x),g=y>=-1&&y<=1,_=rT.distanceTo(a4)<zh*.5;if(g&&_){br.start.fromBufferAttribute(l,f),br.end.fromBufferAttribute(c,f),br.start.applyMatrix4(o),br.end.applyMatrix4(o);const w=new N,S=new N;Qa.distanceSqToSegment(br.start,br.end,S,w),t.push({point:S,pointOnLine:w,distance:Qa.origin.distanceTo(S),object:i,face:null,faceIndex:f,uv:null,[BG]:null})}}}class GG extends Ae{constructor(e=new nP,t=new iP({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)s4.fromBufferAttribute(t,o),o4.fromBufferAttribute(n,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+s4.distanceTo(o4);const s=new h_(r,2,1);return e.setAttribute("instanceDistanceStart",new Ls(s,1,0)),e.setAttribute("instanceDistanceEnd",new Ls(s,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;r===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Qa=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;zh=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),kx.copy(a.boundingSphere).applyMatrix4(o);let c;if(n)c=zh*.5;else{const h=Math.max(r.near,kx.distanceToPoint(Qa.origin));c=l4(r,h,l.resolution)}if(kx.radius+=c,Qa.intersectsSphere(kx)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Fx.copy(a.boundingBox).applyMatrix4(o);let u;if(n)u=zh*.5;else{const h=Math.max(r.near,Fx.distanceToPoint(Qa.origin));u=l4(r,h,l.resolution)}Fx.expandByScalar(u),Qa.intersectsBox(Fx)!==!1&&(n?Rae(this,t):Lae(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(iT),this.material.uniforms.resolution.value.set(iT.z,iT.w))}}class Dae extends GG{constructor(e=new HG,t=new iP({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}const Iae=new N,Uae=new N,Fae=new N,kae=(i,e,t)=>{const n=t.width/2,r=t.height/2;e.updateMatrixWorld(!1);const s=i.project(e);return s.x=s.x*n+n,s.y=-(s.y*r)+r,s},Nae=(i,e,t,n=1)=>{const r=Iae.set(i.x/t.width*2-1,-(i.y/t.height)*2+1,n);return r.unproject(e),r},VG=(i,e,t,n)=>{const r=kae(Fae.copy(i),t,n);let s=0;for(let o=0;o<2;++o){const a=Uae.copy(r).setComponent(o,r.getComponent(o)+e),l=Nae(a,t,n,a.z);s=Math.max(s,i.distanceTo(l))}return s},q_=re.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:r,lineWidth:s,segments:o,dashed:a,...l},c){var u,h;const f=En(g=>g.size),p=re.useMemo(()=>o?new GG:new Dae,[o]),[v]=re.useState(()=>new iP),x=(n==null||(u=n[0])==null?void 0:u.length)===4?4:3,y=re.useMemo(()=>{const g=o?new nP:new HG,_=e.map(w=>{const S=Array.isArray(w);return w instanceof N||w instanceof Pt?[w.x,w.y,w.z]:w instanceof be?[w.x,w.y,0]:S&&w.length===3?[w[0],w[1],w[2]]:S&&w.length===2?[w[0],w[1],0]:w});if(g.setPositions(_.flat()),n){t=16777215;const w=n.map(S=>S instanceof Ge?S.toArray():S);g.setColors(w.flat(),x)}return g},[e,o,n,x]);return re.useLayoutEffect(()=>{p.computeLineDistances()},[e,p]),re.useLayoutEffect(()=>{a?v.defines.USE_DASH="":delete v.defines.USE_DASH,v.needsUpdate=!0},[a,v]),re.useEffect(()=>()=>y.dispose(),[y]),re.createElement("primitive",al({object:p,ref:c},l),re.createElement("primitive",{object:y,attach:"geometry"}),re.createElement("primitive",al({object:v,attach:"material",color:t,vertexColors:!!n,resolution:[f.width,f.height],linewidth:(h=r??s)!==null&&h!==void 0?h:1,dashed:a,transparent:x===4},l)))});function Oae(){var i=Object.create(null);function e(r,s){var o=r.id,a=r.name,l=r.dependencies;l===void 0&&(l=[]);var c=r.init;c===void 0&&(c=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!i[o])try{l=l.map(function(f){return f&&f.isWorkerModule&&(e(f,function(p){if(p instanceof Error)throw p}),f=i[f.id].value),f}),c=n("<"+a+">.init",c),u&&(u=n("<"+a+">.getTransferables",u));var h=null;typeof c=="function"?h=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),i[o]={id:o,value:h,getTransferables:u},s(h)}catch(f){f&&f.noLog||console.error(f),s(f)}}function t(r,s){var o,a=r.id,l=r.args;(!i[a]||typeof i[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var c=(o=i[a]).value.apply(o,l);c&&typeof c.then=="function"?c.then(u,function(h){return s(h instanceof Error?h:new Error(""+h))}):u(c)}catch(h){s(h)}function u(h){try{var f=i[a].getTransferables&&i[a].getTransferables(h);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),s(h,f)}catch(p){console.error(p),s(p)}}}function n(r,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(r){var s=r.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof c=="function"}})}),a==="callModule"&&t(l,function(c,u){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:o,success:!1,error:c.stack})}})}function zae(i){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=i.dependencies,n=i.init;t=Array.isArray(t)?t.map(function(s){return s&&s._getInitResult?s._getInitResult():s}):[];var r=Promise.all(t).then(function(s){return n.apply(null,s)});return e._getInitResult=function(){return r},r},e}var WG=function(){var i=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),i=!0}catch(t){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return WG=function(){return i},i},Bae=0,Hae=0,oT=!1,Yg=Object.create(null),qg=Object.create(null),OE=Object.create(null);function tm(i){if((!i||typeof i.init!="function")&&!oT)throw new Error("requires `options.init` function");var e=i.dependencies,t=i.init,n=i.getTransferables,r=i.workerId;if(!WG())return zae(i);r==null&&(r="#default");var s="workerModule"+ ++Bae,o=i.name||s,a=null;e=e&&e.map(function(c){return typeof c=="function"&&!c.workerModuleData&&(oT=!0,c=tm({workerId:r,name:"<"+o+"> function dependency: "+c.name,init:`function(){return (
`+M1(c)+`
)}`}),oT=!1),c&&c.workerModuleData&&(c=c.workerModuleData),c});function l(){for(var c=[],u=arguments.length;u--;)c[u]=arguments[u];if(!a){a=c4(r,"registerModule",l.workerModuleData);var h=function(){a=null,qg[r].delete(h)};(qg[r]||(qg[r]=new Set)).add(h)}return a.then(function(f){var p=f.isCallable;if(p)return c4(r,"callModule",{id:s,args:c});throw new Error("Worker module function was called but `init` did not return a callable function")})}return l.workerModuleData={isWorkerModule:!0,id:s,name:o,dependencies:e,init:M1(t),getTransferables:n&&M1(n)},l}function Gae(i){qg[i]&&qg[i].forEach(function(e){e()}),Yg[i]&&(Yg[i].terminate(),delete Yg[i])}function M1(i){var e=i.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function Vae(i){var e=Yg[i];if(!e){var t=M1(Oae);e=Yg[i]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+i.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var r=n.data,s=r.messageId,o=OE[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete OE[s],o(r)}}return e}function c4(i,e,t){return new Promise(function(n,r){var s=++Hae;OE[s]=function(o){o.success?n(o.result):r(new Error("Error in worker "+e+" call: "+o.error))},Vae(i).postMessage({messageId:s,action:e,data:t})})}function jG(){var i=function(e){function t(X,j,B,Z,ie,V,te,fe){var he=1-te;fe.x=he*he*X+2*he*te*B+te*te*ie,fe.y=he*he*j+2*he*te*Z+te*te*V}function n(X,j,B,Z,ie,V,te,fe,he,le){var G=1-he;le.x=G*G*G*X+3*G*G*he*B+3*G*he*he*ie+he*he*he*te,le.y=G*G*G*j+3*G*G*he*Z+3*G*he*he*V+he*he*he*fe}function r(X,j){for(var B=/([MLQCZ])([^MLQCZ]*)/g,Z,ie,V,te,fe;Z=B.exec(X);){var he=Z[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(le){return parseFloat(le)});switch(Z[1]){case"M":te=ie=he[0],fe=V=he[1];break;case"L":(he[0]!==te||he[1]!==fe)&&j("L",te,fe,te=he[0],fe=he[1]);break;case"Q":{j("Q",te,fe,te=he[2],fe=he[3],he[0],he[1]);break}case"C":{j("C",te,fe,te=he[4],fe=he[5],he[0],he[1],he[2],he[3]);break}case"Z":(te!==ie||fe!==V)&&j("L",te,fe,ie,V);break}}}function s(X,j,B){B===void 0&&(B=16);var Z={x:0,y:0};r(X,function(ie,V,te,fe,he,le,G,Q,J){switch(ie){case"L":j(V,te,fe,he);break;case"Q":{for(var ne=V,Y=te,de=1;de<B;de++)t(V,te,le,G,fe,he,de/(B-1),Z),j(ne,Y,Z.x,Z.y),ne=Z.x,Y=Z.y;break}case"C":{for(var ve=V,Se=te,Te=1;Te<B;Te++)n(V,te,le,G,Q,J,fe,he,Te/(B-1),Z),j(ve,Se,Z.x,Z.y),ve=Z.x,Se=Z.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(X,j){var B=X.getContext?X.getContext("webgl",c):X,Z=l.get(B);if(!Z){let G=function(ve){var Se=V[ve];if(!Se&&(Se=V[ve]=B.getExtension(ve),!Se))throw new Error(ve+" not supported");return Se},Q=function(ve,Se){var Te=B.createShader(Se);return B.shaderSource(Te,ve),B.compileShader(Te),Te},J=function(ve,Se,Te,Ee){if(!te[ve]){var Re={},K={},k=B.createProgram();B.attachShader(k,Q(Se,B.VERTEX_SHADER)),B.attachShader(k,Q(Te,B.FRAGMENT_SHADER)),B.linkProgram(k),te[ve]={program:k,transaction:function(me){B.useProgram(k),me({setUniform:function(ge,Ye){for(var Ie=[],ze=arguments.length-2;ze-- >0;)Ie[ze]=arguments[ze+2];var Je=K[Ye]||(K[Ye]=B.getUniformLocation(k,Ye));B["uniform"+ge].apply(B,[Je].concat(Ie))},setAttribute:function(ge,Ye,Ie,ze,Je){var Fe=Re[ge];Fe||(Fe=Re[ge]={buf:B.createBuffer(),loc:B.getAttribLocation(k,ge),data:null}),B.bindBuffer(B.ARRAY_BUFFER,Fe.buf),B.vertexAttribPointer(Fe.loc,Ye,B.FLOAT,!1,0,0),B.enableVertexAttribArray(Fe.loc),ie?B.vertexAttribDivisor(Fe.loc,ze):G("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Fe.loc,ze),Je!==Fe.data&&(B.bufferData(B.ARRAY_BUFFER,Je,Ie),Fe.data=Je)}})}}}te[ve].transaction(Ee)},ne=function(ve,Se){he++;try{B.activeTexture(B.TEXTURE0+he);var Te=fe[ve];Te||(Te=fe[ve]=B.createTexture(),B.bindTexture(B.TEXTURE_2D,Te),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,B.NEAREST),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,B.NEAREST)),B.bindTexture(B.TEXTURE_2D,Te),Se(Te,he)}finally{he--}},Y=function(ve,Se,Te){var Ee=B.createFramebuffer();le.push(Ee),B.bindFramebuffer(B.FRAMEBUFFER,Ee),B.activeTexture(B.TEXTURE0+Se),B.bindTexture(B.TEXTURE_2D,ve),B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_2D,ve,0);try{Te(Ee)}finally{B.deleteFramebuffer(Ee),B.bindFramebuffer(B.FRAMEBUFFER,le[--le.length-1]||null)}},de=function(){V={},te={},fe={},he=-1,le.length=0};var ie=typeof WebGL2RenderingContext<"u"&&B instanceof WebGL2RenderingContext,V={},te={},fe={},he=-1,le=[];B.canvas.addEventListener("webglcontextlost",function(ve){de(),ve.preventDefault()},!1),l.set(B,Z={gl:B,isWebGL2:ie,getExtension:G,withProgram:J,withTexture:ne,withTextureFramebuffer:Y,handleContextLoss:de})}j(Z)}function h(X,j,B,Z,ie,V,te,fe){te===void 0&&(te=15),fe===void 0&&(fe=null),u(X,function(he){var le=he.gl,G=he.withProgram,Q=he.withTexture;Q("copy",function(J,ne){le.texImage2D(le.TEXTURE_2D,0,le.RGBA,ie,V,0,le.RGBA,le.UNSIGNED_BYTE,j),G("copy",o,a,function(Y){var de=Y.setUniform,ve=Y.setAttribute;ve("aUV",2,le.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),de("1i","image",ne),le.bindFramebuffer(le.FRAMEBUFFER,fe||null),le.disable(le.BLEND),le.colorMask(te&8,te&4,te&2,te&1),le.viewport(B,Z,ie,V),le.scissor(B,Z,ie,V),le.drawArrays(le.TRIANGLES,0,3)})})})}function f(X,j,B){var Z=X.width,ie=X.height;u(X,function(V){var te=V.gl,fe=new Uint8Array(Z*ie*4);te.readPixels(0,0,Z,ie,te.RGBA,te.UNSIGNED_BYTE,fe),X.width=j,X.height=B,h(te,fe,0,0,Z,ie)})}var p=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:h,resizeWebGLCanvasWithoutClearing:f});function v(X,j,B,Z,ie,V){V===void 0&&(V=1);var te=new Uint8Array(X*j),fe=Z[2]-Z[0],he=Z[3]-Z[1],le=[];s(B,function(ve,Se,Te,Ee){le.push({x1:ve,y1:Se,x2:Te,y2:Ee,minX:Math.min(ve,Te),minY:Math.min(Se,Ee),maxX:Math.max(ve,Te),maxY:Math.max(Se,Ee)})}),le.sort(function(ve,Se){return ve.maxX-Se.maxX});for(var G=0;G<X;G++)for(var Q=0;Q<j;Q++){var J=Y(Z[0]+fe*(G+.5)/X,Z[1]+he*(Q+.5)/j),ne=Math.pow(1-Math.abs(J)/ie,V)/2;J<0&&(ne=1-ne),ne=Math.max(0,Math.min(255,Math.round(ne*255))),te[Q*X+G]=ne}return te;function Y(ve,Se){for(var Te=1/0,Ee=1/0,Re=le.length;Re--;){var K=le[Re];if(K.maxX+Ee<=ve)break;if(ve+Ee>K.minX&&Se-Ee<K.maxY&&Se+Ee>K.minY){var k=g(ve,Se,K.x1,K.y1,K.x2,K.y2);k<Te&&(Te=k,Ee=Math.sqrt(Te))}}return de(ve,Se)&&(Ee=-Ee),Ee}function de(ve,Se){for(var Te=0,Ee=le.length;Ee--;){var Re=le[Ee];if(Re.maxX<=ve)break;var K=Re.y1>Se!=Re.y2>Se&&ve<(Re.x2-Re.x1)*(Se-Re.y1)/(Re.y2-Re.y1)+Re.x1;K&&(Te+=Re.y1<Re.y2?1:-1)}return Te!==0}}function x(X,j,B,Z,ie,V,te,fe,he,le){V===void 0&&(V=1),fe===void 0&&(fe=0),he===void 0&&(he=0),le===void 0&&(le=0),y(X,j,B,Z,ie,V,te,null,fe,he,le)}function y(X,j,B,Z,ie,V,te,fe,he,le,G){V===void 0&&(V=1),he===void 0&&(he=0),le===void 0&&(le=0),G===void 0&&(G=0);for(var Q=v(X,j,B,Z,ie,V),J=new Uint8Array(Q.length*4),ne=0;ne<Q.length;ne++)J[ne*4+G]=Q[ne];h(te,J,he,le,X,j,1<<3-G,fe)}function g(X,j,B,Z,ie,V){var te=ie-B,fe=V-Z,he=te*te+fe*fe,le=he?Math.max(0,Math.min(1,((X-B)*te+(j-Z)*fe)/he)):0,G=X-(B+le*te),Q=j-(Z+le*fe);return G*G+Q*Q}var _=Object.freeze({__proto__:null,generate:v,generateIntoCanvas:x,generateIntoFramebuffer:y}),w="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",S="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",C="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",E=new Float32Array([0,0,2,0,0,2]),A=null,T=!1,L={},M=new WeakMap;function R(X){if(!T&&!q(X))throw new Error("WebGL generation not supported")}function D(X,j,B,Z,ie,V,te){if(V===void 0&&(V=1),te===void 0&&(te=null),!te&&(te=A,!te)){var fe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!fe)throw new Error("OffscreenCanvas or DOM canvas not supported");te=A=fe.getContext("webgl",{depth:!1})}R(te);var he=new Uint8Array(X*j*4);u(te,function(J){var ne=J.gl,Y=J.withTexture,de=J.withTextureFramebuffer;Y("readable",function(ve,Se){ne.texImage2D(ne.TEXTURE_2D,0,ne.RGBA,X,j,0,ne.RGBA,ne.UNSIGNED_BYTE,null),de(ve,Se,function(Te){z(X,j,B,Z,ie,V,ne,Te,0,0,0),ne.readPixels(0,0,X,j,ne.RGBA,ne.UNSIGNED_BYTE,he)})})});for(var le=new Uint8Array(X*j),G=0,Q=0;G<he.length;G+=4)le[Q++]=he[G];return le}function F(X,j,B,Z,ie,V,te,fe,he,le){V===void 0&&(V=1),fe===void 0&&(fe=0),he===void 0&&(he=0),le===void 0&&(le=0),z(X,j,B,Z,ie,V,te,null,fe,he,le)}function z(X,j,B,Z,ie,V,te,fe,he,le,G){V===void 0&&(V=1),he===void 0&&(he=0),le===void 0&&(le=0),G===void 0&&(G=0),R(te);var Q=[];s(B,function(J,ne,Y,de){Q.push(J,ne,Y,de)}),Q=new Float32Array(Q),u(te,function(J){var ne=J.gl,Y=J.isWebGL2,de=J.getExtension,ve=J.withProgram,Se=J.withTexture,Te=J.withTextureFramebuffer,Ee=J.handleContextLoss;if(Se("rawDistances",function(Re,K){(X!==Re._lastWidth||j!==Re._lastHeight)&&ne.texImage2D(ne.TEXTURE_2D,0,ne.RGBA,Re._lastWidth=X,Re._lastHeight=j,0,ne.RGBA,ne.UNSIGNED_BYTE,null),ve("main",w,S,function(k){var ue=k.setAttribute,me=k.setUniform,Me=!Y&&de("ANGLE_instanced_arrays"),ge=!Y&&de("EXT_blend_minmax");ue("aUV",2,ne.STATIC_DRAW,0,E),ue("aLineSegment",4,ne.DYNAMIC_DRAW,1,Q),me.apply(void 0,["4f","uGlyphBounds"].concat(Z)),me("1f","uMaxDistance",ie),me("1f","uExponent",V),Te(Re,K,function(Ye){ne.enable(ne.BLEND),ne.colorMask(!0,!0,!0,!0),ne.viewport(0,0,X,j),ne.scissor(0,0,X,j),ne.blendFunc(ne.ONE,ne.ONE),ne.blendEquationSeparate(ne.FUNC_ADD,Y?ne.MAX:ge.MAX_EXT),ne.clear(ne.COLOR_BUFFER_BIT),Y?ne.drawArraysInstanced(ne.TRIANGLES,0,3,Q.length/4):Me.drawArraysInstancedANGLE(ne.TRIANGLES,0,3,Q.length/4)})}),ve("post",o,C,function(k){k.setAttribute("aUV",2,ne.STATIC_DRAW,0,E),k.setUniform("1i","tex",K),ne.bindFramebuffer(ne.FRAMEBUFFER,fe),ne.disable(ne.BLEND),ne.colorMask(G===0,G===1,G===2,G===3),ne.viewport(he,le,X,j),ne.scissor(he,le,X,j),ne.drawArrays(ne.TRIANGLES,0,3)})}),ne.isContextLost())throw Ee(),new Error("webgl context lost")})}function q(X){var j=!X||X===A?L:X.canvas||X,B=M.get(j);if(B===void 0){T=!0;var Z=null;try{var ie=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],V=D(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,X);B=V&&ie.length===V.length&&V.every(function(te,fe){return te===ie[fe]}),B||(Z="bad trial run results",console.info(ie,V))}catch(te){B=!1,Z=te.message}Z&&console.warn("WebGL SDF generation not supported:",Z),T=!1,M.set(j,B)}return B}var H=Object.freeze({__proto__:null,generate:D,generateIntoCanvas:F,generateIntoFramebuffer:z,isSupported:q});function $(X,j,B,Z,ie,V){ie===void 0&&(ie=Math.max(Z[2]-Z[0],Z[3]-Z[1])/2),V===void 0&&(V=1);try{return D.apply(H,arguments)}catch(te){return console.info("WebGL SDF generation failed, falling back to JS",te),v.apply(_,arguments)}}function U(X,j,B,Z,ie,V,te,fe,he,le){ie===void 0&&(ie=Math.max(Z[2]-Z[0],Z[3]-Z[1])/2),V===void 0&&(V=1),fe===void 0&&(fe=0),he===void 0&&(he=0),le===void 0&&(le=0);try{return F.apply(H,arguments)}catch(G){return console.info("WebGL SDF generation failed, falling back to JS",G),x.apply(_,arguments)}}return e.forEachPathCommand=r,e.generate=$,e.generateIntoCanvas=U,e.javascript=_,e.pathToLineSegments=s,e.webgl=H,e.webglUtils=p,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return i}function Wae(){var i=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},r={};n.L=1,r[1]="L",Object.keys(t).forEach(function(Ee,Re){n[Ee]=1<<Re+1,r[n[Ee]]=Ee}),Object.freeze(n);var s=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,a=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,l=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,c=n.S|n.WS|n.B|s|n.PDI|l,u=null;function h(){if(!u){u=new Map;var Ee=function(K){if(t.hasOwnProperty(K)){var k=0;t[K].split(",").forEach(function(ue){var me=ue.split("+"),Me=me[0],ge=me[1];Me=parseInt(Me,36),ge=ge?parseInt(ge,36):0,u.set(k+=Me,n[K]);for(var Ye=0;Ye<ge;Ye++)u.set(++k,n[K])})}};for(var Re in t)Ee(Re)}}function f(Ee){return h(),u.get(Ee.codePointAt(0))||n.L}function p(Ee){return r[f(Ee)]}var v={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function x(Ee,Re){var K=36,k=0,ue=new Map,me=Re&&new Map,Me;return Ee.split(",").forEach(function ge(Ye){if(Ye.indexOf("+")!==-1)for(var Ie=+Ye;Ie--;)ge(Me);else{Me=Ye;var ze=Ye.split(">"),Je=ze[0],Fe=ze[1];Je=String.fromCodePoint(k+=parseInt(Je,K)),Fe=String.fromCodePoint(k+=parseInt(Fe,K)),ue.set(Je,Fe),Re&&me.set(Fe,Je)}}),{map:ue,reverseMap:me}}var y,g,_;function w(){if(!y){var Ee=x(v.pairs,!0),Re=Ee.map,K=Ee.reverseMap;y=Re,g=K,_=x(v.canonical,!1).map}}function S(Ee){return w(),y.get(Ee)||null}function C(Ee){return w(),g.get(Ee)||null}function E(Ee){return w(),_.get(Ee)||null}var A=n.L,T=n.R,L=n.EN,M=n.ES,R=n.ET,D=n.AN,F=n.CS,z=n.B,q=n.S,H=n.ON,$=n.BN,U=n.NSM,X=n.AL,j=n.LRO,B=n.RLO,Z=n.LRE,ie=n.RLE,V=n.PDF,te=n.LRI,fe=n.RLI,he=n.FSI,le=n.PDI;function G(Ee,Re){for(var K=125,k=new Uint32Array(Ee.length),ue=0;ue<Ee.length;ue++)k[ue]=f(Ee[ue]);var me=new Map;function Me(or,rs){var Si=k[or];k[or]=rs,me.set(Si,me.get(Si)-1),Si&a&&me.set(a,me.get(a)-1),me.set(rs,(me.get(rs)||0)+1),rs&a&&me.set(a,(me.get(a)||0)+1)}for(var ge=new Uint8Array(Ee.length),Ye=new Map,Ie=[],ze=null,Je=0;Je<Ee.length;Je++)ze||Ie.push(ze={start:Je,end:Ee.length-1,level:Re==="rtl"?1:Re==="ltr"?0:xf(Je,!1)}),k[Je]&z&&(ze.end=Je,ze=null);for(var Fe=ie|Z|B|j|s|le|V|z,Xe=function(or){return or+(or&1?1:2)},ct=function(or){return or+(or&1?2:1)},tt=0;tt<Ie.length;tt++){ze=Ie[tt];var Ve=[{_level:ze.level,_override:0,_isolate:0}],qe=void 0,ce=0,ke=0,ae=0;me.clear();for(var Be=ze.start;Be<=ze.end;Be++){var pe=k[Be];if(qe=Ve[Ve.length-1],me.set(pe,(me.get(pe)||0)+1),pe&a&&me.set(a,(me.get(a)||0)+1),pe&Fe)if(pe&(ie|Z)){ge[Be]=qe._level;var De=(pe===ie?ct:Xe)(qe._level);De<=K&&!ce&&!ke?Ve.push({_level:De,_override:0,_isolate:0}):ce||ke++}else if(pe&(B|j)){ge[Be]=qe._level;var $e=(pe===B?ct:Xe)(qe._level);$e<=K&&!ce&&!ke?Ve.push({_level:$e,_override:pe&B?T:A,_isolate:0}):ce||ke++}else if(pe&s){pe&he&&(pe=xf(Be+1,!0)===1?fe:te),ge[Be]=qe._level,qe._override&&Me(Be,qe._override);var je=(pe===fe?ct:Xe)(qe._level);je<=K&&ce===0&&ke===0?(ae++,Ve.push({_level:je,_override:0,_isolate:1,_isolInitIndex:Be})):ce++}else if(pe&le){if(ce>0)ce--;else if(ae>0){for(ke=0;!Ve[Ve.length-1]._isolate;)Ve.pop();var rt=Ve[Ve.length-1]._isolInitIndex;rt!=null&&(Ye.set(rt,Be),Ye.set(Be,rt)),Ve.pop(),ae--}qe=Ve[Ve.length-1],ge[Be]=qe._level,qe._override&&Me(Be,qe._override)}else pe&V?(ce===0&&(ke>0?ke--:!qe._isolate&&Ve.length>1&&(Ve.pop(),qe=Ve[Ve.length-1])),ge[Be]=qe._level):pe&z&&(ge[Be]=ze.level);else ge[Be]=qe._level,qe._override&&pe!==$&&Me(Be,qe._override)}for(var bt=[],Ct=null,nt=ze.start;nt<=ze.end;nt++){var Lt=k[nt];if(!(Lt&l)){var ln=ge[nt],Fn=Lt&s,qn=Lt===le;Ct&&ln===Ct._level?(Ct._end=nt,Ct._endsWithIsolInit=Fn):bt.push(Ct={_start:nt,_end:nt,_level:ln,_startsWithPDI:qn,_endsWithIsolInit:Fn})}}for(var wi=[],Jr=0;Jr<bt.length;Jr++){var Ir=bt[Jr];if(!Ir._startsWithPDI||Ir._startsWithPDI&&!Ye.has(Ir._start)){for(var Ks=[Ct=Ir],rr=void 0;Ct&&Ct._endsWithIsolInit&&(rr=Ye.get(Ct._end))!=null;)for(var _s=Jr+1;_s<bt.length;_s++)if(bt[_s]._start===rr){Ks.push(Ct=bt[_s]);break}for(var ci=[],Ao=0;Ao<Ks.length;Ao++)for(var Su=Ks[Ao],Mu=Su._start;Mu<=Su._end;Mu++)ci.push(Mu);for(var nm=ge[ci[0]],mf=ze.level,ee=ci[0]-1;ee>=0;ee--)if(!(k[ee]&l)){mf=ge[ee];break}var xe=ci[ci.length-1],Pe=ge[xe],Le=ze.level;if(!(k[xe]&s)){for(var _e=xe+1;_e<=ze.end;_e++)if(!(k[_e]&l)){Le=ge[_e];break}}wi.push({_seqIndices:ci,_sosType:Math.max(mf,nm)%2?T:A,_eosType:Math.max(Le,Pe)%2?T:A})}}for(var Qe=0;Qe<wi.length;Qe++){var ot=wi[Qe],He=ot._seqIndices,ht=ot._sosType,Tt=ot._eosType,St=ge[He[0]]&1?T:A;if(me.get(U))for(var vt=0;vt<He.length;vt++){var nn=He[vt];if(k[nn]&U){for(var rn=ht,sn=vt-1;sn>=0;sn--)if(!(k[He[sn]]&l)){rn=k[He[sn]];break}Me(nn,rn&(s|le)?H:rn)}}if(me.get(L))for(var kt=0;kt<He.length;kt++){var xt=He[kt];if(k[xt]&L)for(var dt=kt-1;dt>=-1;dt--){var $t=dt===-1?ht:k[He[dt]];if($t&o){$t===X&&Me(xt,D);break}}}if(me.get(X))for(var Rt=0;Rt<He.length;Rt++){var ui=He[Rt];k[ui]&X&&Me(ui,T)}if(me.get(M)||me.get(F))for(var Xi=1;Xi<He.length-1;Xi++){var dn=He[Xi];if(k[dn]&(M|F)){for(var $r=0,bn=0,es=Xi-1;es>=0&&($r=k[He[es]],!!($r&l));es--);for(var Co=Xi+1;Co<He.length&&(bn=k[He[Co]],!!(bn&l));Co++);$r===bn&&(k[dn]===M?$r===L:$r&(L|D))&&Me(dn,$r)}}if(me.get(L))for(var kn=0;kn<He.length;kn++){var yr=He[kn];if(k[yr]&L){for(var rc=kn-1;rc>=0&&k[He[rc]]&(R|l);rc--)Me(He[rc],L);for(kn++;kn<He.length&&k[He[kn]]&(R|l|L);kn++)k[He[kn]]!==L&&Me(He[kn],L)}}if(me.get(R)||me.get(M)||me.get(F))for(var Ua=0;Ua<He.length;Ua++){var lv=He[Ua];if(k[lv]&(R|M|F)){Me(lv,H);for(var dl=Ua-1;dl>=0&&k[He[dl]]&l;dl--)Me(He[dl],H);for(var pl=Ua+1;pl<He.length&&k[He[pl]]&l;pl++)Me(He[pl],H)}}if(me.get(L))for(var ml=0,bu=ht;ml<He.length;ml++){var cv=He[ml],im=k[cv];im&L?bu===A&&Me(cv,A):im&o&&(bu=im)}if(me.get(a)){var gl=T|L|D,gf=gl|A,Fa=[];{for(var sc=[],ka=0;ka<He.length;ka++)if(k[He[ka]]&a){var Jt=Ee[He[ka]],rm=void 0;if(S(Jt)!==null)if(sc.length<63)sc.push({char:Jt,seqIndex:ka});else break;else if((rm=C(Jt))!==null)for(var vl=sc.length-1;vl>=0;vl--){var vf=sc[vl].char;if(vf===rm||vf===C(E(Jt))||S(E(vf))===Jt){Fa.push([sc[vl].seqIndex,ka]),sc.length=vl;break}}}Fa.sort(function(or,rs){return or[0]-rs[0]})}for(var sm=0;sm<Fa.length;sm++){for(var uv=Fa[sm],ei=uv[0],Tu=uv[1],hv=!1,ts=0,om=ei+1;om<Tu;om++){var Eu=He[om];if(k[Eu]&gf){hv=!0;var Zs=k[Eu]&gl?T:A;if(Zs===St){ts=Zs;break}}}if(hv&&!ts){ts=ht;for(var am=ei-1;am>=0;am--){var fv=He[am];if(k[fv]&gf){var Qs=k[fv]&gl?T:A;Qs!==St?ts=Qs:ts=St;break}}}if(ts){if(k[He[ei]]=k[He[Tu]]=ts,ts!==St){for(var ns=ei+1;ns<He.length;ns++)if(!(k[He[ns]]&l)){f(Ee[He[ns]])&U&&(k[He[ns]]=ts);break}}if(ts!==St){for(var Na=Tu+1;Na<He.length;Na++)if(!(k[He[Na]]&l)){f(Ee[He[Na]])&U&&(k[He[Na]]=ts);break}}}}for(var Po=0;Po<He.length;Po++)if(k[He[Po]]&a){for(var lm=Po,cm=Po,ws=ht,Au=Po-1;Au>=0;Au--)if(k[He[Au]]&l)lm=Au;else{ws=k[He[Au]]&gl?T:A;break}for(var Cu=Tt,Pu=Po+1;Pu<He.length;Pu++)if(k[He[Pu]]&(a|l))cm=Pu;else{Cu=k[He[Pu]]&gl?T:A;break}for(var is=lm;is<=cm;is++)k[He[is]]=ws===Cu?ws:St;Po=cm}}}for(var sr=ze.start;sr<=ze.end;sr++){var yf=ge[sr],ua=k[sr];if(yf&1?ua&(A|L|D)&&ge[sr]++:ua&T?ge[sr]++:ua&(D|L)&&(ge[sr]+=2),ua&l&&(ge[sr]=sr===0?ze.level:ge[sr-1]),sr===ze.end||f(Ee[sr])&(q|z))for(var oc=sr;oc>=0&&f(Ee[oc])&c;oc--)ge[oc]=ze.level}}return{levels:ge,paragraphs:Ie};function xf(or,rs){for(var Si=or;Si<Ee.length;Si++){var Mi=k[Si];if(Mi&(T|X))return 1;if(Mi&(z|A)||rs&&Mi===le)return 0;if(Mi&s){var Js=dv(Si);Si=Js===-1?Ee.length:Js}}return 0}function dv(or){for(var rs=1,Si=or+1;Si<Ee.length;Si++){var Mi=k[Si];if(Mi&z)break;if(Mi&le){if(--rs===0)return Si}else Mi&s&&rs++}return-1}}var Q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",J;function ne(){if(!J){var Ee=x(Q,!0),Re=Ee.map,K=Ee.reverseMap;K.forEach(function(k,ue){Re.set(ue,k)}),J=Re}}function Y(Ee){return ne(),J.get(Ee)||null}function de(Ee,Re,K,k){var ue=Ee.length;K=Math.max(0,K==null?0:+K),k=Math.min(ue-1,k==null?ue-1:+k);for(var me=new Map,Me=K;Me<=k;Me++)if(Re[Me]&1){var ge=Y(Ee[Me]);ge!==null&&me.set(Me,ge)}return me}function ve(Ee,Re,K,k){var ue=Ee.length;K=Math.max(0,K==null?0:+K),k=Math.min(ue-1,k==null?ue-1:+k);var me=[];return Re.paragraphs.forEach(function(Me){var ge=Math.max(K,Me.start),Ye=Math.min(k,Me.end);if(ge<Ye){for(var Ie=Re.levels.slice(ge,Ye+1),ze=Ye;ze>=ge&&f(Ee[ze])&c;ze--)Ie[ze]=Me.level;for(var Je=Me.level,Fe=1/0,Xe=0;Xe<Ie.length;Xe++){var ct=Ie[Xe];ct>Je&&(Je=ct),ct<Fe&&(Fe=ct|1)}for(var tt=Je;tt>=Fe;tt--)for(var Ve=0;Ve<Ie.length;Ve++)if(Ie[Ve]>=tt){for(var qe=Ve;Ve+1<Ie.length&&Ie[Ve+1]>=tt;)Ve++;Ve>qe&&me.push([qe+ge,Ve+ge])}}}),me}function Se(Ee,Re,K,k){var ue=Te(Ee,Re,K,k),me=[].concat(Ee);return ue.forEach(function(Me,ge){me[ge]=(Re.levels[Me]&1?Y(Ee[Me]):null)||Ee[Me]}),me.join("")}function Te(Ee,Re,K,k){for(var ue=ve(Ee,Re,K,k),me=[],Me=0;Me<Ee.length;Me++)me[Me]=Me;return ue.forEach(function(ge){for(var Ye=ge[0],Ie=ge[1],ze=me.slice(Ye,Ie+1),Je=ze.length;Je--;)me[Ie-Je]=ze[Je]}),me}return e.closingToOpeningBracket=C,e.getBidiCharType=f,e.getBidiCharTypeName=p,e.getCanonicalBracket=E,e.getEmbeddingLevels=G,e.getMirroredCharacter=Y,e.getMirroredCharactersMap=de,e.getReorderSegments=ve,e.getReorderedIndices=Te,e.getReorderedString=Se,e.openingToClosingBracket=S,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return i}const XG=/\bvoid\s+main\s*\(\s*\)\s*{/g;function zE(i){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,r){let s=Gt[r];return s?zE(s):n}return i.replace(e,t)}const Sr=[];for(let i=0;i<256;i++)Sr[i]=(i<16?"0":"")+i.toString(16);function jae(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Sr[i&255]+Sr[i>>8&255]+Sr[i>>16&255]+Sr[i>>24&255]+"-"+Sr[e&255]+Sr[e>>8&255]+"-"+Sr[e>>16&15|64]+Sr[e>>24&255]+"-"+Sr[t&63|128]+Sr[t>>8&255]+"-"+Sr[t>>16&255]+Sr[t>>24&255]+Sr[n&255]+Sr[n>>8&255]+Sr[n>>16&255]+Sr[n>>24&255]).toUpperCase()}const sh=Object.assign||function(){let i=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Xae=Date.now(),u4=new WeakMap,h4=new Map;let Yae=1e10;function BE(i,e){const t=Qae(e);let n=u4.get(i);if(n||u4.set(i,n=Object.create(null)),n[t])return new n[t];const r=`_onBeforeCompile${t}`,s=function(c,u){i.onBeforeCompile.call(this,c,u);const h=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let f=h4[h];if(!f){const p=qae(this,c,e,t);f=h4[h]=p}c.vertexShader=f.vertexShader,c.fragmentShader=f.fragmentShader,sh(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-Xae}}),this[r]&&this[r](c)},o=function(){return a(e.chained?i:i.clone())},a=function(c){const u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:i}),Object.defineProperty(u,"id",{value:Yae++}),u.uuid=jae(),u.uniforms=sh({},c.uniforms,e.uniforms),u.defines=sh({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",u.extensions=sh({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return i.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return s},set(c){this[r]=c}},copy:{writable:!0,configurable:!0,value:function(c){return i.copy.call(this,c),!i.isShaderMaterial&&!i.isDerivedMaterial&&(sh(this.extensions,c.extensions),sh(this.defines,c.defines),sh(this.uniforms,Is.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new i.constructor;return a(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=BE(i.isDerivedMaterial?i.getDepthMaterial():new pu({depthPacking:sf}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=BE(i.isDerivedMaterial?i.getDistanceMaterial():new cw,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),i.dispose.call(this)}}};return n[t]=o,new o}function qae(i,{vertexShader:e,fragmentShader:t},n,r){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:h,fragmentColorTransform:f,customRewriter:p,timeUniform:v}=n;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",h=h||"",(l||p)&&(e=zE(e)),(f||p)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=zE(t)),p){let x=p({vertexShader:e,fragmentShader:t});e=x.vertexShader,t=x.fragmentShader}if(f){let x=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(x.push(y),"")),h=`${f}
${x.join(`
`)}
${h}`}if(v){const x=`
uniform float ${v};
`;s=x+s,c=x+c}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(x,y,g,_)=>/\battribute\s+vec[23]\s+$/.test(_.substr(0,g))?y:`troika_${y}_${r}`),i.map&&i.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=f4(e,r,s,o,a),t=f4(t,r,c,u,h),{vertexShader:e,fragmentShader:t}}function f4(i,e,t,n,r){return(n||r||t)&&(i=i.replace(XG,`
${t}
void troikaOrigMain${e}() {`),i+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${r}
}`),i}function Kae(i,e){return i==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Zae=0;const d4=new Map;function Qae(i){const e=JSON.stringify(i,Kae);let t=d4.get(e);return t==null&&d4.set(e,t=++Zae),t}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Jae(){return typeof window>"u"&&(self.window=self),function(i){var e={parse:function(r){var s=e._bin,o=new Uint8Array(r);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var c=[],u=0;u<l;u++){var h=s.readUint(o,a);a+=4,c.push(e._readFont(o,h))}return c}return[e._readFont(o,0)]},_readFont:function(r,s){var o=e._bin,a=s;o.readFixed(r,s),s+=4;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:a},h={},f=0;f<l;f++){var p=o.readASCII(r,s,4);s+=4,o.readUint(r,s),s+=4;var v=o.readUint(r,s);s+=4;var x=o.readUint(r,s);s+=4,h[p]={offset:v,length:x}}for(f=0;f<c.length;f++){var y=c[f];h[y]&&(u[y.trim()]=e[y.trim()].parse(r,h[y].offset,h[y].length,u))}return u},_tabOffset:function(r,s,o){for(var a=e._bin,l=a.readUshort(r,o+4),c=o+12,u=0;u<l;u++){var h=a.readASCII(r,c,4);c+=4,a.readUint(r,c),c+=4;var f=a.readUint(r,c);if(c+=4,a.readUint(r,c),c+=4,h==s)return f}return 0}};e._bin={readFixed:function(r,s){return(r[s]<<8|r[s+1])+(r[s+2]<<8|r[s+3])/65540},readF2dot14:function(r,s){return e._bin.readShort(r,s)/16384},readInt:function(r,s){return e._bin._view(r).getInt32(s)},readInt8:function(r,s){return e._bin._view(r).getInt8(s)},readShort:function(r,s){return e._bin._view(r).getInt16(s)},readUshort:function(r,s){return e._bin._view(r).getUint16(s)},readUshorts:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(r,s+2*l));return a},readUint:function(r,s){return e._bin._view(r).getUint32(s)},readUint64:function(r,s){return 4294967296*e._bin.readUint(r,s)+e._bin.readUint(r,s+4)},readASCII:function(r,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(r[s+l]);return a},readUnicode:function(r,s,o){for(var a="",l=0;l<o;l++){var c=r[s++]<<8|r[s++];a+=String.fromCharCode(c)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,s,o){var a=e._bin._tdec;return a&&s==0&&o==r.length?a.decode(r):e._bin.readASCII(r,s,o)},readBytes:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(r[s+l]);return a},readASCIIArray:function(r,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(r[s+l]));return a},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,s,o,a,l){var c=e._bin,u={},h=s;c.readFixed(r,s),s+=4;var f=c.readUshort(r,s);s+=2;var p=c.readUshort(r,s);s+=2;var v=c.readUshort(r,s);return s+=2,u.scriptList=e._lctf.readScriptList(r,h+f),u.featureList=e._lctf.readFeatureList(r,h+p),u.lookupList=e._lctf.readLookupList(r,h+v,l),u},e._lctf.readLookupList=function(r,s,o){var a=e._bin,l=s,c=[],u=a.readUshort(r,s);s+=2;for(var h=0;h<u;h++){var f=a.readUshort(r,s);s+=2;var p=e._lctf.readLookupTable(r,l+f,o);c.push(p)}return c},e._lctf.readLookupTable=function(r,s,o){var a=e._bin,l=s,c={tabs:[]};c.ltype=a.readUshort(r,s),s+=2,c.flag=a.readUshort(r,s),s+=2;var u=a.readUshort(r,s);s+=2;for(var h=c.ltype,f=0;f<u;f++){var p=a.readUshort(r,s);s+=2;var v=o(r,h,l+p,c);c.tabs.push(v)}return c},e._lctf.numOfOnes=function(r){for(var s=0,o=0;o<32;o++)r>>>o&1&&s++;return s},e._lctf.readClassDef=function(r,s){var o=e._bin,a=[],l=o.readUshort(r,s);if(s+=2,l==1){var c=o.readUshort(r,s);s+=2;var u=o.readUshort(r,s);s+=2;for(var h=0;h<u;h++)a.push(c+h),a.push(c+h),a.push(o.readUshort(r,s)),s+=2}if(l==2){var f=o.readUshort(r,s);for(s+=2,h=0;h<f;h++)a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2,a.push(o.readUshort(r,s)),s+=2}return a},e._lctf.getInterval=function(r,s){for(var o=0;o<r.length;o+=3){var a=r[o],l=r[o+1];if(r[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(r,s){var o=e._bin,a={};a.fmt=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(r,s,l)),a.fmt==2&&(a.tab=o.readUshorts(r,s,3*l)),a},e._lctf.coverageIndex=function(r,s){var o=r.tab;if(r.fmt==1)return o.indexOf(s);if(r.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readASCII(r,s,4);s+=4;var f=o.readUshort(r,s);s+=2;var p=e._lctf.readFeatureTable(r,a+f);p.tag=h.trim(),l.push(p)}return l},e._lctf.readFeatureTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.featureParams=a+c);var u=o.readUshort(r,s);s+=2,l.tab=[];for(var h=0;h<u;h++)l.tab.push(o.readUshort(r,s+2*h));return l},e._lctf.readScriptList=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readASCII(r,s,4);s+=4;var f=o.readUshort(r,s);s+=2,l[h.trim()]=e._lctf.readScriptTable(r,a+f)}return l},e._lctf.readScriptTable=function(r,s){var o=e._bin,a=s,l={},c=o.readUshort(r,s);s+=2,c>0&&(l.default=e._lctf.readLangSysTable(r,a+c));var u=o.readUshort(r,s);s+=2;for(var h=0;h<u;h++){var f=o.readASCII(r,s,4);s+=4;var p=o.readUshort(r,s);s+=2,l[f.trim()]=e._lctf.readLangSysTable(r,a+p)}return l},e._lctf.readLangSysTable=function(r,s){var o=e._bin,a={};o.readUshort(r,s),s+=2,a.reqFeature=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);return s+=2,a.features=o.readUshorts(r,s,l),a},e.CFF={},e.CFF.parse=function(r,s,o){var a=e._bin;(r=new Uint8Array(r.buffer,s,o))[s=0],r[++s],r[++s],r[++s],s++;var l=[];s=e.CFF.readIndex(r,s,l);for(var c=[],u=0;u<l.length-1;u++)c.push(a.readASCII(r,s+l[u],l[u+1]-l[u]));s+=l[l.length-1];var h=[];s=e.CFF.readIndex(r,s,h);var f=[];for(u=0;u<h.length-1;u++)f.push(e.CFF.readDict(r,s+h[u],s+h[u+1]));s+=h[h.length-1];var p=f[0],v=[];s=e.CFF.readIndex(r,s,v);var x=[];for(u=0;u<v.length-1;u++)x.push(a.readASCII(r,s+v[u],v[u+1]-v[u]));if(s+=v[v.length-1],e.CFF.readSubrs(r,s,p),p.CharStrings){s=p.CharStrings,v=[],s=e.CFF.readIndex(r,s,v);var y=[];for(u=0;u<v.length-1;u++)y.push(a.readBytes(r,s+v[u],v[u+1]-v[u]));p.CharStrings=y}if(p.ROS){s=p.FDArray;var g=[];for(s=e.CFF.readIndex(r,s,g),p.FDArray=[],u=0;u<g.length-1;u++){var _=e.CFF.readDict(r,s+g[u],s+g[u+1]);e.CFF._readFDict(r,_,x),p.FDArray.push(_)}s+=g[g.length-1],s=p.FDSelect,p.FDSelect=[];var w=r[s];if(s++,w!=3)throw w;var S=a.readUshort(r,s);for(s+=2,u=0;u<S+1;u++)p.FDSelect.push(a.readUshort(r,s),r[s+2]),s+=3}return p.Encoding&&(p.Encoding=e.CFF.readEncoding(r,p.Encoding,p.CharStrings.length)),p.charset&&(p.charset=e.CFF.readCharset(r,p.charset,p.CharStrings.length)),e.CFF._readFDict(r,p,x),p},e.CFF._readFDict=function(r,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(r,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(r,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(r,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(r,s,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,o.Bias=c,o.Subrs=[];for(var h=0;h<l.length-1;h++)o.Subrs.push(a.readBytes(r,s+l[h],l[h+1]-l[h]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,s){for(var o=0;o<r.charset.length;o++)if(r.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(r,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[s])},e.CFF.readEncoding=function(r,s,o){e._bin;var a=[".notdef"],l=r[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var c=r[s];s++;for(var u=0;u<c;u++)a.push(r[s+u]);return a},e.CFF.readCharset=function(r,s,o){var a=e._bin,l=[".notdef"],c=r[s];if(s++,c==0)for(var u=0;u<o;u++){var h=a.readUshort(r,s);s+=2,l.push(h)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<o;){h=a.readUshort(r,s),s+=2;var f=0;for(c==1?(f=r[s],s++):(f=a.readUshort(r,s),s+=2),u=0;u<=f;u++)l.push(h),h++}}return l},e.CFF.readIndex=function(r,s,o){var a=e._bin,l=a.readUshort(r,s)+1,c=r[s+=2];if(s++,c==1)for(var u=0;u<l;u++)o.push(r[s+u]);else if(c==2)for(u=0;u<l;u++)o.push(a.readUshort(r,s+2*u));else if(c==3)for(u=0;u<l;u++)o.push(16777215&a.readUint(r,s+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(s+=l*c)-1},e.CFF.getCharString=function(r,s,o){var a=e._bin,l=r[s],c=r[s+1];r[s+2],r[s+3],r[s+4];var u=1,h=null,f=null;l<=20&&(h=l,u=1),l==12&&(h=100*l+c,u=2),21<=l&&l<=27&&(h=l,u=1),l==28&&(f=a.readShort(r,s+1),u=3),29<=l&&l<=31&&(h=l,u=1),32<=l&&l<=246&&(f=l-139,u=1),247<=l&&l<=250&&(f=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(f=256*-(l-251)-c-108,u=2),l==255&&(f=a.readInt(r,s+1)/65535,u=5),o.val=f??"o"+h,o.size=u},e.CFF.readCharString=function(r,s,o){for(var a=s+o,l=e._bin,c=[];s<a;){var u=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var f=1,p=null,v=null;u<=20&&(p=u,f=1),u==12&&(p=100*u+h,f=2),u!=19&&u!=20||(p=u,f=2),21<=u&&u<=27&&(p=u,f=1),u==28&&(v=l.readShort(r,s+1),f=3),29<=u&&u<=31&&(p=u,f=1),32<=u&&u<=246&&(v=u-139,f=1),247<=u&&u<=250&&(v=256*(u-247)+h+108,f=2),251<=u&&u<=254&&(v=256*-(u-251)-h-108,f=2),u==255&&(v=l.readInt(r,s+1)/65535,f=5),c.push(v??"o"+p),s+=f}return c},e.CFF.readDict=function(r,s,o){for(var a=e._bin,l={},c=[];s<o;){var u=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var f=1,p=null,v=null;if(u==28&&(v=a.readShort(r,s+1),f=3),u==29&&(v=a.readInt(r,s+1),f=5),32<=u&&u<=246&&(v=u-139,f=1),247<=u&&u<=250&&(v=256*(u-247)+h+108,f=2),251<=u&&u<=254&&(v=256*-(u-251)-h-108,f=2),u==255)throw v=a.readInt(r,s+1)/65535,f=5,"unknown number";if(u==30){var x=[];for(f=1;;){var y=r[s+f];f++;var g=y>>4,_=15&y;if(g!=15&&x.push(g),_!=15&&x.push(_),_==15)break}for(var w="",S=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],C=0;C<x.length;C++)w+=S[x[C]];v=parseFloat(w)}u<=21&&(p=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],f=1,u==12&&(p=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],f=2)),p!=null?(l[p]=c.length==1?c[0]:c,c=[]):c.push(v),s+=f}return l},e.cmap={},e.cmap.parse=function(r,s,o){r=new Uint8Array(r.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2;var u=[];l.tables=[];for(var h=0;h<c;h++){var f=a.readUshort(r,s);s+=2;var p=a.readUshort(r,s);s+=2;var v=a.readUint(r,s);s+=4;var x="p"+f+"e"+p,y=u.indexOf(v);if(y==-1){var g;y=l.tables.length,u.push(v);var _=a.readUshort(r,v);_==0?g=e.cmap.parse0(r,v):_==4?g=e.cmap.parse4(r,v):_==6?g=e.cmap.parse6(r,v):_==12?g=e.cmap.parse12(r,v):console.debug("unknown format: "+_,f,p,v),l.tables.push(g)}if(l[x]!=null)throw"multiple tables for one platform+encoding";l[x]=y}return l},e.cmap.parse0=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,a.map=[];for(var c=0;c<l-6;c++)a.map.push(r[s+c]);return a},e.cmap.parse4=function(r,s){var o=e._bin,a=s,l={};l.format=o.readUshort(r,s),s+=2;var c=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2;var u=o.readUshort(r,s);s+=2;var h=u/2;l.searchRange=o.readUshort(r,s),s+=2,l.entrySelector=o.readUshort(r,s),s+=2,l.rangeShift=o.readUshort(r,s),s+=2,l.endCount=o.readUshorts(r,s,h),s+=2*h,s+=2,l.startCount=o.readUshorts(r,s,h),s+=2*h,l.idDelta=[];for(var f=0;f<h;f++)l.idDelta.push(o.readShort(r,s)),s+=2;for(l.idRangeOffset=o.readUshorts(r,s,h),s+=2*h,l.glyphIdArray=[];s<a+c;)l.glyphIdArray.push(o.readUshort(r,s)),s+=2;return l},e.cmap.parse6=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,a.firstCode=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2,a.glyphIdArray=[];for(var c=0;c<l;c++)a.glyphIdArray.push(o.readUshort(r,s)),s+=2;return a},e.cmap.parse12=function(r,s){var o=e._bin,a={};a.format=o.readUshort(r,s),s+=2,s+=2,o.readUint(r,s),s+=4,o.readUint(r,s),s+=4;var l=o.readUint(r,s);s+=4,a.groups=[];for(var c=0;c<l;c++){var u=s+12*c,h=o.readUint(r,u+0),f=o.readUint(r,u+4),p=o.readUint(r,u+8);a.groups.push([h,f,p])}return a},e.glyf={},e.glyf.parse=function(r,s,o,a){for(var l=[],c=0;c<a.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(r,s){var o=e._bin,a=r._data,l=e._tabOffset(a,"glyf",r._offset)+r.loca[s];if(r.loca[s]==r.loca[s+1])return null;var c={};if(c.noc=o.readShort(a,l),l+=2,c.xMin=o.readShort(a,l),l+=2,c.yMin=o.readShort(a,l),l+=2,c.xMax=o.readShort(a,l),l+=2,c.yMax=o.readShort(a,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(o.readUshort(a,l)),l+=2;var h=o.readUshort(a,l);if(l+=2,a.length-l<h)return null;c.instructions=o.readBytes(a,l,h),l+=h;var f=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<f;u++){var p=a[l];if(l++,c.flags.push(p),(8&p)!=0){var v=a[l];l++;for(var x=0;x<v;x++)c.flags.push(p),u++}}for(c.xs=[],u=0;u<f;u++){var y=(2&c.flags[u])!=0,g=(16&c.flags[u])!=0;y?(c.xs.push(g?a[l]:-a[l]),l++):g?c.xs.push(0):(c.xs.push(o.readShort(a,l)),l+=2)}for(c.ys=[],u=0;u<f;u++)y=(4&c.flags[u])!=0,g=(32&c.flags[u])!=0,y?(c.ys.push(g?a[l]:-a[l]),l++):g?c.ys.push(0):(c.ys.push(o.readShort(a,l)),l+=2);var _=0,w=0;for(u=0;u<f;u++)_+=c.xs[u],w+=c.ys[u],c.xs[u]=_,c.ys[u]=w}else{var S;c.parts=[];do{S=o.readUshort(a,l),l+=2;var C={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(C),C.glyphIndex=o.readUshort(a,l),l+=2,1&S){var E=o.readShort(a,l);l+=2;var A=o.readShort(a,l);l+=2}else E=o.readInt8(a,l),l++,A=o.readInt8(a,l),l++;2&S?(C.m.tx=E,C.m.ty=A):(C.p1=E,C.p2=A),8&S?(C.m.a=C.m.d=o.readF2dot14(a,l),l+=2):64&S?(C.m.a=o.readF2dot14(a,l),l+=2,C.m.d=o.readF2dot14(a,l),l+=2):128&S&&(C.m.a=o.readF2dot14(a,l),l+=2,C.m.b=o.readF2dot14(a,l),l+=2,C.m.c=o.readF2dot14(a,l),l+=2,C.m.d=o.readF2dot14(a,l),l+=2)}while(32&S);if(256&S){var T=o.readUshort(a,l);for(l+=2,c.instr=[],u=0;u<T;u++)c.instr.push(a[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(r,s,o,a){var l=s;s+=4;var c=e._bin.readUshort(r,s);return{glyphClassDef:c===0?null:e._lctf.readClassDef(r,l+c)}},e.GPOS={},e.GPOS.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s==1||s==2||s==3||s==7||s==8&&u.fmt<=2){var h=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,h+c)}if(s==1&&u.fmt==1){var f=l.readUshort(r,o);o+=2,f!=0&&(u.pos=e.GPOS.readValueRecord(r,o,f))}else if(s==2&&u.fmt>=1&&u.fmt<=2){f=l.readUshort(r,o),o+=2;var p=l.readUshort(r,o);o+=2;var v=e._lctf.numOfOnes(f),x=e._lctf.numOfOnes(p);if(u.fmt==1){u.pairsets=[];var y=l.readUshort(r,o);o+=2;for(var g=0;g<y;g++){var _=c+l.readUshort(r,o);o+=2;var w=l.readUshort(r,_);_+=2;for(var S=[],C=0;C<w;C++){var E=l.readUshort(r,_);_+=2,f!=0&&(D=e.GPOS.readValueRecord(r,_,f),_+=2*v),p!=0&&(F=e.GPOS.readValueRecord(r,_,p),_+=2*x),S.push({gid2:E,val1:D,val2:F})}u.pairsets.push(S)}}if(u.fmt==2){var A=l.readUshort(r,o);o+=2;var T=l.readUshort(r,o);o+=2;var L=l.readUshort(r,o);o+=2;var M=l.readUshort(r,o);for(o+=2,u.classDef1=e._lctf.readClassDef(r,c+A),u.classDef2=e._lctf.readClassDef(r,c+T),u.matrix=[],g=0;g<L;g++){var R=[];for(C=0;C<M;C++){var D=null,F=null;f!=0&&(D=e.GPOS.readValueRecord(r,o,f),o+=2*v),p!=0&&(F=e.GPOS.readValueRecord(r,o,p),o+=2*x),R.push({val1:D,val2:F})}u.matrix.push(R)}}}else if(s==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else if(s==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,o)+c),u.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,o+2)+c),u.markClassCount=l.readUshort(r,o+4),u.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,o+6)+c),u.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,o+8)+c,u.markClassCount);else{if(s==9&&u.fmt==1){var z=l.readUshort(r,o);o+=2;var q=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=z;else if(a.ltype!=z)throw"invalid extension substitution";return e.GPOS.subt(r,a.ltype,c+q)}console.debug("unsupported GPOS table LookupType",s,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(r,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(r,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(r,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(r,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(r,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(r,s,o){var a=e._bin,l=[],c=s,u=a.readUshort(r,s);s+=2;for(var h=0;h<u;h++){for(var f=[],p=0;p<o;p++)f.push(e.GPOS.readAnchorRecord(r,c+a.readUshort(r,s))),s+=2;l.push(f)}return l},e.GPOS.readMarkArray=function(r,s){var o=e._bin,a=[],l=s,c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=e.GPOS.readAnchorRecord(r,o.readUshort(r,s+2)+l);h.markClass=o.readUshort(r,s),a.push(h),s+=4}return a},e.GPOS.readAnchorRecord=function(r,s){var o=e._bin,a={};return a.fmt=o.readUshort(r,s),a.x=o.readShort(r,s+2),a.y=o.readShort(r,s+4),a},e.GSUB={},e.GSUB.parse=function(r,s,o,a){return e._lctf.parse(r,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(r,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(r,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&u.fmt<=2||s==6&&u.fmt<=2){var h=l.readUshort(r,o);o+=2,u.coverage=e._lctf.readCoverage(r,c+h)}if(s==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(r,o),o+=2;else if(u.fmt==2){var f=l.readUshort(r,o);o+=2,u.newg=l.readUshorts(r,o,f),o+=2*u.newg.length}}else if(s==2&&u.fmt==1){f=l.readUshort(r,o),o+=2,u.seqs=[];for(var p=0;p<f;p++){var v=l.readUshort(r,o)+c;o+=2;var x=l.readUshort(r,v);u.seqs.push(l.readUshorts(r,v+2,x))}}else if(s==4)for(u.vals=[],f=l.readUshort(r,o),o+=2,p=0;p<f;p++){var y=l.readUshort(r,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(r,c+y))}else if(s==5&&u.fmt==2){if(u.fmt==2){var g=l.readUshort(r,o);o+=2,u.cDef=e._lctf.readClassDef(r,c+g),u.scset=[];var _=l.readUshort(r,o);for(o+=2,p=0;p<_;p++){var w=l.readUshort(r,o);o+=2,u.scset.push(w==0?null:e.GSUB.readSubClassSet(r,c+w))}}}else if(s==6&&u.fmt==3){if(u.fmt==3){for(p=0;p<3;p++){f=l.readUshort(r,o),o+=2;for(var S=[],C=0;C<f;C++)S.push(e._lctf.readCoverage(r,c+l.readUshort(r,o+2*C)));o+=2*f,p==0&&(u.backCvg=S),p==1&&(u.inptCvg=S),p==2&&(u.ahedCvg=S)}f=l.readUshort(r,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(r,o,f)}}else{if(s==7&&u.fmt==1){var E=l.readUshort(r,o);o+=2;var A=l.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=E;else if(a.ltype!=E)throw"invalid extension substitution";return e.GSUB.subt(r,a.ltype,c+A)}console.debug("unsupported GSUB table LookupType",s,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(r,s){var o=e._bin.readUshort,a=s,l=[],c=o(r,s);s+=2;for(var u=0;u<c;u++){var h=o(r,s);s+=2,l.push(e.GSUB.readSubClassRule(r,a+h))}return l},e.GSUB.readSubClassRule=function(r,s){var o=e._bin.readUshort,a={},l=o(r,s),c=o(r,s+=2);s+=2,a.input=[];for(var u=0;u<l-1;u++)a.input.push(o(r,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(r,s,c),a},e.GSUB.readSubstLookupRecords=function(r,s,o){for(var a=e._bin.readUshort,l=[],c=0;c<o;c++)l.push(a(r,s),a(r,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readUshort(r,s);s+=2,l.push(e.GSUB.readChainSubClassRule(r,a+h))}return l},e.GSUB.readChainSubClassRule=function(r,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=o.readUshort(r,s);s+=2,c==1&&u--,a[l[c]]=o.readUshorts(r,s,u),s+=2*a[l[c]].length}return u=o.readUshort(r,s),s+=2,a.subst=o.readUshorts(r,s,2*u),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(r,s){var o=e._bin,a=s,l=[],c=o.readUshort(r,s);s+=2;for(var u=0;u<c;u++){var h=o.readUshort(r,s);s+=2,l.push(e.GSUB.readLigature(r,a+h))}return l},e.GSUB.readLigature=function(r,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(r,s),s+=2;var l=o.readUshort(r,s);s+=2;for(var c=0;c<l-1;c++)a.chain.push(o.readUshort(r,s)),s+=2;return a},e.head={},e.head.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.fontRevision=a.readFixed(r,s),s+=4,a.readUint(r,s),s+=4,a.readUint(r,s),s+=4,l.flags=a.readUshort(r,s),s+=2,l.unitsPerEm=a.readUshort(r,s),s+=2,l.created=a.readUint64(r,s),s+=8,l.modified=a.readUint64(r,s),s+=8,l.xMin=a.readShort(r,s),s+=2,l.yMin=a.readShort(r,s),s+=2,l.xMax=a.readShort(r,s),s+=2,l.yMax=a.readShort(r,s),s+=2,l.macStyle=a.readUshort(r,s),s+=2,l.lowestRecPPEM=a.readUshort(r,s),s+=2,l.fontDirectionHint=a.readShort(r,s),s+=2,l.indexToLocFormat=a.readShort(r,s),s+=2,l.glyphDataFormat=a.readShort(r,s),s+=2,l},e.hhea={},e.hhea.parse=function(r,s,o){var a=e._bin,l={};return a.readFixed(r,s),s+=4,l.ascender=a.readShort(r,s),s+=2,l.descender=a.readShort(r,s),s+=2,l.lineGap=a.readShort(r,s),s+=2,l.advanceWidthMax=a.readUshort(r,s),s+=2,l.minLeftSideBearing=a.readShort(r,s),s+=2,l.minRightSideBearing=a.readShort(r,s),s+=2,l.xMaxExtent=a.readShort(r,s),s+=2,l.caretSlopeRise=a.readShort(r,s),s+=2,l.caretSlopeRun=a.readShort(r,s),s+=2,l.caretOffset=a.readShort(r,s),s+=2,s+=8,l.metricDataFormat=a.readShort(r,s),s+=2,l.numberOfHMetrics=a.readUshort(r,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(r,s,o,a){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,h=0,f=0;f<a.maxp.numGlyphs;f++)f<a.hhea.numberOfHMetrics&&(u=l.readUshort(r,s),s+=2,h=l.readShort(r,s),s+=2),c.aWidth.push(u),c.lsBearing.push(h);return c},e.kern={},e.kern.parse=function(r,s,o,a){var l=e._bin,c=l.readUshort(r,s);if(s+=2,c==1)return e.kern.parseV1(r,s-2,o,a);var u=l.readUshort(r,s);s+=2;for(var h={glyph1:[],rval:[]},f=0;f<u;f++){s+=2,o=l.readUshort(r,s),s+=2;var p=l.readUshort(r,s);s+=2;var v=p>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;s=e.kern.readFormat0(r,s,h)}return h},e.kern.parseV1=function(r,s,o,a){var l=e._bin;l.readFixed(r,s),s+=4;var c=l.readUint(r,s);s+=4;for(var u={glyph1:[],rval:[]},h=0;h<c;h++){l.readUint(r,s),s+=4;var f=l.readUshort(r,s);s+=2,l.readUshort(r,s),s+=2;var p=f>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;s=e.kern.readFormat0(r,s,u)}return u},e.kern.readFormat0=function(r,s,o){var a=e._bin,l=-1,c=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2;for(var u=0;u<c;u++){var h=a.readUshort(r,s);s+=2;var f=a.readUshort(r,s);s+=2;var p=a.readShort(r,s);s+=2,h!=l&&(o.glyph1.push(h),o.rval.push({glyph2:[],vals:[]}));var v=o.rval[o.rval.length-1];v.glyph2.push(f),v.vals.push(p),l=h}return s},e.loca={},e.loca.parse=function(r,s,o,a){var l=e._bin,c=[],u=a.head.indexToLocFormat,h=a.maxp.numGlyphs+1;if(u==0)for(var f=0;f<h;f++)c.push(l.readUshort(r,s+(f<<1))<<1);if(u==1)for(f=0;f<h;f++)c.push(l.readUint(r,s+(f<<2)));return c},e.maxp={},e.maxp.parse=function(r,s,o){var a=e._bin,l={},c=a.readUint(r,s);return s+=4,l.numGlyphs=a.readUshort(r,s),s+=2,c==65536&&(l.maxPoints=a.readUshort(r,s),s+=2,l.maxContours=a.readUshort(r,s),s+=2,l.maxCompositePoints=a.readUshort(r,s),s+=2,l.maxCompositeContours=a.readUshort(r,s),s+=2,l.maxZones=a.readUshort(r,s),s+=2,l.maxTwilightPoints=a.readUshort(r,s),s+=2,l.maxStorage=a.readUshort(r,s),s+=2,l.maxFunctionDefs=a.readUshort(r,s),s+=2,l.maxInstructionDefs=a.readUshort(r,s),s+=2,l.maxStackElements=a.readUshort(r,s),s+=2,l.maxSizeOfInstructions=a.readUshort(r,s),s+=2,l.maxComponentElements=a.readUshort(r,s),s+=2,l.maxComponentDepth=a.readUshort(r,s),s+=2),l},e.name={},e.name.parse=function(r,s,o){var a=e._bin,l={};a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2,a.readUshort(r,s);for(var u,h=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=s+=2,p=0;p<c;p++){var v=a.readUshort(r,s);s+=2;var x=a.readUshort(r,s);s+=2;var y=a.readUshort(r,s);s+=2;var g=a.readUshort(r,s);s+=2;var _=a.readUshort(r,s);s+=2;var w=a.readUshort(r,s);s+=2;var S,C=h[g],E=f+12*c+w;if(v==0)S=a.readUnicode(r,E,_/2);else if(v==3&&x==0)S=a.readUnicode(r,E,_/2);else if(x==0)S=a.readASCII(r,E,_);else if(x==1)S=a.readUnicode(r,E,_/2);else if(x==3)S=a.readUnicode(r,E,_/2);else{if(v!=1)throw"unknown encoding "+x+", platformID: "+v;S=a.readASCII(r,E,_),console.debug("reading unknown MAC encoding "+x+" as ASCII")}var A="p"+v+","+y.toString(16);l[A]==null&&(l[A]={}),l[A][C!==void 0?C:g]=S,l[A]._lang=y}for(var T in l)if(l[T].postScriptName!=null&&l[T]._lang==1033)return l[T];for(var T in l)if(l[T].postScriptName!=null&&l[T]._lang==0)return l[T];for(var T in l)if(l[T].postScriptName!=null&&l[T]._lang==3084)return l[T];for(var T in l)if(l[T].postScriptName!=null)return l[T];for(var T in l){u=T;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(r,s,o){var a=e._bin.readUshort(r,s);s+=2;var l={};if(a==0)e["OS/2"].version0(r,s,l);else if(a==1)e["OS/2"].version1(r,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(r,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(r,s,l)}return l},e["OS/2"].version0=function(r,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(r,s),s+=2,o.usWeightClass=a.readUshort(r,s),s+=2,o.usWidthClass=a.readUshort(r,s),s+=2,o.fsType=a.readUshort(r,s),s+=2,o.ySubscriptXSize=a.readShort(r,s),s+=2,o.ySubscriptYSize=a.readShort(r,s),s+=2,o.ySubscriptXOffset=a.readShort(r,s),s+=2,o.ySubscriptYOffset=a.readShort(r,s),s+=2,o.ySuperscriptXSize=a.readShort(r,s),s+=2,o.ySuperscriptYSize=a.readShort(r,s),s+=2,o.ySuperscriptXOffset=a.readShort(r,s),s+=2,o.ySuperscriptYOffset=a.readShort(r,s),s+=2,o.yStrikeoutSize=a.readShort(r,s),s+=2,o.yStrikeoutPosition=a.readShort(r,s),s+=2,o.sFamilyClass=a.readShort(r,s),s+=2,o.panose=a.readBytes(r,s,10),s+=10,o.ulUnicodeRange1=a.readUint(r,s),s+=4,o.ulUnicodeRange2=a.readUint(r,s),s+=4,o.ulUnicodeRange3=a.readUint(r,s),s+=4,o.ulUnicodeRange4=a.readUint(r,s),s+=4,o.achVendID=[a.readInt8(r,s),a.readInt8(r,s+1),a.readInt8(r,s+2),a.readInt8(r,s+3)],s+=4,o.fsSelection=a.readUshort(r,s),s+=2,o.usFirstCharIndex=a.readUshort(r,s),s+=2,o.usLastCharIndex=a.readUshort(r,s),s+=2,o.sTypoAscender=a.readShort(r,s),s+=2,o.sTypoDescender=a.readShort(r,s),s+=2,o.sTypoLineGap=a.readShort(r,s),s+=2,o.usWinAscent=a.readUshort(r,s),s+=2,o.usWinDescent=a.readUshort(r,s),s+=2},e["OS/2"].version1=function(r,s,o){var a=e._bin;return s=e["OS/2"].version0(r,s,o),o.ulCodePageRange1=a.readUint(r,s),s+=4,o.ulCodePageRange2=a.readUint(r,s),s+=4},e["OS/2"].version2=function(r,s,o){var a=e._bin;return s=e["OS/2"].version1(r,s,o),o.sxHeight=a.readShort(r,s),s+=2,o.sCapHeight=a.readShort(r,s),s+=2,o.usDefault=a.readUshort(r,s),s+=2,o.usBreak=a.readUshort(r,s),s+=2,o.usMaxContext=a.readUshort(r,s),s+=2},e["OS/2"].version5=function(r,s,o){var a=e._bin;return s=e["OS/2"].version2(r,s,o),o.usLowerOpticalPointSize=a.readUshort(r,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(r,s),s+=2},e.post={},e.post.parse=function(r,s,o){var a=e._bin,l={};return l.version=a.readFixed(r,s),s+=4,l.italicAngle=a.readFixed(r,s),s+=4,l.underlinePosition=a.readShort(r,s),s+=2,l.underlineThickness=a.readShort(r,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,s){var o=r.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(s<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>s?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[s-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:s+l.idDelta[c])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var h=l.groups[u];if(h[0]<=s&&s<=h[1])return h[2]+(s-h[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,s){var o={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[s]){var a=r.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),r.SVG.entries[s]=a),a)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},c=r.CFF,u=r.CFF.Private;if(c.ROS){for(var h=0;c.FDSelect[h+2]<=s;)h+=2;u=c.FDArray[c.FDSelect[h+1]].Private}e.U._drawCFF(r.CFF.CharStrings[s],l,c,u,o)}else r.glyf&&e.U._drawGlyf(s,r,o);return o},e.U._drawGlyf=function(r,s,o){var a=s.glyf[r];a==null&&(a=s.glyf[r]=e.glyf._parseGlyf(s,r)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(r,s){for(var o=0;o<r.noc;o++){for(var a=o==0?0:r.endPts[o-1]+1,l=r.endPts[o],c=a;c<=l;c++){var u=c==a?l:c-1,h=c==l?a:c+1,f=1&r.flags[c],p=1&r.flags[u],v=1&r.flags[h],x=r.xs[c],y=r.ys[c];if(c==a)if(f){if(!p){e.U.P.moveTo(s,x,y);continue}e.U.P.moveTo(s,r.xs[u],r.ys[u])}else p?e.U.P.moveTo(s,r.xs[u],r.ys[u]):e.U.P.moveTo(s,(r.xs[u]+x)/2,(r.ys[u]+y)/2);f?p&&e.U.P.lineTo(s,x,y):v?e.U.P.qcurveTo(s,x,y,r.xs[h],r.ys[h]):e.U.P.qcurveTo(s,x,y,(x+r.xs[h])/2,(y+r.ys[h])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(r,s,o){for(var a=0;a<r.parts.length;a++){var l={cmds:[],crds:[]},c=r.parts[a];e.U._drawGlyf(c.glyphIndex,s,l);for(var u=c.m,h=0;h<l.crds.length;h+=2){var f=l.crds[h],p=l.crds[h+1];o.crds.push(f*u.a+p*u.b+u.tx),o.crds.push(f*u.c+p*u.d+u.ty)}for(h=0;h<l.cmds.length;h++)o.cmds.push(l.cmds[h])}},e.U._getGlyphClass=function(r,s){var o=e._lctf.getInterval(s,r);return o==-1?0:s[o+2]},e.U._applySubs=function(r,s,o,a){for(var l=r.length-s-1,c=0;c<o.tabs.length;c++)if(o.tabs[c]!=null){var u,h=o.tabs[c];if(!h.coverage||(u=e._lctf.coverageIndex(h.coverage,r[s]))!=-1){if(o.ltype==1)r[s],h.fmt==1?r[s]=r[s]+h.delta:r[s]=h.newg[u];else if(o.ltype==4)for(var f=h.vals[u],p=0;p<f.length;p++){var v=f[p],x=v.chain.length;if(!(x>l)){for(var y=!0,g=0,_=0;_<x;_++){for(;r[s+g+(1+_)]==-1;)g++;v.chain[_]!=r[s+g+(1+_)]&&(y=!1)}if(y){for(r[s]=v.nglyph,_=0;_<x+g;_++)r[s+_+1]=-1;break}}}else if(o.ltype==5&&h.fmt==2)for(var w=e._lctf.getInterval(h.cDef,r[s]),S=h.cDef[w+2],C=h.scset[S],E=0;E<C.length;E++){var A=C[E],T=A.input;if(!(T.length>l)){for(y=!0,_=0;_<T.length;_++){var L=e._lctf.getInterval(h.cDef,r[s+1+_]);if(w==-1&&h.cDef[L+2]!=T[_]){y=!1;break}}if(y){var M=A.substLookupRecords;for(p=0;p<M.length;p+=2)M[p],M[p+1]}}}else if(o.ltype==6&&h.fmt==3){if(!e.U._glsCovered(r,h.backCvg,s-h.backCvg.length)||!e.U._glsCovered(r,h.inptCvg,s)||!e.U._glsCovered(r,h.ahedCvg,s+h.inptCvg.length))continue;var R=h.lookupRec;for(E=0;E<R.length;E+=2){w=R[E];var D=a[R[E+1]];e.U._applySubs(r,s+w,D,a)}}}}},e.U._glsCovered=function(r,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],r[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(r,s,o){for(var a={cmds:[],crds:[]},l=0,c=0;c<s.length;c++){var u=s[c];if(u!=-1){for(var h=c<s.length-1&&s[c+1]!=-1?s[c+1]:0,f=e.U.glyphToPath(r,u),p=0;p<f.crds.length;p+=2)a.crds.push(f.crds[p]+l),a.crds.push(f.crds[p+1]);for(o&&a.cmds.push(o),p=0;p<f.cmds.length;p++)a.cmds.push(f.cmds[p]);o&&a.cmds.push("X"),l+=r.hmtx.aWidth[u],c<s.length-1&&(l+=e.U.getPairAdjustment(r,u,h))}}return a},e.U.P={},e.U.P.moveTo=function(r,s,o){r.cmds.push("M"),r.crds.push(s,o)},e.U.P.lineTo=function(r,s,o){r.cmds.push("L"),r.crds.push(s,o)},e.U.P.curveTo=function(r,s,o,a,l,c,u){r.cmds.push("C"),r.crds.push(s,o,a,l,c,u)},e.U.P.qcurveTo=function(r,s,o,a,l){r.cmds.push("Q"),r.crds.push(s,o,a,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,s,o,a,l){for(var c=s.stack,u=s.nStems,h=s.haveWidth,f=s.width,p=s.open,v=0,x=s.x,y=s.y,g=0,_=0,w=0,S=0,C=0,E=0,A=0,T=0,L=0,M=0,R={val:0,size:0};v<r.length;){e.CFF.getCharString(r,v,R);var D=R.val;if(v+=R.size,D=="o1"||D=="o18")c.length%2!=0&&!h&&(f=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0;else if(D=="o3"||D=="o23")c.length%2!=0&&!h&&(f=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0;else if(D=="o4")c.length>1&&!h&&(f=c.shift()+a.nominalWidthX,h=!0),p&&e.U.P.closePath(l),y+=c.pop(),e.U.P.moveTo(l,x,y),p=!0;else if(D=="o5")for(;c.length>0;)x+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,x,y);else if(D=="o6"||D=="o7")for(var F=c.length,z=D=="o6",q=0;q<F;q++){var H=c.shift();z?x+=H:y+=H,z=!z,e.U.P.lineTo(l,x,y)}else if(D=="o8"||D=="o24"){F=c.length;for(var $=0;$+6<=F;)g=x+c.shift(),_=y+c.shift(),w=g+c.shift(),S=_+c.shift(),x=w+c.shift(),y=S+c.shift(),e.U.P.curveTo(l,g,_,w,S,x,y),$+=6;D=="o24"&&(x+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,x,y))}else{if(D=="o11")break;if(D=="o1234"||D=="o1235"||D=="o1236"||D=="o1237")D=="o1234"&&(_=y,w=(g=x+c.shift())+c.shift(),M=S=_+c.shift(),E=S,T=y,x=(A=(C=(L=w+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,g,_,w,S,L,M),e.U.P.curveTo(l,C,E,A,T,x,y)),D=="o1235"&&(g=x+c.shift(),_=y+c.shift(),w=g+c.shift(),S=_+c.shift(),L=w+c.shift(),M=S+c.shift(),C=L+c.shift(),E=M+c.shift(),A=C+c.shift(),T=E+c.shift(),x=A+c.shift(),y=T+c.shift(),c.shift(),e.U.P.curveTo(l,g,_,w,S,L,M),e.U.P.curveTo(l,C,E,A,T,x,y)),D=="o1236"&&(g=x+c.shift(),_=y+c.shift(),w=g+c.shift(),M=S=_+c.shift(),E=S,A=(C=(L=w+c.shift())+c.shift())+c.shift(),T=E+c.shift(),x=A+c.shift(),e.U.P.curveTo(l,g,_,w,S,L,M),e.U.P.curveTo(l,C,E,A,T,x,y)),D=="o1237"&&(g=x+c.shift(),_=y+c.shift(),w=g+c.shift(),S=_+c.shift(),L=w+c.shift(),M=S+c.shift(),C=L+c.shift(),E=M+c.shift(),A=C+c.shift(),T=E+c.shift(),Math.abs(A-x)>Math.abs(T-y)?x=A+c.shift():y=T+c.shift(),e.U.P.curveTo(l,g,_,w,S,L,M),e.U.P.curveTo(l,C,E,A,T,x,y));else if(D=="o14"){if(c.length>0&&!h&&(f=c.shift()+o.nominalWidthX,h=!0),c.length==4){var U=c.shift(),X=c.shift(),j=c.shift(),B=c.shift(),Z=e.CFF.glyphBySE(o,j),ie=e.CFF.glyphBySE(o,B);e.U._drawCFF(o.CharStrings[Z],s,o,a,l),s.x=U,s.y=X,e.U._drawCFF(o.CharStrings[ie],s,o,a,l)}p&&(e.U.P.closePath(l),p=!1)}else if(D=="o19"||D=="o20")c.length%2!=0&&!h&&(f=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,h=!0,v+=u+7>>3;else if(D=="o21")c.length>2&&!h&&(f=c.shift()+a.nominalWidthX,h=!0),y+=c.pop(),x+=c.pop(),p&&e.U.P.closePath(l),e.U.P.moveTo(l,x,y),p=!0;else if(D=="o22")c.length>1&&!h&&(f=c.shift()+a.nominalWidthX,h=!0),x+=c.pop(),p&&e.U.P.closePath(l),e.U.P.moveTo(l,x,y),p=!0;else if(D=="o25"){for(;c.length>6;)x+=c.shift(),y+=c.shift(),e.U.P.lineTo(l,x,y);g=x+c.shift(),_=y+c.shift(),w=g+c.shift(),S=_+c.shift(),x=w+c.shift(),y=S+c.shift(),e.U.P.curveTo(l,g,_,w,S,x,y)}else if(D=="o26")for(c.length%2&&(x+=c.shift());c.length>0;)g=x,_=y+c.shift(),x=w=g+c.shift(),y=(S=_+c.shift())+c.shift(),e.U.P.curveTo(l,g,_,w,S,x,y);else if(D=="o27")for(c.length%2&&(y+=c.shift());c.length>0;)_=y,w=(g=x+c.shift())+c.shift(),S=_+c.shift(),x=w+c.shift(),y=S,e.U.P.curveTo(l,g,_,w,S,x,y);else if(D=="o10"||D=="o29"){var V=D=="o10"?a:o;if(c.length==0)console.debug("error: empty stack");else{var te=c.pop(),fe=V.Subrs[te+V.Bias];s.x=x,s.y=y,s.nStems=u,s.haveWidth=h,s.width=f,s.open=p,e.U._drawCFF(fe,s,o,a,l),x=s.x,y=s.y,u=s.nStems,h=s.haveWidth,f=s.width,p=s.open}}else if(D=="o30"||D=="o31"){var he=c.length,le=($=0,D=="o31");for($+=he-(F=-3&he);$<F;)le?(_=y,w=(g=x+c.shift())+c.shift(),y=(S=_+c.shift())+c.shift(),F-$==5?(x=w+c.shift(),$++):x=w,le=!1):(g=x,_=y+c.shift(),w=g+c.shift(),S=_+c.shift(),x=w+c.shift(),F-$==5?(y=S+c.shift(),$++):y=S,le=!0),e.U.P.curveTo(l,g,_,w,S,x,y),$+=4}else{if((D+"").charAt(0)=="o")throw console.debug("Unknown operation: "+D,r),D;c.push(D)}}}s.x=x,s.y=y,s.nStems=u,s.haveWidth=h,s.width=f,s.open=p};var t=e,n={Typr:t};return i.Typr=t,i.default=n,Object.defineProperty(i,"__esModule",{value:!0}),i}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function $ae(){return function(i){var e=Uint8Array,t=Uint16Array,n=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(D,F){for(var z=new t(31),q=0;q<31;++q)z[q]=F+=1<<D[q-1];var H=new n(z[30]);for(q=1;q<30;++q)for(var $=z[q];$<z[q+1];++$)H[$]=$-z[q]<<5|q;return[z,H]},l=a(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var h=a(s,0)[0],f=new t(32768),p=0;p<32768;++p){var v=(43690&p)>>>1|(21845&p)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,f[p]=((65280&v)>>>8|(255&v)<<8)>>>1}var x=function(D,F,z){for(var q=D.length,H=0,$=new t(F);H<q;++H)++$[D[H]-1];var U,X=new t(F);for(H=0;H<F;++H)X[H]=X[H-1]+$[H-1]<<1;{U=new t(1<<F);var j=15-F;for(H=0;H<q;++H)if(D[H])for(var B=H<<4|D[H],Z=F-D[H],ie=X[D[H]-1]++<<Z,V=ie|(1<<Z)-1;ie<=V;++ie)U[f[ie]>>>j]=B}return U},y=new e(288);for(p=0;p<144;++p)y[p]=8;for(p=144;p<256;++p)y[p]=9;for(p=256;p<280;++p)y[p]=7;for(p=280;p<288;++p)y[p]=8;var g=new e(32);for(p=0;p<32;++p)g[p]=5;var _=x(y,9),w=x(g,5),S=function(D){for(var F=D[0],z=1;z<D.length;++z)D[z]>F&&(F=D[z]);return F},C=function(D,F,z){var q=F/8|0;return(D[q]|D[q+1]<<8)>>(7&F)&z},E=function(D,F){var z=F/8|0;return(D[z]|D[z+1]<<8|D[z+2]<<16)>>(7&F)},A=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],T=function(D,F,z){var q=new Error(F||A[D]);if(q.code=D,Error.captureStackTrace&&Error.captureStackTrace(q,T),!z)throw q;return q},L=function(D,F,z){var q=D.length;if(!q||z&&!z.l&&q<5)return F||new e(0);var H=!F||z,$=!z||z.i;z||(z={}),F||(F=new e(3*q));var U,X=function(qe){var ce=F.length;if(qe>ce){var ke=new e(Math.max(2*ce,qe));ke.set(F),F=ke}},j=z.f||0,B=z.p||0,Z=z.b||0,ie=z.l,V=z.d,te=z.m,fe=z.n,he=8*q;do{if(!ie){z.f=j=C(D,B,1);var le=C(D,B+1,3);if(B+=3,!le){var G=D[(K=((U=B)/8|0)+(7&U&&1)+4)-4]|D[K-3]<<8,Q=K+G;if(Q>q){$&&T(0);break}H&&X(Z+G),F.set(D.subarray(K,Q),Z),z.b=Z+=G,z.p=B=8*Q;continue}if(le==1)ie=_,V=w,te=9,fe=5;else if(le==2){var J=C(D,B,31)+257,ne=C(D,B+10,15)+4,Y=J+C(D,B+5,31)+1;B+=14;for(var de=new e(Y),ve=new e(19),Se=0;Se<ne;++Se)ve[o[Se]]=C(D,B+3*Se,7);B+=3*ne;var Te=S(ve),Ee=(1<<Te)-1,Re=x(ve,Te);for(Se=0;Se<Y;){var K,k=Re[C(D,B,Ee)];if(B+=15&k,(K=k>>>4)<16)de[Se++]=K;else{var ue=0,me=0;for(K==16?(me=3+C(D,B,3),B+=2,ue=de[Se-1]):K==17?(me=3+C(D,B,7),B+=3):K==18&&(me=11+C(D,B,127),B+=7);me--;)de[Se++]=ue}}var Me=de.subarray(0,J),ge=de.subarray(J);te=S(Me),fe=S(ge),ie=x(Me,te),V=x(ge,fe)}else T(1);if(B>he){$&&T(0);break}}H&&X(Z+131072);for(var Ye=(1<<te)-1,Ie=(1<<fe)-1,ze=B;;ze=B){var Je=(ue=ie[E(D,B)&Ye])>>>4;if((B+=15&ue)>he){$&&T(0);break}if(ue||T(2),Je<256)F[Z++]=Je;else{if(Je==256){ze=B,ie=null;break}var Fe=Je-254;if(Je>264){var Xe=r[Se=Je-257];Fe=C(D,B,(1<<Xe)-1)+c[Se],B+=Xe}var ct=V[E(D,B)&Ie],tt=ct>>>4;if(ct||T(3),B+=15&ct,ge=h[tt],tt>3&&(Xe=s[tt],ge+=E(D,B)&(1<<Xe)-1,B+=Xe),B>he){$&&T(0);break}H&&X(Z+131072);for(var Ve=Z+Fe;Z<Ve;Z+=4)F[Z]=F[Z-ge],F[Z+1]=F[Z+1-ge],F[Z+2]=F[Z+2-ge],F[Z+3]=F[Z+3-ge];Z=Ve}}z.l=ie,z.p=ze,z.b=Z,ie&&(j=1,z.m=te,z.d=V,z.n=fe)}while(!j);return Z==F.length?F:function(qe,ce,ke){(ke==null||ke>qe.length)&&(ke=qe.length);var ae=new(qe instanceof t?t:qe instanceof n?n:e)(ke-ce);return ae.set(qe.subarray(ce,ke)),ae}(F,0,Z)},M=new e(0),R=typeof TextDecoder<"u"&&new TextDecoder;try{R.decode(M,{stream:!0})}catch{}return i.convert_streams=function(D){var F=new DataView(D),z=0;function q(){var J=F.getUint16(z);return z+=2,J}function H(){var J=F.getUint32(z);return z+=4,J}function $(J){G.setUint16(Q,J),Q+=2}function U(J){G.setUint32(Q,J),Q+=4}for(var X={signature:H(),flavor:H(),length:H(),numTables:q(),reserved:q(),totalSfntSize:H(),majorVersion:q(),minorVersion:q(),metaOffset:H(),metaLength:H(),metaOrigLength:H(),privOffset:H(),privLength:H()},j=0;Math.pow(2,j)<=X.numTables;)j++;j--;for(var B=16*Math.pow(2,j),Z=16*X.numTables-B,ie=12,V=[],te=0;te<X.numTables;te++)V.push({tag:H(),offset:H(),compLength:H(),origLength:H(),origChecksum:H()}),ie+=16;var fe,he=new Uint8Array(12+16*V.length+V.reduce(function(J,ne){return J+ne.origLength+4},0)),le=he.buffer,G=new DataView(le),Q=0;return U(X.flavor),$(X.numTables),$(B),$(j),$(Z),V.forEach(function(J){U(J.tag),U(J.origChecksum),U(ie),U(J.origLength),J.outOffset=ie,(ie+=J.origLength)%4!=0&&(ie+=4-ie%4)}),V.forEach(function(J){var ne,Y=D.slice(J.offset,J.offset+J.compLength);if(J.compLength!=J.origLength){var de=new Uint8Array(J.origLength);ne=new Uint8Array(Y,2),L(ne,de)}else de=new Uint8Array(Y);he.set(de,J.outOffset);var ve=0;(ie=J.outOffset+J.origLength)%4!=0&&(ve=4-ie%4),he.set(new Uint8Array(ve).buffer,J.outOffset+J.origLength),fe=ie+ve}),le.slice(0,fe)},Object.defineProperty(i,"__esModule",{value:!0}),i}({}).convert_streams}function ele(i,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,o=4,a=8,l=16,c=32;let u;function h(A){if(!u){const T={R:s,L:r,D:o,C:l,U:c,T:a};u=new Map;for(let L in n){let M=0;n[L].split(",").forEach(R=>{let[D,F]=R.split("+");D=parseInt(D,36),F=F?parseInt(F,36):0,u.set(M+=D,T[L]);for(let z=F;z--;)u.set(++M,T[L])})}}return u.get(A)||c}const f=1,p=2,v=3,x=4,y=[null,"isol","init","fina","medi"];function g(A){const T=new Uint8Array(A.length);let L=c,M=f,R=-1;for(let D=0;D<A.length;D++){const F=A.codePointAt(D);let z=h(F)|0,q=f;z&a||(L&(r|o|l)?z&(s|o|l)?(q=v,(M===f||M===v)&&T[R]++):z&(r|c)&&(M===p||M===x)&&T[R]--:L&(s|c)&&(M===p||M===x)&&T[R]--,M=T[D]=q,L=z,R=D,F>65535&&D++)}return T}function _(A,T){const L=[];for(let R=0;R<T.length;R++){const D=T.codePointAt(R);D>65535&&R++,L.push(i.U.codeToGlyph(A,D))}const M=A.GSUB;if(M){const{lookupList:R,featureList:D}=M;let F;const z=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,q=[];D.forEach(H=>{if(z.test(H.tag))for(let $=0;$<H.tab.length;$++){if(q[H.tab[$]])continue;q[H.tab[$]]=!0;const U=R[H.tab[$]],X=/^(isol|init|fina|medi)$/.test(H.tag);X&&!F&&(F=g(T));for(let j=0;j<L.length;j++)(!F||!X||y[F[j]]===H.tag)&&i.U._applySubs(L,j,U,R)}})}return L}function w(A,T){const L=new Int16Array(T.length*3);let M=0;for(;M<T.length;M++){const z=T[M];if(z===-1)continue;L[M*3+2]=A.hmtx.aWidth[z];const q=A.GPOS;if(q){const H=q.lookupList;for(let $=0;$<H.length;$++){const U=H[$];for(let X=0;X<U.tabs.length;X++){const j=U.tabs[X];if(U.ltype===1){if(i._lctf.coverageIndex(j.coverage,z)!==-1&&j.pos){F(j.pos,M);break}}else if(U.ltype===2){let B=null,Z=R();if(Z!==-1){const ie=i._lctf.coverageIndex(j.coverage,T[Z]);if(ie!==-1){if(j.fmt===1){const V=j.pairsets[ie];for(let te=0;te<V.length;te++)V[te].gid2===z&&(B=V[te])}else if(j.fmt===2){const V=i.U._getGlyphClass(T[Z],j.classDef1),te=i.U._getGlyphClass(z,j.classDef2);B=j.matrix[V][te]}if(B){B.val1&&F(B.val1,Z),B.val2&&F(B.val2,M);break}}}}else if(U.ltype===4){const B=i._lctf.coverageIndex(j.markCoverage,z);if(B!==-1){const Z=R(D),ie=Z===-1?-1:i._lctf.coverageIndex(j.baseCoverage,T[Z]);if(ie!==-1){const V=j.markArray[B],te=j.baseArray[ie][V.markClass];L[M*3]=te.x-V.x+L[Z*3]-L[Z*3+2],L[M*3+1]=te.y-V.y+L[Z*3+1];break}}}else if(U.ltype===6){const B=i._lctf.coverageIndex(j.mark1Coverage,z);if(B!==-1){const Z=R();if(Z!==-1){const ie=T[Z];if(S(A,ie)===3){const V=i._lctf.coverageIndex(j.mark2Coverage,ie);if(V!==-1){const te=j.mark1Array[B],fe=j.mark2Array[V][te.markClass];L[M*3]=fe.x-te.x+L[Z*3]-L[Z*3+2],L[M*3+1]=fe.y-te.y+L[Z*3+1];break}}}}}}}}else if(A.kern&&!A.cff){const H=R();if(H!==-1){const $=A.kern.glyph1.indexOf(T[H]);if($!==-1){const U=A.kern.rval[$].glyph2.indexOf(z);U!==-1&&(L[H*3+2]+=A.kern.rval[$].vals[U])}}}}return L;function R(z){for(let q=M-1;q>=0;q--)if(T[q]!==-1&&(!z||z(T[q])))return q;return-1}function D(z){return S(A,z)===1}function F(z,q){for(let H=0;H<3;H++)L[q*3+H]+=z[H]||0}}function S(A,T){const L=A.GDEF&&A.GDEF.glyphClassDef;return L?i.U._getGlyphClass(T,L):0}function C(...A){for(let T=0;T<A.length;T++)if(typeof A[T]=="number")return A[T]}function E(A){const T=Object.create(null),L=A["OS/2"],M=A.hhea,R=A.head.unitsPerEm,D=C(L&&L.sTypoAscender,M&&M.ascender,R),F={unitsPerEm:R,ascender:D,descender:C(L&&L.sTypoDescender,M&&M.descender,0),capHeight:C(L&&L.sCapHeight,D),xHeight:C(L&&L.sxHeight,D),lineGap:C(L&&L.sTypoLineGap,M&&M.lineGap),supportsCodePoint(z){return i.U.codeToGlyph(A,z)>0},forEachGlyph(z,q,H,$){let U=0;const X=1/F.unitsPerEm*q,j=_(A,z);let B=0;const Z=w(A,j);return j.forEach((ie,V)=>{if(ie!==-1){let te=T[ie];if(!te){const{cmds:fe,crds:he}=i.U.glyphToPath(A,ie);let le="",G=0;for(let de=0,ve=fe.length;de<ve;de++){const Se=t[fe[de]];le+=fe[de];for(let Te=1;Te<=Se;Te++)le+=(Te>1?",":"")+he[G++]}let Q,J,ne,Y;if(he.length){Q=J=1/0,ne=Y=-1/0;for(let de=0,ve=he.length;de<ve;de+=2){let Se=he[de],Te=he[de+1];Se<Q&&(Q=Se),Te<J&&(J=Te),Se>ne&&(ne=Se),Te>Y&&(Y=Te)}}else Q=ne=J=Y=0;te=T[ie]={index:ie,advanceWidth:A.hmtx.aWidth[ie],xMin:Q,yMin:J,xMax:ne,yMax:Y,path:le}}$.call(null,te,U+Z[V*3]*X,Z[V*3+1]*X,B),U+=Z[V*3+2]*X,H&&(U+=H*q)}B+=z.codePointAt(B)>65535?2:1}),U}};return F}return function(T){const L=new Uint8Array(T,0,4),M=i._bin.readASCII(L,0,4);if(M==="wOFF")T=e(T);else if(M==="wOF2")throw new Error("woff2 fonts not supported");return E(i.parse(T)[0])}}const tle=tm({name:"Typr Font Parser",dependencies:[Jae,$ae,ele],init(i,e,t){const n=i(),r=e();return t(n,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function nle(){return function(i){var e=function(){this.buckets=new Map};e.prototype.add=function(w){var S=w>>5;this.buckets.set(S,(this.buckets.get(S)||0)|1<<(31&w))},e.prototype.has=function(w){var S=this.buckets.get(w>>5);return S!==void 0&&(S&1<<(31&w))!=0},e.prototype.serialize=function(){var w=[];return this.buckets.forEach(function(S,C){w.push((+C).toString(36)+":"+S.toString(36))}),w.join(",")},e.prototype.deserialize=function(w){var S=this;this.buckets.clear(),w.split(",").forEach(function(C){var E=C.split(":");S.buckets.set(parseInt(E[0],36),parseInt(E[1],36))})};var t=Math.pow(2,8),n=t-1,r=~n;function s(w){var S=function(E){return E&r}(w).toString(16),C=function(E){return(E&r)+t-1}(w).toString(16);return"codepoint-index/plane"+(w>>16)+"/"+S+"-"+C+".json"}function o(w,S){var C=w&n,E=S.codePointAt(C/6|0);return((E=(E||48)-48)&1<<C%6)!=0}function a(w,S){var C;(C=w,C.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(E){return E.split("-").map(function(A){return parseInt(A.trim(),16)})})).forEach(function(E){var A=E[0],T=E[1];T===void 0&&(T=A),S(A,T)})}function l(w,S){a(w,function(C,E){for(var A=C;A<=E;A++)S(A)})}var c={},u={},h=new WeakMap,f="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function p(w){var S=h.get(w);return S||(S=new e,l(w.ranges,function(C){return S.add(C)}),h.set(w,S)),S}var v,x=new Map;function y(w,S,C){return w[S]?S:w[C]?C:function(E){for(var A in E)return A}(w)}function g(w,S){var C=S;if(!w.includes(C)){C=1/0;for(var E=0;E<w.length;E++)Math.abs(w[E]-S)<Math.abs(C-S)&&(C=w[E])}return C}function _(w){return v||(v=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(S){v.add(S)})),v.has(w)}return i.CodePointSet=e,i.clearCache=function(){c={},u={}},i.getFontsForString=function(w,S){S===void 0&&(S={});var C,E=S.lang;E===void 0&&(E=new RegExp("\\p{Script=Hangul}","u").test(C=w)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(C)?"ja":"en");var A=S.category;A===void 0&&(A="sans-serif");var T=S.style;T===void 0&&(T="normal");var L=S.weight;L===void 0&&(L=400);var M=(S.dataUrl||f).replace(/\/$/g,""),R=new Map,D=new Uint8Array(w.length),F={},z={},q=new Array(w.length),H=new Map,$=!1;function U(B){var Z=x.get(B);return Z||(Z=fetch(M+"/"+B).then(function(ie){if(!ie.ok)throw new Error(ie.statusText);return ie.json().then(function(V){if(!Array.isArray(V)||V[0]!==1)throw new Error("Incorrect schema version; need 1, got "+V[0]);return V[1]})}).catch(function(ie){if(M!==f)return $||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+M+'", trying default CDN. '+ie.message),$=!0),M=f,x.delete(B),U(B);throw ie}),x.set(B,Z)),Z}for(var X=function(B){var Z=w.codePointAt(B),ie=s(Z);q[B]=ie,c[ie]||H.has(ie)||H.set(ie,U(ie).then(function(V){c[ie]=V})),Z>65535&&(B++,j=B)},j=0;j<w.length;j++)X(j);return Promise.all(H.values()).then(function(){H.clear();for(var B=function(ie){var V=w.codePointAt(ie),te=null,fe=c[q[ie]],he=void 0;for(var le in fe){var G=z[le];if(G===void 0&&(G=z[le]=new RegExp(le).test(E||"en")),G){for(var Q in he=le,fe[le])if(o(V,fe[le][Q])){te=Q;break}break}}if(!te){e:for(var J in fe)if(J!==he){for(var ne in fe[J])if(o(V,fe[J][ne])){te=ne;break e}}}te||(console.debug("No font coverage for U+"+V.toString(16)),te="latin"),q[ie]=te,u[te]||H.has(te)||H.set(te,U("font-meta/"+te+".json").then(function(Y){u[te]=Y})),V>65535&&(ie++,Z=ie)},Z=0;Z<w.length;Z++)B(Z);return Promise.all(H.values())}).then(function(){for(var B,Z=null,ie=0;ie<w.length;ie++){var V=w.codePointAt(ie);if(Z&&(_(V)||p(Z).has(V)))D[ie]=D[ie-1];else{Z=u[q[ie]];var te=F[Z.id];if(!te){var fe=Z.typeforms,he=y(fe,A,"sans-serif"),le=y(fe[he],T,"normal"),G=g((B=fe[he])===null||B===void 0?void 0:B[le],L);te=F[Z.id]=M+"/font-files/"+Z.id+"/"+he+"."+le+"."+G+".woff"}var Q=R.get(te);Q==null&&(Q=R.size,R.set(te,Q)),D[ie]=Q}V>65535&&(ie++,D[ie]=D[ie-1])}return{fontUrls:Array.from(R.keys()),chars:D}})},Object.defineProperty(i,"__esModule",{value:!0}),i}({})}function ile(i,e){const t=Object.create(null),n=Object.create(null);function r(o,a){const l=c=>{console.error(`Failure loading font ${o}`,c)};try{const c=new XMLHttpRequest;c.open("get",o,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const u=i(c.response);u.src=o,a(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function s(o,a){let l=t[o];l?a(l):n[o]?n[o].push(a):(n[o]=[a],r(o,c=>{c.src=o,t[o]=c,n[o].forEach(u=>u(c)),delete n[o]}))}return function(o,a,{lang:l,fonts:c=[],style:u="normal",weight:h="normal",unicodeFontsURL:f}={}){const p=new Uint8Array(o.length),v=[];o.length||_();const x=new Map,y=[];if(u!=="italic"&&(u="normal"),typeof h!="number"&&(h=h==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(S=>!S.lang||S.lang.test(l)).reverse(),c.length){let A=0;(function T(L=0){for(let M=L,R=o.length;M<R;M++){const D=o.codePointAt(M);if(A===1&&v[p[M-1]].supportsCodePoint(D)||/\s/.test(o[M]))p[M]=p[M-1],A===2&&(y[y.length-1][1]=M);else for(let F=p[M],z=c.length;F<=z;F++)if(F===z){const q=A===2?y[y.length-1]:y[y.length]=[M,M];q[1]=M,A=2}else{p[M]=F;const{src:q,unicodeRange:H}=c[F];if(!H||w(D,H)){const $=t[q];if(!$){s(q,()=>{T(M)});return}if($.supportsCodePoint(D)){let U=x.get($);typeof U!="number"&&(U=v.length,v.push($),x.set($,U)),p[M]=U,A=1;break}}}D>65535&&M+1<R&&(p[M+1]=p[M],M++,A===2&&(y[y.length-1][1]=M))}g()})()}else y.push([0,o.length-1]),g();function g(){if(y.length){const S=y.map(C=>o.substring(C[0],C[1]+1)).join(`
`);e.getFontsForString(S,{lang:l||void 0,style:u,weight:h,dataUrl:f}).then(({fontUrls:C,chars:E})=>{const A=v.length;let T=0;y.forEach(M=>{for(let R=0,D=M[1]-M[0];R<=D;R++)p[M[0]+R]=E[T++]+A;T++});let L=0;C.forEach((M,R)=>{s(M,D=>{v[R+A]=D,++L===C.length&&_()})})})}else _()}function _(){a({chars:p,fonts:v})}function w(S,C){for(let E=0;E<C.length;E++){const[A,T=A]=C[E];if(A<=S&&S<=T)return!0}return!1}}}const rle=tm({name:"FontResolver",dependencies:[ile,tle,nle],init(i,e,t){return i(e,t())}});function sle(i,e){const n=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",s=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:v,lang:x,fonts:y,style:g,weight:_,preResolvedFonts:w,unicodeFontsURL:S},C){const E=({chars:A,fonts:T})=>{let L,M;const R=[];for(let D=0;D<A.length;D++)A[D]!==M?(M=A[D],R.push(L={start:D,end:D,fontObj:T[A[D]]})):L.end=D;C(R)};w?E(w):i(v,E,{lang:x,fonts:y,style:g,weight:_,unicodeFontsURL:S})}function a({text:v="",font:x,lang:y,sdfGlyphSize:g=64,fontSize:_=400,fontWeight:w=1,fontStyle:S="normal",letterSpacing:C=0,lineHeight:E="normal",maxWidth:A=1/0,direction:T,textAlign:L="left",textIndent:M=0,whiteSpace:R="normal",overflowWrap:D="normal",anchorX:F=0,anchorY:z=0,metricsOnly:q=!1,unicodeFontsURL:H,preResolvedFonts:$=null,includeCaretPositions:U=!1,chunkedBoundsSize:X=8192,colorRanges:j=null},B){const Z=h(),ie={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),_=+_,C=+C,A=+A,E=E||"normal",M=+M,o({text:v,lang:y,style:S,weight:w,fonts:typeof x=="string"?[{src:x}]:x,unicodeFontsURL:H,preResolvedFonts:$},V=>{ie.fontLoad=h()-Z;const te=isFinite(A);let fe=null,he=null,le=null,G=null,Q=null,J=null,ne=null,Y=null,de=0,ve=0,Se=R!=="nowrap";const Te=new Map,Ee=h();let Re=M,K=0,k=new f;const ue=[k];V.forEach(Ie=>{const{fontObj:ze}=Ie,{ascender:Je,descender:Fe,unitsPerEm:Xe,lineGap:ct,capHeight:tt,xHeight:Ve}=ze;let qe=Te.get(ze);if(!qe){const pe=_/Xe,De=E==="normal"?(Je-Fe+ct)*pe:E*_,$e=(De-(Je-Fe)*pe)/2,je=Math.min(De,(Je-Fe)*pe),rt=(Je+Fe)/2*pe+je/2;qe={index:Te.size,src:ze.src,fontObj:ze,fontSizeMult:pe,unitsPerEm:Xe,ascender:Je*pe,descender:Fe*pe,capHeight:tt*pe,xHeight:Ve*pe,lineHeight:De,baseline:-$e-Je*pe,caretTop:rt,caretBottom:rt-je},Te.set(ze,qe)}const{fontSizeMult:ce}=qe,ke=v.slice(Ie.start,Ie.end+1);let ae,Be;ze.forEachGlyph(ke,_,C,(pe,De,$e,je)=>{De+=K,je+=Ie.start,ae=De,Be=pe;const rt=v.charAt(je),bt=pe.advanceWidth*ce,Ct=k.count;let nt;if("isEmpty"in pe||(pe.isWhitespace=!!rt&&new RegExp(r).test(rt),pe.canBreakAfter=!!rt&&s.test(rt),pe.isEmpty=pe.xMin===pe.xMax||pe.yMin===pe.yMax||n.test(rt)),!pe.isWhitespace&&!pe.isEmpty&&ve++,Se&&te&&!pe.isWhitespace&&De+bt+Re>A&&Ct){if(k.glyphAt(Ct-1).glyphObj.canBreakAfter)nt=new f,Re=-De;else for(let ln=Ct;ln--;)if(ln===0&&D==="break-word"){nt=new f,Re=-De;break}else if(k.glyphAt(ln).glyphObj.canBreakAfter){nt=k.splitAt(ln+1);const Fn=nt.glyphAt(0).x;Re-=Fn;for(let qn=nt.count;qn--;)nt.glyphAt(qn).x-=Fn;break}nt&&(k.isSoftWrapped=!0,k=nt,ue.push(k),de=A)}let Lt=k.glyphAt(k.count);Lt.glyphObj=pe,Lt.x=De+Re,Lt.y=$e,Lt.width=bt,Lt.charIndex=je,Lt.fontData=qe,rt===`
`&&(k=new f,ue.push(k),Re=-(De+bt+C*_)+M)}),K=ae+Be.advanceWidth*ce+C*_});let me=0;ue.forEach(Ie=>{let ze=!0;for(let Je=Ie.count;Je--;){const Fe=Ie.glyphAt(Je);ze&&!Fe.glyphObj.isWhitespace&&(Ie.width=Fe.x+Fe.width,Ie.width>de&&(de=Ie.width),ze=!1);let{lineHeight:Xe,capHeight:ct,xHeight:tt,baseline:Ve}=Fe.fontData;Xe>Ie.lineHeight&&(Ie.lineHeight=Xe);const qe=Ve-Ie.baseline;qe<0&&(Ie.baseline+=qe,Ie.cap+=qe,Ie.ex+=qe),Ie.cap=Math.max(Ie.cap,Ie.baseline+ct),Ie.ex=Math.max(Ie.ex,Ie.baseline+tt)}Ie.baseline-=me,Ie.cap-=me,Ie.ex-=me,me+=Ie.lineHeight});let Me=0,ge=0;if(F&&(typeof F=="number"?Me=-F:typeof F=="string"&&(Me=-de*(F==="left"?0:F==="center"?.5:F==="right"?1:c(F)))),z&&(typeof z=="number"?ge=-z:typeof z=="string"&&(ge=z==="top"?0:z==="top-baseline"?-ue[0].baseline:z==="top-cap"?-ue[0].cap:z==="top-ex"?-ue[0].ex:z==="middle"?me/2:z==="bottom"?me:z==="bottom-baseline"?-ue[ue.length-1].baseline:c(z)*me)),!q){const Ie=e.getEmbeddingLevels(v,T);fe=new Uint16Array(ve),he=new Uint8Array(ve),le=new Float32Array(ve*2),G={},ne=[1/0,1/0,-1/0,-1/0],Y=[],U&&(J=new Float32Array(v.length*4)),j&&(Q=new Uint8Array(ve*3));let ze=0,Je=-1,Fe=-1,Xe,ct;if(ue.forEach((tt,Ve)=>{let{count:qe,width:ce}=tt;if(qe>0){let ke=0;for(let je=qe;je--&&tt.glyphAt(je).glyphObj.isWhitespace;)ke++;let ae=0,Be=0;if(L==="center")ae=(de-ce)/2;else if(L==="right")ae=de-ce;else if(L==="justify"&&tt.isSoftWrapped){let je=0;for(let rt=qe-ke;rt--;)tt.glyphAt(rt).glyphObj.isWhitespace&&je++;Be=(de-ce)/je}if(Be||ae){let je=0;for(let rt=0;rt<qe;rt++){let bt=tt.glyphAt(rt);const Ct=bt.glyphObj;bt.x+=ae+je,Be!==0&&Ct.isWhitespace&&rt<qe-ke&&(je+=Be,bt.width+=Be)}}const pe=e.getReorderSegments(v,Ie,tt.glyphAt(0).charIndex,tt.glyphAt(tt.count-1).charIndex);for(let je=0;je<pe.length;je++){const[rt,bt]=pe[je];let Ct=1/0,nt=-1/0;for(let Lt=0;Lt<qe;Lt++)if(tt.glyphAt(Lt).charIndex>=rt){let ln=Lt,Fn=Lt;for(;Fn<qe;Fn++){let qn=tt.glyphAt(Fn);if(qn.charIndex>bt)break;Fn<qe-ke&&(Ct=Math.min(Ct,qn.x),nt=Math.max(nt,qn.x+qn.width))}for(let qn=ln;qn<Fn;qn++){const wi=tt.glyphAt(qn);wi.x=nt-(wi.x+wi.width-Ct)}break}}let De;const $e=je=>De=je;for(let je=0;je<qe;je++){const rt=tt.glyphAt(je);De=rt.glyphObj;const bt=De.index,Ct=Ie.levels[rt.charIndex]&1;if(Ct){const nt=e.getMirroredCharacter(v[rt.charIndex]);nt&&rt.fontData.fontObj.forEachGlyph(nt,0,0,$e)}if(U){const{charIndex:nt,fontData:Lt}=rt,ln=rt.x+Me,Fn=rt.x+rt.width+Me;J[nt*4]=Ct?Fn:ln,J[nt*4+1]=Ct?ln:Fn,J[nt*4+2]=tt.baseline+Lt.caretBottom+ge,J[nt*4+3]=tt.baseline+Lt.caretTop+ge;const qn=nt-Je;qn>1&&u(J,Je,qn),Je=nt}if(j){const{charIndex:nt}=rt;for(;nt>Fe;)Fe++,j.hasOwnProperty(Fe)&&(ct=j[Fe])}if(!De.isWhitespace&&!De.isEmpty){const nt=ze++,{fontSizeMult:Lt,src:ln,index:Fn}=rt.fontData,qn=G[ln]||(G[ln]={});qn[bt]||(qn[bt]={path:De.path,pathBounds:[De.xMin,De.yMin,De.xMax,De.yMax]});const wi=rt.x+Me,Jr=rt.y+tt.baseline+ge;le[nt*2]=wi,le[nt*2+1]=Jr;const Ir=wi+De.xMin*Lt,Ks=Jr+De.yMin*Lt,rr=wi+De.xMax*Lt,_s=Jr+De.yMax*Lt;Ir<ne[0]&&(ne[0]=Ir),Ks<ne[1]&&(ne[1]=Ks),rr>ne[2]&&(ne[2]=rr),_s>ne[3]&&(ne[3]=_s),nt%X===0&&(Xe={start:nt,end:nt,rect:[1/0,1/0,-1/0,-1/0]},Y.push(Xe)),Xe.end++;const ci=Xe.rect;if(Ir<ci[0]&&(ci[0]=Ir),Ks<ci[1]&&(ci[1]=Ks),rr>ci[2]&&(ci[2]=rr),_s>ci[3]&&(ci[3]=_s),fe[nt]=bt,he[nt]=Fn,j){const Ao=nt*3;Q[Ao]=ct>>16&255,Q[Ao+1]=ct>>8&255,Q[Ao+2]=ct&255}}}}}),J){const tt=v.length-Je;tt>1&&u(J,Je,tt)}}const Ye=[];Te.forEach(({index:Ie,src:ze,unitsPerEm:Je,ascender:Fe,descender:Xe,lineHeight:ct,capHeight:tt,xHeight:Ve})=>{Ye[Ie]={src:ze,unitsPerEm:Je,ascender:Fe,descender:Xe,lineHeight:ct,capHeight:tt,xHeight:Ve}}),ie.typesetting=h()-Ee,B({glyphIds:fe,glyphFontIndices:he,glyphPositions:le,glyphData:G,fontData:Ye,caretPositions:J,glyphColors:Q,chunkedBounds:Y,fontSize:_,topBaseline:ge+ue[0].baseline,blockBounds:[Me,ge-me,Me+de,ge],visibleBounds:ne,timings:ie})})}function l(v,x){a({...v,metricsOnly:!0},y=>{const[g,_,w,S]=y.blockBounds;x({width:w-g,height:S-_})})}function c(v){let x=v.match(/^([\d.]+)%$/),y=x?parseFloat(x[1]):NaN;return isNaN(y)?0:y/100}function u(v,x,y){const g=v[x*4],_=v[x*4+1],w=v[x*4+2],S=v[x*4+3],C=(_-g)/y;for(let E=0;E<y;E++){const A=(x+E)*4;v[A]=g+C*E,v[A+1]=g+C*(E+1),v[A+2]=w,v[A+3]=S}}function h(){return(self.performance||Date).now()}function f(){this.data=[]}const p=["glyphObj","x","y","width","charIndex","fontData"];return f.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/p.length)},glyphAt(v){let x=f.flyweight;return x.data=this.data,x.index=v,x},splitAt(v){let x=new f;return x.data=this.data.splice(v*p.length),x}},f.flyweight=p.reduce((v,x,y,g)=>(Object.defineProperty(v,x,{get(){return this.data[this.index*p.length+y]},set(_){this.data[this.index*p.length+y]=_}}),v),{data:null,index:0}),{typeset:a,measure:l}}const Bh=()=>(self.performance||Date).now(),Yw=jG();let p4;function ole(i,e,t,n,r,s,o,a,l,c,u=!0){return u?lle(i,e,t,n,r,s,o,a,l,c).then(null,h=>(p4||(console.warn("WebGL SDF generation failed, falling back to JS",h),p4=!0),g4(i,e,t,n,r,s,o,a,l,c))):g4(i,e,t,n,r,s,o,a,l,c)}const b1=[],ale=5;let HE=0;function YG(){const i=Bh();for(;b1.length&&Bh()-i<ale;)b1.shift()();HE=b1.length?setTimeout(YG,0):0}const lle=(...i)=>new Promise((e,t)=>{b1.push(()=>{const n=Bh();try{Yw.webgl.generateIntoCanvas(...i),e({timing:Bh()-n})}catch(r){t(r)}}),HE||(HE=setTimeout(YG,0))}),cle=4,ule=2e3,m4={};let hle=0;function g4(i,e,t,n,r,s,o,a,l,c){const u="TroikaTextSDFGenerator_JS_"+hle++%cle;let h=m4[u];return h||(h=m4[u]={workerModule:tm({name:u,workerId:u,dependencies:[jG,Bh],init(f,p){const v=f().javascript.generate;return function(...x){const y=p();return{textureData:v(...x),timing:p()-y}}},getTransferables(f){return[f.textureData.buffer]}}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(i,e,t,n,r,s).then(({textureData:f,timing:p})=>{const v=Bh(),x=new Uint8Array(f.length*4);for(let y=0;y<f.length;y++)x[y*4+c]=f[y];return Yw.webglUtils.renderImageData(o,x,a,l,i,e,1<<3-c),p+=Bh()-v,--h.requests===0&&(h.idleTimer=setTimeout(()=>{Gae(u)},ule)),{timing:p}})}function fle(i){i._warm||(Yw.webgl.isSupported(i),i._warm=!0)}const dle=Yw.webglUtils.resizeWebGLCanvasWithoutClearing,gd={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ple=new Ge;function ad(){return(self.performance||Date).now()}const v4=Object.create(null);function qG(i,e){i=vle({},i);const t=ad(),{defaultFontURL:n}=gd,r=[];if(n&&r.push({label:"default",src:y4(n)}),i.font&&r.push({label:"user",src:y4(i.font)}),i.font=r,i.text=""+i.text,i.sdfGlyphSize=i.sdfGlyphSize||gd.sdfGlyphSize,i.unicodeFontsURL=i.unicodeFontsURL||gd.unicodeFontsURL,i.colorRanges!=null){let f={};for(let p in i.colorRanges)if(i.colorRanges.hasOwnProperty(p)){let v=i.colorRanges[p];typeof v!="number"&&(v=ple.set(v).getHex()),f[p]=v}i.colorRanges=f}Object.freeze(i);const{textureWidth:s,sdfExponent:o}=gd,{sdfGlyphSize:a}=i,l=s/a*4;let c=v4[a];if(!c){const f=document.createElement("canvas");f.width=s,f.height=a*256/l,c=v4[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:f,sdfTexture:new Cn(f,void 0,void 0,void 0,gn,gn),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,mle(c)}const{sdfTexture:u,sdfCanvas:h}=c;xle(i).then(f=>{const{glyphIds:p,glyphFontIndices:v,fontData:x,glyphPositions:y,fontSize:g,timings:_}=f,w=[],S=new Float32Array(p.length*4);let C=0,E=0;const A=ad(),T=x.map(F=>{let z=c.glyphsByFont.get(F.src);return z||c.glyphsByFont.set(F.src,z=new Map),z});p.forEach((F,z)=>{const q=v[z],{src:H,unitsPerEm:$}=x[q];let U=T[q].get(F);if(!U){const{path:ie,pathBounds:V}=f.glyphData[H][F],te=Math.max(V[2]-V[0],V[3]-V[1])/a*(gd.sdfMargin*a+.5),fe=c.glyphCount++,he=[V[0]-te,V[1]-te,V[2]+te,V[3]+te];T[q].set(F,U={path:ie,atlasIndex:fe,sdfViewBox:he}),w.push(U)}const{sdfViewBox:X}=U,j=y[E++],B=y[E++],Z=g/$;S[C++]=j+X[0]*Z,S[C++]=B+X[1]*Z,S[C++]=j+X[2]*Z,S[C++]=B+X[3]*Z,p[z]=U.atlasIndex}),_.quads=(_.quads||0)+(ad()-A);const L=ad();_.sdf={};const M=h.height,R=Math.ceil(c.glyphCount/l),D=Math.pow(2,Math.ceil(Math.log2(R*a)));D>M&&(console.info(`Increasing SDF texture size ${M}->${D}`),dle(h,s,D),u.dispose()),Promise.all(w.map(F=>KG(F,c,i.gpuAccelerateSDF).then(({timing:z})=>{_.sdf[F.atlasIndex]=z}))).then(()=>{w.length&&!c.contextLost&&(ZG(c),u.needsUpdate=!0),_.sdfTotal=ad()-L,_.total=ad()-t,e(Object.freeze({parameters:i,sdfTexture:u,sdfGlyphSize:a,sdfExponent:o,glyphBounds:S,glyphAtlasIndices:p,glyphColors:f.glyphColors,caretPositions:f.caretPositions,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{c.contextLost||fle(h)})}function KG({path:i,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:r,contextLost:s},o){if(s)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:l}=gd,c=Math.max(t[2]-t[0],t[3]-t[1]),u=Math.floor(e/4),h=u%(a/n)*n,f=Math.floor(u/(a/n))*n,p=e%4;return ole(n,n,i,t,c,l,r,h,f,p,o)}function mle(i){const e=i.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),i.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),i.contextLost=!1;const n=[];i.glyphsByFont.forEach(r=>{r.forEach(s=>{n.push(KG(s,i,!0))})}),Promise.all(n).then(()=>{ZG(i),i.sdfTexture.needsUpdate=!0})})}function gle({font:i,characters:e,sdfGlyphSize:t},n){let r=Array.isArray(e)?e.join(`
`):""+e;qG({font:i,sdfGlyphSize:t,text:r},n)}function vle(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}let Nx;function y4(i){return Nx||(Nx=typeof document>"u"?{}:document.createElement("a")),Nx.href=i,Nx.href}function ZG(i){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=i,{width:n,height:r}=e,s=i.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==n*r*4)&&(o=new Uint8Array(n*r*4),t.image={width:n,height:r,data:o},t.flipY=!1,t.isDataTexture=!0),s.readPixels(0,0,n,r,s.RGBA,s.UNSIGNED_BYTE,o)}}const yle=tm({name:"Typesetter",dependencies:[sle,rle,Wae],init(i,e,t){return i(e,t())}}),xle=tm({name:"Typesetter",dependencies:[yle],init(i){return function(e){return new Promise(t=>{i.typeset(e,t)})}},getTransferables(i){const e=[];for(let t in i)i[t]&&i[t].buffer&&e.push(i[t].buffer);return e}}),x4={};function _le(i){let e=x4[i];if(!e){const t=new Ot(1,1,i,i),n=t.clone(),r=t.attributes,s=n.attributes,o=new yt,a=r.uv.count;for(let l=0;l<a;l++)s.position.array[l*3]*=-1,s.normal.array[l*3+2]*=-1;["position","normal","uv"].forEach(l=>{o.setAttribute(l,new lt([...r[l].array,...s[l].array],r[l].itemSize))}),o.setIndex([...t.index.array,...n.index.array.map(l=>l+a)]),o.translate(.5,.5,0),e=x4[i]=o}return e}const wle="aTroikaGlyphBounds",_4="aTroikaGlyphIndex",Sle="aTroikaGlyphColor";class Mle extends Mw{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Li,this.boundingBox=new vn}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const t=this.getIndex().count;this.setDrawRange(e===Vi?t/2:0,e===_n?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=_le(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,r,s){aT(this,wle,e,4),aT(this,_4,t,1),aT(this,Sle,s,3),this._blockBounds=n,this._chunkedBounds=r,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:r,floor:s,min:o,max:a,sin:l,cos:c}=Math,u=r/2,h=r*2,f=Math.abs(t),p=e[0]/f,v=e[2]/f,x=s((p+u)/h)!==s((v+u)/h)?-f:o(l(p)*f,l(v)*f),y=s((p-u)/h)!==s((v-u)/h)?f:a(l(p)*f,l(v)*f),g=s((p+r)/h)!==s((v+r)/h)?f*2:a(f-c(p)*f,f-c(v)*f);n.min.set(x,e[1],t<0?-g:0),n.max.set(y,e[3],t<0?0:g)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(_4).count,n=this._chunkedBounds;if(n)for(let r=n.length;r--;){t=n[r].end;let s=n[r].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=t}}function aT(i,e,t,n){const r=i.getAttribute(e);t?r&&r.array.length===t.length?(r.array.set(t),r.needsUpdate=!0):(i.setAttribute(e,new nu(t,n)),delete i._maxInstanceCount,i.dispose()):r&&i.deleteAttribute(e)}const ble=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Tle=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ele=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Ale=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Cle(i){const e=BE(i,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new be},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Pt(0,0,0,0)},uTroikaClipRect:{value:new Pt(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new be},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Ge},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Nt},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:ble,vertexTransform:Tle,fragmentDefs:Ele,fragmentColorTransform:Ale,customRewriter({vertexShader:t,fragmentShader:n}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(n)&&(n=n.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(t)||(t=t.replace(XG,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const rP=new Yt({color:16777215,side:_n,transparent:!0}),w4=8421504,S4=new Ze,Ox=new N,lT=new N,lg=[],Ple=new N,cT="+x+y";function M4(i){return Array.isArray(i)?i[0]:i}let QG=()=>{const i=new Ae(new Ot(1,1),rP);return QG=()=>i,i},JG=()=>{const i=new Ae(new Ot(1,1,32,1),rP);return JG=()=>i,i};const Rle={type:"syncstart"},Lle={type:"synccomplete"},$G=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Dle=$G.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let eV=class extends Ae{constructor(){const e=new Mle;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=w4,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=cT,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Rle),qG({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(r=>r&&r())})),this.dispatchEvent(Lle),e&&e()})))}onBeforeRender(e,t,n,r,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s),s._hadOwnSide=s.hasOwnProperty("side"),this.geometry.setSide(s._actualSide=s.side),s.side=wo}onAfterRender(e,t,n,r,s,o){s._hadOwnSide?s.side=s._actualSide:delete s.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=rP.clone());if((!e||e.baseMaterial!==t)&&(e=this._derivedMaterial=Cle(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return M4(this.material).getDepthMaterial()}get customDistanceMaterial(){return M4(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:a,blockBounds:l}=r;n.uTroikaSDFTexture.value=a,n.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),n.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,n.uTroikaSDFExponent.value=r.sdfExponent,n.uTroikaTotalBounds.value.fromArray(l),n.uTroikaUseGlyphColors.value=!t&&!!r.glyphColors;let c=0,u=0,h=0,f,p,v,x=0,y=0;if(t){let{outlineWidth:_,outlineOffsetX:w,outlineOffsetY:S,outlineBlur:C,outlineOpacity:E}=this;c=this._parsePercent(_)||0,u=Math.max(0,this._parsePercent(C)||0),f=E,x=this._parsePercent(w)||0,y=this._parsePercent(S)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(v=this.strokeColor,n.uTroikaStrokeColor.value.set(v??w4),p=this.strokeOpacity,p==null&&(p=1)),f=this.fillOpacity;n.uTroikaDistanceOffset.value=c,n.uTroikaPositionOffset.value.set(x,y),n.uTroikaBlurRadius.value=u,n.uTroikaStrokeWidth.value=h,n.uTroikaStrokeOpacity.value=p,n.uTroikaFillOpacity.value=f??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let g=this.clipRect;if(g&&Array.isArray(g)&&g.length===4)n.uTroikaClipRect.value.fromArray(g);else{const _=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(l[0]-_,l[1]-_,l[2]+_,l[3]+_)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=t?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const a=e.hasOwnProperty("color")?e.color:e.color=new Ge;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||cT;if(o!==e._orientation){let a=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==cT&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,h,f]=l;Ox.set(0,0,0)[u]=c==="-"?1:-1,lT.set(0,0,0)[f]=h==="-"?-1:1,S4.lookAt(Ple,Ox.cross(lT),lT),a.setFromMatrix4(S4)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new be){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new be){return Ox.copy(e),this.localPositionToTextCoords(this.worldToLocal(Ox),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:r}=this;if(n){const s=n.blockBounds,o=r?JG():QG(),a=o.geometry,{position:l,uv:c}=a.attributes;for(let u=0;u<c.count;u++){let h=s[0]+c.getX(u)*(s[2]-s[0]);const f=s[1]+c.getY(u)*(s[3]-s[1]);let p=0;r&&(p=r-Math.cos(h/r)*r,h=Math.sin(h/r)*r),l.setXYZ(u,h,f,p)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,lg.length=0,o.raycast(e,lg);for(let u=0;u<lg.length;u++)lg[u].object=this,t.push(lg[u])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Dle.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};$G.forEach(i=>{const e="_private_"+i;Object.defineProperty(eV.prototype,i,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});const Ile=re.forwardRef(({sdfGlyphSize:i=64,anchorX:e="center",anchorY:t="middle",font:n,fontSize:r=1,children:s,characters:o,onSync:a,...l},c)=>{const u=En(({invalidate:v})=>v),[h]=re.useState(()=>new eV),[f,p]=re.useMemo(()=>{const v=[];let x="";return re.Children.forEach(s,y=>{typeof y=="string"||typeof y=="number"?x+=y:v.push(y)}),[v,x]},[s]);return woe(()=>new Promise(v=>gle({font:n,characters:o},v)),["troika-text",n,o]),re.useLayoutEffect(()=>void h.sync(()=>{u(),a&&a(h)})),re.useEffect(()=>()=>h.dispose(),[h]),re.createElement("primitive",al({object:h,ref:c,font:n,text:p,anchorX:e,anchorY:t,fontSize:r,sdfGlyphSize:i},l),f)}),Ule=()=>parseInt(rf.replace(/\D+/g,"")),Fle=Ule(),kle=re.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const h=En(E=>E.invalidate),f=En(E=>E.camera),p=En(E=>E.gl),v=En(E=>E.events),x=En(E=>E.setEvents),y=En(E=>E.set),g=En(E=>E.get),_=En(E=>E.performance),w=e||f,S=n||v.connected||p.domElement,C=re.useMemo(()=>new Pae(w),[w]);return em(()=>{C.enabled&&C.update()},-1),re.useEffect(()=>(s&&C.connect(s===!0?S:s),C.connect(S),()=>void C.dispose()),[s,S,t,C,h]),re.useEffect(()=>{const E=L=>{h(),t&&_.regress(),o&&o(L)},A=L=>{a&&a(L)},T=L=>{l&&l(L)};return C.addEventListener("change",E),C.addEventListener("start",A),C.addEventListener("end",T),()=>{C.removeEventListener("start",A),C.removeEventListener("end",T),C.removeEventListener("change",E)}},[o,a,l,C,h,x]),re.useEffect(()=>{if(i){const E=g().controls;return y({controls:C}),()=>y({controls:E})}},[i,C]),re.createElement("primitive",al({ref:u,object:C,enableDamping:r},c))}),Nle=re.forwardRef(({children:i,domElement:e,onChange:t,onMouseDown:n,onMouseUp:r,onObjectChange:s,object:o,makeDefault:a,camera:l,enabled:c,axis:u,mode:h,translationSnap:f,rotationSnap:p,scaleSnap:v,space:x,size:y,showX:g,showY:_,showZ:w,...S},C)=>{const E=En(B=>B.controls),A=En(B=>B.gl),T=En(B=>B.events),L=En(B=>B.camera),M=En(B=>B.invalidate),R=En(B=>B.get),D=En(B=>B.set),F=l||L,z=e||T.connected||A.domElement,q=re.useMemo(()=>new Mae(F,z),[F,z]),H=re.useRef(null);re.useLayoutEffect(()=>(o?q.attach(o instanceof Kt?o:o.current):H.current instanceof Kt&&q.attach(H.current),()=>void q.detach()),[o,i,q]),re.useEffect(()=>{if(E){const B=Z=>E.enabled=!Z.value;return q.addEventListener("dragging-changed",B),()=>q.removeEventListener("dragging-changed",B)}},[q,E]);const $=re.useRef(),U=re.useRef(),X=re.useRef(),j=re.useRef();return re.useLayoutEffect(()=>void($.current=t),[t]),re.useLayoutEffect(()=>void(U.current=n),[n]),re.useLayoutEffect(()=>void(X.current=r),[r]),re.useLayoutEffect(()=>void(j.current=s),[s]),re.useEffect(()=>{const B=te=>{M(),$.current==null||$.current(te)},Z=te=>U.current==null?void 0:U.current(te),ie=te=>X.current==null?void 0:X.current(te),V=te=>j.current==null?void 0:j.current(te);return q.addEventListener("change",B),q.addEventListener("mouseDown",Z),q.addEventListener("mouseUp",ie),q.addEventListener("objectChange",V),()=>{q.removeEventListener("change",B),q.removeEventListener("mouseDown",Z),q.removeEventListener("mouseUp",ie),q.removeEventListener("objectChange",V)}},[M,q]),re.useEffect(()=>{if(a){const B=R().controls;return D({controls:q}),()=>D({controls:B})}},[a,q]),re.createElement(re.Fragment,null,re.createElement("primitive",{ref:C,object:q,enabled:c,axis:u,mode:h,translationSnap:f,rotationSnap:p,scaleSnap:v,space:x,size:y,showX:g,showY:_,showZ:w}),re.createElement("group",al({ref:H},S),i))});class Ole extends Ft{constructor(e=new be){super({uniforms:{inputBuffer:new We(null),depthBuffer:new We(null),resolution:new We(new be),texelSize:new We(new be),halfTexelSize:new We(new be),kernel:new We(0),scale:new We(1),cameraNear:new We(0),cameraFar:new We(1),minDepthThreshold:new We(0),maxDepthThreshold:new We(1),depthScale:new We(0),depthToBlurRatioBias:new We(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <${Fle>=154?"colorspace_fragment":"encodings_fragment"}>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:ba,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class zle{constructor({gl:e,resolution:t,width:n=500,height:r=500,minDepthThreshold:s=0,maxDepthThreshold:o=1,depthScale:a=0,depthToBlurRatioBias:l=.25}){this.renderToScreen=!1,this.renderTargetA=new vi(t,t,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1,type:Zi}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Ole,this.convolutionMaterial.setTexelSize(1/n,1/r),this.convolutionMaterial.setResolution(new be(n,r)),this.scene=new yp,this.camera=new Gp,this.convolutionMaterial.uniforms.minDepthThreshold.value=s,this.convolutionMaterial.uniforms.maxDepthThreshold.value=o,this.convolutionMaterial.uniforms.depthScale.value=a,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=l,this.convolutionMaterial.defines.USE_DEPTH=a>0;const c=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),u=new Float32Array([0,0,2,0,0,2]),h=new yt;h.setAttribute("position",new wt(c,3)),h.setAttribute("uv",new wt(u,2)),this.screen=new Ae(h,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const r=this.scene,s=this.camera,o=this.renderTargetA,a=this.renderTargetB;let l=this.convolutionMaterial,c=l.uniforms;c.depthBuffer.value=t.depthTexture;const u=l.kernel;let h=t,f,p,v;for(p=0,v=u.length-1;p<v;++p)f=p&1?a:o,c.kernel.value=u[p],c.inputBuffer.value=h.texture,e.setRenderTarget(f),e.render(r,s),h=f;c.kernel.value=u[p],c.inputBuffer.value=h.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,s)}}let Ble=class extends hn{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;(t=e.defines)!=null&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),e.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
			  uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}};const Hle=re.forwardRef(({mixBlur:i=0,mixStrength:e=1,resolution:t=256,blur:n=[0,0],minDepthThreshold:r=.9,maxDepthThreshold:s=1,depthScale:o=0,depthToBlurRatioBias:a=.25,mirror:l=0,distortion:c=1,mixContrast:u=1,distortionMap:h,reflectorOffset:f=0,...p},v)=>{$C({MeshReflectorMaterialImpl:Ble});const x=En(({gl:B})=>B),y=En(({camera:B})=>B),g=En(({scene:B})=>B);n=Array.isArray(n)?n:[n,n];const _=n[0]+n[1]>0,w=re.useRef(null);re.useImperativeHandle(v,()=>w.current,[]);const[S]=re.useState(()=>new Vr),[C]=re.useState(()=>new N),[E]=re.useState(()=>new N),[A]=re.useState(()=>new N),[T]=re.useState(()=>new Ze),[L]=re.useState(()=>new N(0,0,-1)),[M]=re.useState(()=>new Pt),[R]=re.useState(()=>new N),[D]=re.useState(()=>new N),[F]=re.useState(()=>new Pt),[z]=re.useState(()=>new Ze),[q]=re.useState(()=>new Un),H=re.useCallback(()=>{var B;const Z=w.current.parent||((B=w.current)==null?void 0:B.__r3f.parent);if(!Z||(E.setFromMatrixPosition(Z.matrixWorld),A.setFromMatrixPosition(y.matrixWorld),T.extractRotation(Z.matrixWorld),C.set(0,0,1),C.applyMatrix4(T),E.addScaledVector(C,f),R.subVectors(E,A),R.dot(C)>0))return;R.reflect(C).negate(),R.add(E),T.extractRotation(y.matrixWorld),L.set(0,0,-1),L.applyMatrix4(T),L.add(A),D.subVectors(E,L),D.reflect(C).negate(),D.add(E),q.position.copy(R),q.up.set(0,1,0),q.up.applyMatrix4(T),q.up.reflect(C),q.lookAt(D),q.far=y.far,q.updateMatrixWorld(),q.projectionMatrix.copy(y.projectionMatrix),z.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),z.multiply(q.projectionMatrix),z.multiply(q.matrixWorldInverse),z.multiply(Z.matrixWorld),S.setFromNormalAndCoplanarPoint(C,E),S.applyMatrix4(q.matrixWorldInverse),M.set(S.normal.x,S.normal.y,S.normal.z,S.constant);const ie=q.projectionMatrix;F.x=(Math.sign(M.x)+ie.elements[8])/ie.elements[0],F.y=(Math.sign(M.y)+ie.elements[9])/ie.elements[5],F.z=-1,F.w=(1+ie.elements[10])/ie.elements[14],M.multiplyScalar(2/M.dot(F)),ie.elements[2]=M.x,ie.elements[6]=M.y,ie.elements[10]=M.z+1,ie.elements[14]=M.w},[y,f]),[$,U,X,j]=re.useMemo(()=>{const B={minFilter:gn,magFilter:gn,type:Zi},Z=new vi(t,t,B);Z.depthBuffer=!0,Z.depthTexture=new aw(t,t),Z.depthTexture.format=Vc,Z.depthTexture.type=Gh;const ie=new vi(t,t,B),V=new zle({gl:x,resolution:t,width:n[0],height:n[1],minDepthThreshold:r,maxDepthThreshold:s,depthScale:o,depthToBlurRatioBias:a}),te={mirror:l,textureMatrix:z,mixBlur:i,tDiffuse:Z.texture,tDepth:Z.depthTexture,tDiffuseBlur:ie.texture,hasBlur:_,mixStrength:e,minDepthThreshold:r,maxDepthThreshold:s,depthScale:o,depthToBlurRatioBias:a,distortion:c,distortionMap:h,mixContrast:u,"defines-USE_BLUR":_?"":void 0,"defines-USE_DEPTH":o>0?"":void 0,"defines-USE_DISTORTION":h?"":void 0};return[Z,ie,V,te]},[x,n,z,t,l,_,i,e,r,s,o,a,c,h,u]);return em(()=>{var B;const Z=w.current.parent||((B=w.current)==null?void 0:B.__r3f.parent);if(!Z)return;Z.visible=!1;const ie=x.xr.enabled,V=x.shadowMap.autoUpdate;H(),x.xr.enabled=!1,x.shadowMap.autoUpdate=!1,x.setRenderTarget($),x.state.buffers.depth.setMask(!0),x.autoClear||x.clear(),x.render(g,q),_&&X.render(x,$,U),x.xr.enabled=ie,x.shadowMap.autoUpdate=V,Z.visible=!0,x.setRenderTarget(null)}),re.createElement("meshReflectorMaterialImpl",al({attach:"material",key:"key"+j["defines-USE_BLUR"]+j["defines-USE_DEPTH"]+j["defines-USE_DISTORTION"],ref:w},j,p))}),Gle=re.forwardRef(({children:i,enabled:e=!0,speed:t=1,rotationIntensity:n=1,floatIntensity:r=1,floatingRange:s=[-.1,.1],...o},a)=>{const l=re.useRef(null);re.useImperativeHandle(a,()=>l.current,[]);const c=re.useRef(Math.random()*1e4);return em(u=>{var h,f;if(!e||t===0)return;const p=c.current+u.clock.getElapsedTime();l.current.rotation.x=Math.cos(p/4*t)/8*n,l.current.rotation.y=Math.sin(p/4*t)/8*n,l.current.rotation.z=Math.sin(p/4*t)/20*n;let v=Math.sin(p/4*t)/10;v=Ai.mapLinear(v,-.1,.1,(h=s==null?void 0:s[0])!==null&&h!==void 0?h:-.1,(f=s==null?void 0:s[1])!==null&&f!==void 0?f:.1),l.current.position.y=v*r,l.current.updateMatrix()}),re.createElement("group",o,re.createElement("group",{ref:l,matrixAutoUpdate:!1},i))}),av=re.createContext(null),zx=new N,b4=new N,Vle=(i,e,t,n)=>{const r=e.dot(e),s=e.dot(i)-e.dot(t),o=e.dot(n);return o===0?-s/r:(zx.copy(n).multiplyScalar(r/o).sub(e),b4.copy(n).multiplyScalar(s/o).add(t).sub(i),-zx.dot(b4)/zx.dot(zx))},Wle=new N(0,1,0),T4=new Ze,uT=({direction:i,axis:e})=>{const{translation:t,translationLimits:n,annotations:r,annotationsClass:s,depthTest:o,scale:a,lineWidth:l,fixed:c,axisColors:u,hoveredColor:h,opacity:f,onDragStart:p,onDrag:v,onDragEnd:x,userData:y}=re.useContext(av),g=En($=>$.controls),_=re.useRef(null),w=re.useRef(null),S=re.useRef(null),C=re.useRef(0),[E,A]=re.useState(!1),T=re.useCallback($=>{r&&(_.current.innerText=`${t.current[e].toFixed(2)}`,_.current.style.display="block"),$.stopPropagation();const U=new Ze().extractRotation(w.current.matrixWorld),X=$.point.clone(),j=new N().setFromMatrixPosition(w.current.matrixWorld),B=i.clone().applyMatrix4(U).normalize();S.current={clickPoint:X,dir:B},C.current=t.current[e],p({component:"Arrow",axis:e,origin:j,directions:[B]}),g&&(g.enabled=!1),$.target.setPointerCapture($.pointerId)},[r,i,g,p,t,e]),L=re.useCallback($=>{if($.stopPropagation(),E||A(!0),S.current){const{clickPoint:U,dir:X}=S.current,[j,B]=(n==null?void 0:n[e])||[void 0,void 0];let Z=Vle(U,X,$.ray.origin,$.ray.direction);j!==void 0&&(Z=Math.max(Z,j-C.current)),B!==void 0&&(Z=Math.min(Z,B-C.current)),t.current[e]=C.current+Z,r&&(_.current.innerText=`${t.current[e].toFixed(2)}`),T4.makeTranslation(X.x*Z,X.y*Z,X.z*Z),v(T4)}},[r,v,E,t,n,e]),M=re.useCallback($=>{r&&(_.current.style.display="none"),$.stopPropagation(),S.current=null,x(),g&&(g.enabled=!0),$.target.releasePointerCapture($.pointerId)},[r,g,x]),R=re.useCallback($=>{$.stopPropagation(),A(!1)},[]),{cylinderLength:D,coneWidth:F,coneLength:z,matrixL:q}=re.useMemo(()=>{const $=c?l/a*1.6:a/20,U=c?.2:a/5,X=c?1-U:a-U,j=new Qt().setFromUnitVectors(Wle,i.clone().normalize()),B=new Ze().makeRotationFromQuaternion(j);return{cylinderLength:X,coneWidth:$,coneLength:U,matrixL:B}},[i,a,l,c]),H=E?h:u[e];return re.createElement("group",{ref:w},re.createElement("group",{matrix:q,matrixAutoUpdate:!1,onPointerDown:T,onPointerMove:L,onPointerUp:M,onPointerOut:R},r&&re.createElement(ov,{position:[0,-z,0]},re.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:_})),re.createElement("mesh",{visible:!1,position:[0,(D+z)/2,0],userData:y},re.createElement("cylinderGeometry",{args:[F*1.4,F*1.4,D+z,8,1]})),re.createElement(q_,{transparent:!0,raycast:()=>null,depthTest:o,points:[0,0,0,0,D,0],lineWidth:l,side:_n,color:H,opacity:f,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),re.createElement("mesh",{raycast:()=>null,position:[0,D+z/2,0],renderOrder:500},re.createElement("coneGeometry",{args:[F,z,24,1]}),re.createElement("meshBasicMaterial",{transparent:!0,depthTest:o,color:H,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},hT=new N,fT=new N,dT=i=>i*180/Math.PI,jle=i=>i*Math.PI/180,Xle=(i,e,t,n,r)=>{hT.copy(i).sub(t),fT.copy(e).sub(t);const s=n.dot(n),o=r.dot(r),a=hT.dot(n)/s,l=hT.dot(r)/o,c=fT.dot(n)/s,u=fT.dot(r)/o,h=Math.atan2(l,a);return Math.atan2(u,c)-h},Yle=(i,e)=>{let t=Math.floor(i/e);return t=t<0?t+1:t,i-t*e},E4=i=>{let e=Yle(i,2*Math.PI);return Math.abs(e)<1e-6?0:(e<0&&(e+=2*Math.PI),e)},Bx=new Ze,A4=new N,Hx=new la,pT=new N,mT=({dir1:i,dir2:e,axis:t})=>{const{rotationLimits:n,annotations:r,annotationsClass:s,depthTest:o,scale:a,lineWidth:l,fixed:c,axisColors:u,hoveredColor:h,opacity:f,onDragStart:p,onDrag:v,onDragEnd:x,userData:y}=re.useContext(av),g=En(H=>H.controls),_=re.useRef(null),w=re.useRef(null),S=re.useRef(0),C=re.useRef(0),E=re.useRef(null),[A,T]=re.useState(!1),L=re.useCallback(H=>{r&&(_.current.innerText=`${dT(C.current).toFixed(0)}º`,_.current.style.display="block"),H.stopPropagation();const $=H.point.clone(),U=new N().setFromMatrixPosition(w.current.matrixWorld),X=new N().setFromMatrixColumn(w.current.matrixWorld,0).normalize(),j=new N().setFromMatrixColumn(w.current.matrixWorld,1).normalize(),B=new N().setFromMatrixColumn(w.current.matrixWorld,2).normalize(),Z=new Vr().setFromNormalAndCoplanarPoint(B,U);E.current={clickPoint:$,origin:U,e1:X,e2:j,normal:B,plane:Z},p({component:"Rotator",axis:t,origin:U,directions:[X,j,B]}),g&&(g.enabled=!1),H.target.setPointerCapture(H.pointerId)},[r,g,p,t]),M=re.useCallback(H=>{if(H.stopPropagation(),A||T(!0),E.current){const{clickPoint:$,origin:U,e1:X,e2:j,normal:B,plane:Z}=E.current,[ie,V]=(n==null?void 0:n[t])||[void 0,void 0];Hx.copy(H.ray),Hx.intersectPlane(Z,pT),Hx.direction.negate(),Hx.intersectPlane(Z,pT);let te=Xle($,pT,U,X,j),fe=dT(te);H.shiftKey&&(fe=Math.round(fe/10)*10,te=jle(fe)),ie!==void 0&&V!==void 0&&V-ie<2*Math.PI?(te=E4(te),te=te>Math.PI?te-2*Math.PI:te,te=Ai.clamp(te,ie-S.current,V-S.current),C.current=S.current+te):(C.current=E4(S.current+te),C.current=C.current>Math.PI?C.current-2*Math.PI:C.current),r&&(fe=dT(C.current),_.current.innerText=`${fe.toFixed(0)}º`),Bx.makeRotationAxis(B,te),A4.copy(U).applyMatrix4(Bx).sub(U).negate(),Bx.setPosition(A4),v(Bx)}},[r,v,A,n,t]),R=re.useCallback(H=>{r&&(_.current.style.display="none"),H.stopPropagation(),S.current=C.current,E.current=null,x(),g&&(g.enabled=!0),H.target.releasePointerCapture(H.pointerId)},[r,g,x]),D=re.useCallback(H=>{H.stopPropagation(),T(!1)},[]),F=re.useMemo(()=>{const H=i.clone().normalize(),$=e.clone().normalize();return new Ze().makeBasis(H,$,H.clone().cross($))},[i,e]),z=c?.65:a*.65,q=re.useMemo(()=>{const $=[];for(let U=0;U<=32;U++){const X=U*(Math.PI/2)/32;$.push(new N(Math.cos(X)*z,Math.sin(X)*z,0))}return $},[z]);return re.createElement("group",{ref:w,onPointerDown:L,onPointerMove:M,onPointerUp:R,onPointerOut:D,matrix:F,matrixAutoUpdate:!1},r&&re.createElement(ov,{position:[z,z,0]},re.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:_})),re.createElement(q_,{points:q,lineWidth:l*4,visible:!1,userData:y}),re.createElement(q_,{transparent:!0,raycast:()=>null,depthTest:o,points:q,lineWidth:l,side:_n,color:A?h:u[t],opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},qle=(i,e,t)=>{const n=Math.abs(i.x)>=Math.abs(i.y)&&Math.abs(i.x)>=Math.abs(i.z)?0:Math.abs(i.y)>=Math.abs(i.x)&&Math.abs(i.y)>=Math.abs(i.z)?1:2,r=[0,1,2].sort((v,x)=>Math.abs(e.getComponent(x))-Math.abs(e.getComponent(v))),s=n===r[0]?r[1]:r[0],o=i.getComponent(n),a=i.getComponent(s),l=e.getComponent(n),c=e.getComponent(s),u=t.getComponent(n),f=(t.getComponent(s)-u*(a/o))/(c-l*(a/o));return[(u-f*l)/o,f]},Gx=new la,Vx=new N,C4=new Ze,gT=({dir1:i,dir2:e,axis:t})=>{const{translation:n,translationLimits:r,annotations:s,annotationsClass:o,depthTest:a,scale:l,lineWidth:c,fixed:u,axisColors:h,hoveredColor:f,opacity:p,onDragStart:v,onDrag:x,onDragEnd:y,userData:g}=re.useContext(av),_=En(X=>X.controls),w=re.useRef(null),S=re.useRef(null),C=re.useRef(null),E=re.useRef(0),A=re.useRef(0),[T,L]=re.useState(!1),M=re.useCallback(X=>{s&&(w.current.innerText=`${n.current[(t+1)%3].toFixed(2)}, ${n.current[(t+2)%3].toFixed(2)}`,w.current.style.display="block"),X.stopPropagation();const j=X.point.clone(),B=new N().setFromMatrixPosition(S.current.matrixWorld),Z=new N().setFromMatrixColumn(S.current.matrixWorld,0).normalize(),ie=new N().setFromMatrixColumn(S.current.matrixWorld,1).normalize(),V=new N().setFromMatrixColumn(S.current.matrixWorld,2).normalize(),te=new Vr().setFromNormalAndCoplanarPoint(V,B);C.current={clickPoint:j,e1:Z,e2:ie,plane:te},E.current=n.current[(t+1)%3],A.current=n.current[(t+2)%3],v({component:"Slider",axis:t,origin:B,directions:[Z,ie,V]}),_&&(_.enabled=!1),X.target.setPointerCapture(X.pointerId)},[s,_,v,t]),R=re.useCallback(X=>{if(X.stopPropagation(),T||L(!0),C.current){const{clickPoint:j,e1:B,e2:Z,plane:ie}=C.current,[V,te]=(r==null?void 0:r[(t+1)%3])||[void 0,void 0],[fe,he]=(r==null?void 0:r[(t+2)%3])||[void 0,void 0];Gx.copy(X.ray),Gx.intersectPlane(ie,Vx),Gx.direction.negate(),Gx.intersectPlane(ie,Vx),Vx.sub(j);let[le,G]=qle(B,Z,Vx);V!==void 0&&(le=Math.max(le,V-E.current)),te!==void 0&&(le=Math.min(le,te-E.current)),fe!==void 0&&(G=Math.max(G,fe-A.current)),he!==void 0&&(G=Math.min(G,he-A.current)),n.current[(t+1)%3]=E.current+le,n.current[(t+2)%3]=A.current+G,s&&(w.current.innerText=`${n.current[(t+1)%3].toFixed(2)}, ${n.current[(t+2)%3].toFixed(2)}`),C4.makeTranslation(le*B.x+G*Z.x,le*B.y+G*Z.y,le*B.z+G*Z.z),x(C4)}},[s,x,T,n,r,t]),D=re.useCallback(X=>{s&&(w.current.style.display="none"),X.stopPropagation(),C.current=null,y(),_&&(_.enabled=!0),X.target.releasePointerCapture(X.pointerId)},[s,_,y]),F=re.useCallback(X=>{X.stopPropagation(),L(!1)},[]),z=re.useMemo(()=>{const X=i.clone().normalize(),j=e.clone().normalize();return new Ze().makeBasis(X,j,X.clone().cross(j))},[i,e]),q=u?1/7:l/7,H=u?.225:l*.225,$=T?f:h[t],U=re.useMemo(()=>[new N(0,0,0),new N(0,H,0),new N(H,H,0),new N(H,0,0),new N(0,0,0)],[H]);return re.createElement("group",{ref:S,matrix:z,matrixAutoUpdate:!1},s&&re.createElement(ov,{position:[0,0,0]},re.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:w})),re.createElement("group",{position:[q*1.7,q*1.7,0]},re.createElement("mesh",{visible:!0,onPointerDown:M,onPointerMove:R,onPointerUp:D,onPointerOut:F,scale:H,userData:g},re.createElement("planeGeometry",null),re.createElement("meshBasicMaterial",{transparent:!0,depthTest:a,color:$,polygonOffset:!0,polygonOffsetFactor:-10,side:_n,fog:!1})),re.createElement(q_,{position:[-H/2,-H/2,0],transparent:!0,depthTest:a,points:U,lineWidth:c,color:$,opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,userData:g,fog:!1})))},Mg=new N,P4=new N,Kle=(i,e,t,n)=>{const r=e.dot(e),s=e.dot(i)-e.dot(t),o=e.dot(n);return o===0?-s/r:(Mg.copy(n).multiplyScalar(r/o).sub(e),P4.copy(n).multiplyScalar(s/o).add(t).sub(i),-Mg.dot(P4)/Mg.dot(Mg))},Zle=new N(0,1,0),cg=new N,R4=new Ze,vT=({direction:i,axis:e})=>{const{scaleLimits:t,annotations:n,annotationsClass:r,depthTest:s,scale:o,lineWidth:a,fixed:l,axisColors:c,hoveredColor:u,opacity:h,onDragStart:f,onDrag:p,onDragEnd:v,userData:x}=re.useContext(av),y=En(U=>U.size),g=En(U=>U.controls),_=re.useRef(null),w=re.useRef(null),S=re.useRef(null),C=re.useRef(1),E=re.useRef(1),A=re.useRef(null),[T,L]=re.useState(!1),M=l?1.2:1.2*o,R=re.useCallback(U=>{n&&(_.current.innerText=`${E.current.toFixed(2)}`,_.current.style.display="block"),U.stopPropagation();const X=new Ze().extractRotation(w.current.matrixWorld),j=U.point.clone(),B=new N().setFromMatrixPosition(w.current.matrixWorld),Z=i.clone().applyMatrix4(X).normalize(),ie=w.current.matrixWorld.clone(),V=ie.clone().invert(),te=l?1/VG(w.current.getWorldPosition(Mg),o,U.camera,y):1;A.current={clickPoint:j,dir:Z,mPLG:ie,mPLGInv:V,offsetMultiplier:te},f({component:"Sphere",axis:e,origin:B,directions:[Z]}),g&&(g.enabled=!1),U.target.setPointerCapture(U.pointerId)},[n,g,i,f,e,l,o,y]),D=re.useCallback(U=>{if(U.stopPropagation(),T||L(!0),A.current){const{clickPoint:X,dir:j,mPLG:B,mPLGInv:Z,offsetMultiplier:ie}=A.current,[V,te]=(t==null?void 0:t[e])||[1e-5,void 0],he=Kle(X,j,U.ray.origin,U.ray.direction)*ie,le=l?he:he/o;let G=Math.pow(2,le*.2);U.shiftKey&&(G=Math.round(G*10)/10),G=Math.max(G,V/C.current),te!==void 0&&(G=Math.min(G,te/C.current)),E.current=C.current*G,S.current.position.set(0,M+he,0),n&&(_.current.innerText=`${E.current.toFixed(2)}`),cg.set(1,1,1),cg.setComponent(e,G),R4.makeScale(cg.x,cg.y,cg.z).premultiply(B).multiply(Z),p(R4)}},[n,M,p,T,t,e]),F=re.useCallback(U=>{n&&(_.current.style.display="none"),U.stopPropagation(),C.current=E.current,A.current=null,S.current.position.set(0,M,0),v(),g&&(g.enabled=!0),U.target.releasePointerCapture(U.pointerId)},[n,g,v,M]),z=re.useCallback(U=>{U.stopPropagation(),L(!1)},[]),{radius:q,matrixL:H}=re.useMemo(()=>{const U=l?a/o*1.8:o/22.5,X=new Qt().setFromUnitVectors(Zle,i.clone().normalize()),j=new Ze().makeRotationFromQuaternion(X);return{radius:U,matrixL:j}},[i,o,a,l]),$=T?u:c[e];return re.createElement("group",{ref:w},re.createElement("group",{matrix:H,matrixAutoUpdate:!1,onPointerDown:R,onPointerMove:D,onPointerUp:F,onPointerOut:z},n&&re.createElement(ov,{position:[0,M/2,0]},re.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:r,ref:_})),re.createElement("mesh",{ref:S,position:[0,M,0],renderOrder:500,userData:x},re.createElement("sphereGeometry",{args:[q,12,12]}),re.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:$,opacity:h,polygonOffset:!0,polygonOffsetFactor:-10}))))},L4=new Ze,D4=new Ze,I4=new Ze,Wx=new Ze,yT=new Ze,ld=new Ze,U4=new Ze,F4=new Ze,k4=new Ze,cd=new vn,xT=new vn,N4=new N,O4=new N,z4=new N,B4=new N,ug=new N,ud=new N(1,0,0),hd=new N(0,1,0),fd=new N(0,0,1),Qle=re.forwardRef(({enabled:i=!0,matrix:e,onDragStart:t,onDrag:n,onDragEnd:r,autoTransform:s=!0,anchor:o,disableAxes:a=!1,disableSliders:l=!1,disableRotations:c=!1,disableScaling:u=!1,activeAxes:h=[!0,!0,!0],offset:f=[0,0,0],rotation:p=[0,0,0],scale:v=1,lineWidth:x=4,fixed:y=!1,translationLimits:g,rotationLimits:_,scaleLimits:w,depthTest:S=!0,axisColors:C=["#ff2060","#20df80","#2080ff"],hoveredColor:E="#ffff40",annotations:A=!1,annotationsClass:T,opacity:L=1,visible:M=!0,userData:R,children:D,...F},z)=>{const q=En(te=>te.invalidate),H=re.useRef(null),$=re.useRef(null),U=re.useRef(null),X=re.useRef(null),j=re.useRef([0,0,0]),B=re.useRef(new N(1,1,1)),Z=re.useRef(new N(1,1,1));re.useLayoutEffect(()=>{o&&(X.current.updateWorldMatrix(!0,!0),Wx.copy(X.current.matrixWorld).invert(),cd.makeEmpty(),X.current.traverse(te=>{te.geometry&&(te.geometry.boundingBox||te.geometry.computeBoundingBox(),ld.copy(te.matrixWorld).premultiply(Wx),xT.copy(te.geometry.boundingBox),xT.applyMatrix4(ld),cd.union(xT))}),N4.copy(cd.max).add(cd.min).multiplyScalar(.5),O4.copy(cd.max).sub(cd.min).multiplyScalar(.5),z4.copy(O4).multiply(new N(...o)).add(N4),B4.set(...f).add(z4),U.current.position.copy(B4),q())});const ie=re.useMemo(()=>({onDragStart:te=>{L4.copy($.current.matrix),D4.copy($.current.matrixWorld),t&&t(te),q()},onDrag:te=>{I4.copy(H.current.matrixWorld),Wx.copy(I4).invert(),yT.copy(D4).premultiply(te),ld.copy(yT).premultiply(Wx),U4.copy(L4).invert(),F4.copy(ld).multiply(U4),s&&$.current.matrix.copy(ld),n&&n(ld,F4,yT,te),q()},onDragEnd:()=>{r&&r(),q()},translation:j,translationLimits:g,rotationLimits:_,axisColors:C,hoveredColor:E,opacity:L,scale:v,lineWidth:x,fixed:y,depthTest:S,userData:R,annotations:A,annotationsClass:T}),[t,n,r,j,g,_,w,S,v,x,y,...C,E,L,R,s,A,T]),V=new N;return em(te=>{if(y){const fe=VG(U.current.getWorldPosition(V),v,te.camera,te.size);B.current.setScalar(fe)}e&&e instanceof Ze&&($.current.matrix=e),$.current.updateWorldMatrix(!0,!0),k4.makeRotationFromEuler(U.current.rotation).setPosition(U.current.position).premultiply($.current.matrixWorld),Z.current.setFromMatrixScale(k4),ug.copy(B.current).divide(Z.current),(Math.abs(U.current.scale.x-ug.x)>1e-4||Math.abs(U.current.scale.y-ug.y)>1e-4||Math.abs(U.current.scale.z-ug.z)>1e-4)&&(U.current.scale.copy(ug),te.invalidate())}),re.useImperativeHandle(z,()=>$.current,[]),re.createElement(av.Provider,{value:ie},re.createElement("group",{ref:H},re.createElement("group",al({ref:$,matrix:e,matrixAutoUpdate:!1},F),re.createElement("group",{visible:M,ref:U,position:f,rotation:p},i&&re.createElement(re.Fragment,null,!a&&h[0]&&re.createElement(uT,{axis:0,direction:ud}),!a&&h[1]&&re.createElement(uT,{axis:1,direction:hd}),!a&&h[2]&&re.createElement(uT,{axis:2,direction:fd}),!l&&h[0]&&h[1]&&re.createElement(gT,{axis:2,dir1:ud,dir2:hd}),!l&&h[0]&&h[2]&&re.createElement(gT,{axis:1,dir1:fd,dir2:ud}),!l&&h[2]&&h[1]&&re.createElement(gT,{axis:0,dir1:hd,dir2:fd}),!c&&h[0]&&h[1]&&re.createElement(mT,{axis:2,dir1:ud,dir2:hd}),!c&&h[0]&&h[2]&&re.createElement(mT,{axis:1,dir1:fd,dir2:ud}),!c&&h[2]&&h[1]&&re.createElement(mT,{axis:0,dir1:hd,dir2:fd}),!u&&h[0]&&re.createElement(vT,{axis:0,direction:ud}),!u&&h[1]&&re.createElement(vT,{axis:1,direction:hd}),!u&&h[2]&&re.createElement(vT,{axis:2,direction:fd}))),re.createElement("group",{ref:X},D))))});function Jle(){const i=re.useRef(null),e=re.useRef(null);return ft.jsxs(ft.Fragment,{children:[ft.jsx(kle,{enableDamping:!0,makeDefault:!0}),ft.jsx("directionalLight",{position:[1,2,3],intesity:4.5}),ft.jsx("ambientLight",{intensity:1.5}),ft.jsx(Qle,{anchor:[0,0,0],depthTest:!1,lineWidth:4,axisColors:["#9381ff","#ff4d6d","#7ae582"],scale:100,fixed:!0,children:ft.jsxs("mesh",{"position-x":-2,ref:e,children:[ft.jsx("sphereGeometry",{}),ft.jsx("meshStandardMaterial",{color:"orange"}),ft.jsx(ov,{position:[1,1,0],wrapperClass:"label",center:!0,distanceFactor:8,occlude:[i,e],style:{fontFamily:"Helvetica, Arial",background:"#00000088",padding:"15px",borderRadius:"30px",userSelect:"none",whiteSpace:"nowrap"},children:"That's a sphere 💅"})]})}),ft.jsxs("mesh",{ref:i,"position-x":2,scale:1.5,children:[ft.jsx("boxGeometry",{}),ft.jsx("meshStandardMaterial",{color:"mediumpurple"})]}),ft.jsx(Nle,{object:i,mode:"translate"}),ft.jsxs("mesh",{"position-y":-1,"rotation-x":-Math.PI/2,scale:10,children:[ft.jsx("planeGeometry",{}),ft.jsx(Hle,{resolution:1024,blur:[1e3,1e3],mirror:.5,color:"greenyellow"})]}),ft.jsx(Gle,{speed:5,floatIntensity:2,children:ft.jsx(Ile,{font:"./media/fonts/bangers-v20-latin-regular.woff",fontSize:.5,color:"salmon","position-y":2,maxWidth:1,textAlign:"center",children:"I love R3F"})})]})}class $le{constructor(e){this.root=iv(e),this.root.render(ft.jsx(NG,{camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:ft.jsx(Jle,{})}))}}class ece extends Tw{constructor(){super(...arguments);oe(this,"app");oe(this,"appElement")}get number(){return"56"}get title(){return"Drei"}get link(){return"https://threejs-journey.com/lessons/r3f-drei"}open(){this.appElement=document.createElement("div"),this.appElement.style.width="100vw",this.appElement.style.height="100vh",document.body.appendChild(this.appElement),this.app=new $le(this.appElement)}close(){document.body.removeChild(this.appElement)}}const tce=[new qK,new KK,new uQ,new hQ,new fQ,new dQ,new pQ,new mQ,new gQ,new SQ,new bQ,new TQ,new ZQ,new QQ,new JQ,new tJ,new uJ,new qJ,new KJ,new ZJ,new QJ,new JJ,new $J,new i$,new o$,new c$,new f$,new v$,new S$,new T$,new P$,new D$,new F$,new O$,new X$,new Q$,new tee,new See,new Mte,new Tte,new xie,new wie,new Tie,new Eie,new Aie,new Cie,new Iie,new coe,new aae,new ece],nce=new IV(tce.reverse(),".lesson-title",".controls__arrow--left",".controls__arrow--right");nce.run();
//# sourceMappingURL=index-D8zsYfOV.js.map
